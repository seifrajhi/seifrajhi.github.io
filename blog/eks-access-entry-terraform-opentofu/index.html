<!DOCTYPE html><html lang="en" class="blogpost-view-page"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="description" property="og:description" content="EKS Access Entries, Terraform, OpenTofu, Kubernetes, Authentication"/><meta data-react-helmet="true" name="keywords" content="EKS Access Entries,Kubernetes,Terraform,OpenTofu,Authentication"/><meta data-react-helmet="true" name="author" content="@RajhiSaifeddine"/><meta data-react-helmet="true" property="og:title" content="Managing AWS EKS access entries with Terraform and OpenTofu - Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@RajhiSaifeddine"/><meta data-react-helmet="true" name="twitter:title" content="Managing AWS EKS access entries with Terraform and OpenTofu - Blog"/><meta data-react-helmet="true" name="twitter:description" content="EKS Access Entries, Terraform, OpenTofu, Kubernetes, Authentication"/><meta data-react-helmet="true" name="image" property="og:image" content="https://seifrajhi.github.io/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png"/><meta data-react-helmet="true" name="twitter:image" content="https://seifrajhi.github.io/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png"/><meta data-react-helmet="true" property="og:url" content="https://seifrajhi.github.io/blog/eks-access-entry-terraform-opentofu/"/><meta name="theme-color" content="#ffffff"/><link rel="stylesheet" href="/styles.f3bb17c4eaf5735a380f.css"/><link rel="stylesheet"/><link rel="alternate" type="application/rss+xml" title="Saifeddine Rajhi&#x27;s Blog RSS Feed" href="/rss.xml"/><title data-react-helmet="true">Managing AWS EKS access entries with Terraform and OpenTofu - Blog by Saifeddine Rajhi</title><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":"/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png","headline":"Managing AWS EKS access entries with Terraform and OpenTofu","dateCreated":"2024-10-02","datePublished":"2024-10-02","dateModified":"2024-10-02","inLanguage":"en-US","isFamilyFriendly":true,"isAccessibleForFree":true,"author":{"@type":"Person","name":"Saifeddine Rajhi","url":"https://seifrajhi.github.io"},"publisher":{"@type":"Organization","name":"Saifeddine Rajhi's Website"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seifrajhi.github.io/blog/eks-access-entry-terraform-opentofu/"},"keywords":["EKS Access Entries","Kubernetes","Terraform","OpenTofu","Authentication"],"genre":["Platform engineer","software engineering","science","deep learning","statistics"],"articleSection":"Technical Blog","articleBody":"\n> **Setting up EKS authentication and authorization using Infrastructure as Code**\n\n## üìö Introduction\n\nManaging who can access your AWS EKS clusters can be tricky, especially in big companies. Usually, the person who creates the EKS cluster has full control. But this can be a problem for security and management. AWS EKS has new controls called access entries to help manage who can access your Kubernetes clusters more easily.\n\nIn this blog, we will show you how to use Terraform and OpenTofu to set up access entries for your AWS EKS clusters. We will explain what access entries are, the different options you can use, and how this new method makes it easier to manage who can access your clusters.\n\n\n## The Need for EKS access entries\n\nTraditionally, we used a special `aws-auth` [ConfigMap](https://docs.aws.amazon.com/eks/latest/userguide/auth-configmap.html) to define the IAM roles for worker nodes, users, roles, and groups. This method required manual updates and was prone to errors, making it difficult to manage access at scale.\n\nWith the introduction of Access Entries, AWS has provided a more streamlined and efficient way to manage access to EKS clusters. Now, we can manage access directly through the [EKS API](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/eks/index.html) using AWS IAM as an authenticator. This means that when a user logs in to AWS, AWS handles the authentication, verifying the user's identity. When the user connects to Kubernetes, Kubernetes handles the authorization, checking the user's permissions within the cluster.\n\nThis new approach integrates seamlessly with [Kubernetes' RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/) (Role-Based Access Control), providing a more robust and flexible access management system. One significant improvement is the ability to remove the \"default root user\" ‚Äì the hidden cluster administrator created by default. Previously, this user could not be seen or changed, which sometimes caused issues.\n\nBy moving access control to a dedicated infrastructure as code, we can manage access more easily and with less risk. In the old system, there was a chance you would lose cluster access if you deleted the cluster owner. Now, other users can add IAM principals to access the cluster through APIs, making it easier to manage access with [Infrastructure as Code (IaC) tools](https://aws.amazon.com/what-is/iac/#:~:text=Infrastructure%20as%20code%20(IaC)%20is%20used%20for%20infrastructure%20automation%20to,to%20set%20up%20infrastructure%20environments.) like [OpenTofu](https://opentofu.org/), [Terraform](https://www.terraform.io/), [Pulumi](https://www.pulumi.com/), [Ansible](https://docs.ansible.com/ansible-core/devel/getting_started/index.html), and [CloudFormation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html).\n\n<div class=\"note\">\n    <p><strong>üîµ Note:</strong></p>\n    <p>Access Entries also provide predefined access policies that can be assigned to IAM principals outside the cluster through EKS APIs. This allows users to access cluster resources without needing to define RBAC resources inside the Kubernetes cluster, simplifying the management process and enhancing security.</p>\n</div>\n\n## ‚öõÔ∏è Legacy access management: IAM and aws-auth ConfigMaps\n<div class=\"caution\">\n    <p><strong>üö´ Caution:</strong></p>\n    <p>The aws-auth ConfigMap is deprecated.</p>\n</div>\n\nIn the early days of AWS EKS, managing access to Kubernetes clusters was primarily done through AWS IAM roles and the `aws-auth` ConfigMap. This method involved mapping IAM users and roles to Kubernetes RBAC (Role-Based Access Control) roles and groups. The `aws-auth` ConfigMap was a critical component in this setup, serving as the bridge between AWS IAM and Kubernetes RBAC.\n\n### Detailed explanation of the aws-auth ConfigMap\n\nThe `aws-auth` ConfigMap is a Kubernetes configuration map that resides in the `kube-system` namespace of an EKS cluster. It contains mappings that associate AWS IAM roles and users with Kubernetes RBAC roles and groups.\n\nHere is an example of what the `aws-auth` ConfigMap might look like:\n\n```yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: aws-auth\n  namespace: kube-system\ndata:\n  mapRoles: |\n    - rolearn: arn:aws:iam::123456789012:role/EKS-NodeInstanceRole\n      username: system:node:{{EC2PrivateDNSName}}\n      groups:\n        - system:bootstrappers\n        - system:nodes\n  mapUsers: |\n    - userarn: arn:aws:iam::123456789012:user/admin\n      username: admin\n      groups:\n        - system:masters\n  mapAccounts: |\n    - \"123456789012\"\n```\n\n**Components of the aws-auth ConfigMap**\n\n1. **mapRoles**: This section maps IAM roles to Kubernetes usernames and groups. For example, the `EKS-NodeInstanceRole` is mapped to the `system:nodes` group, which grants the necessary permissions for node operations.\n2. **mapUsers**: This section maps IAM users to Kubernetes usernames and groups. For instance, the `admin` user is mapped to the `system:masters` group, granting cluster admin privileges.\n3. **mapAccounts**: This optional section allows specifying AWS account IDs that are trusted to authenticate to the cluster.\n\n### Issues and Challenges with Using IAM and ConfigMap for Access Management\n\nWhile the `aws-auth` ConfigMap provided a way to manage access, it came with several challenges:\n\n1. **Manual updates**: Any changes to access control required manual updates to the `aws-auth` ConfigMap. This process was error-prone and could lead to misconfigurations.\n2. **Scalability**: Managing access for a large number of users and roles became cumbersome. Each change required editing the ConfigMap, which was not scalable in large environments.\n3. **Risk of misconfiguration**: A single mistake in the ConfigMap could break access control, potentially locking out users or granting unintended permissions.\n4. **Lack of visibility**: The `aws-auth` ConfigMap did not provide a clear way to audit or track changes, making it difficult to maintain security and compliance.\n5. **Cluster owner issues**: The default cluster creator had full admin rights, and there was no straightforward way to change the cluster owner. Deleting the cluster owner could result in losing access to the cluster.\n\n### A real world scenario\n\nConsider a scenario where you need to add a new IAM user to the `system:masters` group for admin access. You would need to manually edit the `aws-auth` ConfigMap as follows:\n\n1. Retrieve the current `aws-auth` ConfigMap:\n\n \n```Shell\n    kubectl get configmap aws-auth -n kube-system -o yaml > aws-auth.yaml\n```\n\n2. Edit the `aws-auth.yaml` file to add the new user:\n\n```yaml\n    apiVersion: v1\n    kind: ConfigMap\n    metadata:\n      name: aws-auth\n      namespace: kube-system\n    data:\n      mapRoles: |\n        - rolearn: arn:aws:iam::123456789012:role/EKS-NodeInstanceRole\n          username: system:node:{{EC2PrivateDNSName}}\n          groups:\n            - system:bootstrappers\n            - system:nodes\n      mapUsers: |\n        - userarn: arn:aws:iam::123456789012:user/admin\n          username: admin\n          groups:\n            - system:masters\n        - userarn: arn:aws:iam::123456789012:user/new-admin\n          username: new-admin\n          groups:\n            - system:masters\n      mapAccounts: |\n        - \"123456789012\"\n```\n\n3. Apply the updated ConfigMap:\n\n \n```Shell\n    kubectl apply -f aws-auth.yaml\n```\n\nThis manual process is prone to errors and does not scale well, highlighting the need for a more efficient access management solution.\n\n## EKS API: The New Way of Granting Access\n\nAWS has introduced a new way to manage access to EKS clusters using the EKS API. This method allows you to manage access entries directly through the API, making use of AWS IAM for authentication. This new approach simplifies the process of managing who can access your Kubernetes clusters and integrates seamlessly with Kubernetes' RBAC (Role-Based Access Control).\n\n### Enabling Access entries\n\nTo enable Access Entries on new or existing clusters, you need to use the latest version of the AWS CLI, which includes the `--access-config` option in the EKS create/update commands. Here‚Äôs how you can enable Access Entries:\n\n#### Creating a New cluster with Access entries\n\n```sh\naws eks create-cluster \\\n   --name <CLUSTER_NAME> \\\n   --role-arn <CLUSTER_ROLE_ARN> \\\n   --resources-vpc-config subnetIds=<value>,endpointPublicAccess=true \\\n   --logging '{\"clusterLogging\":[{\"types\":[\"api\",\"audit\",\"authenticator\",\"controllerManager\",\"scheduler\"],\"enabled\":true}]}' \\\n   --access-config authenticationMode=API_AND_CONFIG_MAP\n```\n\n**Updating an existing cluster to use Access entries**\n\n```sh\naws eks update-cluster-config \\\n   --name <CLUSTER_NAME> \\\n   --access-config authenticationMode=API\n```\n\n### Comparison Between the New API and the Old ConfigMap Method\n\n| **Old Method: aws-auth ConfigMap** | **New Method: EKS API** |\n|------------------------------------|-------------------------|\n| **Manual Updates**: Required manual editing of the `aws-auth` ConfigMap to manage access. | **Automated Management**: Access entries can be managed programmatically through the EKS API. |\n| **Scalability Issues**: Difficult to manage access for a large number of users and roles. | **Scalable**: Easier to manage access for a large number of users and roles. |\n| **Risk of Misconfiguration**: Errors in the ConfigMap could break access control. | **Reduced Risk**: Less prone to errors compared to manual ConfigMap updates. |\n| **Cluster Owner Issues**: The default cluster creator had full admin rights, and deleting this user could result in losing access to the cluster. | **Flexible Ownership**: Allows changing the cluster owner and adding IAM principals by other users. |\n\n### Advantages of using the EKS API\n\n1. **Simplified access management**: The EKS API allows you to manage access entries directly, reducing the complexity and risk associated with manual ConfigMap updates.\n2. **Integration with IAM and RBAC**: Combines AWS IAM for authentication and Kubernetes RBAC for authorization, providing a robust and flexible access control system.\n3. **Predefined Access Policies**: AWS provides predefined access policies similar to Kubernetes ClusterRoles:\n   - **AmazonEKSClusterAdminPolicy** ‚Äì cluster-admin\n   - **AmazonEKSAdminPolicy** ‚Äì admin\n   - **AmazonEKSEditPolicy** ‚Äì edit\n   - **AmazonEKSViewPolicy** ‚Äì view\n4. **Enhanced security**: By managing access through the EKS API, you can ensure that only authorized users have access to your clusters, improving overall security.\n5. **Infrastructure as Code (IaC)**: Easily manage access entries using IaC tools like Terraform, OpenTofu, Pulumi, Ansible, and CloudFormation.\n\n### Example AWS CLI commands\n\n**Listing Existing Access Entries**\n\n```sh\naws eks list-access-entries --cluster-name <CLUSTER_NAME>\n```\n\n**Creating a Cluster Access Entry**\n\n```sh\naws eks create-access-entry --cluster-name <CLUSTER_NAME> \\\n  --principal-arn <IAM_PRINCIPAL_ARN>\n```\n\n**Associating an Access Policy to an Access Entry**\n\n```sh\naws eks associate-access-policy --cluster-name <CLUSTER_NAME> \\\n  --principal-arn <IAM_PRINCIPAL_ARN> \\\n  --policy-arn arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy \\\n  --access-scope type=cluster\n```\n\n<div class=\"important\">\n    <p><strong>‚ùó Important:</strong></p>\n    <p>Changing the <b>authentication_mode</b> is a one-way operation. You can switch from <b>CONFIG_MAP</b> to <b>API_AND_CONFIG_MAP</b>, and then to <b>API</b>, but you cannot revert these changes.</p>\n</div>\n\n### Combining EKS API with Kubernetes RBAC\n\nThe EKS API does not replace Kubernetes RBAC but works alongside it. For example, you can create a cluster access entry and then use Kubernetes RBAC to assign permissions:\n\n**1- Creating a Cluster Access Entry**\n\n```sh\naws eks create-access-entry --cluster-name <CLUSTER_NAME> \\\n  --principal-arn <IAM_PRINCIPAL_ARN> \\\n  --kubernetes-groups eks-admins\n```\n\n**2- Applying a Cluster Role Binding**\n\nCreate a `crb.yaml` file with the following content:\n\n```yaml\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: cluster-admin-ae\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- apiGroup: rbac.authorization.k8s.io\n  kind: Group\n  name: eks-admins\n```\n\nApply the Cluster Role Binding:\n\n```sh\nkubectl apply -f crb.yaml\n```\n\n### Managing EKS Access Policies with Terraform and OpenTofu\n\n#### Prerequisites\n\n- **AWS Account**: Ensure you have an AWS account and the necessary permissions to create the required resources.\n- **Terraform**: Install Terraform on your machine.\n- **OpenTofu**: Ensure OpenTofu is installed on your machine.\n\n#### IAC Configuration\n\nHere is an example  configuration to set up an EKS cluster with access entries:\n\n```hcl\nmodule \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"~> 20.0\"\n\n  cluster_name    = \"my-cluster\"\n  cluster_version = \"1.30\"\n\n  cluster_endpoint_public_access  = true\n\n  cluster_addons = {\n    coredns                = {}\n    eks-pod-identity-agent = {}\n    kube-proxy             = {}\n    vpc-cni                = {}\n  }\n\n  vpc_id                   = \"vpc-1234556abcdef\"\n  subnet_ids               = [\"subnet-abcde012\", \"subnet-bcde012a\", \"subnet-fghi345a\"]\n  control_plane_subnet_ids = [\"subnet-xyzde987\", \"subnet-slkjf456\", \"subnet-qeiru789\"]\n\n  # EKS Managed Node Group(s)\n  eks_managed_node_group_defaults = {\n    instance_types = [\"m6i.large\", \"m5.large\", \"m5n.large\", \"m5zn.large\"]\n  }\n\n  eks_managed_node_groups = {\n    example = {\n      # Starting on 1.30, AL2023 is the default AMI type for EKS managed node groups\n      ami_type       = \"AL2023_x86_64_STANDARD\"\n      instance_types = [\"m5.xlarge\"]\n\n      min_size     = 2\n      max_size     = 10\n      desired_size = 2\n    }\n  }\n\n  # Cluster access entry\n  # To add the current caller identity as an administrator\n  enable_cluster_creator_admin_permissions = true\n\n  access_entries = {\n    # One access entry with a policy associated\n    example = {\n      kubernetes_groups = []\n      principal_arn     = \"arn:aws:iam::123456789012:role/something\"\n\n      policy_associations = {\n        example = {\n          policy_arn = \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSViewPolicy\"\n          access_scope = {\n            namespaces = [\"default\"]\n            type       = \"namespace\"\n          }\n        }\n      }\n    }\n  }\n\n  tags = {\n    Environment = \"dev\"\n    Terraform   = \"true\"\n  }\n}\n```\n\n### Explanation of the Code\n\nThis Terraform configuration sets up an AWS EKS cluster with the following components:\n\n1. **EKS Cluster**: Creates an EKS cluster named \"my-cluster\" with version 1.30.\n2. **Cluster Endpoint**: Enables public access to the cluster endpoint.\n3. **Cluster Addons**: Installs essential Kubernetes addons such as CoreDNS, EKS Pod Identity Agent, Kube-Proxy, and VPC CNI.\n4. **VPC Configuration**: Specifies the VPC and subnets for the EKS cluster.\n5. **Managed Node Groups**: Configures managed node groups with specified instance types and sizes.\n6. **Access Entries**: \n   - **Cluster Creator Admin Permissions**: Enables the current caller identity as an administrator.\n   - **Example Access Entry**: Creates an access entry for an IAM role with the ARN `arn:aws:iam::123456789012:role/something`. This entry is associated with the `AmazonEKSViewPolicy`, granting view permissions within the \"default\" namespace.\n\n### Applying the Configuration\n\n1. **Initialize Terraform**:\n \n```Shell\n    terraform init\n```\n\n2. **Plan the Deployment**:\n \n```Shell\n    terraform plan\n```\n\n3. **Apply the Configuration**:\n \n```Shell\n    terraform apply\n```\n\nAlternatively, if you are using OpenTofu:\n\n1. **Initialize OpenTofu**:\n \n```Shell\n    tofu init\n```\n\n2. **Plan the Deployment**:\n \n```Shell\n    tofu plan\n```\n\n3. **Apply the Configuration**:\n \n```Shell\n    tofu apply\n```\n\nThis  configuration automates the setup of an AWS EKS cluster, including the creation of access entries and the association of IAM policies. Specifically, it creates the following:\n\n- **Access entries**:\n  - **Example Access Entry**: Associates the IAM role `arn:aws:iam::123456789012:role/something` with the `AmazonEKSViewPolicy`, granting view permissions within the \"default\" namespace.\n\n- **IAM Policies**:\n  - **AmazonEKSClusterPolicy**: Attached to the EKS cluster IAM role.\n  - **AmazonEKSVPCResourceController**: Attached to the EKS cluster IAM role.\n  - **AmazonEKSViewPolicy**: Associated with the example access entry.\n\n### Checking Access Entries and IAM Policies\n\nAfter the creation is complete, you can verify the access entries and IAM policies using the AWS CLI:\n\n#### List access entries\n\nTo list the access entries for your EKS cluster, use the following command:\n\n```sh\naws eks list-access-entries --cluster-name my-cluster\n```\n\nThis command will output the access entries associated with your cluster, including the IAM role and the policies attached.\n\n#### Describe IAM Role\n\nTo check the IAM policies attached to the EKS cluster IAM role, use the following command:\n\n```sh\naws iam list-attached-role-policies --role-name <IAM_ROLE_NAME>\n```\n\nReplace `<IAM_ROLE_NAME>` with the name of your IAM role. This command will list all the policies attached to the specified IAM role.\n\n### Closing statement\n\nManaging AWS EKS access policies using Terraform and OpenTofu simplifies the process of setting up and maintaining your Kubernetes clusters. By using both AWS IAM policies and Kubernetes RBAC, you can achieve a resilient and flexible access control system. This approach allows you to centrally manage permissions through AWS while also providing fine-grained control within the Kubernetes cluster.\n\n**Until next time üéâ**\n\n<br><br>\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  _**Until next time üéâ**_\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìö References:**\n\n- https://docs.aws.amazon.com/eks/latest/userguide/access-entries.html\n- https://aws.amazon.com/blogs/containers/a-deep-dive-into-simplified-amazon-eks-access-management-controls/\n- https://kubedemy.io/aws-eks-part-20-authentication-and-authorization-with-access-entries\n- https://securitylabs.datadoghq.com/articles/eks-cluster-access-management-deep-dive/\n- https://community.aws/content/2aWo77epP0lbfrWhnqTpWzSSXyu/simplified-eks-cluster-access-management-directly-using-amazon-eks-apis?lang=en\n\n\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordcount":1727}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://seifrajhi.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://seifrajhi.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Managing AWS EKS access entries with Terraform and OpenTofu","item":"https://seifrajhi.github.io/blog/eks-access-entry-terraform-opentofu/"}]}</script><link crossorigin="" href="https://utteranc.es" rel="preconnect"/><link crossorigin="" href="https://www.google-analytics.com" rel="preconnect"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=47ae28bb567c9025f1fee24afb2d20c9" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2"/><style>@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2) format("woff2")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMr3.woff) format("woff")}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-LLPCCGNLH7', 'auto', {"alwaysSendReferrer":true});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LLPCCGNLH7"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-LLPCCGNLH7', {"anonymize_ip":true,"send_page_view":false});gtag('config', 'GTM-5V895PDS', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><link rel="stylesheet"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://seifrajhi.github.io/blog/eks-access-entry-terraform-opentofu/" data-baseprotocol="https:" data-basehost="seifrajhi.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="blogpost-header"><div class="view-page-header"><div class="view-page-header-wrapper"><div class="logo-wrapper"><div class="logo"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained logo-img"><div style="max-width:150px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;174&#x27;%20width=&#x27;150&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" data-src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture><noscript><picture><source type="image/avif" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="name"><a href="/blog/" title="back to blog">Saifeddine <br/> Rajhi</a></div></div><h2 class="blog-title"><a href="/blog/" title="back to the homepage">Blog</a></h2></div></div><nav class="main-navigation"><ul><li><a rel="home" title="Go Home" href="/">Home</a></li><li><a title="Go to my Technical Blog" href="/blog/">Blog</a></li><li><a title="Go to my Thoughts" href="/thoughts/">Thoughts</a></li><li><a title="Review My Resume" href="/cv/platform-engineer/">cv</a></li></ul></nav></div><main><article class="blog-wrapper"><header><figure class="cover"><div class="cover-filter"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper cover cover-image"><div aria-hidden="true" style="padding-top:57.239583333333336%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACaElEQVR42k1SOW8TURDOf0AoEoIKujQ0qVAaGkSFRAlCSLTUkaCgoUEiDRIKh0KgwbHj2N71fcVJHB97eNe73tO78ZEA4m98zLyFiGJ25s3OfN/3Zt7KzG/CUTIITRlTqwRPy5EvwzckRJMKAvKTQTrJ6Xm4albURXYZIXmOw3FR1M7DNlb4wwku9NQDOMMMPGoMRgWR9/WcAOQGTzsQ/xiciV0le0kSu7V/gIdglVMrYeGYG0NTQkDGsU/G/0OjIAiYLKA4dqqIqYeJGedS4SI6xJnfwtSpI5zUMFFzsIndGUkiNvtpTOjs6hJczimk1KARuU1EbgPn8REWhCMAz/wk6RhF6P0DGEMCUCVhGp0Hx2n0Oin0yPfJjGEehlLAaJCD1svC1mXqr5OYv1ceK3n0O98xVgsCjBssAuO8qRA4DV3XCqS2AI9nbZYQ2BUCkuCPywKIxXDM4la4gFlsTU4AB/uY0Dm0q9RchvPlHbzsJ7h2l0AbCGlufCNW44yr4trOqIhacScB1AZ57Kc/QpZ2kdnbxvB0Dz8WPTHk5bKL84dP8fP1C3S6JuRMCcetXah01TOvgaa0Df00hdPiezx7sAHPqvAMWxTUiLmOyGsi9lq4qLzCuZnCLD5BT5GhjqqYhQ0ETol8E/Oog4v5CX7FNfxetKE2PuPDyydQTtLJlpe05cWUtj1Ntm0V38Ibpmh7x+gOZAw1nk8dlklPxqvAOtpBJb1Far9he2sT9+/cxvraLdzdWE8A/7dZ0EYUHiH225dPQTwtIltOO5iTX7hVZL6+webzx3h0bx1rN6/jxrVVrF69gj9Qr8W9/hlIywAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/e4939971a4dca815ae199c22a047da00/4c8c9/eks-entries-cover.webp 750w,/static/e4939971a4dca815ae199c22a047da00/a04f2/eks-entries-cover.webp 1080w,/static/e4939971a4dca815ae199c22a047da00/eff6d/eks-entries-cover.webp 1366w,/static/e4939971a4dca815ae199c22a047da00/6ed78/eks-entries-cover.webp 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png" data-srcset="/static/e4939971a4dca815ae199c22a047da00/596c0/eks-entries-cover.png 750w,/static/e4939971a4dca815ae199c22a047da00/a324d/eks-entries-cover.png 1080w,/static/e4939971a4dca815ae199c22a047da00/3147f/eks-entries-cover.png 1366w,/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png 1920w" alt="Managing AWS EKS access entries with Terraform and OpenTofu"/></picture><noscript><picture><source type="image/webp" srcSet="/static/e4939971a4dca815ae199c22a047da00/4c8c9/eks-entries-cover.webp 750w,/static/e4939971a4dca815ae199c22a047da00/a04f2/eks-entries-cover.webp 1080w,/static/e4939971a4dca815ae199c22a047da00/eff6d/eks-entries-cover.webp 1366w,/static/e4939971a4dca815ae199c22a047da00/6ed78/eks-entries-cover.webp 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png" srcSet="/static/e4939971a4dca815ae199c22a047da00/596c0/eks-entries-cover.png 750w,/static/e4939971a4dca815ae199c22a047da00/a324d/eks-entries-cover.png 1080w,/static/e4939971a4dca815ae199c22a047da00/3147f/eks-entries-cover.png 1366w,/static/e4939971a4dca815ae199c22a047da00/11ec7/eks-entries-cover.png 1920w" alt="Managing AWS EKS access entries with Terraform and OpenTofu"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><figcaption data-nosnippet="" class="image-title">Photo by Saifeddine Rajhi</figcaption></figure><h1>Managing AWS EKS access entries with Terraform and OpenTofu</h1><div data-nosnippet="" class="blog-details"><time class="blog-createdat" dateTime="2024-10-02">Oct 2, 2024</time><span> ‚Ä¢ </span><span class="blog-time2read">10<!-- -->mins<!-- --> read</span><div class="theme-switcher"><div class="theme-switcher-toggler"><div class="theme-switcher-track"></div><div class="theme-switcher-thumb"></div><input class="theme-switcher-input" type="checkbox" readonly="" aria-label="Switch between Dark and Light modes"/></div></div></div><ul data-nosnippet="" class="blog-tags"><li>EKS Access Entries</li><li>Kubernetes</li><li>Terraform</li><li>OpenTofu</li><li>Authentication</li></ul></header><div class="blog-divider"></div><div id="intro"></div><div class="content-wrapper"><div data-nosnippet="" class="blog-content-nav-wrapper"><ul class="blog-content-nav"><h2>Content</h2><ul class="toc-list"></ul></ul></div><div class="content blog-content"><blockquote>
<p><strong>Setting up EKS authentication and authorization using Infrastructure as Code</strong></p>
</blockquote>
<h2 id="-introduction" style="position:relative;"><a href="#-introduction" aria-label=" introduction permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üìö Introduction</h2>
<p>Managing who can access your AWS EKS clusters can be tricky, especially in big companies. Usually, the person who creates the EKS cluster has full control. But this can be a problem for security and management. AWS EKS has new controls called access entries to help manage who can access your Kubernetes clusters more easily.</p>
<p>In this blog, we will show you how to use Terraform and OpenTofu to set up access entries for your AWS EKS clusters. We will explain what access entries are, the different options you can use, and how this new method makes it easier to manage who can access your clusters.</p>
<h2 id="the-need-for-eks-access-entries" style="position:relative;"><a href="#the-need-for-eks-access-entries" aria-label="the need for eks access entries permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The Need for EKS access entries</h2>
<p>Traditionally, we used a special <code class="language-text">aws-auth</code> <a href="https://docs.aws.amazon.com/eks/latest/userguide/auth-configmap.html" target="_blank" rel="noopener noreferrer">ConfigMap</a> to define the IAM roles for worker nodes, users, roles, and groups. This method required manual updates and was prone to errors, making it difficult to manage access at scale.</p>
<p>With the introduction of Access Entries, AWS has provided a more streamlined and efficient way to manage access to EKS clusters. Now, we can manage access directly through the <a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/eks/index.html" target="_blank" rel="noopener noreferrer">EKS API</a> using AWS IAM as an authenticator. This means that when a user logs in to AWS, AWS handles the authentication, verifying the user's identity. When the user connects to Kubernetes, Kubernetes handles the authorization, checking the user's permissions within the cluster.</p>
<p>This new approach integrates seamlessly with <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">Kubernetes' RBAC</a> (Role-Based Access Control), providing a more robust and flexible access management system. One significant improvement is the ability to remove the "default root user" ‚Äì the hidden cluster administrator created by default. Previously, this user could not be seen or changed, which sometimes caused issues.</p>
<p>By moving access control to a dedicated infrastructure as code, we can manage access more easily and with less risk. In the old system, there was a chance you would lose cluster access if you deleted the cluster owner. Now, other users can add IAM principals to access the cluster through APIs, making it easier to manage access with <a href="https://aws.amazon.com/what-is/iac/#:~:text=Infrastructure%20as%20code%20(IaC)%20is%20used%20for%20infrastructure%20automation%20to,to%20set%20up%20infrastructure%20environments." target="_blank" rel="noopener noreferrer">Infrastructure as Code (IaC) tools</a> like <a href="https://opentofu.org/" target="_blank" rel="noopener noreferrer">OpenTofu</a>, <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a>, <a href="https://www.pulumi.com/" target="_blank" rel="noopener noreferrer">Pulumi</a>, <a href="https://docs.ansible.com/ansible-core/devel/getting_started/index.html" target="_blank" rel="noopener noreferrer">Ansible</a>, and <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html" target="_blank" rel="noopener noreferrer">CloudFormation</a>.</p>
<div class="note">
    <p><strong>üîµ Note:</strong></p>
    <p>Access Entries also provide predefined access policies that can be assigned to IAM principals outside the cluster through EKS APIs. This allows users to access cluster resources without needing to define RBAC resources inside the Kubernetes cluster, simplifying the management process and enhancing security.</p>
</div>
<h2 id="Ô∏è-legacy-access-management-iam-and-aws-auth-configmaps" style="position:relative;"><a href="#%EF%B8%8F-legacy-access-management-iam-and-aws-auth-configmaps" aria-label="Ô∏è legacy access management iam and aws auth configmaps permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>‚öõÔ∏è Legacy access management: IAM and aws-auth ConfigMaps</h2>
<div class="caution">
    <p><strong>üö´ Caution:</strong></p>
    <p>The aws-auth ConfigMap is deprecated.</p>
</div>
<p>In the early days of AWS EKS, managing access to Kubernetes clusters was primarily done through AWS IAM roles and the <code class="language-text">aws-auth</code> ConfigMap. This method involved mapping IAM users and roles to Kubernetes RBAC (Role-Based Access Control) roles and groups. The <code class="language-text">aws-auth</code> ConfigMap was a critical component in this setup, serving as the bridge between AWS IAM and Kubernetes RBAC.</p>
<h3 id="detailed-explanation-of-the-aws-auth-configmap" style="position:relative;"><a href="#detailed-explanation-of-the-aws-auth-configmap" aria-label="detailed explanation of the aws auth configmap permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Detailed explanation of the aws-auth ConfigMap</h3>
<p>The <code class="language-text">aws-auth</code> ConfigMap is a Kubernetes configuration map that resides in the <code class="language-text">kube-system</code> namespace of an EKS cluster. It contains mappings that associate AWS IAM roles and users with Kubernetes RBAC roles and groups.</p>
<p>Here is an example of what the <code class="language-text">aws-auth</code> ConfigMap might look like:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> aws<span class="token punctuation">-</span>auth
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>system
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapRoles</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    - rolearn: arn:aws:iam::123456789012:role/EKS-NodeInstanceRole
      username: system:node:{{EC2PrivateDNSName}}
      groups:
        - system:bootstrappers
        - system:nodes</span>
  <span class="token key atrule">mapUsers</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    - userarn: arn:aws:iam::123456789012:user/admin
      username: admin
      groups:
        - system:masters</span>
  <span class="token key atrule">mapAccounts</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    - "123456789012"</span></code></pre></div>
<p><strong>Components of the aws-auth ConfigMap</strong></p>
<ol>
<li><strong>mapRoles</strong>: This section maps IAM roles to Kubernetes usernames and groups. For example, the <code class="language-text">EKS-NodeInstanceRole</code> is mapped to the <code class="language-text">system:nodes</code> group, which grants the necessary permissions for node operations.</li>
<li><strong>mapUsers</strong>: This section maps IAM users to Kubernetes usernames and groups. For instance, the <code class="language-text">admin</code> user is mapped to the <code class="language-text">system:masters</code> group, granting cluster admin privileges.</li>
<li><strong>mapAccounts</strong>: This optional section allows specifying AWS account IDs that are trusted to authenticate to the cluster.</li>
</ol>
<h3 id="issues-and-challenges-with-using-iam-and-configmap-for-access-management" style="position:relative;"><a href="#issues-and-challenges-with-using-iam-and-configmap-for-access-management" aria-label="issues and challenges with using iam and configmap for access management permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Issues and Challenges with Using IAM and ConfigMap for Access Management</h3>
<p>While the <code class="language-text">aws-auth</code> ConfigMap provided a way to manage access, it came with several challenges:</p>
<ol>
<li><strong>Manual updates</strong>: Any changes to access control required manual updates to the <code class="language-text">aws-auth</code> ConfigMap. This process was error-prone and could lead to misconfigurations.</li>
<li><strong>Scalability</strong>: Managing access for a large number of users and roles became cumbersome. Each change required editing the ConfigMap, which was not scalable in large environments.</li>
<li><strong>Risk of misconfiguration</strong>: A single mistake in the ConfigMap could break access control, potentially locking out users or granting unintended permissions.</li>
<li><strong>Lack of visibility</strong>: The <code class="language-text">aws-auth</code> ConfigMap did not provide a clear way to audit or track changes, making it difficult to maintain security and compliance.</li>
<li><strong>Cluster owner issues</strong>: The default cluster creator had full admin rights, and there was no straightforward way to change the cluster owner. Deleting the cluster owner could result in losing access to the cluster.</li>
</ol>
<h3 id="a-real-world-scenario" style="position:relative;"><a href="#a-real-world-scenario" aria-label="a real world scenario permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>A real world scenario</h3>
<p>Consider a scenario where you need to add a new IAM user to the <code class="language-text">system:masters</code> group for admin access. You would need to manually edit the <code class="language-text">aws-auth</code> ConfigMap as follows:</p>
<ol>
<li>
<p>Retrieve the current <code class="language-text">aws-auth</code> ConfigMap:</p>
</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    kubectl get configmap aws-auth <span class="token parameter variable">-n</span> kube-system <span class="token parameter variable">-o</span> yaml <span class="token operator">></span> aws-auth.yaml</code></pre></div>
<ol start="2">
<li>Edit the <code class="language-text">aws-auth.yaml</code> file to add the new user:</li>
</ol>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">    <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
    <span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> aws<span class="token punctuation">-</span>auth
      <span class="token key atrule">namespace</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>system
    <span class="token key atrule">data</span><span class="token punctuation">:</span>
      <span class="token key atrule">mapRoles</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        - rolearn: arn:aws:iam::123456789012:role/EKS-NodeInstanceRole
          username: system:node:{{EC2PrivateDNSName}}
          groups:
            - system:bootstrappers
            - system:nodes</span>
      <span class="token key atrule">mapUsers</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        - userarn: arn:aws:iam::123456789012:user/admin
          username: admin
          groups:
            - system:masters
        - userarn: arn:aws:iam::123456789012:user/new-admin
          username: new-admin
          groups:
            - system:masters</span>
      <span class="token key atrule">mapAccounts</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        - "123456789012"</span></code></pre></div>
<ol start="3">
<li>
<p>Apply the updated ConfigMap:</p>
</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    kubectl apply <span class="token parameter variable">-f</span> aws-auth.yaml</code></pre></div>
<p>This manual process is prone to errors and does not scale well, highlighting the need for a more efficient access management solution.</p>
<h2 id="eks-api-the-new-way-of-granting-access" style="position:relative;"><a href="#eks-api-the-new-way-of-granting-access" aria-label="eks api the new way of granting access permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>EKS API: The New Way of Granting Access</h2>
<p>AWS has introduced a new way to manage access to EKS clusters using the EKS API. This method allows you to manage access entries directly through the API, making use of AWS IAM for authentication. This new approach simplifies the process of managing who can access your Kubernetes clusters and integrates seamlessly with Kubernetes' RBAC (Role-Based Access Control).</p>
<h3 id="enabling-access-entries" style="position:relative;"><a href="#enabling-access-entries" aria-label="enabling access entries permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Enabling Access entries</h3>
<p>To enable Access Entries on new or existing clusters, you need to use the latest version of the AWS CLI, which includes the <code class="language-text">--access-config</code> option in the EKS create/update commands. Here‚Äôs how you can enable Access Entries:</p>
<h4 id="creating-a-new-cluster-with-access-entries" style="position:relative;"><a href="#creating-a-new-cluster-with-access-entries" aria-label="creating a new cluster with access entries permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Creating a New cluster with Access entries</h4>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks create-cluster <span class="token punctuation">\</span>
   <span class="token parameter variable">--name</span> <span class="token operator">&lt;</span>CLUSTER_NAME<span class="token operator">></span> <span class="token punctuation">\</span>
   --role-arn <span class="token operator">&lt;</span>CLUSTER_ROLE_ARN<span class="token operator">></span> <span class="token punctuation">\</span>
   --resources-vpc-config <span class="token assign-left variable">subnetIds</span><span class="token operator">=</span><span class="token operator">&lt;</span>value<span class="token operator">></span>,endpointPublicAccess<span class="token operator">=</span>true <span class="token punctuation">\</span>
   <span class="token parameter variable">--logging</span> <span class="token string">'{"clusterLogging":[{"types":["api","audit","authenticator","controllerManager","scheduler"],"enabled":true}]}'</span> <span class="token punctuation">\</span>
   --access-config <span class="token assign-left variable">authenticationMode</span><span class="token operator">=</span>API_AND_CONFIG_MAP</code></pre></div>
<p><strong>Updating an existing cluster to use Access entries</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks update-cluster-config <span class="token punctuation">\</span>
   <span class="token parameter variable">--name</span> <span class="token operator">&lt;</span>CLUSTER_NAME<span class="token operator">></span> <span class="token punctuation">\</span>
   --access-config <span class="token assign-left variable">authenticationMode</span><span class="token operator">=</span>API</code></pre></div>
<h3 id="comparison-between-the-new-api-and-the-old-configmap-method" style="position:relative;"><a href="#comparison-between-the-new-api-and-the-old-configmap-method" aria-label="comparison between the new api and the old configmap method permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Comparison Between the New API and the Old ConfigMap Method</h3>
<table>
<thead>
<tr>
<th><strong>Old Method: aws-auth ConfigMap</strong></th>
<th><strong>New Method: EKS API</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Manual Updates</strong>: Required manual editing of the <code class="language-text">aws-auth</code> ConfigMap to manage access.</td>
<td><strong>Automated Management</strong>: Access entries can be managed programmatically through the EKS API.</td>
</tr>
<tr>
<td><strong>Scalability Issues</strong>: Difficult to manage access for a large number of users and roles.</td>
<td><strong>Scalable</strong>: Easier to manage access for a large number of users and roles.</td>
</tr>
<tr>
<td><strong>Risk of Misconfiguration</strong>: Errors in the ConfigMap could break access control.</td>
<td><strong>Reduced Risk</strong>: Less prone to errors compared to manual ConfigMap updates.</td>
</tr>
<tr>
<td><strong>Cluster Owner Issues</strong>: The default cluster creator had full admin rights, and deleting this user could result in losing access to the cluster.</td>
<td><strong>Flexible Ownership</strong>: Allows changing the cluster owner and adding IAM principals by other users.</td>
</tr>
</tbody>
</table>
<h3 id="advantages-of-using-the-eks-api" style="position:relative;"><a href="#advantages-of-using-the-eks-api" aria-label="advantages of using the eks api permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Advantages of using the EKS API</h3>
<ol>
<li><strong>Simplified access management</strong>: The EKS API allows you to manage access entries directly, reducing the complexity and risk associated with manual ConfigMap updates.</li>
<li><strong>Integration with IAM and RBAC</strong>: Combines AWS IAM for authentication and Kubernetes RBAC for authorization, providing a robust and flexible access control system.</li>
<li><strong>Predefined Access Policies</strong>: AWS provides predefined access policies similar to Kubernetes ClusterRoles:
<ul>
<li><strong>AmazonEKSClusterAdminPolicy</strong> ‚Äì cluster-admin</li>
<li><strong>AmazonEKSAdminPolicy</strong> ‚Äì admin</li>
<li><strong>AmazonEKSEditPolicy</strong> ‚Äì edit</li>
<li><strong>AmazonEKSViewPolicy</strong> ‚Äì view</li>
</ul>
</li>
<li><strong>Enhanced security</strong>: By managing access through the EKS API, you can ensure that only authorized users have access to your clusters, improving overall security.</li>
<li><strong>Infrastructure as Code (IaC)</strong>: Easily manage access entries using IaC tools like Terraform, OpenTofu, Pulumi, Ansible, and CloudFormation.</li>
</ol>
<h3 id="example-aws-cli-commands" style="position:relative;"><a href="#example-aws-cli-commands" aria-label="example aws cli commands permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example AWS CLI commands</h3>
<p><strong>Listing Existing Access Entries</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks list-access-entries --cluster-name <span class="token operator">&lt;</span>CLUSTER_NAME<span class="token operator">></span></code></pre></div>
<p><strong>Creating a Cluster Access Entry</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks create-access-entry --cluster-name <span class="token operator">&lt;</span>CLUSTER_NAME<span class="token operator">></span> <span class="token punctuation">\</span>
  --principal-arn <span class="token operator">&lt;</span>IAM_PRINCIPAL_ARN<span class="token operator">></span></code></pre></div>
<p><strong>Associating an Access Policy to an Access Entry</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks associate-access-policy --cluster-name <span class="token operator">&lt;</span>CLUSTER_NAME<span class="token operator">></span> <span class="token punctuation">\</span>
  --principal-arn <span class="token operator">&lt;</span>IAM_PRINCIPAL_ARN<span class="token operator">></span> <span class="token punctuation">\</span>
  --policy-arn arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy <span class="token punctuation">\</span>
  --access-scope <span class="token assign-left variable">type</span><span class="token operator">=</span>cluster</code></pre></div>
<div class="important">
    <p><strong>‚ùó Important:</strong></p>
    <p>Changing the <b>authentication_mode</b> is a one-way operation. You can switch from <b>CONFIG_MAP</b> to <b>API_AND_CONFIG_MAP</b>, and then to <b>API</b>, but you cannot revert these changes.</p>
</div>
<h3 id="combining-eks-api-with-kubernetes-rbac" style="position:relative;"><a href="#combining-eks-api-with-kubernetes-rbac" aria-label="combining eks api with kubernetes rbac permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Combining EKS API with Kubernetes RBAC</h3>
<p>The EKS API does not replace Kubernetes RBAC but works alongside it. For example, you can create a cluster access entry and then use Kubernetes RBAC to assign permissions:</p>
<p><strong>1- Creating a Cluster Access Entry</strong></p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks create-access-entry --cluster-name <span class="token operator">&lt;</span>CLUSTER_NAME<span class="token operator">></span> <span class="token punctuation">\</span>
  --principal-arn <span class="token operator">&lt;</span>IAM_PRINCIPAL_ARN<span class="token operator">></span> <span class="token punctuation">\</span>
  --kubernetes-groups eks-admins</code></pre></div>
<p><strong>2- Applying a Cluster Role Binding</strong></p>
<p>Create a <code class="language-text">crb.yaml</code> file with the following content:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRoleBinding
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cluster<span class="token punctuation">-</span>admin<span class="token punctuation">-</span>ae
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cluster<span class="token punctuation">-</span>admin
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> Group
  <span class="token key atrule">name</span><span class="token punctuation">:</span> eks<span class="token punctuation">-</span>admins</code></pre></div>
<p>Apply the Cluster Role Binding:</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl apply <span class="token parameter variable">-f</span> crb.yaml</code></pre></div>
<h3 id="managing-eks-access-policies-with-terraform-and-opentofu" style="position:relative;"><a href="#managing-eks-access-policies-with-terraform-and-opentofu" aria-label="managing eks access policies with terraform and opentofu permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Managing EKS Access Policies with Terraform and OpenTofu</h3>
<h4 id="prerequisites" style="position:relative;"><a href="#prerequisites" aria-label="prerequisites permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Prerequisites</h4>
<ul>
<li><strong>AWS Account</strong>: Ensure you have an AWS account and the necessary permissions to create the required resources.</li>
<li><strong>Terraform</strong>: Install Terraform on your machine.</li>
<li><strong>OpenTofu</strong>: Ensure OpenTofu is installed on your machine.</li>
</ul>
<h4 id="iac-configuration" style="position:relative;"><a href="#iac-configuration" aria-label="iac configuration permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>IAC Configuration</h4>
<p>Here is an example  configuration to set up an EKS cluster with access entries:</p>
<div class="gatsby-highlight" data-language="hcl"><pre class="language-hcl"><code class="language-hcl"><span class="token keyword">module<span class="token type variable"> "eks" </span></span><span class="token punctuation">{</span>
  <span class="token property">source</span>  <span class="token punctuation">=</span> <span class="token string">"terraform-aws-modules/eks/aws"</span>
  <span class="token property">version</span> <span class="token punctuation">=</span> <span class="token string">"~> 20.0"</span>

  <span class="token property">cluster_name</span>    <span class="token punctuation">=</span> <span class="token string">"my-cluster"</span>
  <span class="token property">cluster_version</span> <span class="token punctuation">=</span> <span class="token string">"1.30"</span>

  <span class="token property">cluster_endpoint_public_access</span>  <span class="token punctuation">=</span> <span class="token boolean">true</span>

  <span class="token property">cluster_addons</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
    <span class="token property">coredns</span>                <span class="token punctuation">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token property">eks-pod-identity-agent</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token property">kube-proxy</span>             <span class="token punctuation">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token property">vpc-cni</span>                <span class="token punctuation">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token property">vpc_id</span>                   <span class="token punctuation">=</span> <span class="token string">"vpc-1234556abcdef"</span>
  <span class="token property">subnet_ids</span>               <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"subnet-abcde012"</span>, <span class="token string">"subnet-bcde012a"</span>, <span class="token string">"subnet-fghi345a"</span><span class="token punctuation">]</span>
  <span class="token property">control_plane_subnet_ids</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"subnet-xyzde987"</span>, <span class="token string">"subnet-slkjf456"</span>, <span class="token string">"subnet-qeiru789"</span><span class="token punctuation">]</span>

  <span class="token comment"># EKS Managed Node Group(s)</span>
  <span class="token property">eks_managed_node_group_defaults</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
    <span class="token property">instance_types</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"m6i.large"</span>, <span class="token string">"m5.large"</span>, <span class="token string">"m5n.large"</span>, <span class="token string">"m5zn.large"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token property">eks_managed_node_groups</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
    <span class="token property">example</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
      <span class="token comment"># Starting on 1.30, AL2023 is the default AMI type for EKS managed node groups</span>
      <span class="token property">ami_type</span>       <span class="token punctuation">=</span> <span class="token string">"AL2023_x86_64_STANDARD"</span>
      <span class="token property">instance_types</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"m5.xlarge"</span><span class="token punctuation">]</span>

      <span class="token property">min_size</span>     <span class="token punctuation">=</span> <span class="token number">2</span>
      <span class="token property">max_size</span>     <span class="token punctuation">=</span> <span class="token number">10</span>
      <span class="token property">desired_size</span> <span class="token punctuation">=</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment"># Cluster access entry</span>
  <span class="token comment"># To add the current caller identity as an administrator</span>
  <span class="token property">enable_cluster_creator_admin_permissions</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>

  <span class="token property">access_entries</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
    <span class="token comment"># One access entry with a policy associated</span>
    <span class="token property">example</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
      <span class="token property">kubernetes_groups</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token property">principal_arn</span>     <span class="token punctuation">=</span> <span class="token string">"arn:aws:iam::123456789012:role/something"</span>

      <span class="token property">policy_associations</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
        <span class="token property">example</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
          <span class="token property">policy_arn</span> <span class="token punctuation">=</span> <span class="token string">"arn:aws:eks::aws:cluster-access-policy/AmazonEKSViewPolicy"</span>
          <span class="token property">access_scope</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
            <span class="token property">namespaces</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">"default"</span><span class="token punctuation">]</span>
            <span class="token property">type</span>       <span class="token punctuation">=</span> <span class="token string">"namespace"</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token property">tags</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
    <span class="token property">Environment</span> <span class="token punctuation">=</span> <span class="token string">"dev"</span>
    <span class="token property">Terraform</span>   <span class="token punctuation">=</span> <span class="token string">"true"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="explanation-of-the-code" style="position:relative;"><a href="#explanation-of-the-code" aria-label="explanation of the code permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Explanation of the Code</h3>
<p>This Terraform configuration sets up an AWS EKS cluster with the following components:</p>
<ol>
<li><strong>EKS Cluster</strong>: Creates an EKS cluster named "my-cluster" with version 1.30.</li>
<li><strong>Cluster Endpoint</strong>: Enables public access to the cluster endpoint.</li>
<li><strong>Cluster Addons</strong>: Installs essential Kubernetes addons such as CoreDNS, EKS Pod Identity Agent, Kube-Proxy, and VPC CNI.</li>
<li><strong>VPC Configuration</strong>: Specifies the VPC and subnets for the EKS cluster.</li>
<li><strong>Managed Node Groups</strong>: Configures managed node groups with specified instance types and sizes.</li>
<li><strong>Access Entries</strong>:
<ul>
<li><strong>Cluster Creator Admin Permissions</strong>: Enables the current caller identity as an administrator.</li>
<li><strong>Example Access Entry</strong>: Creates an access entry for an IAM role with the ARN <code class="language-text">arn:aws:iam::123456789012:role/something</code>. This entry is associated with the <code class="language-text">AmazonEKSViewPolicy</code>, granting view permissions within the "default" namespace.</li>
</ul>
</li>
</ol>
<h3 id="applying-the-configuration" style="position:relative;"><a href="#applying-the-configuration" aria-label="applying the configuration permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Applying the Configuration</h3>
<ol>
<li><strong>Initialize Terraform</strong>:</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    terraform init</code></pre></div>
<ol start="2">
<li><strong>Plan the Deployment</strong>:</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    terraform plan</code></pre></div>
<ol start="3">
<li><strong>Apply the Configuration</strong>:</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    terraform apply</code></pre></div>
<p>Alternatively, if you are using OpenTofu:</p>
<ol>
<li><strong>Initialize OpenTofu</strong>:</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    tofu init</code></pre></div>
<ol start="2">
<li><strong>Plan the Deployment</strong>:</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    tofu plan</code></pre></div>
<ol start="3">
<li><strong>Apply the Configuration</strong>:</li>
</ol>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">    tofu apply</code></pre></div>
<p>This  configuration automates the setup of an AWS EKS cluster, including the creation of access entries and the association of IAM policies. Specifically, it creates the following:</p>
<ul>
<li>
<p><strong>Access entries</strong>:</p>
<ul>
<li><strong>Example Access Entry</strong>: Associates the IAM role <code class="language-text">arn:aws:iam::123456789012:role/something</code> with the <code class="language-text">AmazonEKSViewPolicy</code>, granting view permissions within the "default" namespace.</li>
</ul>
</li>
<li>
<p><strong>IAM Policies</strong>:</p>
<ul>
<li><strong>AmazonEKSClusterPolicy</strong>: Attached to the EKS cluster IAM role.</li>
<li><strong>AmazonEKSVPCResourceController</strong>: Attached to the EKS cluster IAM role.</li>
<li><strong>AmazonEKSViewPolicy</strong>: Associated with the example access entry.</li>
</ul>
</li>
</ul>
<h3 id="checking-access-entries-and-iam-policies" style="position:relative;"><a href="#checking-access-entries-and-iam-policies" aria-label="checking access entries and iam policies permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Checking Access Entries and IAM Policies</h3>
<p>After the creation is complete, you can verify the access entries and IAM policies using the AWS CLI:</p>
<h4 id="list-access-entries" style="position:relative;"><a href="#list-access-entries" aria-label="list access entries permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>List access entries</h4>
<p>To list the access entries for your EKS cluster, use the following command:</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws eks list-access-entries --cluster-name my-cluster</code></pre></div>
<p>This command will output the access entries associated with your cluster, including the IAM role and the policies attached.</p>
<h4 id="describe-iam-role" style="position:relative;"><a href="#describe-iam-role" aria-label="describe iam role permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Describe IAM Role</h4>
<p>To check the IAM policies attached to the EKS cluster IAM role, use the following command:</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">aws iam list-attached-role-policies --role-name <span class="token operator">&lt;</span>IAM_ROLE_NAME<span class="token operator">></span></code></pre></div>
<p>Replace <code class="language-text">&lt;IAM_ROLE_NAME></code> with the name of your IAM role. This command will list all the policies attached to the specified IAM role.</p>
<h3 id="closing-statement" style="position:relative;"><a href="#closing-statement" aria-label="closing statement permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Closing statement</h3>
<p>Managing AWS EKS access policies using Terraform and OpenTofu simplifies the process of setting up and maintaining your Kubernetes clusters. By using both AWS IAM policies and Kubernetes RBAC, you can achieve a resilient and flexible access control system. This approach allows you to centrally manage permissions through AWS while also providing fine-grained control within the Kubernetes cluster.</p>
<p><strong>Until next time üéâ</strong></p>
<p><br><br></p>
<blockquote>
<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>
</blockquote>
<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>
<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href="https://www.linkedin.com/in/rajhi-saif/" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/in/rajhi-saif/</a></p>
<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href="https://x.com/rajhisaifeddine" target="_blank" rel="noopener noreferrer">https://x.com/rajhisaifeddine</a></p>
<p><strong>The end ‚úåüèª</strong></p>
<h1 align="center">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>
<p><strong>üìö References:</strong></p>
<ul>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/access-entries.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/userguide/access-entries.html</a></li>
<li><a href="https://aws.amazon.com/blogs/containers/a-deep-dive-into-simplified-amazon-eks-access-management-controls/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/containers/a-deep-dive-into-simplified-amazon-eks-access-management-controls/</a></li>
<li><a href="https://kubedemy.io/aws-eks-part-20-authentication-and-authorization-with-access-entries" target="_blank" rel="noopener noreferrer">https://kubedemy.io/aws-eks-part-20-authentication-and-authorization-with-access-entries</a></li>
<li><a href="https://securitylabs.datadoghq.com/articles/eks-cluster-access-management-deep-dive/" target="_blank" rel="noopener noreferrer">https://securitylabs.datadoghq.com/articles/eks-cluster-access-management-deep-dive/</a></li>
<li><a href="https://community.aws/content/2aWo77epP0lbfrWhnqTpWzSSXyu/simplified-eks-cluster-access-management-directly-using-amazon-eks-apis?lang=en" target="_blank" rel="noopener noreferrer">https://community.aws/content/2aWo77epP0lbfrWhnqTpWzSSXyu/simplified-eks-cluster-access-management-directly-using-amazon-eks-apis?lang=en</a></li>
</ul>
<p><strong>üìÖ Stay updated</strong></p>
<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p></div></div><div id="content-end"></div></article><div data-nosnippet="" class="social-share-wrapper"><h3>Share Your Love</h3><button keywords="" aria-label="Share Via Facebook" class="react-share__ShareButton social-share-item facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" class="svg-inline--fa fa-facebook " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"></path></svg></button><button keywords="" aria-label="Share Via Twitter" class="react-share__ShareButton social-share-item twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></button><button aria-label="Share Via LinkedIn" keywords="" class="react-share__ShareButton social-share-item linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></button><button keywords="" aria-label="Share Via Reddit" class="react-share__ShareButton social-share-item reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" class="svg-inline--fa fa-reddit " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 256C0 114.6 114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256L37.1 512c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256zM349.6 153.6c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34c-34.5 3.7-61.4 33-61.4 68.4l0 .2c-37.5 1.6-71.8 12.3-99 29.1c-10.1-7.8-22.8-12.5-36.5-12.5c-33 0-59.8 26.8-59.8 59.8c0 24 14.1 44.6 34.4 54.1c2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54c0-33-26.8-59.8-59.8-59.8c-13.7 0-26.3 4.6-36.4 12.4c-27.4-17-62.1-27.7-100-29.1l0-.2c0-25.4 18.9-46.5 43.4-49.9l0 0c4.4 18.8 21.3 32.8 41.5 32.8zM177.1 246.9c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6s-31.4-8.8-30.4-30.5s15.4-38.3 32.1-38.3zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6c-1-21.7 11.8-39.3 28.5-39.3s31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9 .8-6.2 3.9-6.5c18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1 .3 5.1 3.6 3.9 6.5z"></path></svg></button><button keywords="" aria-label="Add to Pocket" class="react-share__ShareButton social-share-item pocket" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="get-pocket" class="svg-inline--fa fa-get-pocket " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg></button></div><br/><br/><br/></main><aside class="blogpost-sidebar"><div data-nosnippet="" class="blog-navigation-wrapper"><h3>Read Other Posts</h3><nav class="blog-navigation"><div class="nav-links"><a rel="next" class="next-post" href="/blog/aws-pod-id-agent-boto3-python/">Simplify AWS resource access with EKS Pod Identity Agent and Python SDK<!-- --> ‚Üí</a><a rel="prev" class="prev-post" href="/blog/kubernetes-os-choice/">‚Üê <!-- -->Choosing the right Linux Operating System for your Kubernetes cluster</a><a class="all-posts" href="/blog/">All Posts</a></div></nav></div></aside><footer data-nosnippet=""><div class="footer-wrapper"><div data-nosnippet="" class="social"><ul class="social-list"><li class="social-item social-linkedin"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="linkedin" href="https://www.linkedin.com/in/rajhi-saif/" title="Saifeddine Rajhi on LinkedIn" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg><span>LinkedIn</span></a></li><li class="social-item social-github"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="github" href="https://github.com/seifrajhi" title="Saifeddine Rajhi on Github" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span>GitHub</span></a></li><li class="social-item social-email"><a itemProp="email" eventCategory="social" eventAction="click" eventLabel="email" href="mailto:rajhiseif@gmail.com" title="Saifeddine Rajhi&#x27;s Email"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg><span>Email</span></a></li><li class="social-item social-X/Twitter"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="X/Twitter" href="https://x.com/RajhiSaifeddine" title="Saifeddine Rajhi on X/X/Twitter" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg><span>X/Twitter</span></a></li><li class="social-item social-reddit"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="reddit" href="https://www.reddit.com/user/ScoreApprehensive992/" title="Saifeddine Rajhi on Reddit" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit-alien" class="svg-inline--fa fa-reddit-alien fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M373 138.6c-25.2 0-46.3-17.5-51.9-41l0 0c-30.6 4.3-54.2 30.7-54.2 62.4l0 .2c47.4 1.8 90.6 15.1 124.9 36.3c12.6-9.7 28.4-15.5 45.5-15.5c41.3 0 74.7 33.4 74.7 74.7c0 29.8-17.4 55.5-42.7 67.5c-2.4 86.8-97 156.6-213.2 156.6S45.5 410.1 43 323.4C17.6 311.5 0 285.7 0 255.7c0-41.3 33.4-74.7 74.7-74.7c17.2 0 33 5.8 45.7 15.6c34-21.1 76.8-34.4 123.7-36.4l0-.3c0-44.3 33.7-80.9 76.8-85.5C325.8 50.2 347.2 32 373 32c29.4 0 53.3 23.9 53.3 53.3s-23.9 53.3-53.3 53.3zM157.5 255.3c-20.9 0-38.9 20.8-40.2 47.9s17.1 38.1 38 38.1s36.6-9.8 37.8-36.9s-14.7-49.1-35.7-49.1zM395 303.1c-1.2-27.1-19.2-47.9-40.2-47.9s-36.9 22-35.7 49.1c1.2 27.1 16.9 36.9 37.8 36.9s39.3-11 38-38.1zm-60.1 70.8c1.5-3.6-1-7.7-4.9-8.1c-23-2.3-47.9-3.6-73.8-3.6s-50.8 1.3-73.8 3.6c-3.9 .4-6.4 4.5-4.9 8.1c12.9 30.8 43.3 52.4 78.7 52.4s65.8-21.6 78.7-52.4z"></path></svg><span>Reddit</span></a></li><li class="social-item social-stackoverflow"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://stackoverflow.com/users/21897244/saifeddine-rajhi" title="Saifeddine Rajhi on StackOverflow" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="stack-overflow" class="svg-inline--fa fa-stack-overflow fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg><span>StackOverflow</span></a></li><li class="social-item social-Goodreads"><a rel="me" eventLabel="StackOverflow" href="https://www.goodreads.com/user/show/176103378-saifeddine" title="Saifeddine Rajhi on Goodreads" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="goodreads" class="svg-inline--fa fa-goodreads fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M299.9 191.2c5.1 37.3-4.7 79-35.9 100.7-22.3 15.5-52.8 14.1-70.8 5.7-37.1-17.3-49.5-58.6-46.8-97.2 4.3-60.9 40.9-87.9 75.3-87.5 46.9-.2 71.8 31.8 78.2 78.3zM448 88v336c0 30.9-25.1 56-56 56H56c-30.9 0-56-25.1-56-56V88c0-30.9 25.1-56 56-56h336c30.9 0 56 25.1 56 56zM330 313.2s-.1-34-.1-217.3h-29v40.3c-.8.3-1.2-.5-1.6-1.2-9.6-20.7-35.9-46.3-76-46-51.9.4-87.2 31.2-100.6 77.8-4.3 14.9-5.8 30.1-5.5 45.6 1.7 77.9 45.1 117.8 112.4 115.2 28.9-1.1 54.5-17 69-45.2.5-1 1.1-1.9 1.7-2.9.2.1.4.1.6.2.3 3.8.2 30.7.1 34.5-.2 14.8-2 29.5-7.2 43.5-7.8 21-22.3 34.7-44.5 39.5-17.8 3.9-35.6 3.8-53.2-1.2-21.5-6.1-36.5-19-41.1-41.8-.3-1.6-1.3-1.3-2.3-1.3h-26.8c.8 10.6 3.2 20.3 8.5 29.2 24.2 40.5 82.7 48.5 128.2 37.4 49.9-12.3 67.3-54.9 67.4-106.3z"></path></svg><span>Goodreads</span></a></li><li class="social-item social-osi"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://ossinsight.io/analyze/seifrajhi" title="Saifeddine Rajhi on OSSInsights" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="osi" class="svg-inline--fa fa-osi fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M8 266.44C10.3 130.64 105.4 34 221.8 18.34c138.8-18.6 255.6 75.8 278 201.1 21.3 118.8-44 230-151.6 274-9.3 3.8-14.4 1.7-18-7.7q-26.7-69.45-53.4-139c-3.1-8.1-1-13.2 7-16.8 24.2-11 39.3-29.4 43.3-55.8a71.47 71.47 0 0 0-64.5-82.2c-39-3.4-71.8 23.7-77.5 59.7-5.2 33 11.1 63.7 41.9 77.7 9.6 4.4 11.5 8.6 7.8 18.4q-26.85 69.9-53.7 139.9c-2.6 6.9-8.3 9.3-15.5 6.5-52.6-20.3-101.4-61-130.8-119-24.9-49.2-25.2-87.7-26.8-108.7zm20.9-1.9c.4 6.6.6 14.3 1.3 22.1 6.3 71.9 49.6 143.5 131 183.1 3.2 1.5 4.4.8 5.6-2.3q22.35-58.65 45-117.3c1.3-3.3.6-4.8-2.4-6.7-31.6-19.9-47.3-48.5-45.6-86 1-21.6 9.3-40.5 23.8-56.3 30-32.7 77-39.8 115.5-17.6a91.64 91.64 0 0 1 45.2 90.4c-3.6 30.6-19.3 53.9-45.7 69.8-2.7 1.6-3.5 2.9-2.3 6q22.8 58.8 45.2 117.7c1.2 3.1 2.4 3.8 5.6 2.3 35.5-16.6 65.2-40.3 88.1-72 34.8-48.2 49.1-101.9 42.3-161-13.7-117.5-119.4-214.8-255.5-198-106.1 13-195.3 102.5-197.1 225.8z"></path></svg><span>OSSInsights</span></a></li><li class="social-item social-devstats"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://devstats.cluster.fun/?user=seifrajhi" title="Saifeddine Rajhi on DevStats" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chart-line" class="svg-inline--fa fa-chart-line fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64L0 400c0 44.2 35.8 80 80 80l400 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 416c-8.8 0-16-7.2-16-16L64 64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"></path></svg><span>DevStats</span></a></li><li class="social-item social-RSS"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="RSS" href="https://seifrajhi.github.io/rss.xml" title="Subscribe to my blog post" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg><span>RSS</span></a></li></ul></div><div class="copyright">Saifeddine Rajhi ¬© 1994 - <!-- -->2024<!-- --> <br/><a rel="license" href="https://creativecommons.org/licenses/by/4.0/" title="Content is published under CC BY 4.0 license">CC BY 4.0</a></div><div class="pgp"><a href="https://keybase.io/saifrajhi">0C3B BABB 8BC1 EA2B</a></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/eks-access-entry-terraform-opentofu/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-26cd7e4ffafe4b5866ba.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-88fb5c28d68e831e730a.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-83bdb4e48c18bf191297.js\"],\"component---src-pages-blog-js\":[\"/component---src-pages-blog-js-6c9f539d882b31737b03.js\"],\"component---src-pages-cv-platform-engineer-js\":[\"/component---src-pages-cv-platform-engineer-js-13625961a6abec0cbdf1.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-635e45002a3b3339b137.js\"],\"component---src-pages-thoughts-js\":[\"/component---src-pages-thoughts-js-fe54f831bbb3f7f31564.js\"],\"component---src-templates-blog-template-js\":[\"/component---src-templates-blog-template-js-43b163172ed2ce4e492d.js\"],\"component---src-templates-thought-template-js\":[\"/component---src-templates-thought-template-js-7ddf4a0a920bf599f1a2.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="4595bb9a61696dab4748";</script><script src="/webpack-runtime-b52987cbf9e0728ddd5e.js" async></script><script src="/framework-c989293af61a95023f7f.js" async></script><script src="/app-26cd7e4ffafe4b5866ba.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>