<!DOCTYPE html><html lang="en" class="blogpost-view-page"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="description" property="og:description" content="AWS SDK for Python, Boto3, Pod identity agent, EKS"/><meta data-react-helmet="true" name="keywords" content="AWS,EKS,Pod Identity Agent,Python SDK,Cloud Native"/><meta data-react-helmet="true" name="author" content="@RajhiSaifeddine"/><meta data-react-helmet="true" property="og:title" content="Simplify AWS resource access with EKS Pod Identity Agent and Python SDK - Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@RajhiSaifeddine"/><meta data-react-helmet="true" name="twitter:title" content="Simplify AWS resource access with EKS Pod Identity Agent and Python SDK - Blog"/><meta data-react-helmet="true" name="twitter:description" content="AWS SDK for Python, Boto3, Pod identity agent, EKS"/><meta data-react-helmet="true" name="image" property="og:image" content="https://seifrajhi.github.io/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png"/><meta data-react-helmet="true" name="twitter:image" content="https://seifrajhi.github.io/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png"/><meta data-react-helmet="true" property="og:url" content="https://seifrajhi.github.io/blog/aws-pod-id-agent-boto3-python/"/><meta name="theme-color" content="#ffffff"/><link rel="stylesheet" href="/styles.3418df2b1c63496c79d3.css"/><link rel="stylesheet"/><link rel="alternate" type="application/rss+xml" title="Saifeddine Rajhi&#x27;s Blog RSS Feed" href="/rss.xml"/><title data-react-helmet="true">Simplify AWS resource access with EKS Pod Identity Agent and Python SDK - Blog by Saifeddine Rajhi</title><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":"/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png","headline":"Simplify AWS resource access with EKS Pod Identity Agent and Python SDK","dateCreated":"2024-10-02","datePublished":"2024-10-02","dateModified":"2024-10-02","inLanguage":"en-US","isFamilyFriendly":true,"isAccessibleForFree":true,"author":{"@type":"Person","name":"Saifeddine Rajhi","url":"https://seifrajhi.github.io"},"publisher":{"@type":"Organization","name":"Saifeddine Rajhi's Website"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seifrajhi.github.io/blog/aws-pod-id-agent-boto3-python/"},"keywords":["AWS","EKS","Pod Identity Agent","Python SDK","Cloud Native"],"genre":["Platform engineer","software engineering","science","deep learning","statistics"],"articleSection":"Technical Blog","articleBody":"> **Boto3 inside a Pod with Pod identities**\n\n## üìö Introduction\n\nIn this blog post, we will guide you through the process of using the [AWS EKS Pod Identity Agent](https://docs.aws.amazon.com/eks/latest/userguide/pod-identities.html) with the Python [SDK](https://aws.amazon.com/fr/what-is/sdk/) to manage AWS resources. \n\n[Boto3](https://boto3.amazonaws.com/v1/documentation/api/latest/index.html) is the name of the Python SDK for AWS. It allows you to directly manage AWS resources from your Python code. We will see in the hands-on.\n\nTo connect to AWS APIs in Python, you typically use the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3 and Amazon EC2. \n\nWe will take you step-by-step through setting up the EKS cluster, creating the IAM role, and writing a Python script to access AWS resources.\n\n## üîë EKS Pod Identity\n\n[**Pod Identity**](https://aws.amazon.com/blogs/aws/amazon-eks-pod-identity-simplifies-iam-permissions-for-applications-on-amazon-eks-clusters/) is a mechanism that allows Kubernetes pods to assume specific identities, enabling them to access cloud resources securely. Applications running in a pod's containers can use an AWS SDK or the AWS CLI to make API requests to AWS services using AWS IAM permissions. These applications must sign their AWS API requests with AWS credentials.\n\n**EKS Pod Identities** provide the ability to manage credentials for your applications, similar to how [Amazon EC2 instance profiles](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html)provide credentials to Amazon EC2 instances. Instead of creating and distributing your AWS credentials to the containers or using the Amazon EC2 instance's role, you associate an IAM role with a [Kubernetes service account](https://kubernetes.io/docs/concepts/security/service-accounts/) and configure your pods to use the service account.\n\n### üÜî How It Works in Amazon EKS\n\nIn Amazon EKS, Pod Identity is implemented using IAM roles. When a pod needs to access AWS resources, it can assume an IAM role that grants the necessary permissions. This is achieved through the AWS [EKS Pod Identity Agent](https://github.com/aws/eks-pod-identity-agent), which manages the association between Kubernetes service accounts and IAM roles. The agent ensures that the pods receive temporary credentials to access AWS services securely.\n\n- **üîí Secure connection**: EKS Pod Identity allows secure connections between Amazon EKS clusters and AWS services like S3.\n- **üîÑ Simplified IAM roles**: It simplifies the use of IAM roles with Kubernetes pods, reducing operational overhead compared to [IRSA](https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html).\n- **üí° Backward compatibility**: Pod Identity is backward compatible with IAM Roles for Service Accounts IRSA.\n- **üîë RBAC authorization**: Kubernetes authorizes users using RBAC with cluster roles and namespace roles.\n- **üÜî Service accounts**: Service accounts within Kubernetes are used to authorize workloads accessing the Kubernetes API.\n- **üîÑ IAM Role association**: Pod Identity allows Kubernetes workloads to access AWS services by associating IAM roles with pods.\n- **üí° No OIDC Providers needed**: With EKS Pod Identity, there's no need to create [OIDC providers](https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html) for each cluster, unlike IRSA.\n- **üîë ABAC**: Pod Identity uses attribute-based access control [ABAC](https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_attribute-based-access-control.html) for more flexible role management.\n- **üÜî Pod Identity Agent**: The Pod Identity agent, deployable as an [EKS add-on](https://docs.aws.amazon.com/eks/latest/userguide/eks-add-ons.html), handles pod identity management with minimal operational overhead.\n- **üîí Secure Access**: Pod Identity ensures that Kubernetes workloads running in EKS securely access external AWS services like S3 using the right IAM roles.\n\n### üí° The f(ea)uture state: EKS Pod Identities\n\nBefore this enhancement, we used the IAM Roles for Service Accounts (IRSA) model. To give a pod access to, for example, S3, we had to:\n1. Create an IAM Role with the appropriate IAM Policy.\n2. Configure its Trust Policy to allow `AssumeRole` and `TagSession` to be executed only from the appropriate cluster.\n3. Create a Kubernetes ServiceAccount with the ARN of this role in its annotations.\n\n#### Common Issues with the Previous Model:\n\n- **Trust Policy Errors**: Often errors occurred in the Trust Policy, where it was necessary to specify the cluster OIDC.\n- **ServiceAccount Errors**: Mistakes could be made in the ARN of the role within the ServiceAccount annotations.\n\n\n### üîÑ Enhanced mechanism: Pod Identity association\n\nAWS EKS has introduced a new enhanced mechanism called **Pod Identity Association** for cluster administrators to configure Kubernetes applications to receive IAM permissions required to connect with AWS services outside of the cluster. Pod Identity Association makes use of IRSA, but it makes it configurable directly through the EKS API, eliminating the need for using the IAM API altogether.\n\nAs a result, IAM roles no longer need to reference an OIDC provider and hence won't be tied to a single cluster anymore. This means IAM roles can now be used across multiple EKS clusters without the need to update the role trust policy each time a new cluster is created. This, in turn, eliminates the need for role duplication and simplifies the process of automating IRSA altogether.\n\n\n### üÜî How EKS Pod Identities Simplify the Process\n\n1. **Add a New Controller**: Introduce the Amazon EKS Pod Identity Agent add-on.\n2. **Create an IAM Role**: In the Trust Policy, use `Principal: pods.eks.amazonaws.com`.\n3. **Connect the Role**: Use the AWS CLI, AWS Console, or AWS API to connect this role directly to the desired ServiceAccount.\n\n### üîÑ Pod Identity vs. IAM Roles for Service Accounts (IRSA)\n\n\n![ alt text](./irsa-vs-pia.png)\n\n- **Pod Identity**: This method involves assigning IAM roles directly to Kubernetes pods. It provides fine-grained control over which pods can access specific AWS resources. The AWS EKS Pod Identity Agent handles the credential management, ensuring that pods receive the necessary permissions.\n\n- **IAM Roles for Service Accounts IRSA**: IRSA is a feature that allows you to associate IAM roles with Kubernetes service accounts. When a pod uses a service account, it inherits the permissions of the associated IAM role. This method simplifies the management of permissions at the service account level rather than the individual pod level.\n\n\n| Feature | EKS Pod Identity | IRSA |\n| --- | --- | --- |\n| **Role Extensibility** | No need to update the role's trust policy for each new cluster. | Need to update role's trust policy with new EKS cluster OIDC provider endpoint. |\n| **Cluster Scalability** | No need to setup IAM OIDC provider. | Need to setup IAM OIDC provider. Default global limit of 100 OIDC providers for AWS account applies. |\n| **Role Scalability** | No need to define trust relationship between IAM role and service account in the trust policy. | Need to define trust relationship between IAM role and service account in the trust policy. Max of 8 trust relationships within a single trust policy applies due to limit on trust policy size. |\n| **Role Reusability** | AWS STS temporary credentials supplied by EKS Pod Identity include role session tags, such as cluster name, namespace, service account name. | AWS STS session tags are not supported. You can reuse a role between clusters but every pod receives all of the permissions of the role. |\n| **Environments Supported** | Only available on Amazon EKS. | IRSA can be used with Amazon EKS, Amazon EKS Anywhere, Red Hat OpenShift Service on AWS, and self-managed Kubernetes clusters on Amazon EC2 instances. |\n| **EKS Versions Supported** | EKS Kubernetes versions 1.24 or later. | All of the supported EKS cluster versions. |\n\n#### Use cases for each method\n\n- **Pod Identity**: Ideal for scenarios where you need granular control over individual pod permissions. It is useful when different pods within the same application require different levels of access to AWS resources.\n\n- **IRSA**: Suitable for managing permissions at a higher level, such as for a group of pods that share the same service account. It simplifies the setup and is easier to manage when multiple pods need the same permissions.\n\n### Technical Details and Benefits\n\n- **Applications in Pods**: Applications in a pod's containers can use an AWS SDK or the AWS CLI to make API requests to AWS services using IAM permissions. These applications must sign their AWS API requests with AWS credentials.\n\n- **Credential Management**: EKS Pod Identities manage credentials for your applications, similar to how Amazon EC2 instance profiles provide credentials to Amazon EC2 instances.\n\n- **IAM Role Association**: Instead of creating and distributing your AWS credentials to the containers or using the Amazon EC2 instance's role, you associate an IAM role with a Kubernetes service account and configure your pods to use the service account.\n\n- **Pod Identity Agent**: The Pod Identity agent, deployable as an EKS add-on, handles pod identity management with minimal operational overhead.\n\n- **ABAC**: Pod Identity uses attribute-based access control ABAC for more flexible role management.\n\n### üí° Introduction to Boto3\n\n[**Boto3**](https://boto3.amazonaws.com/v1/documentation/api/latest/index.html)  is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3 and Amazon EC2. Boto3 provides an easy-to-use, object-oriented API as well as low-level access to AWS services.\n\n#### Benefits of Using Boto3 for AWS Resource Management\n\n- **Ease of use**: Boto3 simplifies the process of interacting with AWS services by providing a high-level, Pythonic interface.\n- **Comprehensive coverage**: It supports a wide range of AWS services, allowing you to manage everything from S3 buckets to EC2 instances.\n- **Integration**: Boto3 integrates seamlessly with other Python libraries and frameworks, making it a versatile tool for AWS resource management.\n- **Automation**: With Boto3, you can automate repetitive tasks, such as creating and managing AWS resources, which improves efficiency and reduces the risk of human error.\n- **Community and support**: As a widely-used SDK, Boto3 has a large community and extensive documentation, making it easier to find help and resources.\n\n### üîÑ Takeaways\n\n- **EKS Pod Identity** simplifies the process of granting AWS permissions to Kubernetes pods.\n- **Pod Identity Association** eliminates the need for OIDC providers and allows IAM roles to be used across multiple clusters.\n- **Pod Identity** provides fine-grained control over pod permissions, while **IRSA** simplifies permission management at the service account level.\n- **Boto3** is a great tool for managing AWS resources programmatically with Python.\n\n\n## Setting Up EKS Pod Identity\n\nWe can create an EKS cluster using `eksctl` with the following configuration:\n\n```yaml\n# cluster.yaml\n---\napiVersion: eksctl.io/v1alpha5\nkind: ClusterConfig\n\nmetadata:\n  name: eks-pod-identity-boto3\n  region: eu-west-1\n\nmanagedNodeGroups:\n  - name: managed-nodes\n    instanceType: m5.large\n    minSize: 2\n    desiredCapacity: 3\n    maxSize: 4\n    availabilityZones: [\"eu-west-1a\", \"eu-west-1b\"]\n    volumeSize: 20\n    updateConfig:\n      maxUnavailable: 3 \n    securityGroups:\n      attachIDs: [\"sg-1\", \"sg-2\"]\n```\n\nCreate the cluster with:\n\n```shell\n$ eksctl create cluster -f cluster.yaml\n```\n\n### Step-by-Step Guide to Creating an IAM Role\n\n1. **Create an IAM Role**:\n\n   - Go to the IAM console.\n   - Click on **Roles** and then **Create role**.\n   - Select **EKS** as the trusted entity and choose **EKS - Pod**.\n   - Attach the necessary policies (e.g., `AmazonS3ReadOnlyAccess` for S3 access).\n   - Name the role (e.g., `EKS-S3-Access-Role`) and create it.\n\n2. **Update the Trust Policy**:\n\n   - Go to the IAM role you just created.\n   - Under the **Trust relationships** tab, click **Edit trust relationship**.\n   - Update the trust policy to allow the `pods.eks.amazonaws.com` principal.\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"eks.amazonaws.com\"\n      },\n      \"Action\": [\"sts:AssumeRole\",\"sts:TagSession\"]\n    }\n  ]\n}\n```\n\n### Associating the IAM Role with a Kubernetes Service Account\n\n> **Note**: Unlike IAM roles for service accounts, EKS Pod Identity doesn't use an annotation on the service account.\n\n#### Create a Kubernetes Service Account\n\nCreate a service account in your Kubernetes cluster.\n\n```yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: s3-access-sa\n  namespace: default\n```\n\n#### Apply the Service Account\n\nApply the service account configuration to your cluster.\n\n```shell\n$ kubectl apply -f service-account.yaml\n```\n\n### Installing the Pod Identity Agent\n\n#### Install the Pod Identity Agent\n\nUse the AWS CLI to install the Pod Identity Agent as an EKS add-on.\n\n```shell\n$ aws eks create-addon --cluster-name eks-pod-identity-boto3 --addon-name eks-pod-identity-agent --addon-version v1.0.0-eksbuild.1\n```\n\nConfirm that the EKS Pod Identity Agent pods are running on your cluster.\n\n```shell\n$ kubectl get pods -n kube-system | grep 'eks-pod-identity-agent'\n```\n\n### Creating a Pod Identity Association\n\nCreate a pod identity association using the AWS CLI:\n\n```shell\n$ aws eks create-pod-identity-association \\\n  --cluster-name eks-pod-identity-boto3 \\\n  --namespace default \\\n  --service-account s3-access-sa \\\n  --role-arn arn:aws:iam::012345678901:role/EKS-S3-Access-Role\n```\n\nEnsure the IAM role has the following trust policy:\n\n```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [{\n    \"Effect\": \"Allow\",\n    \"Principal\": {\n      \"Service\": \"pods.eks.amazonaws.com\"\n    },\n    \"Action\": [\"sts:AssumeRole\",\"sts:TagSession\"]\n  }]\n}\n```\n\n\n## Deploying a test Pod\n\n### Creating a Kubernetes Pod Spec\n\nCreate a Kubernetes pod specification that uses the service account with the IAM role.\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: s3-list-pod\n  namespace: default\nspec:\n  serviceAccountName: s3-access-sa\n  containers:\n  - name: s3-list-container\n    image: amazonlinux\n    command: [\"/bin/sh\", \"-c\", \"while true; do sleep 30; done;\"]\n```\n\nSave this specification to a file named `pod-spec.yaml`.\n\n### Deploying the Pod with the Service Account\n\nApply the pod specification to your Kubernetes cluster.\n\n```sh\nkubectl apply -f pod-spec.yaml\n```\n\nVerify that the pod is running.\n\n```sh\nkubectl get pods -n default\n```\n\n## Using Boto3 Inside the Pod\n\n### Accessing the Pod and Installing Boto3\n\nUse `kubectl exec` to access the pod.\n\n```sh\nkubectl exec -it s3-list-pod -- /bin/bash\n```\n\nInside the pod, install Boto3 using pip.\n\n```sh\nyum install -y python3-pip\npip3 install boto3\n```\n\n### Writing a Python Script to List S3 Bucket Objects\n\nCreate a Python script to list objects in an S3 bucket. Save this script as `list_s3_objects.py`.\n\n```python\nimport boto3\n\n# Create a session using the default credentials chain\nsession = boto3.Session()\n\n# Create an S3 client\ns3 = session.client('s3')\n\n# List all buckets\nresponse = s3.list_buckets()\n\n# Print bucket names\nprint(\"Buckets:\")\nfor bucket in response['Buckets']:\n    print(f\"  {bucket['Name']}\")\n```\n\n### Running the Script and Verifying Access\n\nRun the Python script inside the pod.\n\n```sh\npython3 list_s3_objects.py\n```\n\nCheck the output to verify that the script lists the S3 buckets.\n\n```sh\nkubectl logs s3-list-pod\n```\n\n## Conclusion\n\nIn this blog post, we explored how to securely manage AWS resources using the AWS EKS Pod Identity Agent and Boto3. We began by understanding the importance of managing AWS resources securely and introduced the concept of Pod Identity in Kubernetes, highlighting its implementation in Amazon EKS. \n\nWe then provided a detailed, step-by-step guide to setting up EKS Pod Identity, including creating an IAM role, associating it with a Kubernetes service account, and installing the Pod Identity Agent. Following this, we demonstrated how to deploy a test pod and use Boto3 inside the pod to list S3 bucket objects. \n\nBy using these tools, you can enhance security, simplify management, and increase the flexibility and scalability of your AWS resource management.\n\n## üìªüß° Additional Resources\n\n- [AWS EKS Pod Identity agent documentation](https://docs.aws.amazon.com/eks/latest/userguide/pod-id-how-it-works.html)\n- [Boto3 documentation](https://boto3.amazonaws.com/v1/documentation/api/latest/index.html)\n- [Kubernetes Service accounts](https://kubernetes.io/docs/concepts/security/service-accounts/)\n- [IAM Roles for Service Accounts (IRSA)](https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html)\n- [Amazon EKS documentation](https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html)\n- [Kubernetes RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)\n- [AWS ABAC](https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_attribute-based-access-control.html)\n\nFurther reading on Kubernetes, EKS, and Boto3:\n\n- [Kubernetes documentation](https://kubernetes.io/docs/concepts/)\n- [Amazon EKS best practices Guide](https://aws.github.io/aws-eks-best-practices/)\n- [Boto3 GitHub repository](https://github.com/boto/boto3)\n- [Pod Agent GitHub repository](https://github.com/aws/eks-pod-identity-agent)\n- [EKS addons GitHub repository](https://github.com/aws-ia/terraform-aws-eks-blueprints-addons)\n\n<br>\n<br>\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  _**Until next time üéâ**_\n\n\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n_**Keep Learning !! Keep Sharing !! üî∞**_\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud coomputing and containers.\npassword: test\n\n","wordcount":2104}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://seifrajhi.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://seifrajhi.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Simplify AWS resource access with EKS Pod Identity Agent and Python SDK","item":"https://seifrajhi.github.io/blog/aws-pod-id-agent-boto3-python/"}]}</script><link crossorigin="" href="https://utteranc.es" rel="preconnect"/><link crossorigin="" href="https://www.google-analytics.com" rel="preconnect"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=47ae28bb567c9025f1fee24afb2d20c9" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2"/><style>@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2) format("woff2")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMr3.woff) format("woff")}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-LLPCCGNLH7', 'auto', {"alwaysSendReferrer":true});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LLPCCGNLH7"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-LLPCCGNLH7', {"anonymize_ip":true,"send_page_view":false});gtag('config', 'GTM-5V895PDS', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><link rel="stylesheet"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://seifrajhi.github.io/blog/aws-pod-id-agent-boto3-python/" data-baseprotocol="https:" data-basehost="seifrajhi.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="blogpost-header"><div class="view-page-header"><div class="view-page-header-wrapper"><div class="logo-wrapper"><div class="logo"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained logo-img"><div style="max-width:150px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;174&#x27;%20width=&#x27;150&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" data-src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture><noscript><picture><source type="image/avif" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="name"><a href="/blog/" title="back to blog">Saifeddine <br/> Rajhi</a></div></div><h2 class="blog-title"><a href="/blog/" title="back to the homepage">Blog</a></h2></div></div><nav class="main-navigation"><ul><li><a rel="home" title="Go Home" href="/">Home</a></li><li><a title="Go to my Technical Blog" href="/blog/">Blog</a></li><li><a title="Go to my Thoughts" href="/thoughts/">Thoughts</a></li><li><a title="Review My CV" href="/cv/platform-engineer/">Resume</a></li></ul></nav></div><main><article class="blog-wrapper"><header><figure class="cover"><div class="cover-filter"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper cover cover-image"><div aria-hidden="true" style="padding-top:56.25%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC5klEQVR42hWSW1OaVxSGv5/Z6fQq05vWOpOkISKIHAqiCIjwcRD4kINoZAhCQDGo0TT1BImAJzAeKloUTT12mtsnOxfPzNp71n7nXe9eksNXwB56R78tjydcwuad54VjU5xz2OU8Q8om+kAFp+gZDi5jHn3LgPwOo0u8cSxh9Sww4F5gyDOPSV5F0gW3GU7s0Odcode3jTm0gSFYQ6/so/NXMET2BE2skS0GojVMoU8Y5XWeD62jEmgdq2icmxg9ovbWkEyBDfzRBSyuAr3uinA4x0hoAX2ojl64sXpLGMN1Bn0l7MEFXMoydt8cJldJCK1hc2UYdM8iK0to5C0kVeCQl2NH/O77jCp4gjZ8QF9wB53SoC+0jUmpY47sYI03MMebGJQmltBHhpU1rIljBqPiPtzAMtGiP36G1O1v8ZugJ3HB89gVmmAVW0DkEVxH7a9idOYwuYvYw+8xed+j9dUwjBSF+0U0kSO0E1cYEudoY+foBNJoYpvQ6yaxUovx2UMmC3sEim2cqUO80/uMTjVQ0ruE0k2CAvlVg7GJKu6JXZK5XTypA9TRM3oF2phwmJw7ID+/RaxwwJu3dRZLZZLFzwSmayRTZcamqmQyG0TTVSbTFeKZOjO5MsX5jywufmIqs0XPuBAcPxWCLaT00gEz1a9kBZb8Pb2v7zAXHlDFb+gKnPM0dMYvgX/oFjyLdOhWvvBsvIMm/YAm87+IqoNWxKWfvBJcIp1+SHPdueD+8T+mVm/4Y+YL+kSDLjknxjjihXLOT/ZrfrYc84N5FqM/Rf9kG+tUDTm7iaUgTET36HL8SffIJtL+yQVHp23uHh55tX6HYeYW1ViFJ+ZpDKkOLyN/88R+wo+2FpGwmg85NU8nrrHEVpBTc+jyj2Jn/0LlyKIaziKt7V5SPbmn0f5KePkWU+aawfwNltwt1jf/Ykpf0GVf4VdnmaGkWKfYMerYJT3ffzjZwpK9wZlvE8uX8c00+AbH+JFmK5U5+wAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/6a38bcb79dc3642536c1c17e76de65dc/a66aa/eks-pod-identity.webp 750w,/static/6a38bcb79dc3642536c1c17e76de65dc/65dd5/eks-pod-identity.webp 1080w,/static/6a38bcb79dc3642536c1c17e76de65dc/f9724/eks-pod-identity.webp 1366w,/static/6a38bcb79dc3642536c1c17e76de65dc/c512e/eks-pod-identity.webp 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png" data-srcset="/static/6a38bcb79dc3642536c1c17e76de65dc/0dee1/eks-pod-identity.png 750w,/static/6a38bcb79dc3642536c1c17e76de65dc/8beaa/eks-pod-identity.png 1080w,/static/6a38bcb79dc3642536c1c17e76de65dc/a4198/eks-pod-identity.png 1366w,/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png 1920w" alt="Simplify AWS resource access with EKS Pod Identity Agent and Python SDK"/></picture><noscript><picture><source type="image/webp" srcSet="/static/6a38bcb79dc3642536c1c17e76de65dc/a66aa/eks-pod-identity.webp 750w,/static/6a38bcb79dc3642536c1c17e76de65dc/65dd5/eks-pod-identity.webp 1080w,/static/6a38bcb79dc3642536c1c17e76de65dc/f9724/eks-pod-identity.webp 1366w,/static/6a38bcb79dc3642536c1c17e76de65dc/c512e/eks-pod-identity.webp 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png" srcSet="/static/6a38bcb79dc3642536c1c17e76de65dc/0dee1/eks-pod-identity.png 750w,/static/6a38bcb79dc3642536c1c17e76de65dc/8beaa/eks-pod-identity.png 1080w,/static/6a38bcb79dc3642536c1c17e76de65dc/a4198/eks-pod-identity.png 1366w,/static/6a38bcb79dc3642536c1c17e76de65dc/afa5c/eks-pod-identity.png 1920w" alt="Simplify AWS resource access with EKS Pod Identity Agent and Python SDK"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><figcaption data-nosnippet="" class="image-title">Photo by Saifeddine Rajhi</figcaption></figure><h1>Simplify AWS resource access with EKS Pod Identity Agent and Python SDK</h1><div data-nosnippet="" class="blog-details"><time class="blog-createdat" dateTime="2024-10-02">Oct 2, 2024</time><span> ‚Ä¢ </span><span class="blog-time2read">10<!-- -->mins<!-- --> read</span><div class="theme-switcher"><div class="theme-switcher-toggler"><div class="theme-switcher-track"></div><div class="theme-switcher-thumb"></div><input class="theme-switcher-input" type="checkbox" readonly="" aria-label="Switch between Dark and Light modes"/></div></div></div><ul data-nosnippet="" class="blog-tags"><li>AWS</li><li>EKS</li><li>Pod Identity Agent</li><li>Python SDK</li><li>Cloud Native</li></ul></header><div class="blog-divider"></div><div id="intro"></div><div class="content-wrapper"><div data-nosnippet="" class="blog-content-nav-wrapper"><ul class="blog-content-nav"><h2>Content</h2><ul class="toc-list"></ul></ul></div><div class="content blog-content"><blockquote>
<p><strong>Boto3 inside a Pod with Pod identities</strong></p>
</blockquote>
<h2 id="-introduction" style="position:relative;"><a href="#-introduction" aria-label=" introduction permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üìö Introduction</h2>
<p>In this blog post, we will guide you through the process of using the <a href="https://docs.aws.amazon.com/eks/latest/userguide/pod-identities.html" target="_blank" rel="noopener noreferrer">AWS EKS Pod Identity Agent</a> with the Python <a href="https://aws.amazon.com/fr/what-is/sdk/" target="_blank" rel="noopener noreferrer">SDK</a> to manage AWS resources.</p>
<p><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" target="_blank" rel="noopener noreferrer">Boto3</a> is the name of the Python SDK for AWS. It allows you to directly manage AWS resources from your Python code. We will see in the hands-on.</p>
<p>To connect to AWS APIs in Python, you typically use the boto3 library, which is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3 and Amazon EC2.</p>
<p>We will take you step-by-step through setting up the EKS cluster, creating the IAM role, and writing a Python script to access AWS resources.</p>
<h2 id="-eks-pod-identity" style="position:relative;"><a href="#-eks-pod-identity" aria-label=" eks pod identity permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üîë EKS Pod Identity</h2>
<p><a href="https://aws.amazon.com/blogs/aws/amazon-eks-pod-identity-simplifies-iam-permissions-for-applications-on-amazon-eks-clusters/" target="_blank" rel="noopener noreferrer"><strong>Pod Identity</strong></a> is a mechanism that allows Kubernetes pods to assume specific identities, enabling them to access cloud resources securely. Applications running in a pod's containers can use an AWS SDK or the AWS CLI to make API requests to AWS services using AWS IAM permissions. These applications must sign their AWS API requests with AWS credentials.</p>
<p><strong>EKS Pod Identities</strong> provide the ability to manage credentials for your applications, similar to how <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html" target="_blank" rel="noopener noreferrer">Amazon EC2 instance profiles</a>provide credentials to Amazon EC2 instances. Instead of creating and distributing your AWS credentials to the containers or using the Amazon EC2 instance's role, you associate an IAM role with a <a href="https://kubernetes.io/docs/concepts/security/service-accounts/" target="_blank" rel="noopener noreferrer">Kubernetes service account</a> and configure your pods to use the service account.</p>
<h3 id="-how-it-works-in-amazon-eks" style="position:relative;"><a href="#-how-it-works-in-amazon-eks" aria-label=" how it works in amazon eks permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üÜî How It Works in Amazon EKS</h3>
<p>In Amazon EKS, Pod Identity is implemented using IAM roles. When a pod needs to access AWS resources, it can assume an IAM role that grants the necessary permissions. This is achieved through the AWS <a href="https://github.com/aws/eks-pod-identity-agent" target="_blank" rel="noopener noreferrer">EKS Pod Identity Agent</a>, which manages the association between Kubernetes service accounts and IAM roles. The agent ensures that the pods receive temporary credentials to access AWS services securely.</p>
<ul>
<li><strong>üîí Secure connection</strong>: EKS Pod Identity allows secure connections between Amazon EKS clusters and AWS services like S3.</li>
<li><strong>üîÑ Simplified IAM roles</strong>: It simplifies the use of IAM roles with Kubernetes pods, reducing operational overhead compared to <a href="https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html" target="_blank" rel="noopener noreferrer">IRSA</a>.</li>
<li><strong>üí° Backward compatibility</strong>: Pod Identity is backward compatible with IAM Roles for Service Accounts IRSA.</li>
<li><strong>üîë RBAC authorization</strong>: Kubernetes authorizes users using RBAC with cluster roles and namespace roles.</li>
<li><strong>üÜî Service accounts</strong>: Service accounts within Kubernetes are used to authorize workloads accessing the Kubernetes API.</li>
<li><strong>üîÑ IAM Role association</strong>: Pod Identity allows Kubernetes workloads to access AWS services by associating IAM roles with pods.</li>
<li><strong>üí° No OIDC Providers needed</strong>: With EKS Pod Identity, there's no need to create <a href="https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html" target="_blank" rel="noopener noreferrer">OIDC providers</a> for each cluster, unlike IRSA.</li>
<li><strong>üîë ABAC</strong>: Pod Identity uses attribute-based access control <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_attribute-based-access-control.html" target="_blank" rel="noopener noreferrer">ABAC</a> for more flexible role management.</li>
<li><strong>üÜî Pod Identity Agent</strong>: The Pod Identity agent, deployable as an <a href="https://docs.aws.amazon.com/eks/latest/userguide/eks-add-ons.html" target="_blank" rel="noopener noreferrer">EKS add-on</a>, handles pod identity management with minimal operational overhead.</li>
<li><strong>üîí Secure Access</strong>: Pod Identity ensures that Kubernetes workloads running in EKS securely access external AWS services like S3 using the right IAM roles.</li>
</ul>
<h3 id="-the-feauture-state-eks-pod-identities" style="position:relative;"><a href="#-the-feauture-state-eks-pod-identities" aria-label=" the feauture state eks pod identities permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üí° The f(ea)uture state: EKS Pod Identities</h3>
<p>Before this enhancement, we used the IAM Roles for Service Accounts (IRSA) model. To give a pod access to, for example, S3, we had to:</p>
<ol>
<li>Create an IAM Role with the appropriate IAM Policy.</li>
<li>Configure its Trust Policy to allow <code class="language-text">AssumeRole</code> and <code class="language-text">TagSession</code> to be executed only from the appropriate cluster.</li>
<li>Create a Kubernetes ServiceAccount with the ARN of this role in its annotations.</li>
</ol>
<h4 id="common-issues-with-the-previous-model" style="position:relative;"><a href="#common-issues-with-the-previous-model" aria-label="common issues with the previous model permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Common Issues with the Previous Model:</h4>
<ul>
<li><strong>Trust Policy Errors</strong>: Often errors occurred in the Trust Policy, where it was necessary to specify the cluster OIDC.</li>
<li><strong>ServiceAccount Errors</strong>: Mistakes could be made in the ARN of the role within the ServiceAccount annotations.</li>
</ul>
<h3 id="-enhanced-mechanism-pod-identity-association" style="position:relative;"><a href="#-enhanced-mechanism-pod-identity-association" aria-label=" enhanced mechanism pod identity association permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üîÑ Enhanced mechanism: Pod Identity association</h3>
<p>AWS EKS has introduced a new enhanced mechanism called <strong>Pod Identity Association</strong> for cluster administrators to configure Kubernetes applications to receive IAM permissions required to connect with AWS services outside of the cluster. Pod Identity Association makes use of IRSA, but it makes it configurable directly through the EKS API, eliminating the need for using the IAM API altogether.</p>
<p>As a result, IAM roles no longer need to reference an OIDC provider and hence won't be tied to a single cluster anymore. This means IAM roles can now be used across multiple EKS clusters without the need to update the role trust policy each time a new cluster is created. This, in turn, eliminates the need for role duplication and simplifies the process of automating IRSA altogether.</p>
<h3 id="-how-eks-pod-identities-simplify-the-process" style="position:relative;"><a href="#-how-eks-pod-identities-simplify-the-process" aria-label=" how eks pod identities simplify the process permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üÜî How EKS Pod Identities Simplify the Process</h3>
<ol>
<li><strong>Add a New Controller</strong>: Introduce the Amazon EKS Pod Identity Agent add-on.</li>
<li><strong>Create an IAM Role</strong>: In the Trust Policy, use <code class="language-text">Principal: pods.eks.amazonaws.com</code>.</li>
<li><strong>Connect the Role</strong>: Use the AWS CLI, AWS Console, or AWS API to connect this role directly to the desired ServiceAccount.</li>
</ol>
<h3 id="-pod-identity-vs-iam-roles-for-service-accounts-irsa" style="position:relative;"><a href="#-pod-identity-vs-iam-roles-for-service-accounts-irsa" aria-label=" pod identity vs iam roles for service accounts irsa permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üîÑ Pod Identity vs. IAM Roles for Service Accounts (IRSA)</h3>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 52.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACsUlEQVR42lVSXUhUQRQ+q7vrevd/9bqNrHt1WVy74dZ2/WdzkJbu1dY1jRuE2prSEoltGUr1ciHrIfyJqIcU04fAByXqKZAI3/JFerIieghlUUJLDKLetpnxrtDAYebMOfOd78x3wClgF6qUioXj2EWtqqq2KFoddfv91W4QVTMcrHzd8gRBcIkNDZ5AIFDi9XqtANgoCNiSkiQTjUNCOR3ByXlLcOhNAYpPc1JqjQS0PAF3uIr6Z+0C1iwIIU4URXMwGCygZ/LQRM4OCqBEI2FZrjpJq7ICe4+cLupkAQx03647VbGptA0M+HweIGChxIhdksCkMwV8cbh4dOrdsVAoZCeuIZsF025PtH6n9XwN8QtyebCoqrQl+NIYO7vZ1vlx1+NxAGEbiKWcEmGE8YqRxnsnfsjDs7+2Lz/4wKfgoNBGS+zh1pnWZQY0vrRbT/jlwf+LsRW1dXNRU789Hte4jrFMGb1Tn363JbSNGlVdzM8lX7sw1jySuNPCGKanf243jXy26yBG9eZk4erC9TD5jZLCUKyUsbr/VR6d2//bNbYlMFACRv8UY42xTs/9fjs092eBocvp1XLC0KCrCOuaZv6W7CgfLnWXdUoyAqJg542XqH9iJxFPrXHsv7MsH6hIPA+2tvTreuXqUoQHsB22SIMHVbFRJTu91LSs0aN0OyQ4FMXE87yNqknGx6KLYNBjZqb84JNMZVJbsbjdbqff768ghoj+1t6ZaGXfq74yQCmOFqOiUBBiRwIB5KfzSAsk57EyuJCgCkM4HLZC+tne/pWpTIxeSJLEKeQxbb/rccPapeexSTYqmLExsMHV91zb7VN177tnmseZiFi0Qc94pl2++wkBUdJ7a9lKzaO8cJy43VgbuXfuKJ0AhIDT2Vl8Pl9hzqiPMCoWsNOVi/0DZVGxqvqXPUgAAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt=" alt text" title="" src="/static/c2145156100e69a819951589546b091d/c5bb3/irsa-vs-pia.png" srcset="/static/c2145156100e69a819951589546b091d/04472/irsa-vs-pia.png 170w,
/static/c2145156100e69a819951589546b091d/9f933/irsa-vs-pia.png 340w,
/static/c2145156100e69a819951589546b091d/c5bb3/irsa-vs-pia.png 680w,
/static/c2145156100e69a819951589546b091d/a2b88/irsa-vs-pia.png 908w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<ul>
<li>
<p><strong>Pod Identity</strong>: This method involves assigning IAM roles directly to Kubernetes pods. It provides fine-grained control over which pods can access specific AWS resources. The AWS EKS Pod Identity Agent handles the credential management, ensuring that pods receive the necessary permissions.</p>
</li>
<li>
<p><strong>IAM Roles for Service Accounts IRSA</strong>: IRSA is a feature that allows you to associate IAM roles with Kubernetes service accounts. When a pod uses a service account, it inherits the permissions of the associated IAM role. This method simplifies the management of permissions at the service account level rather than the individual pod level.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Feature</th>
<th>EKS Pod Identity</th>
<th>IRSA</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Role Extensibility</strong></td>
<td>No need to update the role's trust policy for each new cluster.</td>
<td>Need to update role's trust policy with new EKS cluster OIDC provider endpoint.</td>
</tr>
<tr>
<td><strong>Cluster Scalability</strong></td>
<td>No need to setup IAM OIDC provider.</td>
<td>Need to setup IAM OIDC provider. Default global limit of 100 OIDC providers for AWS account applies.</td>
</tr>
<tr>
<td><strong>Role Scalability</strong></td>
<td>No need to define trust relationship between IAM role and service account in the trust policy.</td>
<td>Need to define trust relationship between IAM role and service account in the trust policy. Max of 8 trust relationships within a single trust policy applies due to limit on trust policy size.</td>
</tr>
<tr>
<td><strong>Role Reusability</strong></td>
<td>AWS STS temporary credentials supplied by EKS Pod Identity include role session tags, such as cluster name, namespace, service account name.</td>
<td>AWS STS session tags are not supported. You can reuse a role between clusters but every pod receives all of the permissions of the role.</td>
</tr>
<tr>
<td><strong>Environments Supported</strong></td>
<td>Only available on Amazon EKS.</td>
<td>IRSA can be used with Amazon EKS, Amazon EKS Anywhere, Red Hat OpenShift Service on AWS, and self-managed Kubernetes clusters on Amazon EC2 instances.</td>
</tr>
<tr>
<td><strong>EKS Versions Supported</strong></td>
<td>EKS Kubernetes versions 1.24 or later.</td>
<td>All of the supported EKS cluster versions.</td>
</tr>
</tbody>
</table>
<h4 id="use-cases-for-each-method" style="position:relative;"><a href="#use-cases-for-each-method" aria-label="use cases for each method permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use cases for each method</h4>
<ul>
<li>
<p><strong>Pod Identity</strong>: Ideal for scenarios where you need granular control over individual pod permissions. It is useful when different pods within the same application require different levels of access to AWS resources.</p>
</li>
<li>
<p><strong>IRSA</strong>: Suitable for managing permissions at a higher level, such as for a group of pods that share the same service account. It simplifies the setup and is easier to manage when multiple pods need the same permissions.</p>
</li>
</ul>
<h3 id="technical-details-and-benefits" style="position:relative;"><a href="#technical-details-and-benefits" aria-label="technical details and benefits permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Technical Details and Benefits</h3>
<ul>
<li>
<p><strong>Applications in Pods</strong>: Applications in a pod's containers can use an AWS SDK or the AWS CLI to make API requests to AWS services using IAM permissions. These applications must sign their AWS API requests with AWS credentials.</p>
</li>
<li>
<p><strong>Credential Management</strong>: EKS Pod Identities manage credentials for your applications, similar to how Amazon EC2 instance profiles provide credentials to Amazon EC2 instances.</p>
</li>
<li>
<p><strong>IAM Role Association</strong>: Instead of creating and distributing your AWS credentials to the containers or using the Amazon EC2 instance's role, you associate an IAM role with a Kubernetes service account and configure your pods to use the service account.</p>
</li>
<li>
<p><strong>Pod Identity Agent</strong>: The Pod Identity agent, deployable as an EKS add-on, handles pod identity management with minimal operational overhead.</p>
</li>
<li>
<p><strong>ABAC</strong>: Pod Identity uses attribute-based access control ABAC for more flexible role management.</p>
</li>
</ul>
<h3 id="-introduction-to-boto3" style="position:relative;"><a href="#-introduction-to-boto3" aria-label=" introduction to boto3 permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üí° Introduction to Boto3</h3>
<p><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" target="_blank" rel="noopener noreferrer"><strong>Boto3</strong></a>  is the Amazon Web Services (AWS) SDK for Python. It allows Python developers to write software that makes use of services like Amazon S3 and Amazon EC2. Boto3 provides an easy-to-use, object-oriented API as well as low-level access to AWS services.</p>
<h4 id="benefits-of-using-boto3-for-aws-resource-management" style="position:relative;"><a href="#benefits-of-using-boto3-for-aws-resource-management" aria-label="benefits of using boto3 for aws resource management permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Benefits of Using Boto3 for AWS Resource Management</h4>
<ul>
<li><strong>Ease of use</strong>: Boto3 simplifies the process of interacting with AWS services by providing a high-level, Pythonic interface.</li>
<li><strong>Comprehensive coverage</strong>: It supports a wide range of AWS services, allowing you to manage everything from S3 buckets to EC2 instances.</li>
<li><strong>Integration</strong>: Boto3 integrates seamlessly with other Python libraries and frameworks, making it a versatile tool for AWS resource management.</li>
<li><strong>Automation</strong>: With Boto3, you can automate repetitive tasks, such as creating and managing AWS resources, which improves efficiency and reduces the risk of human error.</li>
<li><strong>Community and support</strong>: As a widely-used SDK, Boto3 has a large community and extensive documentation, making it easier to find help and resources.</li>
</ul>
<h3 id="-takeaways" style="position:relative;"><a href="#-takeaways" aria-label=" takeaways permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üîÑ Takeaways</h3>
<ul>
<li><strong>EKS Pod Identity</strong> simplifies the process of granting AWS permissions to Kubernetes pods.</li>
<li><strong>Pod Identity Association</strong> eliminates the need for OIDC providers and allows IAM roles to be used across multiple clusters.</li>
<li><strong>Pod Identity</strong> provides fine-grained control over pod permissions, while <strong>IRSA</strong> simplifies permission management at the service account level.</li>
<li><strong>Boto3</strong> is a great tool for managing AWS resources programmatically with Python.</li>
</ul>
<h2 id="setting-up-eks-pod-identity" style="position:relative;"><a href="#setting-up-eks-pod-identity" aria-label="setting up eks pod identity permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setting Up EKS Pod Identity</h2>
<p>We can create an EKS cluster using <code class="language-text">eksctl</code> with the following configuration:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token comment"># cluster.yaml</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> eksctl.io/v1alpha5
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterConfig

<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> eks<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>identity<span class="token punctuation">-</span>boto3
  <span class="token key atrule">region</span><span class="token punctuation">:</span> eu<span class="token punctuation">-</span>west<span class="token punctuation">-</span><span class="token number">1</span>

<span class="token key atrule">managedNodeGroups</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> managed<span class="token punctuation">-</span>nodes
    <span class="token key atrule">instanceType</span><span class="token punctuation">:</span> m5.large
    <span class="token key atrule">minSize</span><span class="token punctuation">:</span> <span class="token number">2</span>
    <span class="token key atrule">desiredCapacity</span><span class="token punctuation">:</span> <span class="token number">3</span>
    <span class="token key atrule">maxSize</span><span class="token punctuation">:</span> <span class="token number">4</span>
    <span class="token key atrule">availabilityZones</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"eu-west-1a"</span><span class="token punctuation">,</span> <span class="token string">"eu-west-1b"</span><span class="token punctuation">]</span>
    <span class="token key atrule">volumeSize</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token key atrule">updateConfig</span><span class="token punctuation">:</span>
      <span class="token key atrule">maxUnavailable</span><span class="token punctuation">:</span> <span class="token number">3</span> 
    <span class="token key atrule">securityGroups</span><span class="token punctuation">:</span>
      <span class="token key atrule">attachIDs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"sg-1"</span><span class="token punctuation">,</span> <span class="token string">"sg-2"</span><span class="token punctuation">]</span></code></pre></div>
<p>Create the cluster with:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ eksctl create cluster <span class="token parameter variable">-f</span> cluster.yaml</code></pre></div>
<h3 id="step-by-step-guide-to-creating-an-iam-role" style="position:relative;"><a href="#step-by-step-guide-to-creating-an-iam-role" aria-label="step by step guide to creating an iam role permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Step-by-Step Guide to Creating an IAM Role</h3>
<ol>
<li>
<p><strong>Create an IAM Role</strong>:</p>
<ul>
<li>Go to the IAM console.</li>
<li>Click on <strong>Roles</strong> and then <strong>Create role</strong>.</li>
<li>Select <strong>EKS</strong> as the trusted entity and choose <strong>EKS - Pod</strong>.</li>
<li>Attach the necessary policies (e.g., <code class="language-text">AmazonS3ReadOnlyAccess</code> for S3 access).</li>
<li>Name the role (e.g., <code class="language-text">EKS-S3-Access-Role</code>) and create it.</li>
</ul>
</li>
<li>
<p><strong>Update the Trust Policy</strong>:</p>
<ul>
<li>Go to the IAM role you just created.</li>
<li>Under the <strong>Trust relationships</strong> tab, click <strong>Edit trust relationship</strong>.</li>
<li>Update the trust policy to allow the <code class="language-text">pods.eks.amazonaws.com</code> principal.</li>
</ul>
</li>
</ol>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"Version"</span><span class="token operator">:</span> <span class="token string">"2012-10-17"</span><span class="token punctuation">,</span>
  <span class="token property">"Statement"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"Effect"</span><span class="token operator">:</span> <span class="token string">"Allow"</span><span class="token punctuation">,</span>
      <span class="token property">"Principal"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"Service"</span><span class="token operator">:</span> <span class="token string">"eks.amazonaws.com"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"sts:AssumeRole"</span><span class="token punctuation">,</span><span class="token string">"sts:TagSession"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="associating-the-iam-role-with-a-kubernetes-service-account" style="position:relative;"><a href="#associating-the-iam-role-with-a-kubernetes-service-account" aria-label="associating the iam role with a kubernetes service account permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Associating the IAM Role with a Kubernetes Service Account</h3>
<blockquote>
<p><strong>Note</strong>: Unlike IAM roles for service accounts, EKS Pod Identity doesn't use an annotation on the service account.</p>
</blockquote>
<h4 id="create-a-kubernetes-service-account" style="position:relative;"><a href="#create-a-kubernetes-service-account" aria-label="create a kubernetes service account permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Create a Kubernetes Service Account</h4>
<p>Create a service account in your Kubernetes cluster.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> s3<span class="token punctuation">-</span>access<span class="token punctuation">-</span>sa
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default</code></pre></div>
<h4 id="apply-the-service-account" style="position:relative;"><a href="#apply-the-service-account" aria-label="apply the service account permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Apply the Service Account</h4>
<p>Apply the service account configuration to your cluster.</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ kubectl apply <span class="token parameter variable">-f</span> service-account.yaml</code></pre></div>
<h3 id="installing-the-pod-identity-agent" style="position:relative;"><a href="#installing-the-pod-identity-agent" aria-label="installing the pod identity agent permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing the Pod Identity Agent</h3>
<h4 id="install-the-pod-identity-agent" style="position:relative;"><a href="#install-the-pod-identity-agent" aria-label="install the pod identity agent permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install the Pod Identity Agent</h4>
<p>Use the AWS CLI to install the Pod Identity Agent as an EKS add-on.</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ aws eks create-addon --cluster-name eks-pod-identity-boto3 --addon-name eks-pod-identity-agent --addon-version v1.0.0-eksbuild.1</code></pre></div>
<p>Confirm that the EKS Pod Identity Agent pods are running on your cluster.</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ kubectl get pods <span class="token parameter variable">-n</span> kube-system <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'eks-pod-identity-agent'</span></code></pre></div>
<h3 id="creating-a-pod-identity-association" style="position:relative;"><a href="#creating-a-pod-identity-association" aria-label="creating a pod identity association permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Creating a Pod Identity Association</h3>
<p>Create a pod identity association using the AWS CLI:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ aws eks create-pod-identity-association <span class="token punctuation">\</span>
  --cluster-name eks-pod-identity-boto3 <span class="token punctuation">\</span>
  <span class="token parameter variable">--namespace</span> default <span class="token punctuation">\</span>
  --service-account s3-access-sa <span class="token punctuation">\</span>
  --role-arn arn:aws:iam::012345678901:role/EKS-S3-Access-Role</code></pre></div>
<p>Ensure the IAM role has the following trust policy:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"Version"</span><span class="token operator">:</span> <span class="token string">"2012-10-17"</span><span class="token punctuation">,</span>
  <span class="token property">"Statement"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token property">"Effect"</span><span class="token operator">:</span> <span class="token string">"Allow"</span><span class="token punctuation">,</span>
    <span class="token property">"Principal"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"Service"</span><span class="token operator">:</span> <span class="token string">"pods.eks.amazonaws.com"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"sts:AssumeRole"</span><span class="token punctuation">,</span><span class="token string">"sts:TagSession"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="deploying-a-test-pod" style="position:relative;"><a href="#deploying-a-test-pod" aria-label="deploying a test pod permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deploying a test Pod</h2>
<h3 id="creating-a-kubernetes-pod-spec" style="position:relative;"><a href="#creating-a-kubernetes-pod-spec" aria-label="creating a kubernetes pod spec permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Creating a Kubernetes Pod Spec</h3>
<p>Create a Kubernetes pod specification that uses the service account with the IAM role.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> s3<span class="token punctuation">-</span>list<span class="token punctuation">-</span>pod
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">serviceAccountName</span><span class="token punctuation">:</span> s3<span class="token punctuation">-</span>access<span class="token punctuation">-</span>sa
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> s3<span class="token punctuation">-</span>list<span class="token punctuation">-</span>container
    <span class="token key atrule">image</span><span class="token punctuation">:</span> amazonlinux
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> <span class="token string">"while true; do sleep 30; done;"</span><span class="token punctuation">]</span></code></pre></div>
<p>Save this specification to a file named <code class="language-text">pod-spec.yaml</code>.</p>
<h3 id="deploying-the-pod-with-the-service-account" style="position:relative;"><a href="#deploying-the-pod-with-the-service-account" aria-label="deploying the pod with the service account permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deploying the Pod with the Service Account</h3>
<p>Apply the pod specification to your Kubernetes cluster.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl apply <span class="token parameter variable">-f</span> pod-spec.yaml</code></pre></div>
<p>Verify that the pod is running.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl get pods <span class="token parameter variable">-n</span> default</code></pre></div>
<h2 id="using-boto3-inside-the-pod" style="position:relative;"><a href="#using-boto3-inside-the-pod" aria-label="using boto3 inside the pod permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using Boto3 Inside the Pod</h2>
<h3 id="accessing-the-pod-and-installing-boto3" style="position:relative;"><a href="#accessing-the-pod-and-installing-boto3" aria-label="accessing the pod and installing boto3 permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Accessing the Pod and Installing Boto3</h3>
<p>Use <code class="language-text">kubectl exec</code> to access the pod.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> s3-list-pod -- /bin/bash</code></pre></div>
<p>Inside the pod, install Boto3 using pip.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> python3-pip
pip3 <span class="token function">install</span> boto3</code></pre></div>
<h3 id="writing-a-python-script-to-list-s3-bucket-objects" style="position:relative;"><a href="#writing-a-python-script-to-list-s3-bucket-objects" aria-label="writing a python script to list s3 bucket objects permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Writing a Python Script to List S3 Bucket Objects</h3>
<p>Create a Python script to list objects in an S3 bucket. Save this script as <code class="language-text">list_s3_objects.py</code>.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> boto3

<span class="token comment"># Create a session using the default credentials chain</span>
session <span class="token operator">=</span> boto3<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Create an S3 client</span>
s3 <span class="token operator">=</span> session<span class="token punctuation">.</span>client<span class="token punctuation">(</span><span class="token string">'s3'</span><span class="token punctuation">)</span>

<span class="token comment"># List all buckets</span>
response <span class="token operator">=</span> s3<span class="token punctuation">.</span>list_buckets<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Print bucket names</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Buckets:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> bucket <span class="token keyword">in</span> response<span class="token punctuation">[</span><span class="token string">'Buckets'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  </span><span class="token interpolation"><span class="token punctuation">{</span>bucket<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre></div>
<h3 id="running-the-script-and-verifying-access" style="position:relative;"><a href="#running-the-script-and-verifying-access" aria-label="running the script and verifying access permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Running the Script and Verifying Access</h3>
<p>Run the Python script inside the pod.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">python3 list_s3_objects.py</code></pre></div>
<p>Check the output to verify that the script lists the S3 buckets.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl logs s3-list-pod</code></pre></div>
<h2 id="conclusion" style="position:relative;"><a href="#conclusion" aria-label="conclusion permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conclusion</h2>
<p>In this blog post, we explored how to securely manage AWS resources using the AWS EKS Pod Identity Agent and Boto3. We began by understanding the importance of managing AWS resources securely and introduced the concept of Pod Identity in Kubernetes, highlighting its implementation in Amazon EKS.</p>
<p>We then provided a detailed, step-by-step guide to setting up EKS Pod Identity, including creating an IAM role, associating it with a Kubernetes service account, and installing the Pod Identity Agent. Following this, we demonstrated how to deploy a test pod and use Boto3 inside the pod to list S3 bucket objects.</p>
<p>By using these tools, you can enhance security, simplify management, and increase the flexibility and scalability of your AWS resource management.</p>
<h2 id="-additional-resources" style="position:relative;"><a href="#-additional-resources" aria-label=" additional resources permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üìªüß° Additional Resources</h2>
<ul>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/pod-id-how-it-works.html" target="_blank" rel="noopener noreferrer">AWS EKS Pod Identity agent documentation</a></li>
<li><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" target="_blank" rel="noopener noreferrer">Boto3 documentation</a></li>
<li><a href="https://kubernetes.io/docs/concepts/security/service-accounts/" target="_blank" rel="noopener noreferrer">Kubernetes Service accounts</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html" target="_blank" rel="noopener noreferrer">IAM Roles for Service Accounts (IRSA)</a></li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html" target="_blank" rel="noopener noreferrer">Amazon EKS documentation</a></li>
<li><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">Kubernetes RBAC</a></li>
<li><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_attribute-based-access-control.html" target="_blank" rel="noopener noreferrer">AWS ABAC</a></li>
</ul>
<p>Further reading on Kubernetes, EKS, and Boto3:</p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/" target="_blank" rel="noopener noreferrer">Kubernetes documentation</a></li>
<li><a href="https://aws.github.io/aws-eks-best-practices/" target="_blank" rel="noopener noreferrer">Amazon EKS best practices Guide</a></li>
<li><a href="https://github.com/boto/boto3" target="_blank" rel="noopener noreferrer">Boto3 GitHub repository</a></li>
<li><a href="https://github.com/aws/eks-pod-identity-agent" target="_blank" rel="noopener noreferrer">Pod Agent GitHub repository</a></li>
<li><a href="https://github.com/aws-ia/terraform-aws-eks-blueprints-addons" target="_blank" rel="noopener noreferrer">EKS addons GitHub repository</a></li>
</ul>
<br>
<br>
<blockquote>
<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>
</blockquote>
<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>
<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href="https://www.linkedin.com/in/rajhi-saif/" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/in/rajhi-saif/</a></p>
<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href="https://x.com/rajhisaifeddine" target="_blank" rel="noopener noreferrer">https://x.com/rajhisaifeddine</a></p>
<p><strong>The end ‚úåüèª</strong></p>
<p><em><strong>Keep Learning !! Keep Sharing !! üî∞</strong></em></p>
<p><strong>üìÖ Stay updated</strong></p>
<p>Subscribe to our newsletter for more insights on AWS cloud coomputing and containers.
password: test</p></div></div><div id="content-end"></div></article><div data-nosnippet="" class="social-share-wrapper"><h3>Share Your Love</h3><button keywords="" aria-label="Share Via Facebook" class="react-share__ShareButton social-share-item facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" class="svg-inline--fa fa-facebook " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"></path></svg></button><button keywords="" aria-label="Share Via Twitter" class="react-share__ShareButton social-share-item twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></button><button aria-label="Share Via LinkedIn" keywords="" class="react-share__ShareButton social-share-item linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></button><button keywords="" aria-label="Share Via Reddit" class="react-share__ShareButton social-share-item reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" class="svg-inline--fa fa-reddit " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 256C0 114.6 114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256L37.1 512c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256zM349.6 153.6c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34c-34.5 3.7-61.4 33-61.4 68.4l0 .2c-37.5 1.6-71.8 12.3-99 29.1c-10.1-7.8-22.8-12.5-36.5-12.5c-33 0-59.8 26.8-59.8 59.8c0 24 14.1 44.6 34.4 54.1c2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54c0-33-26.8-59.8-59.8-59.8c-13.7 0-26.3 4.6-36.4 12.4c-27.4-17-62.1-27.7-100-29.1l0-.2c0-25.4 18.9-46.5 43.4-49.9l0 0c4.4 18.8 21.3 32.8 41.5 32.8zM177.1 246.9c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6s-31.4-8.8-30.4-30.5s15.4-38.3 32.1-38.3zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6c-1-21.7 11.8-39.3 28.5-39.3s31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9 .8-6.2 3.9-6.5c18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1 .3 5.1 3.6 3.9 6.5z"></path></svg></button><button keywords="" aria-label="Add to Pocket" class="react-share__ShareButton social-share-item pocket" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="get-pocket" class="svg-inline--fa fa-get-pocket " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg></button></div><br/><br/><br/></main><aside class="blogpost-sidebar"><div data-nosnippet="" class="blog-navigation-wrapper"><h3>Read Other Posts</h3><nav class="blog-navigation"><div class="nav-links"><a rel="next" class="next-post" href="/blog/ai-and-kubernetes/">AI and Kubernetes: Open Source Tools powered by AI/OpenAI for Kubernetes<!-- --> ‚Üí</a><a rel="prev" class="prev-post" href="/blog/eks-access-entry-terraform-opentofu/">‚Üê <!-- -->Managing AWS EKS access entries with Terraform and OpenTofu</a><a class="all-posts" href="/blog/">All Posts</a></div></nav></div></aside><footer data-nosnippet=""><div class="footer-wrapper"><div data-nosnippet="" class="social"><ul class="social-list"><li class="social-item social-linkedin"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="linkedin" href="https://www.linkedin.com/in/rajhi-saif/" title="Saifeddine Rajhi on LinkedIn" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg><span>LinkedIn</span></a></li><li class="social-item social-github"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="github" href="https://github.com/seifrajhi" title="Saifeddine Rajhi on Github" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span>GitHub</span></a></li><li class="social-item social-email"><a itemProp="email" eventCategory="social" eventAction="click" eventLabel="email" href="mailto:rajhiseif@gmail.com" title="Saifeddine Rajhi&#x27;s Email"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg><span>Email</span></a></li><li class="social-item social-X/Twitter"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="X/Twitter" href="https://x.com/RajhiSaifeddine" title="Saifeddine Rajhi on X/X/Twitter" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg><span>X/Twitter</span></a></li><li class="social-item social-reddit"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="reddit" href="https://www.reddit.com/user/ScoreApprehensive992/" title="Saifeddine Rajhi on Reddit" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit-alien" class="svg-inline--fa fa-reddit-alien fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M373 138.6c-25.2 0-46.3-17.5-51.9-41l0 0c-30.6 4.3-54.2 30.7-54.2 62.4l0 .2c47.4 1.8 90.6 15.1 124.9 36.3c12.6-9.7 28.4-15.5 45.5-15.5c41.3 0 74.7 33.4 74.7 74.7c0 29.8-17.4 55.5-42.7 67.5c-2.4 86.8-97 156.6-213.2 156.6S45.5 410.1 43 323.4C17.6 311.5 0 285.7 0 255.7c0-41.3 33.4-74.7 74.7-74.7c17.2 0 33 5.8 45.7 15.6c34-21.1 76.8-34.4 123.7-36.4l0-.3c0-44.3 33.7-80.9 76.8-85.5C325.8 50.2 347.2 32 373 32c29.4 0 53.3 23.9 53.3 53.3s-23.9 53.3-53.3 53.3zM157.5 255.3c-20.9 0-38.9 20.8-40.2 47.9s17.1 38.1 38 38.1s36.6-9.8 37.8-36.9s-14.7-49.1-35.7-49.1zM395 303.1c-1.2-27.1-19.2-47.9-40.2-47.9s-36.9 22-35.7 49.1c1.2 27.1 16.9 36.9 37.8 36.9s39.3-11 38-38.1zm-60.1 70.8c1.5-3.6-1-7.7-4.9-8.1c-23-2.3-47.9-3.6-73.8-3.6s-50.8 1.3-73.8 3.6c-3.9 .4-6.4 4.5-4.9 8.1c12.9 30.8 43.3 52.4 78.7 52.4s65.8-21.6 78.7-52.4z"></path></svg><span>Reddit</span></a></li><li class="social-item social-stackoverflow"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://stackoverflow.com/users/21897244/saifeddine-rajhi" title="Saifeddine Rajhi on StackOverflow" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="stack-overflow" class="svg-inline--fa fa-stack-overflow fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg><span>StackOverflow</span></a></li><li class="social-item social-Goodreads"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://www.goodreads.com/user/show/176103378-saifeddine" title="Saifeddine Rajhi on Goodreads" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="goodreads" class="svg-inline--fa fa-goodreads fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M299.9 191.2c5.1 37.3-4.7 79-35.9 100.7-22.3 15.5-52.8 14.1-70.8 5.7-37.1-17.3-49.5-58.6-46.8-97.2 4.3-60.9 40.9-87.9 75.3-87.5 46.9-.2 71.8 31.8 78.2 78.3zM448 88v336c0 30.9-25.1 56-56 56H56c-30.9 0-56-25.1-56-56V88c0-30.9 25.1-56 56-56h336c30.9 0 56 25.1 56 56zM330 313.2s-.1-34-.1-217.3h-29v40.3c-.8.3-1.2-.5-1.6-1.2-9.6-20.7-35.9-46.3-76-46-51.9.4-87.2 31.2-100.6 77.8-4.3 14.9-5.8 30.1-5.5 45.6 1.7 77.9 45.1 117.8 112.4 115.2 28.9-1.1 54.5-17 69-45.2.5-1 1.1-1.9 1.7-2.9.2.1.4.1.6.2.3 3.8.2 30.7.1 34.5-.2 14.8-2 29.5-7.2 43.5-7.8 21-22.3 34.7-44.5 39.5-17.8 3.9-35.6 3.8-53.2-1.2-21.5-6.1-36.5-19-41.1-41.8-.3-1.6-1.3-1.3-2.3-1.3h-26.8c.8 10.6 3.2 20.3 8.5 29.2 24.2 40.5 82.7 48.5 128.2 37.4 49.9-12.3 67.3-54.9 67.4-106.3z"></path></svg><span>Goodreads</span></a></li><li class="social-item social-osi"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://ossinsight.io/analyze/seifrajhi" title="Saifeddine Rajhi on OSSInsights" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="osi" class="svg-inline--fa fa-osi fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M8 266.44C10.3 130.64 105.4 34 221.8 18.34c138.8-18.6 255.6 75.8 278 201.1 21.3 118.8-44 230-151.6 274-9.3 3.8-14.4 1.7-18-7.7q-26.7-69.45-53.4-139c-3.1-8.1-1-13.2 7-16.8 24.2-11 39.3-29.4 43.3-55.8a71.47 71.47 0 0 0-64.5-82.2c-39-3.4-71.8 23.7-77.5 59.7-5.2 33 11.1 63.7 41.9 77.7 9.6 4.4 11.5 8.6 7.8 18.4q-26.85 69.9-53.7 139.9c-2.6 6.9-8.3 9.3-15.5 6.5-52.6-20.3-101.4-61-130.8-119-24.9-49.2-25.2-87.7-26.8-108.7zm20.9-1.9c.4 6.6.6 14.3 1.3 22.1 6.3 71.9 49.6 143.5 131 183.1 3.2 1.5 4.4.8 5.6-2.3q22.35-58.65 45-117.3c1.3-3.3.6-4.8-2.4-6.7-31.6-19.9-47.3-48.5-45.6-86 1-21.6 9.3-40.5 23.8-56.3 30-32.7 77-39.8 115.5-17.6a91.64 91.64 0 0 1 45.2 90.4c-3.6 30.6-19.3 53.9-45.7 69.8-2.7 1.6-3.5 2.9-2.3 6q22.8 58.8 45.2 117.7c1.2 3.1 2.4 3.8 5.6 2.3 35.5-16.6 65.2-40.3 88.1-72 34.8-48.2 49.1-101.9 42.3-161-13.7-117.5-119.4-214.8-255.5-198-106.1 13-195.3 102.5-197.1 225.8z"></path></svg><span>OSSInsights</span></a></li><li class="social-item social-devstats"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://devstats.cluster.fun/?user=seifrajhi" title="Saifeddine Rajhi on DevStats" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chart-line" class="svg-inline--fa fa-chart-line fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64L0 400c0 44.2 35.8 80 80 80l400 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 416c-8.8 0-16-7.2-16-16L64 64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"></path></svg><span>DevStats</span></a></li><li class="social-item social-RSS"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="RSS" href="https://seifrajhi.github.io/rss.xml" title="Subscribe to my blog post" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg><span>RSS</span></a></li></ul></div><div class="copyright">Saifeddine Rajhi ¬© 1994 - <!-- -->2024<!-- --> <br/><a rel="license" href="https://creativecommons.org/licenses/by/4.0/" title="Content is published under CC BY 4.0 license">CC BY 4.0</a></div><div class="pgp"><a href="https://keybase.io/saifrajhi">0C3B BABB 8BC1 EA2B</a></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/aws-pod-id-agent-boto3-python/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-9a8612690ac49bf4d185.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-88fb5c28d68e831e730a.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-83bdb4e48c18bf191297.js\"],\"component---src-pages-blog-js\":[\"/component---src-pages-blog-js-1d9df5951d31bb40530f.js\"],\"component---src-pages-cv-ecommerce-developer-js\":[\"/component---src-pages-cv-ecommerce-developer-js-d1851454f247dcae7a52.js\"],\"component---src-pages-cv-platform-engineer-backup-js\":[\"/component---src-pages-cv-platform-engineer-backup-js-032ec4806b6ebaf7b512.js\"],\"component---src-pages-cv-platform-engineer-js\":[\"/component---src-pages-cv-platform-engineer-js-3f9ab5d9a89c46bb51e4.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-05d8f3435c4df82fd6b8.js\"],\"component---src-pages-thoughts-js\":[\"/component---src-pages-thoughts-js-fe54f831bbb3f7f31564.js\"],\"component---src-templates-blog-template-js\":[\"/component---src-templates-blog-template-js-b2a62575daef5a334ab3.js\"],\"component---src-templates-thought-template-js\":[\"/component---src-templates-thought-template-js-22418db5dfd1822532e8.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="c798d9ec617769792316";</script><script src="/webpack-runtime-49ed5611d2152f590842.js" async></script><script src="/framework-c989293af61a95023f7f.js" async></script><script src="/app-9a8612690ac49bf4d185.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>