<!DOCTYPE html><html lang="en" class="blogpost-view-page"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="description" property="og:description" content="Explore KubeArmor, a great runtime security enforcement system designed to protect cloud-native applications in Kubernetes environments."/><meta data-react-helmet="true" name="keywords" content="Kubernetes,Runtime Security,Cloud-Native,Threat Protection,KubeArmor"/><meta data-react-helmet="true" name="author" content="@RajhiSaifeddine"/><meta data-react-helmet="true" property="og:title" content="KubeArmor: A Cloud-Native Runtime Security Enforcement System - Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@RajhiSaifeddine"/><meta data-react-helmet="true" name="twitter:title" content="KubeArmor: A Cloud-Native Runtime Security Enforcement System - Blog"/><meta data-react-helmet="true" name="twitter:description" content="Explore KubeArmor, a great runtime security enforcement system designed to protect cloud-native applications in Kubernetes environments."/><meta data-react-helmet="true" name="image" property="og:image" content="https://seifrajhi.github.io/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg"/><meta data-react-helmet="true" name="twitter:image" content="https://seifrajhi.github.io/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg"/><meta data-react-helmet="true" property="og:url" content="https://seifrajhi.github.io/blog/kubearmor-k8s-runtime-security/"/><meta name="theme-color" content="#ffffff"/><link rel="stylesheet" href="/styles.38c2a06e874c487e61a0.css"/><link rel="stylesheet"/><link rel="alternate" type="application/rss+xml" title="Saifeddine Rajhi&#x27;s Blog RSS Feed" href="/rss.xml"/><title data-react-helmet="true">KubeArmor: A Cloud-Native Runtime Security Enforcement System - Blog by Saifeddine Rajhi</title><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":"/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg","headline":"KubeArmor: A Cloud-Native Runtime Security Enforcement System","dateCreated":"2024-10-25","datePublished":"2024-10-25","dateModified":"2024-10-25","inLanguage":"en-US","isFamilyFriendly":true,"isAccessibleForFree":true,"author":{"@type":"Person","name":"Saifeddine Rajhi","url":"https://seifrajhi.github.io"},"publisher":{"@type":"Organization","name":"Saifeddine Rajhi's Website"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seifrajhi.github.io/blog/kubearmor-k8s-runtime-security/"},"keywords":["Kubernetes","Runtime Security","Cloud-Native","Threat Protection","KubeArmor"],"genre":["Platform engineer","software engineering","science","deep learning","statistics"],"articleSection":"Technical Blog","articleBody":"\n> **Shield Against Cloud-Native Threats‚ò∏Ô∏è**\n\n## üß∞ Introduction\n\nCloud-native workloads are increasingly becoming the target of attackers. This is because cloud-native applications are often complex and distributed, and they can be difficult to secure.\n\n[KubeArmor](https://kubearmor.io/) is a cloud-native runtime security enforcement system that can help you to secure your workloads. KubeArmor restricts the behavior of pods, containers, and nodes at the system level, and it can be used to enforce least-permissive policies. This helps to reduce the attack surface and make it more difficult for attackers to exploit vulnerabilities.\n\nIn this blog post, we will introduce KubeArmor and discuss its key features and benefits. We will also provide some examples of how KubeArmor can be used to improve cloud-native security.\n\n![KubeArmor](./KubeArmor.png)\n\nKubeArmor is a cloud-native security system that controls what pods, containers, and nodes (VMs) can do, such as running processes, accessing files, and connecting to the network. It does this at the system level, which means that it has a lot of power and flexibility.\n\nKubeArmor leverages [Linux security modules (LSMs)](https://en.wikipedia.org/wiki/Linux_Security_Modules) such as [AppArmor](https://en.wikipedia.org/wiki/AppArmor), [SELinux](https://en.wikipedia.org/wiki/Security-Enhanced_Linux), or [BPF-LSM](https://docs.kernel.org/bpf/prog_lsm.html) to enforce the user-specified policies. KubeArmor generates rich alerts/telemetry events with container/pod/namespace identities by leveraging eBPF.\n\n### ‚ú® KubeArmor Features\n\n![features](./features.png)\n\nKubeArmor leverages technologies like eBPF, AppArmor, or SELinux to enforce user-specified policies. eBPF is a kernel technology that allows users to program the Linux kernel without changing the kernel code. This makes eBPF ideal for runtime security enforcement, as it allows KubeArmor to intercept and modify system calls without impacting the performance of the workload.\n\nKubeArmor uses eBPF to generate detailed alerts and telemetry events that include information about the identities of the container, pod, and namespace. This information is essential for investigating and responding to security incidents.\n\nThe following diagram shows the architecture of KubeArmor:\n\n![archi](./archi.png)\n\nKubeArmor and AppArmor are both security modules that can be used to restrict access to particular processes or files. However, KubeArmor is specifically designed to secure containers within Kubernetes environments.\n\nHere is a recap of the key differences between KubeArmor and AppArmor:\n\n- **Scope**: KubeArmor operates at the Kubernetes cluster level, while AppArmor operates at the host level.\n- **Policy syntax**: KubeArmor uses the universally recognized YAML syntax for policy definitions, while AppArmor uses its own profile syntax.\n- **Features**: KubeArmor leverages Linux security modules like AppArmor to enforce policies, but it also goes beyond that by utilizing more advanced features, such as seccomp and auditd, for a more comprehensive approach to container security.\n- **Integration**: KubeArmor is seamlessly integrated with the Kubernetes ecosystem, while AppArmor is focused on individual applications running on a Linux system.\n\n### üöÄ Getting Started with KubeArmor\n\nKubeArmor is a cloud-native runtime security enforcement system that can help you to secure your workloads. It is easy to use, scalable, and effective.\n\nThis guide provides instructions on how to get started with KubeArmor. It assumes that you have access to a Kubernetes cluster, but it also mentions that you can use KubeArmor in non-Kubernetes mode, such as systemd mode, to protect or audit containers or processes on VMs or bare metal.\n\n#### Install KubeArmor\n\n```sh\ncurl -sfL http://get.kubearmor.io/ | sudo sh -s -- -b /usr/local/bin\nkarmor install\n```\n\n#### Deploy test nginx app\n\n```sh\nkubectl create deployment nginx --image=nginx\nPOD=$(kubectl get pod -l app=nginx -o name)\n```\n\n`$POD` is used to refer to the target nginx pod in many cases below.\n\n#### Sample policies\n\n**Denying Execution of Package Management Tools:**\n\nPackage management tools, such as apt and apt-get, can be used to download new binaries to pods at runtime. This can increase the attack surface of the pods, as attackers can use package management tools to download malicious software.\n\nTo prevent this, you can use a KubeArmor policy to block the execution of package management tools. This is a good practice in production environments.\n\nHere is an example of a KubeArmor policy to block the execution of package management tools:\n\n```yaml\ncat <<EOF | kubectl apply -f -\napiVersion: security.kubearmor.com/v1\nkind: KubeArmorPolicy\nmetadata:\n    name: block-pkg-mgmt-tools-exec\nspec:\n    selector:\n        matchLabels:\n            app: nginx\n    process:\n        matchPaths:\n        - path: /usr/bin/apt\n        - path: /usr/bin/apt-get\n    action:\n        Block\nEOF\n```\n\nNow execute the apt command to download the masscan tool.\n\n```sh\nkubectl exec -it $POD -- bash -c \"apt update && apt install masscan\"\n```\n\nIt will be denied permission to execute.\n\n```sh\nsh: 1: apt: Permission denied\ncommand terminated with exit code 126\n```\n\n#### Get policy violations notifications\n\n```sh\nkarmor logs -n default --json\n```\n\n```json\n{\n    \"Timestamp\": 1686516788, \n    \"UpdatedTime\": \"2023-10-10T19:03:08Z\",\n    \"ClusterName\": \"default\",\n    \"HostName\": \"ip-172-10-58-42\",\n    \"NamespaceName\": \"default\",\n    \"PodName\": \"nginx-fr786gioa-9843a\",\n    \"Labels\": \"app=nginx\",\n    \"ContainerID\": \"9876543210abcdef1234567890abcdef\", \n    \"ContainerName\": \"nginx\",\n    \"ContainerImage\": \"docker.io/library/nginx:latest@sha256:af296b188c7b7df99ba960ca614439c99cb7cf252ed7bbc23e90cfda59092305\",\n    \"HostPPID\": 4741922,\n    \"HostPID\": 4191928,\n    \"PPID\": 677,\n    \"PID\": 855,\n    \"ParentProcessName\": \"/bin/dash\",\n    \"ProcessName\": \"/usr/bin/apt\",\n    \"PolicyName\": \"block-pkg-mgmt-tools-exec\",\n    \"Severity\": \"1\",\n    \"Type\": \"MatchedPolicy\",\n    \"Source\": \"/bin/dash\",\n    \"Operation\": \"Process\",\n    \"Resource\": \"/usr/bin/apt update\",\n    \"Data\": \"syscall=SYS_EXECVE\",\n    \"Enforcer\": \"BPFLSM\",\n    \"Action\": \"Block\",\n    \"Result\": \"Permission denied\"\n}\n```\n\n**Deny Access to Service Account Tokens:**\n\nKubernetes mounts a service account token in each pod by default, even if the app does not need it. Attackers can exploit these service account tokens to move laterally across a cluster.\n\n```sh\nkubectl exec -it $POD -- bash\n```\n\n(inside pod)\n\n```sh\ncurl https://$KUBERNETES_PORT_443_TCP_ADDR/api --insecure --header \"Authorization: Bearer $(cat /run/secrets/kubernetes.io/serviceaccount/token)\"\n```\n\n```json\n{                                \n    \"kind\": \"APIVersions\",      \n    \"versions\": [                 \n        \"v1\"                      \n    ],                          \n    \"serverAddressByClientCIDRs\": [\n        {\n            \"clientCIDR\": \"0.0.0.0/0\",\n            \"serverAddress\": \"ip-10-0-48-51.eu-west-1.compute.internal:443\"\n        }\n    ]\n}\n```\n\nThus we can see that one can use the service account token to access the Kube API server.\n\nLet's apply a policy to block access to service account token:\n\n```shell\ncat <<EOF | kubectl apply -f -\napiVersion: security.kubearmor.com/v1\nkind: KubeArmorPolicy\nmetadata:\n    name: block-service-access-token-access\nspec:\n    selector:\n        matchLabels:\n            app: nginx\n    file:\n        matchDirectories:\n        - dir: /run/secrets/kubernetes.io/serviceaccount/\n            recursive: true\n    action:\n        Block\nEOF\n```\n\nNow when anyone tries to access to service account token, it would be Permission Denied.\n\n```sh\n‚ùØ kubectl exec -it $POD -- bash\n\n(inside pod) $ curl https://$KUBERNETES_PORT_443_TCP_ADDR/api --insecure --header \"Authorization: Bearer $(cat /run/secrets/kubernetes.io/serviceaccount/token)\"\n```\n\n```sh\ncat: /run/secrets/kubernetes.io/serviceaccount/token: Permission denied\n{\n    \"kind\": \"Status\",\n    \"apiVersion\": \"v1\",\n    \"metadata\": {},\n    \"status\": \"Failure\",\n    \"message\": \"forbidden: User \\\"system:anonymous\\\" cannot get path \\\"/api\\\"\",\n    \"reason\": \"Forbidden\",\n    \"details\": {},\n    \"code\": 403\n}\n```\n\n**Auditing Access to Folders/Paths:**\n\nKubeArmor can be used to audit access to specific folders or paths. This can be useful for compliance or reporting reasons.\n\nFor instance, to audit access to the `/etc/nginx/` folder within a deployment, you can create the following KubeArmor policy:\n\n```shell\ncat <<EOF | kubectl apply -f -\napiVersion: security.kubearmor.com/v1\nkind: KubeArmorPolicy\nmetadata:\n    name: audit-etc-nginx-access\nspec:\n    selector:\n        matchLabels:\n            app: nginx\n    file:\n        matchDirectories:\n        - dir: /etc/nginx/\n            recursive: true  \n    action:\n        Audit\nEOF\n```\n\nNote: `karmor logs -n default` would show all the audit/block operations.\n\n```json\n{\n    \"Timestamp\": 1686516788, \n    \"UpdatedTime\": \"2023-10-10T19:03:08Z\",\n    \"ClusterName\": \"default\",\n    \"HostName\": \"ip-172-10-58-42\",\n    \"NamespaceName\": \"default\",\n    \"PodName\": \"nginx-fr786gioa-9843a\",\n    \"Labels\": \"app=nginx\",\n    \"ContainerID\": \"9876543210abcdef1234567890abcdef\", \n    \"ContainerName\": \"nginx\",\n    \"ContainerImage\": \"docker.io/library/nginx:latest@sha256:af296b188c7b7df99ba960ca614439c99cb7cf252ed7bbc23e90cfda59092305\",\n    \"HostPPID\": 4741922,\n    \"HostPID\": 4191928,\n    \"PPID\": 677,\n    \"PID\": 855,\n    \"ParentProcessName\": \"/x86_64-bottlerocket-linux-gnu/sys-root/usr/bin/containerd-shim-runc-v2\",\n    \"ProcessName\": \"/bin/cat\",\n    \"PolicyName\": \"audit-etc-nginx-access\",\n    \"Severity\": \"1\",\n    \"Type\": \"MatchedPolicy\",\n    \"Source\": \"/bin/cat /etc/nginx/conf.d/default.conf\",\n    \"Operation\": \"File\",\n    \"Resource\": \"/etc/nginx/conf.d/default.conf\",\n    \"Data\": \"syscall=SYS_OPENAT fd=-100 flags=O_RDONLY\",\n    \"Enforcer\": \"eBPF Monitor\",\n    \"Action\": \"Audit\",\n    \"Result\": \"Passed\"\n}\n```\n\n**Zero Trust Least Permissive Policy: Allow Only Nginx to Execute in the Pod, Deny Rest:**\n\nA least permissive policy requires you to explicitly allow certain actions or operations and deny the rest. With KubeArmor, you can specify which actions to allow and deny or audit in the policy.\n\nThe security posture defines what happens to operations that are not in the allowed list. Should they be audited (allowed but alerted) or denied (blocked and alerted)?\n\nBy default, the security posture is set to audit. To change the security posture to default deny, run the following command:\n\n```sh\nkubectl annotate ns default kubearmor-file-posture=block --overwrite\n```\n\n```shell\ncat <<EOF | kubectl apply -f -\napiVersion: security.kubearmor.com/v1\nkind: KubeArmorPolicy\nmetadata:\n    name: only-allow-nginx-exec\nspec:\n    selector:\n        matchLabels:\n            app: nginx\n    file:\n        matchDirectories:\n        - dir: /\n            recursive: true  \n    process:\n        matchPaths:\n        - path: /usr/sbin/nginx\n        - path: /bin/bash\n    action:\n        Allow\nEOF\n```\n\nObserve that the policy contains Allow action. Once there is any KubeArmor policy having Allow action then the pods enter least permissive mode, allowing only explicitly allowed operations.\n\nNote: Use `kubectl port-forward $POD --address 0.0.0.0 8080:80` to access nginx and you can see that the nginx web access still works normally.\n\nLet's try to execute some other processes:\n\n```sh\nkubectl exec -it $POD -- bash -c \"chroot\"\n```\n\nAny binary other than bash and nginx would be permission denied.\n\n### üõ°Ô∏è KubeArmor Support Matrix\n\nKubeArmor supports the following types of workloads:\n\n- **K8s orchestrated**: Workloads deployed as k8s orchestrated containers. In this case, Kubearmor is deployed as a [k8s daemonset](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/). Note, KubeArmor supports policy enforcement on both k8s-pods ([KubeArmorPolicy](https://github.com/kubearmor/KubeArmor/blob/main/getting-started/security_policy_specification.md)) as well as k8s-nodes (KubeArmorHostPolicy).\n- **Containerized**: Workloads that are containerized but not k8s orchestrated are supported. KubeArmor installed in [systemd mode](https://github.com/kubearmor/KubeArmor/blob/main/getting-started/kubearmor_vm.md) can be used to protect such workloads.\n- **VM/Bare-Metals**: Workloads deployed on Virtual Machines or Bare Metal i.e. workloads directly operating as host/system processes. In this case, Kubearmor is deployed in [systemd mode](https://github.com/kubearmor/KubeArmor/blob/main/getting-started/kubearmor_vm.md).\n\n### üîí Hardening Infrastructure with KubeArmor\n\nKubeArmor is a security solution that can help you harden your Kubernetes and cloud-native infrastructure. It provides a set of out-of-the-box hardening policies that are based on industry-leading compliance and attack frameworks, such as CIS, MITRE, NIST-800‚Äì53, and STIGs. These policies can help you secure your workloads in a way that is compliant with these frameworks and recommended best practices.\n\n![hardening](./Hardening.png)\n\nOne of the key benefits of KubeArmor is that it makes it easy to apply hardening policies to your workloads. You don't have to spend time researching and configuring the policies yourself; simply apply them to your workloads and start benefiting from the added security that they provide.\n\nKubeArmor also presents hardening policies in the context of your workloads, so you can see how they will be applied and what impact they will have on your system. This allows you to make informed decisions about which policies to apply and to understand the trade-offs between security and functionality.\n\n![line](./line.png)\n\n## üìù Takeaways\n\n- KubeArmor is a powerful and flexible Kubernetes security tool that provides granular control over container behavior.\n- It offers a wide range of pre-configured policies and supports custom policies, making it easy for organizations to comply with regulatory standards and protect against security threats.\n- KubeArmor is a valuable tool for safeguarding containerized environments within Kubernetes and preventing the exploitation of vulnerabilities.\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordcount":1315}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://seifrajhi.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://seifrajhi.github.io/blog/"},{"@type":"ListItem","position":3,"name":"KubeArmor: A Cloud-Native Runtime Security Enforcement System","item":"https://seifrajhi.github.io/blog/kubearmor-k8s-runtime-security/"}]}</script><link crossorigin="" href="https://utteranc.es" rel="preconnect"/><link crossorigin="" href="https://www.google-analytics.com" rel="preconnect"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=47ae28bb567c9025f1fee24afb2d20c9" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2"/><style>@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2) format("woff2")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMr3.woff) format("woff")}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-LLPCCGNLH7', 'auto', {"alwaysSendReferrer":true});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LLPCCGNLH7"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-LLPCCGNLH7', {"anonymize_ip":true,"send_page_view":false});gtag('config', 'GTM-5V895PDS', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><link rel="stylesheet"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://seifrajhi.github.io/blog/kubearmor-k8s-runtime-security/" data-baseprotocol="https:" data-basehost="seifrajhi.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="blogpost-header"><div class="view-page-header"><div class="view-page-header-wrapper"><div class="logo-wrapper"><div class="logo"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained logo-img"><div style="max-width:150px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;174&#x27;%20width=&#x27;150&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" data-src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture><noscript><picture><source type="image/avif" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="name"><a href="/blog/" title="back to blog">Saifeddine <br/> Rajhi</a></div></div><h2 class="blog-title"><a href="/blog/" title="back to the homepage">Blog</a></h2></div></div><nav class="main-navigation"><ul><li><a rel="home" title="Go Home" href="/">Home</a></li><li><a title="Go to my Technical Blog" href="/blog/">Blog</a></li><li><a title="Go to my Thoughts" href="/thoughts/">Thoughts</a></li><li><a title="My public talks" href="/talks/">talks</a></li><li><a title="Review My Resume" href="/cv/platform-engineer/">cv</a></li></ul></nav></div><main><article class="blog-wrapper"><header><figure class="cover"><div class="cover-filter"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper cover cover-image"><div aria-hidden="true" style="padding-top:56.25%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;object-fit:fill;object-position:center" decoding="async" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIFAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAABAwT/2gAMAwEAAhADEAAAAUyu8MtEkQH/xAAYEAADAQEAAAAAAAAAAAAAAAAAAQIDEf/aAAgBAQABBQLSXF0zpql3fKEM/8QAGBEAAgMAAAAAAAAAAAAAAAAAAgMQETH/2gAIAQMBAT8BFt7H/8QAFhEAAwAAAAAAAAAAAAAAAAAAAQIQ/9oACAECAQE/ASk//8QAGxAAAgEFAAAAAAAAAAAAAAAAARAAAhESITH/2gAIAQEABj8CxdIt0zQX/8QAGhABAAMAAwAAAAAAAAAAAAAAAQARIWGBof/aAAgBAQABPyHVBR8gR1FVlacy9ae2Auf/2gAMAwEAAgADAAAAEOv/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAARUf/aAAgBAwEBPxCjSv/EABYRAQEBAAAAAAAAAAAAAAAAAAARMf/aAAgBAgEBPxCGI//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExUWGhsdH/2gAIAQEAAT8QSk6VcDtLLTRxZiFp7i0sYa4MLsvX2gmV5n//2Q==" alt=""/><picture><source type="image/webp" data-srcset="/static/c2645fb75d87c0e7b5a3407d6a3da5d7/a66aa/KubeArmor-cover.webp 750w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/65dd5/KubeArmor-cover.webp 1080w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/4fad6/KubeArmor-cover.webp 1366w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/e9d78/KubeArmor-cover.webp 1600w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="object-fit:fill;object-position:center;opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg" data-srcset="/static/c2645fb75d87c0e7b5a3407d6a3da5d7/37bba/KubeArmor-cover.jpg 750w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/61c72/KubeArmor-cover.jpg 1080w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/d61e8/KubeArmor-cover.jpg 1366w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg 1600w" alt="KubeArmor: A Cloud-Native Runtime Security Enforcement System"/></picture><noscript><picture><source type="image/webp" srcSet="/static/c2645fb75d87c0e7b5a3407d6a3da5d7/a66aa/KubeArmor-cover.webp 750w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/65dd5/KubeArmor-cover.webp 1080w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/4fad6/KubeArmor-cover.webp 1366w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/e9d78/KubeArmor-cover.webp 1600w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="object-fit:fill;object-position:center;opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg" srcSet="/static/c2645fb75d87c0e7b5a3407d6a3da5d7/37bba/KubeArmor-cover.jpg 750w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/61c72/KubeArmor-cover.jpg 1080w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/d61e8/KubeArmor-cover.jpg 1366w,/static/c2645fb75d87c0e7b5a3407d6a3da5d7/f6810/KubeArmor-cover.jpg 1600w" alt="KubeArmor: A Cloud-Native Runtime Security Enforcement System"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><figcaption data-nosnippet="" class="image-title">Photo by Saifeddine Rajhi</figcaption></figure><h1>KubeArmor: A Cloud-Native Runtime Security Enforcement System</h1><div data-nosnippet="" class="blog-details"><time class="blog-createdat" dateTime="2024-10-25">Oct 25, 2024</time><span> ‚Ä¢ </span><span class="blog-time2read">8<!-- -->mins<!-- --> read</span><div class="theme-switcher"><div class="theme-switcher-toggler"><div class="theme-switcher-track"></div><div class="theme-switcher-thumb"></div><input class="theme-switcher-input" type="checkbox" readonly="" aria-label="Switch between Dark and Light modes"/></div></div></div><ul data-nosnippet="" class="blog-tags"><li>Kubernetes</li><li>Runtime Security</li><li>Cloud-Native</li><li>Threat Protection</li><li>KubeArmor</li></ul></header><div class="blog-divider"></div><div id="intro"></div><div class="content-wrapper"><div data-nosnippet="" class="blog-content-nav-wrapper"><ul class="blog-content-nav"><h2>Content</h2><ul class="toc-list"></ul></ul></div><div class="content blog-content"><blockquote>
<p><strong>Shield Against Cloud-Native Threats‚ò∏Ô∏è</strong></p>
</blockquote>
<h2 id="-introduction" style="position:relative;"><a href="#-introduction" aria-label=" introduction permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üß∞ Introduction</h2>
<p>Cloud-native workloads are increasingly becoming the target of attackers. This is because cloud-native applications are often complex and distributed, and they can be difficult to secure.</p>
<p><a href="https://kubearmor.io/" target="_blank" rel="noopener noreferrer">KubeArmor</a> is a cloud-native runtime security enforcement system that can help you to secure your workloads. KubeArmor restricts the behavior of pods, containers, and nodes at the system level, and it can be used to enforce least-permissive policies. This helps to reduce the attack surface and make it more difficult for attackers to exploit vulnerabilities.</p>
<p>In this blog post, we will introduce KubeArmor and discuss its key features and benefits. We will also provide some examples of how KubeArmor can be used to improve cloud-native security.</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 18.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVR42mMwzzu+0C5750ezwrNNaTP/czGo1PNxu04TYwACUfspPPL28zkYoCB01Srm3Mq5ogz//zMy4ALaIQv+B6RO/qfkv/C7etqxXHabCV2cztP9eewnaXA5TivlcZyWyeM4xY7BZlqEb8ES66zGJcvTGpeZZ9QvjchqWBaZVbckNatxsXNm4zLvjPolPgxaflP/u0T1/Ffxm/1NM+NYFattfw+304xsbueZrUA8m9NxSiOP07R5LHZT5wcULazObV7SlNW0vLOgY118TuvKwuzm5UVZjcsmpDcubchuWjGHwbDi7D7j9K3fzEsutoWu+s/MZ9ErxOEyU47dcaYyp9N0aXb76QoMPjO5uC27xUDeDa1fxZZSv1gmq34VT279Yr7yjlX8aeWr+PPqV8llVywUBgBoKXUWkgWCGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="KubeArmor" title="" src="/static/2a02b75cb4f505624fcaeb537cfa8b3a/c5bb3/KubeArmor.png" srcset="/static/2a02b75cb4f505624fcaeb537cfa8b3a/04472/KubeArmor.png 170w,
/static/2a02b75cb4f505624fcaeb537cfa8b3a/9f933/KubeArmor.png 340w,
/static/2a02b75cb4f505624fcaeb537cfa8b3a/c5bb3/KubeArmor.png 680w,
/static/2a02b75cb4f505624fcaeb537cfa8b3a/b12f7/KubeArmor.png 1020w,
/static/2a02b75cb4f505624fcaeb537cfa8b3a/b5a09/KubeArmor.png 1360w,
/static/2a02b75cb4f505624fcaeb537cfa8b3a/29007/KubeArmor.png 1600w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<p>KubeArmor is a cloud-native security system that controls what pods, containers, and nodes (VMs) can do, such as running processes, accessing files, and connecting to the network. It does this at the system level, which means that it has a lot of power and flexibility.</p>
<p>KubeArmor leverages <a href="https://en.wikipedia.org/wiki/Linux_Security_Modules" target="_blank" rel="noopener noreferrer">Linux security modules (LSMs)</a> such as <a href="https://en.wikipedia.org/wiki/AppArmor" target="_blank" rel="noopener noreferrer">AppArmor</a>, <a href="https://en.wikipedia.org/wiki/Security-Enhanced_Linux" target="_blank" rel="noopener noreferrer">SELinux</a>, or <a href="https://docs.kernel.org/bpf/prog_lsm.html" target="_blank" rel="noopener noreferrer">BPF-LSM</a> to enforce the user-specified policies. KubeArmor generates rich alerts/telemetry events with container/pod/namespace identities by leveraging eBPF.</p>
<h3 id="-kubearmor-features" style="position:relative;"><a href="#-kubearmor-features" aria-label=" kubearmor features permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>‚ú® KubeArmor Features</h3>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABV0lEQVR42nVSi26DMBDr/3/iVnWFEtY2vF95x7sclLbTdpJlEYzvzuGAVH7BNDn0Y8QwBQzExkS8VogR1hHsE869a1IdWOw1lDaYlcU0G4Y2jj6ycN6z0IXUzKMbVvSj5+fUKPw2XJYFX1mGqq7RdT1xg7br0A8DtNYsHMd0XtF5C1lJNG2DiH8mbGmiTHzjLu8sllWF8npj40c1bc1NL4VAXhTILgWdddxYKfVuOGkH2WoyUJCEqtE0taW1NWJc57DE2gSKJjBr4ylTx/Ah7LOyIWlZOCu3wcJYElJ+2hgWLhRlO6QLC5TfynFziRt2Q6NmCCFwznNa9QpRlrSWwO0u0fXDaigdGtlwdnVTc57DOP6doVILClFCfF9JNNEFTHQhI/1K8y6UdY/P0xmnc4Yj8cfxRJnmWF7y2w29p0y05RtNAqWe/Mgw0G+Tskq8IqzY3j9W/gF48ruTUaq/swAAAABJRU5ErkJggg=='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="features" title="" src="/static/6c5477587726f04681a4c06b263993c0/c5bb3/features.png" srcset="/static/6c5477587726f04681a4c06b263993c0/04472/features.png 170w,
/static/6c5477587726f04681a4c06b263993c0/9f933/features.png 340w,
/static/6c5477587726f04681a4c06b263993c0/c5bb3/features.png 680w,
/static/6c5477587726f04681a4c06b263993c0/b12f7/features.png 1020w,
/static/6c5477587726f04681a4c06b263993c0/b5a09/features.png 1360w,
/static/6c5477587726f04681a4c06b263993c0/29007/features.png 1600w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<p>KubeArmor leverages technologies like eBPF, AppArmor, or SELinux to enforce user-specified policies. eBPF is a kernel technology that allows users to program the Linux kernel without changing the kernel code. This makes eBPF ideal for runtime security enforcement, as it allows KubeArmor to intercept and modify system calls without impacting the performance of the workload.</p>
<p>KubeArmor uses eBPF to generate detailed alerts and telemetry events that include information about the identities of the container, pod, and namespace. This information is essential for investigating and responding to security incidents.</p>
<p>The following diagram shows the architecture of KubeArmor:</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 52.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/UlEQVR42l1STWgTaRge2y1LD3UpbbFdJKJ2L55ke9ktePMgC9uTPSh48CKIrLDrFkWE7GUFBS1WDWQvZfGwqx4KWsSfqu02m03apOk0k/82M5PJJDOTmUySmSbhm4zPztSK4gsf3/N83/s+vN/3PtRm9reHpHl7tla9Ndcxfj8titVjNUV9YCqNu7pU9dUlxRdZWvEtLyz6MjTjMxXDp0jKfVmW/ZIk3cxms3spJyYfodvdqQTjDSjyzZeieGOlUbl8hbSNSzoAprVllawKaK2EeCuFnFHGmsaDfVdAk7RsJwWEEFVRlBFXx6F7qPfhglu9zsEXLqvr2i9bjTqWxGgrrbOdqMR2YvpGJ6OLnUAh7WCmU1JlUqloULWqAvD9Ew+YIxN/MCd35CbPXf5qysfO/OR9tt/lb4L81WIHSOsgMdnGzBMe82sNLG+1EMq3sCbaWNfwLm4AMWG79ueF6wMzr8Qr15cbuLYofEONjx//+tSF6e8nz5zzuILBUO6qZjbBy2WSKwh4FUwiuJ5CJJ5GluOR4zmIimTLmgquKGqRSHpw9t78Cf/j1WnvPDvsahxw1qDHs++gS/RiagqGU7T2lrTLGQjxRUiZMKRsFPnYW2hcAvR6xGYSCUhcoiLQtPuyrrExf8/o6J0vqd7eA995PGcPDQ0NHXUu9m2r/M/bqgQ6ECZqtY7gP/8it8miWBTxZG4OqXwZfwdo+6/QFnIc57S59GEoXTt/2N9/dPzw4fNjI4Oebx06QtT8Rb1pI7BpkqfBAhYiZbxYLWHewVHWQFKoIZIt2FFWgSCwqrkr6PV6u3anTP1AUd0/9vX1TTi4p61uXiQVp6N0rFlIrlqJ6IqV2whbXCJs5RjaavC0hfwCQf41mlxYYmVz+DPb7Jpn1zZtPf+r4zDYHZOQRgl6uYBWtQjLLEOXRZgKB6tdtd0cUuNUheM+9yHlgj1+v7/HJRLLnN4uJ9ItJRPQ+Y2QIcZDtcJG6COOh4xS6r+mnI7UBeZ5Mpkc+FTwf4lCRWwcBcz7AAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="archi" title="" src="/static/9e8e2112c0eff19099c3b4a8b798fe23/c5bb3/archi.png" srcset="/static/9e8e2112c0eff19099c3b4a8b798fe23/04472/archi.png 170w,
/static/9e8e2112c0eff19099c3b4a8b798fe23/9f933/archi.png 340w,
/static/9e8e2112c0eff19099c3b4a8b798fe23/c5bb3/archi.png 680w,
/static/9e8e2112c0eff19099c3b4a8b798fe23/5a190/archi.png 800w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<p>KubeArmor and AppArmor are both security modules that can be used to restrict access to particular processes or files. However, KubeArmor is specifically designed to secure containers within Kubernetes environments.</p>
<p>Here is a recap of the key differences between KubeArmor and AppArmor:</p>
<ul>
<li><strong>Scope</strong>: KubeArmor operates at the Kubernetes cluster level, while AppArmor operates at the host level.</li>
<li><strong>Policy syntax</strong>: KubeArmor uses the universally recognized YAML syntax for policy definitions, while AppArmor uses its own profile syntax.</li>
<li><strong>Features</strong>: KubeArmor leverages Linux security modules like AppArmor to enforce policies, but it also goes beyond that by utilizing more advanced features, such as seccomp and auditd, for a more comprehensive approach to container security.</li>
<li><strong>Integration</strong>: KubeArmor is seamlessly integrated with the Kubernetes ecosystem, while AppArmor is focused on individual applications running on a Linux system.</li>
</ul>
<h3 id="-getting-started-with-kubearmor" style="position:relative;"><a href="#-getting-started-with-kubearmor" aria-label=" getting started with kubearmor permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üöÄ Getting Started with KubeArmor</h3>
<p>KubeArmor is a cloud-native runtime security enforcement system that can help you to secure your workloads. It is easy to use, scalable, and effective.</p>
<p>This guide provides instructions on how to get started with KubeArmor. It assumes that you have access to a Kubernetes cluster, but it also mentions that you can use KubeArmor in non-Kubernetes mode, such as systemd mode, to protect or audit containers or processes on VMs or bare metal.</p>
<h4 id="install-kubearmor" style="position:relative;"><a href="#install-kubearmor" aria-label="install kubearmor permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install KubeArmor</h4>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh"><span class="token function">curl</span> <span class="token parameter variable">-sfL</span> http://get.kubearmor.io/ <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-s</span> -- <span class="token parameter variable">-b</span> /usr/local/bin
karmor <span class="token function">install</span></code></pre></div>
<h4 id="deploy-test-nginx-app" style="position:relative;"><a href="#deploy-test-nginx-app" aria-label="deploy test nginx app permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deploy test nginx app</h4>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl create deployment nginx <span class="token parameter variable">--image</span><span class="token operator">=</span>nginx
<span class="token assign-left variable">POD</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>kubectl get pod <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>nginx <span class="token parameter variable">-o</span> name<span class="token variable">)</span></span></code></pre></div>
<p><code class="language-text">$POD</code> is used to refer to the target nginx pod in many cases below.</p>
<h4 id="sample-policies" style="position:relative;"><a href="#sample-policies" aria-label="sample policies permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Sample policies</h4>
<p><strong>Denying Execution of Package Management Tools:</strong></p>
<p>Package management tools, such as apt and apt-get, can be used to download new binaries to pods at runtime. This can increase the attack surface of the pods, as attackers can use package management tools to download malicious software.</p>
<p>To prevent this, you can use a KubeArmor policy to block the execution of package management tools. This is a good practice in production environments.</p>
<p>Here is an example of a KubeArmor policy to block the execution of package management tools:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">cat &lt;&lt;EOF <span class="token punctuation">|</span> kubectl apply <span class="token punctuation">-</span>f <span class="token punctuation">-</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> security.kubearmor.com/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> KubeArmorPolicy
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> block<span class="token punctuation">-</span>pkg<span class="token punctuation">-</span>mgmt<span class="token punctuation">-</span>tools<span class="token punctuation">-</span>exec
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
    <span class="token key atrule">selector</span><span class="token punctuation">:</span>
        <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
            <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">process</span><span class="token punctuation">:</span>
        <span class="token key atrule">matchPaths</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /usr/bin/apt
        <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /usr/bin/apt<span class="token punctuation">-</span>get
    <span class="token key atrule">action</span><span class="token punctuation">:</span>
        Block
EOF</code></pre></div>
<p>Now execute the apt command to download the masscan tool.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token variable">$POD</span> -- <span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">"apt update &amp;&amp; apt install masscan"</span></code></pre></div>
<p>It will be denied permission to execute.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">sh: <span class="token number">1</span>: apt: Permission denied
<span class="token builtin class-name">command</span> terminated with <span class="token builtin class-name">exit</span> code <span class="token number">126</span></code></pre></div>
<h4 id="get-policy-violations-notifications" style="position:relative;"><a href="#get-policy-violations-notifications" aria-label="get policy violations notifications permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Get policy violations notifications</h4>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">karmor logs <span class="token parameter variable">-n</span> default <span class="token parameter variable">--json</span></code></pre></div>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"Timestamp"</span><span class="token operator">:</span> <span class="token number">1686516788</span><span class="token punctuation">,</span> 
    <span class="token property">"UpdatedTime"</span><span class="token operator">:</span> <span class="token string">"2023-10-10T19:03:08Z"</span><span class="token punctuation">,</span>
    <span class="token property">"ClusterName"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
    <span class="token property">"HostName"</span><span class="token operator">:</span> <span class="token string">"ip-172-10-58-42"</span><span class="token punctuation">,</span>
    <span class="token property">"NamespaceName"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
    <span class="token property">"PodName"</span><span class="token operator">:</span> <span class="token string">"nginx-fr786gioa-9843a"</span><span class="token punctuation">,</span>
    <span class="token property">"Labels"</span><span class="token operator">:</span> <span class="token string">"app=nginx"</span><span class="token punctuation">,</span>
    <span class="token property">"ContainerID"</span><span class="token operator">:</span> <span class="token string">"9876543210abcdef1234567890abcdef"</span><span class="token punctuation">,</span> 
    <span class="token property">"ContainerName"</span><span class="token operator">:</span> <span class="token string">"nginx"</span><span class="token punctuation">,</span>
    <span class="token property">"ContainerImage"</span><span class="token operator">:</span> <span class="token string">"docker.io/library/nginx:latest@sha256:af296b188c7b7df99ba960ca614439c99cb7cf252ed7bbc23e90cfda59092305"</span><span class="token punctuation">,</span>
    <span class="token property">"HostPPID"</span><span class="token operator">:</span> <span class="token number">4741922</span><span class="token punctuation">,</span>
    <span class="token property">"HostPID"</span><span class="token operator">:</span> <span class="token number">4191928</span><span class="token punctuation">,</span>
    <span class="token property">"PPID"</span><span class="token operator">:</span> <span class="token number">677</span><span class="token punctuation">,</span>
    <span class="token property">"PID"</span><span class="token operator">:</span> <span class="token number">855</span><span class="token punctuation">,</span>
    <span class="token property">"ParentProcessName"</span><span class="token operator">:</span> <span class="token string">"/bin/dash"</span><span class="token punctuation">,</span>
    <span class="token property">"ProcessName"</span><span class="token operator">:</span> <span class="token string">"/usr/bin/apt"</span><span class="token punctuation">,</span>
    <span class="token property">"PolicyName"</span><span class="token operator">:</span> <span class="token string">"block-pkg-mgmt-tools-exec"</span><span class="token punctuation">,</span>
    <span class="token property">"Severity"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
    <span class="token property">"Type"</span><span class="token operator">:</span> <span class="token string">"MatchedPolicy"</span><span class="token punctuation">,</span>
    <span class="token property">"Source"</span><span class="token operator">:</span> <span class="token string">"/bin/dash"</span><span class="token punctuation">,</span>
    <span class="token property">"Operation"</span><span class="token operator">:</span> <span class="token string">"Process"</span><span class="token punctuation">,</span>
    <span class="token property">"Resource"</span><span class="token operator">:</span> <span class="token string">"/usr/bin/apt update"</span><span class="token punctuation">,</span>
    <span class="token property">"Data"</span><span class="token operator">:</span> <span class="token string">"syscall=SYS_EXECVE"</span><span class="token punctuation">,</span>
    <span class="token property">"Enforcer"</span><span class="token operator">:</span> <span class="token string">"BPFLSM"</span><span class="token punctuation">,</span>
    <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token string">"Block"</span><span class="token punctuation">,</span>
    <span class="token property">"Result"</span><span class="token operator">:</span> <span class="token string">"Permission denied"</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>Deny Access to Service Account Tokens:</strong></p>
<p>Kubernetes mounts a service account token in each pod by default, even if the app does not need it. Attackers can exploit these service account tokens to move laterally across a cluster.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token variable">$POD</span> -- <span class="token function">bash</span></code></pre></div>
<p>(inside pod)</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh"><span class="token function">curl</span> https://<span class="token variable">$KUBERNETES_PORT_443_TCP_ADDR</span>/api <span class="token parameter variable">--insecure</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /run/secrets/kubernetes.io/serviceaccount/token<span class="token variable">)</span></span>"</span></code></pre></div>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>                                
    <span class="token property">"kind"</span><span class="token operator">:</span> <span class="token string">"APIVersions"</span><span class="token punctuation">,</span>      
    <span class="token property">"versions"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                 
        <span class="token string">"v1"</span>                      
    <span class="token punctuation">]</span><span class="token punctuation">,</span>                          
    <span class="token property">"serverAddressByClientCIDRs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"clientCIDR"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0/0"</span><span class="token punctuation">,</span>
            <span class="token property">"serverAddress"</span><span class="token operator">:</span> <span class="token string">"ip-10-0-48-51.eu-west-1.compute.internal:443"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Thus we can see that one can use the service account token to access the Kube API server.</p>
<p>Let's apply a policy to block access to service account token:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
    name: block-service-access-token-access
spec:
    selector:
        matchLabels:
            app: nginx
    file:
        matchDirectories:
        - dir: /run/secrets/kubernetes.io/serviceaccount/
            recursive: true
    action:
        Block
EOF</span></code></pre></div>
<p>Now when anyone tries to access to service account token, it would be Permission Denied.</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">‚ùØ kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token variable">$POD</span> -- <span class="token function">bash</span>

<span class="token punctuation">(</span>inside pod<span class="token punctuation">)</span> $ <span class="token function">curl</span> https://<span class="token variable">$KUBERNETES_PORT_443_TCP_ADDR</span>/api <span class="token parameter variable">--insecure</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /run/secrets/kubernetes.io/serviceaccount/token<span class="token variable">)</span></span>"</span></code></pre></div>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">cat: /run/secrets/kubernetes.io/serviceaccount/token: Permission denied
<span class="token punctuation">{</span>
    <span class="token string">"kind"</span><span class="token builtin class-name">:</span> <span class="token string">"Status"</span>,
    <span class="token string">"apiVersion"</span><span class="token builtin class-name">:</span> <span class="token string">"v1"</span>,
    <span class="token string">"metadata"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
    <span class="token string">"status"</span><span class="token builtin class-name">:</span> <span class="token string">"Failure"</span>,
    <span class="token string">"message"</span><span class="token builtin class-name">:</span> <span class="token string">"forbidden: User <span class="token entity" title="\&quot;">\"</span>system:anonymous<span class="token entity" title="\&quot;">\"</span> cannot get path <span class="token entity" title="\&quot;">\"</span>/api<span class="token entity" title="\&quot;">\"</span>"</span>,
    <span class="token string">"reason"</span><span class="token builtin class-name">:</span> <span class="token string">"Forbidden"</span>,
    <span class="token string">"details"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
    <span class="token string">"code"</span><span class="token builtin class-name">:</span> <span class="token number">403</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>Auditing Access to Folders/Paths:</strong></p>
<p>KubeArmor can be used to audit access to specific folders or paths. This can be useful for compliance or reporting reasons.</p>
<p>For instance, to audit access to the <code class="language-text">/etc/nginx/</code> folder within a deployment, you can create the following KubeArmor policy:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
    name: audit-etc-nginx-access
spec:
    selector:
        matchLabels:
            app: nginx
    file:
        matchDirectories:
        - dir: /etc/nginx/
            recursive: true  
    action:
        Audit
EOF</span></code></pre></div>
<p>Note: <code class="language-text">karmor logs -n default</code> would show all the audit/block operations.</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"Timestamp"</span><span class="token operator">:</span> <span class="token number">1686516788</span><span class="token punctuation">,</span> 
    <span class="token property">"UpdatedTime"</span><span class="token operator">:</span> <span class="token string">"2023-10-10T19:03:08Z"</span><span class="token punctuation">,</span>
    <span class="token property">"ClusterName"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
    <span class="token property">"HostName"</span><span class="token operator">:</span> <span class="token string">"ip-172-10-58-42"</span><span class="token punctuation">,</span>
    <span class="token property">"NamespaceName"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
    <span class="token property">"PodName"</span><span class="token operator">:</span> <span class="token string">"nginx-fr786gioa-9843a"</span><span class="token punctuation">,</span>
    <span class="token property">"Labels"</span><span class="token operator">:</span> <span class="token string">"app=nginx"</span><span class="token punctuation">,</span>
    <span class="token property">"ContainerID"</span><span class="token operator">:</span> <span class="token string">"9876543210abcdef1234567890abcdef"</span><span class="token punctuation">,</span> 
    <span class="token property">"ContainerName"</span><span class="token operator">:</span> <span class="token string">"nginx"</span><span class="token punctuation">,</span>
    <span class="token property">"ContainerImage"</span><span class="token operator">:</span> <span class="token string">"docker.io/library/nginx:latest@sha256:af296b188c7b7df99ba960ca614439c99cb7cf252ed7bbc23e90cfda59092305"</span><span class="token punctuation">,</span>
    <span class="token property">"HostPPID"</span><span class="token operator">:</span> <span class="token number">4741922</span><span class="token punctuation">,</span>
    <span class="token property">"HostPID"</span><span class="token operator">:</span> <span class="token number">4191928</span><span class="token punctuation">,</span>
    <span class="token property">"PPID"</span><span class="token operator">:</span> <span class="token number">677</span><span class="token punctuation">,</span>
    <span class="token property">"PID"</span><span class="token operator">:</span> <span class="token number">855</span><span class="token punctuation">,</span>
    <span class="token property">"ParentProcessName"</span><span class="token operator">:</span> <span class="token string">"/x86_64-bottlerocket-linux-gnu/sys-root/usr/bin/containerd-shim-runc-v2"</span><span class="token punctuation">,</span>
    <span class="token property">"ProcessName"</span><span class="token operator">:</span> <span class="token string">"/bin/cat"</span><span class="token punctuation">,</span>
    <span class="token property">"PolicyName"</span><span class="token operator">:</span> <span class="token string">"audit-etc-nginx-access"</span><span class="token punctuation">,</span>
    <span class="token property">"Severity"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
    <span class="token property">"Type"</span><span class="token operator">:</span> <span class="token string">"MatchedPolicy"</span><span class="token punctuation">,</span>
    <span class="token property">"Source"</span><span class="token operator">:</span> <span class="token string">"/bin/cat /etc/nginx/conf.d/default.conf"</span><span class="token punctuation">,</span>
    <span class="token property">"Operation"</span><span class="token operator">:</span> <span class="token string">"File"</span><span class="token punctuation">,</span>
    <span class="token property">"Resource"</span><span class="token operator">:</span> <span class="token string">"/etc/nginx/conf.d/default.conf"</span><span class="token punctuation">,</span>
    <span class="token property">"Data"</span><span class="token operator">:</span> <span class="token string">"syscall=SYS_OPENAT fd=-100 flags=O_RDONLY"</span><span class="token punctuation">,</span>
    <span class="token property">"Enforcer"</span><span class="token operator">:</span> <span class="token string">"eBPF Monitor"</span><span class="token punctuation">,</span>
    <span class="token property">"Action"</span><span class="token operator">:</span> <span class="token string">"Audit"</span><span class="token punctuation">,</span>
    <span class="token property">"Result"</span><span class="token operator">:</span> <span class="token string">"Passed"</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>Zero Trust Least Permissive Policy: Allow Only Nginx to Execute in the Pod, Deny Rest:</strong></p>
<p>A least permissive policy requires you to explicitly allow certain actions or operations and deny the rest. With KubeArmor, you can specify which actions to allow and deny or audit in the policy.</p>
<p>The security posture defines what happens to operations that are not in the allowed list. Should they be audited (allowed but alerted) or denied (blocked and alerted)?</p>
<p>By default, the security posture is set to audit. To change the security posture to default deny, run the following command:</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl annotate ns default kubearmor-file-posture<span class="token operator">=</span>block <span class="token parameter variable">--overwrite</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
    name: only-allow-nginx-exec
spec:
    selector:
        matchLabels:
            app: nginx
    file:
        matchDirectories:
        - dir: /
            recursive: true  
    process:
        matchPaths:
        - path: /usr/sbin/nginx
        - path: /bin/bash
    action:
        Allow
EOF</span></code></pre></div>
<p>Observe that the policy contains Allow action. Once there is any KubeArmor policy having Allow action then the pods enter least permissive mode, allowing only explicitly allowed operations.</p>
<p>Note: Use <code class="language-text">kubectl port-forward $POD --address 0.0.0.0 8080:80</code> to access nginx and you can see that the nginx web access still works normally.</p>
<p>Let's try to execute some other processes:</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token variable">$POD</span> -- <span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">"chroot"</span></code></pre></div>
<p>Any binary other than bash and nginx would be permission denied.</p>
<h3 id="Ô∏è-kubearmor-support-matrix" style="position:relative;"><a href="#%EF%B8%8F-kubearmor-support-matrix" aria-label="Ô∏è kubearmor support matrix permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üõ°Ô∏è KubeArmor Support Matrix</h3>
<p>KubeArmor supports the following types of workloads:</p>
<ul>
<li><strong>K8s orchestrated</strong>: Workloads deployed as k8s orchestrated containers. In this case, Kubearmor is deployed as a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/" target="_blank" rel="noopener noreferrer">k8s daemonset</a>. Note, KubeArmor supports policy enforcement on both k8s-pods (<a href="https://github.com/kubearmor/KubeArmor/blob/main/getting-started/security_policy_specification.md" target="_blank" rel="noopener noreferrer">KubeArmorPolicy</a>) as well as k8s-nodes (KubeArmorHostPolicy).</li>
<li><strong>Containerized</strong>: Workloads that are containerized but not k8s orchestrated are supported. KubeArmor installed in <a href="https://github.com/kubearmor/KubeArmor/blob/main/getting-started/kubearmor_vm.md" target="_blank" rel="noopener noreferrer">systemd mode</a> can be used to protect such workloads.</li>
<li><strong>VM/Bare-Metals</strong>: Workloads deployed on Virtual Machines or Bare Metal i.e. workloads directly operating as host/system processes. In this case, Kubearmor is deployed in <a href="https://github.com/kubearmor/KubeArmor/blob/main/getting-started/kubearmor_vm.md" target="_blank" rel="noopener noreferrer">systemd mode</a>.</li>
</ul>
<h3 id="-hardening-infrastructure-with-kubearmor" style="position:relative;"><a href="#-hardening-infrastructure-with-kubearmor" aria-label=" hardening infrastructure with kubearmor permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üîí Hardening Infrastructure with KubeArmor</h3>
<p>KubeArmor is a security solution that can help you harden your Kubernetes and cloud-native infrastructure. It provides a set of out-of-the-box hardening policies that are based on industry-leading compliance and attack frameworks, such as CIS, MITRE, NIST-800‚Äì53, and STIGs. These policies can help you secure your workloads in a way that is compliant with these frameworks and recommended best practices.</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 63.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACx0lEQVR42mM4ceIE38uXzza/ev3q8oe3L8+8efP63ONH98+cv3Tj6oZDL9bur7dnYSAF/P9/RWjP2Y/329f8/n/1wbe/379//9++8v3flYd//n/68vON+tBQNqhSRiINPCZ09OLre5ULv/2fs/3tn6+f3v9rXPzmD4j/4PGb6//PpLGSZuCHR0J3H724t2Lv4//X7r3++/L1m/8Pnr79e+3ht/9v3r65kZZGqoH/PwhuPXbrctX0wz8Onrr9YdOBa58v37j38fL1O3/uPnh07szMmaQZqKWlxbZjx3rZm5dOKd26dUJm27q9ym8e3ZR+cvu27KVLl8RBakJDVzFraYWygdRC6FA2Y+M01lCGUOZ6BgYmsBogGyQGYgsBsQQQi/tbaRmoqdmLoFsKVMgvLq4nJiqvJSEuriQmzi0uJqjtJsvinG3J6ZZjxu5b7sRlG22kK6crCNZQXw+x5Wx3QtCqkiwJRHD8Z/z/n4Gx3n4/C0P9TC6GsBp9Bpc0fpAcW9I0dcHEyZOFEydn8yVPreZNm+ELMez/f7Bh+z/899j16lPX1kdvW/a9+9y9/eXXIFC4AV3GraWVxQM0nZFBRoYzlIGBGaR+p6ul2F5XM6cdnqY++zyNrXe4mciCDdy/fz844R77+rf39J+///e9fffzPNBph779n7I219difnWuB0ieK++wMUPpRWeGjnvuDO0PBeMZGDhc9fS4t6mosMeIi3NbgCwDhjU8nDZc/8975P9/qZP//0sc+/9fGuhyrtvzimSPzqmWB0exy5QFDJ7TrjIEzLvNELzMECgky8zM78LAwKrDIGQvw6AWqmhsbMxKRDqoBwcJg16BL4Nu9jQG7exqBq16aERyWANpDQY5ZyUG5XBZe3vC2RSc9goLezn/19cz8ZgW28lalUqBIis0tJczN3ci+8yZZ1hDQws5QTg+fj4HACEbNVS59bUfAAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="hardening" title="" src="/static/d5224c2e59a77437a17379d5b3442de9/c5bb3/Hardening.png" srcset="/static/d5224c2e59a77437a17379d5b3442de9/04472/Hardening.png 170w,
/static/d5224c2e59a77437a17379d5b3442de9/9f933/Hardening.png 340w,
/static/d5224c2e59a77437a17379d5b3442de9/c5bb3/Hardening.png 680w,
/static/d5224c2e59a77437a17379d5b3442de9/b12f7/Hardening.png 1020w,
/static/d5224c2e59a77437a17379d5b3442de9/b5a09/Hardening.png 1360w,
/static/d5224c2e59a77437a17379d5b3442de9/ce0a7/Hardening.png 1590w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<p>One of the key benefits of KubeArmor is that it makes it easy to apply hardening policies to your workloads. You don't have to spend time researching and configuring the policies yourself; simply apply them to your workloads and start benefiting from the added security that they provide.</p>
<p>KubeArmor also presents hardening policies in the context of your workloads, so you can see how they will be applied and what impact they will have on your system. This allows you to make informed decisions about which policies to apply and to understand the trade-offs between security and functionality.</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 2.3529411764705883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAU0lEQVR42h3MzQpAQBRAYe//GvIIylqslLIY2ZgNIj+xYsydOrr25ztRdwTMJjSrUC9CNXvKyWOvQGxuMuvIh5di9KS9I2kf+jP8jbZq1Jpd0NcHislJHs+u0V8AAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="line" title="" src="/static/6db4b9b93a39c786f7252c04d4769030/c5bb3/line.png" srcset="/static/6db4b9b93a39c786f7252c04d4769030/04472/line.png 170w,
/static/6db4b9b93a39c786f7252c04d4769030/9f933/line.png 340w,
/static/6db4b9b93a39c786f7252c04d4769030/c5bb3/line.png 680w,
/static/6db4b9b93a39c786f7252c04d4769030/c54b3/line.png 727w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<h2 id="-takeaways" style="position:relative;"><a href="#-takeaways" aria-label=" takeaways permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üìù Takeaways</h2>
<ul>
<li>KubeArmor is a powerful and flexible Kubernetes security tool that provides granular control over container behavior.</li>
<li>It offers a wide range of pre-configured policies and supports custom policies, making it easy for organizations to comply with regulatory standards and protect against security threats.</li>
<li>KubeArmor is a valuable tool for safeguarding containerized environments within Kubernetes and preventing the exploitation of vulnerabilities.</li>
</ul>
<br>
<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>
<blockquote>
<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>
</blockquote>
<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>
<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href="https://www.linkedin.com/in/rajhi-saif/" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/in/rajhi-saif/</a></p>
<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href="https://x.com/rajhisaifeddine" target="_blank" rel="noopener noreferrer">https://x.com/rajhisaifeddine</a></p>
<p><strong>The end ‚úåüèª</strong></p>
<h1 align="center">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>
<p><strong>üìÖ Stay updated</strong></p>
<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p></div></div><div id="content-end"></div></article><div data-nosnippet="" class="social-share-wrapper"><h3>Share Your Love</h3><button keywords="" aria-label="Share Via Facebook" class="react-share__ShareButton social-share-item facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" class="svg-inline--fa fa-facebook " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"></path></svg></button><button keywords="" aria-label="Share Via Twitter" class="react-share__ShareButton social-share-item twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></button><button aria-label="Share Via LinkedIn" keywords="" class="react-share__ShareButton social-share-item linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></button><button keywords="" aria-label="Share Via Reddit" class="react-share__ShareButton social-share-item reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" class="svg-inline--fa fa-reddit " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 256C0 114.6 114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256L37.1 512c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256zM349.6 153.6c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34c-34.5 3.7-61.4 33-61.4 68.4l0 .2c-37.5 1.6-71.8 12.3-99 29.1c-10.1-7.8-22.8-12.5-36.5-12.5c-33 0-59.8 26.8-59.8 59.8c0 24 14.1 44.6 34.4 54.1c2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54c0-33-26.8-59.8-59.8-59.8c-13.7 0-26.3 4.6-36.4 12.4c-27.4-17-62.1-27.7-100-29.1l0-.2c0-25.4 18.9-46.5 43.4-49.9l0 0c4.4 18.8 21.3 32.8 41.5 32.8zM177.1 246.9c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6s-31.4-8.8-30.4-30.5s15.4-38.3 32.1-38.3zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6c-1-21.7 11.8-39.3 28.5-39.3s31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9 .8-6.2 3.9-6.5c18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1 .3 5.1 3.6 3.9 6.5z"></path></svg></button><button keywords="" aria-label="Add to Pocket" class="react-share__ShareButton social-share-item pocket" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="get-pocket" class="svg-inline--fa fa-get-pocket " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg></button></div><br/><br/><br/></main><aside class="blogpost-sidebar"><div data-nosnippet="" class="blog-navigation-wrapper"><h3>Read Other Posts</h3><nav class="blog-navigation"><div class="nav-links"><a rel="next" class="next-post" href="/blog/managing-deprecated-k8s-apis/">Managing Deprecated Kubernetes APIs: Best Practices and Tools¬†‚ò∏Ô∏è<!-- --> ‚Üí</a><a rel="prev" class="prev-post" href="/blog/data-on-kubernetes-strimzi-kafka-6/">‚Üê <!-- -->Data on Kubernetes: Part 6- Strimzi for running Apache Kafka</a><a class="all-posts" href="/blog/">All Posts</a></div></nav></div></aside><footer data-nosnippet=""><div class="footer-wrapper"><div data-nosnippet="" class="social"><ul class="social-list"><li class="social-item social-linkedin"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="linkedin" href="https://www.linkedin.com/in/rajhi-saif/" title="Saifeddine Rajhi on LinkedIn" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg><span>LinkedIn</span></a></li><li class="social-item social-github"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="github" href="https://github.com/seifrajhi" title="Saifeddine Rajhi on Github" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span>GitHub</span></a></li><li class="social-item social-email"><a itemProp="email" eventCategory="social" eventAction="click" eventLabel="email" href="mailto:rajhiseif@gmail.com" title="Saifeddine Rajhi&#x27;s Email"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg><span>Email</span></a></li><li class="social-item social-bluesky"><a rel="me" itemProp="url" eventCategory="bluesky" eventAction="click" eventLabel="social" href="https://bsky.app/profile/saifrajhi.bsky.social" title="Saifeddine Rajhi on Bluesky Social" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="bluesky" class="svg-inline--fa fa-bluesky fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2c42.1-31.6 110.3-56 110.3 21.8c0 15.5-8.9 130.5-14.1 149.2C478.2 298 412 314.6 353.1 304.5c102.9 17.5 129.1 75.5 72.5 133.5c-107.4 110.2-154.3-27.6-166.3-62.9l0 0c-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8l0 0c-12 35.3-59 173.1-166.3 62.9c-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1C10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"></path></svg><span>Bluesky Social</span></a></li><li class="social-item social-X/Twitter"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="X/Twitter" href="https://x.com/RajhiSaifeddine" title="Saifeddine Rajhi on X/Twitter" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg><span>X/Twitter</span></a></li><li class="social-item social-reddit"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="reddit" href="https://www.reddit.com/user/ScoreApprehensive992/" title="Saifeddine Rajhi on Reddit" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit-alien" class="svg-inline--fa fa-reddit-alien fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M373 138.6c-25.2 0-46.3-17.5-51.9-41l0 0c-30.6 4.3-54.2 30.7-54.2 62.4l0 .2c47.4 1.8 90.6 15.1 124.9 36.3c12.6-9.7 28.4-15.5 45.5-15.5c41.3 0 74.7 33.4 74.7 74.7c0 29.8-17.4 55.5-42.7 67.5c-2.4 86.8-97 156.6-213.2 156.6S45.5 410.1 43 323.4C17.6 311.5 0 285.7 0 255.7c0-41.3 33.4-74.7 74.7-74.7c17.2 0 33 5.8 45.7 15.6c34-21.1 76.8-34.4 123.7-36.4l0-.3c0-44.3 33.7-80.9 76.8-85.5C325.8 50.2 347.2 32 373 32c29.4 0 53.3 23.9 53.3 53.3s-23.9 53.3-53.3 53.3zM157.5 255.3c-20.9 0-38.9 20.8-40.2 47.9s17.1 38.1 38 38.1s36.6-9.8 37.8-36.9s-14.7-49.1-35.7-49.1zM395 303.1c-1.2-27.1-19.2-47.9-40.2-47.9s-36.9 22-35.7 49.1c1.2 27.1 16.9 36.9 37.8 36.9s39.3-11 38-38.1zm-60.1 70.8c1.5-3.6-1-7.7-4.9-8.1c-23-2.3-47.9-3.6-73.8-3.6s-50.8 1.3-73.8 3.6c-3.9 .4-6.4 4.5-4.9 8.1c12.9 30.8 43.3 52.4 78.7 52.4s65.8-21.6 78.7-52.4z"></path></svg><span>Reddit</span></a></li><li class="social-item social-stackoverflow"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://stackoverflow.com/users/21897244/saifeddine-rajhi" title="Saifeddine Rajhi on StackOverflow" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="stack-overflow" class="svg-inline--fa fa-stack-overflow fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg><span>StackOverflow</span></a></li><li class="social-item social-Goodreads"><a rel="me" eventLabel="StackOverflow" href="https://www.goodreads.com/user/show/176103378-saifeddine" title="Saifeddine Rajhi on Goodreads" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="goodreads" class="svg-inline--fa fa-goodreads fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M299.9 191.2c5.1 37.3-4.7 79-35.9 100.7-22.3 15.5-52.8 14.1-70.8 5.7-37.1-17.3-49.5-58.6-46.8-97.2 4.3-60.9 40.9-87.9 75.3-87.5 46.9-.2 71.8 31.8 78.2 78.3zM448 88v336c0 30.9-25.1 56-56 56H56c-30.9 0-56-25.1-56-56V88c0-30.9 25.1-56 56-56h336c30.9 0 56 25.1 56 56zM330 313.2s-.1-34-.1-217.3h-29v40.3c-.8.3-1.2-.5-1.6-1.2-9.6-20.7-35.9-46.3-76-46-51.9.4-87.2 31.2-100.6 77.8-4.3 14.9-5.8 30.1-5.5 45.6 1.7 77.9 45.1 117.8 112.4 115.2 28.9-1.1 54.5-17 69-45.2.5-1 1.1-1.9 1.7-2.9.2.1.4.1.6.2.3 3.8.2 30.7.1 34.5-.2 14.8-2 29.5-7.2 43.5-7.8 21-22.3 34.7-44.5 39.5-17.8 3.9-35.6 3.8-53.2-1.2-21.5-6.1-36.5-19-41.1-41.8-.3-1.6-1.3-1.3-2.3-1.3h-26.8c.8 10.6 3.2 20.3 8.5 29.2 24.2 40.5 82.7 48.5 128.2 37.4 49.9-12.3 67.3-54.9 67.4-106.3z"></path></svg><span>Goodreads</span></a></li><li class="social-item social-osi"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://ossinsight.io/analyze/seifrajhi" title="Saifeddine Rajhi on OSSInsights" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="osi" class="svg-inline--fa fa-osi fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M8 266.44C10.3 130.64 105.4 34 221.8 18.34c138.8-18.6 255.6 75.8 278 201.1 21.3 118.8-44 230-151.6 274-9.3 3.8-14.4 1.7-18-7.7q-26.7-69.45-53.4-139c-3.1-8.1-1-13.2 7-16.8 24.2-11 39.3-29.4 43.3-55.8a71.47 71.47 0 0 0-64.5-82.2c-39-3.4-71.8 23.7-77.5 59.7-5.2 33 11.1 63.7 41.9 77.7 9.6 4.4 11.5 8.6 7.8 18.4q-26.85 69.9-53.7 139.9c-2.6 6.9-8.3 9.3-15.5 6.5-52.6-20.3-101.4-61-130.8-119-24.9-49.2-25.2-87.7-26.8-108.7zm20.9-1.9c.4 6.6.6 14.3 1.3 22.1 6.3 71.9 49.6 143.5 131 183.1 3.2 1.5 4.4.8 5.6-2.3q22.35-58.65 45-117.3c1.3-3.3.6-4.8-2.4-6.7-31.6-19.9-47.3-48.5-45.6-86 1-21.6 9.3-40.5 23.8-56.3 30-32.7 77-39.8 115.5-17.6a91.64 91.64 0 0 1 45.2 90.4c-3.6 30.6-19.3 53.9-45.7 69.8-2.7 1.6-3.5 2.9-2.3 6q22.8 58.8 45.2 117.7c1.2 3.1 2.4 3.8 5.6 2.3 35.5-16.6 65.2-40.3 88.1-72 34.8-48.2 49.1-101.9 42.3-161-13.7-117.5-119.4-214.8-255.5-198-106.1 13-195.3 102.5-197.1 225.8z"></path></svg><span>OSSInsights</span></a></li><li class="social-item social-devstats"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://devstats.cluster.fun/?user=seifrajhi" title="Saifeddine Rajhi on DevStats" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chart-line" class="svg-inline--fa fa-chart-line fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64L0 400c0 44.2 35.8 80 80 80l400 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 416c-8.8 0-16-7.2-16-16L64 64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"></path></svg><span>DevStats</span></a></li><li class="social-item social-RSS"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="RSS" href="https://seifrajhi.github.io/rss.xml" title="Subscribe to my blog post" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg><span>RSS</span></a></li></ul></div><div class="copyright">Saifeddine Rajhi ¬© 1994 - <!-- -->2024<!-- --> <br/><a rel="license" href="https://creativecommons.org/licenses/by/4.0/" title="Content is published under CC BY 4.0 license">CC BY 4.0</a></div><div class="pgp"><a href="https://keybase.io/saifrajhi">0C3B BABB 8BC1 EA2B</a></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/kubearmor-k8s-runtime-security/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-a5a85b91af04696ccdc4.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-88fb5c28d68e831e730a.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-83bdb4e48c18bf191297.js\"],\"component---src-pages-blog-js\":[\"/component---src-pages-blog-js-ecde77d98197d52cb813.js\"],\"component---src-pages-cv-platform-engineer-js\":[\"/component---src-pages-cv-platform-engineer-js-b123892ec44b2247c14c.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-ea9268b02241eb42b7ab.js\"],\"component---src-pages-talks-js\":[\"/component---src-pages-talks-js-be8ac3db9e3c2f2f5cd6.js\"],\"component---src-pages-thoughts-js\":[\"/component---src-pages-thoughts-js-54f56c1476e2dcbf7fc4.js\"],\"component---src-templates-blog-template-js\":[\"/component---src-templates-blog-template-js-36418f189bad33f744db.js\"],\"component---src-templates-talk-template-js\":[\"/component---src-templates-talk-template-js-7623845caf43043e0341.js\"],\"component---src-templates-thought-template-js\":[\"/component---src-templates-thought-template-js-4e873e19a182fe3c30b3.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="6740a3edb303f203b08f";</script><script src="/webpack-runtime-80ade5d9bbec0331f109.js" async></script><script src="/framework-c989293af61a95023f7f.js" async></script><script src="/app-a5a85b91af04696ccdc4.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>