<!DOCTYPE html><html lang="en" class="blogpost-view-page"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="description" property="og:description" content="Discover how Carvel kapp simplifies Kubernetes application management, giving you control over your Kubernetes resources."/><meta data-react-helmet="true" name="keywords" content="Kubernetes,Carvel,kapp,Platform engineering"/><meta data-react-helmet="true" name="author" content="@RajhiSaifeddine"/><meta data-react-helmet="true" property="og:title" content="Simplify Kubernetes Application Management with Carvel kapp - Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@RajhiSaifeddine"/><meta data-react-helmet="true" name="twitter:title" content="Simplify Kubernetes Application Management with Carvel kapp - Blog"/><meta data-react-helmet="true" name="twitter:description" content="Discover how Carvel kapp simplifies Kubernetes application management, giving you control over your Kubernetes resources."/><meta data-react-helmet="true" name="image" property="og:image" content="https://seifrajhi.github.io/static/c2d1a71e3412fe9cb8ae584b2dd9cf63/38fe1/carvel-cover.png"/><meta data-react-helmet="true" name="twitter:image" content="https://seifrajhi.github.io/static/c2d1a71e3412fe9cb8ae584b2dd9cf63/38fe1/carvel-cover.png"/><meta data-react-helmet="true" property="og:url" content="https://seifrajhi.github.io/blog/carvel-kapp-kubernetes-management/"/><meta name="theme-color" content="#ffffff"/><link rel="stylesheet" href="/styles.f2578406544ee58a43e3.css"/><link rel="stylesheet"/><link rel="alternate" type="application/rss+xml" title="Saifeddine Rajhi&#x27;s Blog RSS Feed" href="/rss.xml"/><title data-react-helmet="true">Simplify Kubernetes Application Management with Carvel kapp - Blog by Saifeddine Rajhi</title><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":"/static/3afa5d844f90e8fbfb49d3a8845f4ac3/1cbbd/dok4.png","headline":"Data on Kubernetes: Part 4‚Ää-‚ÄäArgo Workflows: Simplify parallel jobs","dateCreated":"2024-10-25","datePublished":"2024-10-25","dateModified":"2024-10-25","inLanguage":"en-US","isFamilyFriendly":true,"isAccessibleForFree":true,"author":{"@type":"Person","name":"Saifeddine Rajhi","url":"https://seifrajhi.github.io"},"publisher":{"@type":"Organization","name":"Saifeddine Rajhi's Website"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seifrajhi.github.io/blog/data-on-kubernetes-argo-workflows-4/"},"keywords":["Kubernetes","Argo Workflows","Workflow Automation","Parallel Jobs","Container-native"],"genre":["Platform engineer","software engineering","science","deep learning","statistics"],"articleSection":"Technical Blog","articleBody":"\n> **Container-native workflow engine for Kubernetes üîÆ**\n\n## üêô Introduction\n\nWelcome to the fourth part of the \"Data on Kubernetes\" series!\n\nIn this part, we'll explore [Argo Workflows](https://argo-workflows.readthedocs.io/en/latest/)‚Ää-‚Ääan open-source, container-native workflow engine designed specifically for orchestrating parallel jobs on Kubernetes.\n\nArgo Workflows seamlessly integrates with Kubernetes services like volumes, secrets, and RBAC, making it a powerful tool for managing complex data workflows.\n\n## Introduction to Argo Workflows\n\nIn our [previous blog post](https://seifrajhi.github.io/blog/data-on-kubernetes-airflow-on-aws-3/), we explored the world of workflow orchestrators, with a specific focus on Apache Airflow.\n\nNow, let's check another tool: Argo Workflows.\n\nAs an open-source, container-native workflow engine, Argo Workflows is purpose-built for orchestrating parallel jobs within Kubernetes environments.\n\nLet's take a closer look at why Argo Workflows stands out:\n\n### 1. What is Argo Workflows? ü§î\n\nArgo Workflows empowers you to define workflows where each step corresponds to a container. This flexibility allows for the creation of complex data processing pipelines. Think of it as assembling a series of building blocks, where each block represents a specific task or operation.\n\nAdditionally, Argo Workflows is implemented as a Kubernetes Custom Resource Definition (CRD), seamlessly integrating into the Kubernetes ecosystem without disrupting the existing setup.\n\n### 2. Main Features and Benefits\n\n**Container-Native Approach:**\n\nArgo Workflows fully embraces the containerization paradigm. Each step in your workflow runs within its own container, ensuring consistency and compatibility across different tasks. Whether you're dealing with data transformations, model training, or any other computational task, Argo Workflows has you covered.\n\n**DAG Modeling (Directed Acyclic Graphs):**\n\nImagine your workflow as a flowchart with interconnected boxes. Argo Workflows allows you to model multi-step workflows using [directed acyclic graphs (DAGs)](https://en.wikipedia.org/wiki/Directed_acyclic_graph). These graphs capture dependencies between tasks, ensuring that steps execute in the correct order. It's like choreographing a dance where each move follows a logical sequence.\n\n**Efficient Compute Handling:**\n\nArgo Workflows shines when it comes to compute-intensive workloads. Whether you're crunching numbers, analyzing data, or training machine learning models, Argo efficiently manages the computational resources needed for each step.\n\n### 3. Integration with the Kubernetes Ecosystem\n\nArgo Workflows seamlessly integrates with other Kubernetes services:\n\n- **Volumes:** Need to read or write data? Argo Workflows plays well with [Kubernetes volumes](https://kubernetes.io/docs/concepts/storage/volumes/), allowing you to handle data storage efficiently.\n- **Secrets:** Security matters! Argo Workflows integrates with [Kubernetes secrets](https://kubernetes.io/docs/concepts/configuration/secret/), ensuring that sensitive information remains protected.\n- **RBAC (Role-Based Access Control):** Argo Workflows respects your access policies. It works harmoniously with [Kubernetes RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/), allowing you to control who can orchestrate workflows and who can't.\n\n### 4. Why Choose Argo Workflows\n\nArgo Workflows stands out for several reasons:\n\n- **Kubernetes Integration:** Argo Workflows seamlessly integrates with Kubernetes, simplifying usage and deployment.\n- **Scalability and Complexity Handling:** It efficiently manages complex workflows, even those with thousands of steps.\n- **Flexible Workflow Patterns:** Argo supports various workflow structures, adapting to your needs.\n- **Active Open Source Community:** Benefit from a thriving community that actively contributes to Argo's development.\n\n##  Exploring Argo Workflows on Amazon EKS\n\nIn this section, we'll dive into creating and deploying a data processing platform on [Amazon Elastic Kubernetes Service (Amazon EKS)](https://aws.amazon.com/eks/).\n\nThe solution includes essential Kubernetes add-ons: [Argo Workflows](https://argo-workflows.readthedocs.io/en/latest/), [Argo Events](https://argoproj.github.io/argo-events/), [Spark Operator](https://github.com/kubeflow/spark-operator) for managing Spark jobs, [Fluent Bit](https://fluentbit.io/) for logging, and [Prometheus](https://prometheus.io/) for metrics.\n\n### üõ†Ô∏è Setup Overview\n\n**Cluster Setup:** We'll set up an Amazon EKS cluster with a managed node group. We'll install Argo Workflows and Argo Events in their own dedicated namespaces (`argo-workflows` and `argo-events`).\n\n**Event-Driven Workflow:** An [Amazon SQS queue](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/welcome.html) will receive user requests. In the Argo Events namespace, an SQS event source object will fetch messages from this external queue. When a new message arrives, a sensor in Argo Workflow will trigger the specified workflow.\n\n**Spark Job Execution:** The triggered workflow will create a Spark application using Spark Operator in the `data-ops` namespace. This application consists of one Spark driver pod and two executor pods.\n\nThe diagram illustrates how Argo Events sources drive the execution of Spark jobs.\n\n![diagram](./diagram.png)\n\n> **Prerequisites:** Ensure you have [AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html), [kubectl](https://kubernetes.io/docs/tasks/tools/), [Terraform](https://learn.hashicorp.com/tutorials/terraform/install-cli), and [Argo Workflow CLI](https://github.com/argoproj/argo-workflows/releases/latest) installed.\n\nThe diagram below shows the detailed technical design that will be set up in this demo:\n\n![setup](./setup.png)\n\n### üöÄ Implementation Steps\n\n1. **Clone the Repository:**\n\n    ```shell\n    git clone https://github.com/awslabs/data-on-eks.git\n    cd data-on-eks/schedulers/terraform/argo-workflow\n    ```\n\n2. **Initialize and Apply Terraform:**\n\n    ```shell\n    terraform init\n    terraform apply -var region=eu-west-1 --auto-approve\n    ```\n\n    This will create:\n    - **EKS and Networking Infrastructure:**\n        - VPC with Private and Public Subnets.\n        - Internet Gateway (Public) and NAT Gateway (Private).\n        - EKS Cluster Control Plane with managed node group.\n    - **EKS Managed Add-ons:**\n        - VPC_CNI, CoreDNS, Kube_Proxy, EBS_CSI_Driver.\n    - **Additional Kubernetes Components:**\n        - Argo Workflows, Argo Events, AWS for FluentBit, Karpenter.\n        - Metrics Server, CoreDNS Autoscaler, Cluster Autoscaler.\n        - Kube Prometheus Stack, Spark Operator.\n        - Roles for Argo Workflows and Argo Events.\n\n3. **Create the SQS Queue:**\n\n    ```shell\n    queue_url=$(aws sqs create-queue --queue-name demo-argo-workflows --region eu-west-1 --output text)\n    ```\n\n4. **Retrieve the Queue ARN:**\n\n    ```shell\n    sqs_queue_arn=$(aws sqs get-queue-attributes --queue-url $queue_url --attribute-names QueueArn --region eu-west-1 --query \"Attributes.QueueArn\" --output text)\n    ```\n\n    Update the SQS access policy:\n\n    ```shell\n    template=`cat argo-events-manifests/sqs-accesspolicy.json | sed -e \"s|<sqs_queue_arn>|$sqs_queue_arn|g;s|<your_event_irsa_arn>|$your_event_irsa_arn|g\"`\n    aws sqs set-queue-attributes --queue-url $queue_url --attributes $template --region eu-west-1\n    ```\n\n5. **Access Argo Workflows Web UI:**\n\n    Extract the bearer token:\n\n    ```shell\n    argo auth token\n    ```\n\n    Get the load balancer URL:\n\n    ```shell\n    kubectl -n argo-workflows get service argo-workflows-server -o jsonpath=\"{.status.loadBalancer.ingress[*].hostname}{'\\n'}\"\n    ```\n\n    Open your browser, enter the URL, and paste the token (including `Bearer`) into the login prompt.\n\n    ![argo](./argo.png)\n\n6. **Create a Spark Job within an Argo Workflow:**\n\n    Install the EventBus:\n\n    ```shell\n    kubectl apply -f argo-events-manifests/eventbus.yaml\n    ```\n\n    Set up Amazon SQS as an event source:\n\n    ```shell\n    queue_name=demo-argo-workflows\n    region_sqs=eu-west-1\n\n    cat argo-events-manifests/eventsource-sqs.yaml | sed \"s/<region_sqs>/$region_sqs/g;s/<queue_name>/$queue_name/g\" | kubectl apply -f -\n    ```\n\n    Deploy the sensor:\n\n    ```shell\n    kubectl apply -f argo-events-manifests/sensor-rbac.yaml\n    ```\n\n    Update `taxi-trip.sh` with your S3 bucket and region:\n\n    ```shell\n    if [ $# -ne 2 ]; then\n      echo \"Usage: $0 <s3_bucket> <region>\"\n      exit 1\n    fi\n\n    s3_bucket=\"$1\"\n    region=\"$2\"\n\n    INPUT_DATA_S3_PATH=\"s3://${s3_bucket}/taxi-trip/input/\"\n\n    mkdir input\n\n    aws s3 cp pyspark-taxi-trip.py s3://${s3_bucket}/taxi-trip/scripts/ --region ${region}\n\n    wget https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2022-01.parquet -O \"input/yellow_tripdata_2022-0.parquet\"\n\n    max=5\n    for (( i=1; i <= $max; ++i ))\n    do\n       cp -rf \"input/yellow_tripdata_2022-0.parquet\" \"input/yellow_tripdata_2022-${i}.parquet\"\n    done\n\n    aws s3 sync \"input/\" ${INPUT_DATA_S3_PATH}\n\n    rm -rf input\n    ```\n\n    Execute the script:\n\n    ```shell\n    ./taxi-trip.sh\n    ```\n\n    Apply the sensor configuration:\n\n    ```shell\n    kubectl apply -f sensor-sqs-sparkjobs.yaml\n    ```\n\n7. **Test the Setup:**\n\n    Send a message from SQS:\n\n    ```shell\n    aws sqs send-message --queue-url $queue_url --message-body '{\"message\": \"hello data on k8s\"}' --region $region_sqs\n    ```\n\n    Check the workflow status:\n\n    ```shell\n    kubectl get workflows -n argo-workflows\n    ```\n\n    You can also see the SQS workflow status in the web UI:\n\n    ![webui](./webui.png)\n\n    ![webui2](./webui2.png)\n\n### üìå Key Takeaways\n\nIn this post, we explored how Argo Workflows and Argo Events can help us better manage and scale Spark applications on Amazon EKS. These tools have several advantages, such as allowing us to create and automate complex pipelines using Argo Workflows, and triggering actions based on events using Argo Events.\n\n**Stay tuned for next blogs in this¬†seriesüéâ**\n\n**References:**\n\n- https://spacelift.io/blog/argo-workflows\n- https://codefresh.io/learn/argo-workflows\n- https://codefresh.io/learn/argo-workflows/learn-argo-workflows-with-8-simple-examples\n- https://argo-workflows.readthedocs.io/en/latest\n- https://awslabs.github.io/data-on-eks/docs/blueprints/job-schedulers/argo-workflows-eks\n- https://aws.amazon.com/blogs/containers/dynamic-spark-scaling-on-amazon-eks-with-argo-workflows-and-events\n- https://mkdev.me/posts/argo-ecosystem-argo-cd-argo-workflows-argo-events-argo-rollouts-argo-everything\n- https://dok.community/blog/scheduled-scaling-with-dask-and-argo-workflows/\n- https://www.youtube.com/watch?v=FBRMURQYbgw\n\n**Thank You üñ§**\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordcount":1012}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://seifrajhi.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://seifrajhi.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Data on Kubernetes: Part 4‚Ää-‚ÄäArgo Workflows: Simplify parallel jobs","item":"https://seifrajhi.github.io/blog/data-on-kubernetes-argo-workflows-4/"}]}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","image":"/static/c2d1a71e3412fe9cb8ae584b2dd9cf63/38fe1/carvel-cover.png","headline":"Simplify Kubernetes Application Management with Carvel kapp","dateCreated":"2024-10-25","datePublished":"2024-10-25","dateModified":"2024-10-25","inLanguage":"en-US","isFamilyFriendly":true,"isAccessibleForFree":true,"author":{"@type":"Person","name":"Saifeddine Rajhi","url":"https://seifrajhi.github.io"},"publisher":{"@type":"Organization","name":"Saifeddine Rajhi's Website"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://seifrajhi.github.io/blog/carvel-kapp-kubernetes-management/"},"keywords":["Kubernetes","Carvel","kapp","Platform engineering"],"genre":["Platform engineer","software engineering","science","deep learning","statistics"],"articleSection":"Technical Blog","articleBody":"\n> **Take control of your Kubernetes resourcesüî•**\n\n## üìî Introduction\n\nKubernetes applications involve juggling multiple resources, configurations, and dependencies. Carvel kapp offers a straightforward solution to this complexity. It treats related Kubernetes resources as logical \"applications,\" allowing you to deploy, update, and manage them as cohesive units. With kapp, you can safely apply changes, preview diffs, and prune obsolete resources‚Ää‚Äî‚Ääall while minimizing disruptions to running workloads.\n\n## kapp Overview\n\nCarvel kapp is a lightweight, command-line tool that simplifies the deployment and management of Kubernetes applications. Unlike some other tools, kapp does not require any server-side components, elevated privileges, or custom resources, making it highly portable and easy to use, even in RBAC-constrained clusters.\n\nAt its core, kapp is designed to be explicit, providing visibility into the changes it will apply to your cluster before executing them. It calculates the differences between your desired configuration and the live cluster state, presenting a clear set of create, update, and delete operations for your approval.\n\nOne of kapp's standout features is its dependency-aware resource ordering. It intelligently manages the deployment order of certain resources, ensuring that dependencies are respected. For instance, Custom Resource Definitions (CRDs) and Namespaces are installed before the resources that depend on them. Additionally, kapp allows you to declare your own dependency rules, such as requiring a Job to complete database migrations before updating a Deployment.\n\n## Deploy Kubernetes Applications with kapp\n\nBefore getting too deep, let's get some basic preparations out of the way:\n\n1. **Create a Kubernetes cluster.**\n2. **Install [ytt](https://carvel.dev/ytt/), [kbld](https://carvel.dev/kbld/), [kapp](https://carvel.dev/kapp/)** by following instructions in the [Install section on carvel.dev](https://carvel.dev/#install).\n\nTo get started with our example application, clone [kapp-k8s-demo](https://github.com/seifrajhi/kapp-k8s-demo.git) locally:\n\n```shell\ngit clone https://github.com/seifrajhi/kapp-k8s-demo.git\ncd kapp-k8s-demo\n```\n\nThis directory contains a simple Go application that consists of main.go (an HTTP web server) and a Dockerfile¬†.\nMultiple step-* directories contain variations of application configuration that we will use in each step.\n\n```shell\n$ ls -l\nDockerfile\nmain.go\nconfig-minimal\n```\n\nTypically, an application deployed to Kubernetes will include **Deployment** and **Service** resources in its configuration. In our example, `config-minimal/` directory contains `config.yml` which includes exactly that. (Note that the Docker image is already preset and the environment variable `HELLO_MSG` is hard coded. We'll get to those shortly.)\n\nTraditionally, you can use `kubectl apply -f config-minimal/config.yml` to deploy this application. However, `kubectl` does not indicate which resources are affected and how they are affected before applying changes, and does not yet have a robust prune functionality to converge a set of resources.\n\n**kapp** addresses and improves on several `kubectl` limitations as it was designed from the start around the notion of a \"Kubernetes Application\" ‚Äî a set of resources with the same label:\n\n- **Visibility and Confidence**: `kapp` separates the change calculation phase (diff) from the change apply phase (apply) to give users visibility and confidence regarding what's about to change in the cluster.\n- **Resource Tracking**: `kapp` tracks and converges resources based on a unique generated label, freeing its users from worrying about cleaning up old deleted resources as the application is updated.\n- **Order Management**: `kapp` orders certain resources so that the Kubernetes API server can successfully process them (e.g., CRDs and namespaces before other resources).\n- **Readiness Wait**: `kapp` tries to wait for resources to become ready before considering the deploy a success.\n\nFor more information, you can visit the [Carvel kapp documentation](https://carvel.dev/kapp/docs/latest/).\n\nLet us deploy our application with kapp:\n\n```shell\n$ kapp deploy -a simple-app -f step-1-minimal/\nTarget cluster ['https://192.168.99.111:8443'](https://192.168.99.111:8443) (nodes: minikube)\nChanges\nNamespace  Name        Kind        Conds.  Age  Op      Op st.  Wait to    Rs  Ri\ndefault    simple-app  Deployment  -       -    create  -       reconcile  -   -\n^          simple-app  Service     -       -    create  -       reconcile  -   -\nOp:      2 create, 0 delete, 0 update, 0 noop\nWait to: 2 reconcile, 0 delete, 0 noop\nContinue? [yN]: y\n8:17:44PM: ---- applying 2 changes [0/2 done] ----\n8:17:44PM: create deployment/simple-app (apps/v1) namespace: default\n8:17:44PM: create service/simple-app (v1) namespace: default\n8:17:44PM: ---- waiting on 2 changes [0/2 done] ----\n8:17:45PM: ok: reconcile service/simple-app (v1) namespace: default\n8:17:45PM: ongoing: reconcile deployment/simple-app (apps/v1) namespace: default\n8:17:45PM:  ^ Waiting for generation 2 to be observed\n8:17:45PM:    ok: waiting on replicaset/simple-app-7fbc6b7c9b (apps/v1) namespace: default\n8:17:45PM:    ongoing: waiting on pod/simple-app-7fbc6b7c9b-g92t7 (v1) namespace: default\n8:17:45PM:     ^ Pending: ContainerCreating\n8:17:45PM: ---- waiting on 1 changes [1/2 done] ----\n8:17:45PM: ongoing: reconcile deployment/simple-app (apps/v1) namespace: default\n8:17:45PM:  ^ Waiting for 1 unavailable replicas\n8:17:45PM:    ok: waiting on replicaset/simple-app-7fbc6b7c9b (apps/v1) namespace: default\n8:17:45PM:    ongoing: waiting on pod/simple-app-7fbc6b7c9b-g92t7 (v1) namespace: default\n8:17:45PM:     ^ Pending: ContainerCreating\n8:17:49PM: ok: reconcile deployment/simple-app (apps/v1) namespace: default\n8:17:49PM: ---- applying complete [2/2 done] ----\n8:17:49PM: ---- waiting complete [2/2 done] ----\nSucceeded\n```\n\nOur simple-app received a unique label kapp.k14s.io/app=1557433075084066000 for resource tracking:\n\n```shell\n$ kapp ls\nTarget cluster ['https://192.168.99.111:8443'](https://192.168.99.111:8443) (nodes: minikube)\nApps in namespace 'default'\nName        Namespaces  Lcs   Lca\nsimple-app  default     true  23s\n1 apps\nSucceeded\n```\n\nUsing this label, kapp tracks and allows inspection of all Kubernetes resources created for sample-app:\n\n```shell\n$ kapp inspect -a simple-app --tree\nTarget cluster 'https://192.168.99.111:8443' (nodes: minikube)\nResources in app 'simple-app'\nNamespace  Name                              Kind        Owner    Conds.  Rs  Ri  Age\ndefault    simple-app                        Deployment  kapp     2/2 t   ok  -   46s\ndefault       simple-app-7fbc6b7c9b          ReplicaSet  cluster  -       ok  -   46s\ndefault         simple-app-7fbc6b7c9b-g92t7  Pod         cluster  4/4 t   ok  -   46s\ndefault    simple-app                        Service     kapp     -       ok  -   46s\ndefault       simple-app                     Endpoints   cluster  -       ok  -   46s\nRs: Reconcile state\nRi: Reconcile information\n5 resources\nSucceeded\n```\n\nNote that it even knows about resources it did not directly create (such as ReplicaSet and Endpoints).\n\n```shell\n$ kapp logs -f -a simple-app\nTarget cluster 'https://192.168.99.111:8443' (nodes: minikube)\n# starting tailing 'simple-app-7fbc6b7c9b-g92t7 > simple-app' logs\nsimple-app-7fbc6b7c9b-g92t7 > simple-app | 2020/12/14 01:17:48 Server started\n```\n\ninspect and logs commands demonstrate why it's convenient to view resources in \"bulk\" (via a label). For example, logs command will tail any existing or new Pod that is part of simple-app application, even after we make changes and redeploy.\n\n### Deploying configuration changes\n\nLet's make a change to the application configuration to simulate a common occurrence in a development workflow. A simple observable change we can make is to change the value of the HELLO_MSG environment variable in [config-step-1-minimal/config.yml](https://github.com/carvel-dev/simple-app-on-kubernetes/blob/develop/config-step-1-minimal/config.yml):\n\n![alt text](change.png)\n\nand **re-run kapp deploy command**.\n\nThe output should highlight several kapp features:\n\nkapp detected a single change to simple-app Deployment by comparing given local configuration against the live cluster copy\n\nkapp showed changes in a git-style diff via `--diff-changes` flag\n\nsince simple-app Service was not changed in any way, it was not \"touched\" during the apply changes phase at all\n\nkapp waited for Pods associated with a Deployment to converge to their ready state before exiting successfully\n\nTo double check that our change applied, go ahead and refresh your browser window with our deployed application.\n\nGiven that kapp does not care where application configuration comes from, one can use it with any other tools that produce Kubernetes configuration, for example, Helm's template command:\n\n```shell\nhelm template my-chart --values values.yml | kapp deploy -a my-app -f- --yes\n```\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n<br><br>\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time, „Å§„Å•„Åè üáµüá∏üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordcount":842}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://seifrajhi.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://seifrajhi.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Simplify Kubernetes Application Management with Carvel kapp","item":"https://seifrajhi.github.io/blog/carvel-kapp-kubernetes-management/"}]}</script><link crossorigin="" href="https://utteranc.es" rel="preconnect"/><link crossorigin="" href="https://www.google-analytics.com" rel="preconnect"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=47ae28bb567c9025f1fee24afb2d20c9" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=47ae28bb567c9025f1fee24afb2d20c9"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2"/><style>@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup8.woff2) format("woff2")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:400;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7BMSo3Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Dancing Script;font-style:normal;font-weight:700;src:url(/static/webfonts/s/dancingscript/v25/If2cXTr6YS-zF4S-kcSWSVi_sxjsohD9F50Ruu7B1i03Sup6.woff) format("woff")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMrx.woff2) format("woff2")}@font-face{font-display:swap;font-family:Ledger;font-style:normal;font-weight:400;src:url(/static/webfonts/s/ledger/v16/j8_q6-HK1L3if_sBnMr3.woff) format("woff")}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-LLPCCGNLH7', 'auto', {"alwaysSendReferrer":true});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LLPCCGNLH7"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-LLPCCGNLH7',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-LLPCCGNLH7', {"anonymize_ip":true,"send_page_view":false});gtag('config', 'GTM-5V895PDS', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><link rel="stylesheet"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://seifrajhi.github.io/blog/data-on-kubernetes-argo-workflows-4/" data-baseprotocol="https:" data-basehost="seifrajhi.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="blogpost-header"><div class="view-page-header"><div class="view-page-header-wrapper"><div class="logo-wrapper"><div class="logo"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained logo-img"><div style="max-width:150px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;174&#x27;%20width=&#x27;150&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" data-src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" data-srcset="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture><noscript><picture><source type="image/avif" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/2e0ee/saifeddine-rajhi.avif 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/81dba/saifeddine-rajhi.avif 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/20c67/saifeddine-rajhi.avif 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/94b9f/saifeddine-rajhi.avif 300w" sizes="(min-width: 150px) 150px, 100vw"/><source type="image/webp" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/92aab/saifeddine-rajhi.webp 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/359cc/saifeddine-rajhi.webp 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/aac41/saifeddine-rajhi.webp 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/a15c6/saifeddine-rajhi.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" src="/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png" srcSet="/static/a1a51351bdf7de55eaaa515eb15ce2da/9c61d/saifeddine-rajhi.png 38w,/static/a1a51351bdf7de55eaaa515eb15ce2da/d405f/saifeddine-rajhi.png 75w,/static/a1a51351bdf7de55eaaa515eb15ce2da/885b3/saifeddine-rajhi.png 150w,/static/a1a51351bdf7de55eaaa515eb15ce2da/4aeea/saifeddine-rajhi.png 300w" alt="Saifeddine Rajhi"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="name"><a href="/blog/" title="back to blog">Saifeddine <br/> Rajhi</a></div></div><h2 class="blog-title"><a href="/blog/" title="back to the homepage">Blog</a></h2></div></div><nav class="main-navigation"><ul><li><a rel="home" title="Go Home" href="/">Home</a></li><li><a title="Go to my Technical Blog" href="/blog/">Blog</a></li><li><a title="Go to my Thoughts" href="/thoughts/">Thoughts</a></li><li><a title="Review My Resume" href="/cv/platform-engineer/">cv</a></li></ul></nav></div><main><article class="blog-wrapper"><header><figure class="cover"><div class="cover-filter"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper cover cover-image"><div aria-hidden="true" style="padding-top:55.875%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoklEQVR42j2SyW4TURBF/Td8BDs+ALFnhcSGDb8ACkhh2LABBRIiQAExJiaxE5xWBmewYzu2u9122+7B7jGOBxLCFEBIh3KDWFzVe7eeblXdeglnbx6nssLAMxn6ThwHnsXQs+nHnP0fo8D5m5Pzodum75r/udCq4zU1EhtbSd6uv8Ry6jidBlHkcNDr0OkaRKEdc7ajC+q0TBXfa2PZOqNhSBjZtCwNPzA5lrvXVEm4ovpx4FOt7aEJbEtHlVhRdzGaZUrlLfZKm+QKa2ztZrBMjaJwXSnUaleFX5fCDiejCM8QwaCl8ev0hNPvn6QbgyNJFPaz7OQVanqRILBQ9XGBHEXh9XpBhFRpIC8N5Akl//vXN476Pm5DBD0RPP12jCmVS5VtStVt6awSd2FaNQzpIl/aYFsKODLqWDDwTcLQIl9cp1DOMjrqcfrliKAtHobtGj9EcDQIOOy5cRz0PYHPl5Mhx/I4Eq98vy0iNp7EgVg0lHdRZNFQC9Tyq7xWFsgsKyRsfR/X1Ak7TYIxHCNG2G3GXH+81UC2PN6m/y8K13Mtvn7+RHruLVcvnCM1fY03k49J3EpOcSc1zeT7h9xNT8fnW4uPuDH/gLnUc+xKnq5ejg33GlXcegXX0HBl1EC5T7g9IzkNvdqUvHiY3EyytJMWLPF44RXv1pKsFFZIZhdJLaeo7uYY/4RuoxKLRmJR2LHpZmYJJ87w8+lZkorOlWdfeblqkTho6nyU8bLJNW5fnmD25iyeVsZRSxiZJWpPHmA2G6TfPGduZoqcksasq3Q35jEnz+PPXOSDssed+QOyOUP+oYxx2KmjLChcv3SNqYlpzGqRjvDa8jt2Z+7hmQ06tX0KG6uspxeoF3cI2+J7S2c/m2Fz8QW+fK2eVeMPq2jvUMTf9AQAAAAASUVORK5CYII=" alt=""/><picture><source type="image/webp" data-srcset="/static/3afa5d844f90e8fbfb49d3a8845f4ac3/45f0d/dok4.webp 750w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/3c63c/dok4.webp 1080w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/9ee7a/dok4.webp 1366w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/cfdd9/dok4.webp 1600w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/3afa5d844f90e8fbfb49d3a8845f4ac3/1cbbd/dok4.png" data-srcset="/static/3afa5d844f90e8fbfb49d3a8845f4ac3/38de2/dok4.png 750w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/f79fe/dok4.png 1080w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/8bf4f/dok4.png 1366w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/1cbbd/dok4.png 1600w" alt="Data on Kubernetes: Part 4‚Ää-‚ÄäArgo Workflows: Simplify parallel jobs"/></picture><noscript><picture><source type="image/webp" srcSet="/static/3afa5d844f90e8fbfb49d3a8845f4ac3/45f0d/dok4.webp 750w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/3c63c/dok4.webp 1080w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/9ee7a/dok4.webp 1366w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/cfdd9/dok4.webp 1600w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/3afa5d844f90e8fbfb49d3a8845f4ac3/1cbbd/dok4.png" srcSet="/static/3afa5d844f90e8fbfb49d3a8845f4ac3/38de2/dok4.png 750w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/f79fe/dok4.png 1080w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/8bf4f/dok4.png 1366w,/static/3afa5d844f90e8fbfb49d3a8845f4ac3/1cbbd/dok4.png 1600w" alt="Data on Kubernetes: Part 4‚Ää-‚ÄäArgo Workflows: Simplify parallel jobs"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><figcaption data-nosnippet="" class="image-title">Photo by Saifeddine Rajhi</figcaption></figure><h1>Data on Kubernetes: Part 4‚Ää-‚ÄäArgo Workflows: Simplify parallel jobs</h1><div data-nosnippet="" class="blog-details"><time class="blog-createdat" dateTime="2024-10-25">Oct 25, 2024</time><span> ‚Ä¢ </span><span class="blog-time2read">6<!-- -->mins<!-- --> read</span><div class="theme-switcher"><div class="theme-switcher-toggler"><div class="theme-switcher-track"></div><div class="theme-switcher-thumb"></div><input class="theme-switcher-input" type="checkbox" readonly="" aria-label="Switch between Dark and Light modes"/></div></div></div><ul data-nosnippet="" class="blog-tags"><li>Kubernetes</li><li>Argo Workflows</li><li>Workflow Automation</li><li>Parallel Jobs</li><li>Container-native</li></ul></header><div class="blog-divider"></div><div id="intro"></div><div class="content-wrapper"><div data-nosnippet="" class="blog-content-nav-wrapper"><ul class="blog-content-nav"><h2>Content</h2><ul class="toc-list"></ul></ul></div><div class="content blog-content"><blockquote>
<p><strong>Container-native workflow engine for Kubernetes üîÆ</strong></p>
</blockquote>
<h2 id="-introduction" style="position:relative;"><a href="#-introduction" aria-label=" introduction permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üêô Introduction</h2>
<p>Welcome to the fourth part of the "Data on Kubernetes" series!</p>
<p>In this part, we'll explore <a href="https://argo-workflows.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Argo Workflows</a>‚Ää-‚Ääan open-source, container-native workflow engine designed specifically for orchestrating parallel jobs on Kubernetes.</p>
<p>Argo Workflows seamlessly integrates with Kubernetes services like volumes, secrets, and RBAC, making it a powerful tool for managing complex data workflows.</p>
<h2 id="introduction-to-argo-workflows" style="position:relative;"><a href="#introduction-to-argo-workflows" aria-label="introduction to argo workflows permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Introduction to Argo Workflows</h2>
<p>In our <a href="https://seifrajhi.github.io/blog/data-on-kubernetes-airflow-on-aws-3/" target="_blank" rel="noopener noreferrer">previous blog post</a>, we explored the world of workflow orchestrators, with a specific focus on Apache Airflow.</p>
<p>Now, let's check another tool: Argo Workflows.</p>
<p>As an open-source, container-native workflow engine, Argo Workflows is purpose-built for orchestrating parallel jobs within Kubernetes environments.</p>
<p>Let's take a closer look at why Argo Workflows stands out:</p>
<h3 id="1-what-is-argo-workflows-" style="position:relative;"><a href="#1-what-is-argo-workflows-" aria-label="1 what is argo workflows  permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. What is Argo Workflows? ü§î</h3>
<p>Argo Workflows empowers you to define workflows where each step corresponds to a container. This flexibility allows for the creation of complex data processing pipelines. Think of it as assembling a series of building blocks, where each block represents a specific task or operation.</p>
<p>Additionally, Argo Workflows is implemented as a Kubernetes Custom Resource Definition (CRD), seamlessly integrating into the Kubernetes ecosystem without disrupting the existing setup.</p>
<h3 id="2-main-features-and-benefits" style="position:relative;"><a href="#2-main-features-and-benefits" aria-label="2 main features and benefits permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. Main Features and Benefits</h3>
<p><strong>Container-Native Approach:</strong></p>
<p>Argo Workflows fully embraces the containerization paradigm. Each step in your workflow runs within its own container, ensuring consistency and compatibility across different tasks. Whether you're dealing with data transformations, model training, or any other computational task, Argo Workflows has you covered.</p>
<p><strong>DAG Modeling (Directed Acyclic Graphs):</strong></p>
<p>Imagine your workflow as a flowchart with interconnected boxes. Argo Workflows allows you to model multi-step workflows using <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" target="_blank" rel="noopener noreferrer">directed acyclic graphs (DAGs)</a>. These graphs capture dependencies between tasks, ensuring that steps execute in the correct order. It's like choreographing a dance where each move follows a logical sequence.</p>
<p><strong>Efficient Compute Handling:</strong></p>
<p>Argo Workflows shines when it comes to compute-intensive workloads. Whether you're crunching numbers, analyzing data, or training machine learning models, Argo efficiently manages the computational resources needed for each step.</p>
<h3 id="3-integration-with-the-kubernetes-ecosystem" style="position:relative;"><a href="#3-integration-with-the-kubernetes-ecosystem" aria-label="3 integration with the kubernetes ecosystem permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. Integration with the Kubernetes Ecosystem</h3>
<p>Argo Workflows seamlessly integrates with other Kubernetes services:</p>
<ul>
<li><strong>Volumes:</strong> Need to read or write data? Argo Workflows plays well with <a href="https://kubernetes.io/docs/concepts/storage/volumes/" target="_blank" rel="noopener noreferrer">Kubernetes volumes</a>, allowing you to handle data storage efficiently.</li>
<li><strong>Secrets:</strong> Security matters! Argo Workflows integrates with <a href="https://kubernetes.io/docs/concepts/configuration/secret/" target="_blank" rel="noopener noreferrer">Kubernetes secrets</a>, ensuring that sensitive information remains protected.</li>
<li><strong>RBAC (Role-Based Access Control):</strong> Argo Workflows respects your access policies. It works harmoniously with <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">Kubernetes RBAC</a>, allowing you to control who can orchestrate workflows and who can't.</li>
</ul>
<h3 id="4-why-choose-argo-workflows" style="position:relative;"><a href="#4-why-choose-argo-workflows" aria-label="4 why choose argo workflows permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>4. Why Choose Argo Workflows</h3>
<p>Argo Workflows stands out for several reasons:</p>
<ul>
<li><strong>Kubernetes Integration:</strong> Argo Workflows seamlessly integrates with Kubernetes, simplifying usage and deployment.</li>
<li><strong>Scalability and Complexity Handling:</strong> It efficiently manages complex workflows, even those with thousands of steps.</li>
<li><strong>Flexible Workflow Patterns:</strong> Argo supports various workflow structures, adapting to your needs.</li>
<li><strong>Active Open Source Community:</strong> Benefit from a thriving community that actively contributes to Argo's development.</li>
</ul>
<h2 id="exploring-argo-workflows-on-amazon-eks" style="position:relative;"><a href="#exploring-argo-workflows-on-amazon-eks" aria-label="exploring argo workflows on amazon eks permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exploring Argo Workflows on Amazon EKS</h2>
<p>In this section, we'll dive into creating and deploying a data processing platform on <a href="https://aws.amazon.com/eks/" target="_blank" rel="noopener noreferrer">Amazon Elastic Kubernetes Service (Amazon EKS)</a>.</p>
<p>The solution includes essential Kubernetes add-ons: <a href="https://argo-workflows.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Argo Workflows</a>, <a href="https://argoproj.github.io/argo-events/" target="_blank" rel="noopener noreferrer">Argo Events</a>, <a href="https://github.com/kubeflow/spark-operator" target="_blank" rel="noopener noreferrer">Spark Operator</a> for managing Spark jobs, <a href="https://fluentbit.io/" target="_blank" rel="noopener noreferrer">Fluent Bit</a> for logging, and <a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus</a> for metrics.</p>
<h3 id="Ô∏è-setup-overview" style="position:relative;"><a href="#%EF%B8%8F-setup-overview" aria-label="Ô∏è setup overview permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üõ†Ô∏è Setup Overview</h3>
<p><strong>Cluster Setup:</strong> We'll set up an Amazon EKS cluster with a managed node group. We'll install Argo Workflows and Argo Events in their own dedicated namespaces (<code class="language-text">argo-workflows</code> and <code class="language-text">argo-events</code>).</p>
<p><strong>Event-Driven Workflow:</strong> An <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/welcome.html" target="_blank" rel="noopener noreferrer">Amazon SQS queue</a> will receive user requests. In the Argo Events namespace, an SQS event source object will fetch messages from this external queue. When a new message arrives, a sensor in Argo Workflow will trigger the specified workflow.</p>
<p><strong>Spark Job Execution:</strong> The triggered workflow will create a Spark application using Spark Operator in the <code class="language-text">data-ops</code> namespace. This application consists of one Spark driver pod and two executor pods.</p>
<p>The diagram illustrates how Argo Events sources drive the execution of Spark jobs.</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 117.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAADOUlEQVR42qVVa08aQRTllzfppyZNtCIqgqJQUdO0tZ/6iC9EQAGtysobUXdBnrvuLshT4fTOLFL6iI+4yWV27pw595w7A5jw2NPvo9O9RZviKY/pAR7+tDpdOPwinPt5dDsdY+0lhDeNBr6EslgLZtButV6i0GBUrlVkL0TEk2notfoLCPlnD+sJBRZfETOBCraTMs+9yHIgWYDLm4RjU0AoU/xj7VmE7GnTgSiqDlHKI3N2jmutznPPttwbSPAkKjD7SrAHZR6WPRn+tMwb0n8O4f2BnEoq3IEsVn0puLYELAfOkShoD14d02OnVtN15PN5ZLPn9K497ZSZoNHoDcqzi/w5UoU1pGJ6r4q1SIUD/sbfx6MKe3e32IqI+HQg4WPoEtvC5eMK2anJWg2KXv8nZDphScohnUohlYhz6//DyhRq7QY9smbazShwCB24410sxQYRpXniDrb9Msa/RTH2NYo3a2GMf4/BcagR9o5jDDyN8Vu4Tuq4kmsweTIqFuJ9LKcBd2okaO4isNkjYnzjDO82s7Ds5rEoNAfY/gBr7HVG2xCrOkw7ZxoWYj0sM0ByJAjsIhWOozp97UqY8kpYOL7hOXcSI1i2l7CnbUhVrlDDIilcoSpsYRg0n/+pY3a/gtlglcYyrETsOKphJUPrRGZgjb2skEGYVmE/bsEZaWFxGE2y1sLcAV0XfxGTOyImti7ovYC5QxVOgWEaBo7hhTapr0NiPdyIlTG1r3DQwkmDBwM5yYKNlI39SOLVkgevV/2wEDFTzIotDvE3HD9DhcWKBtN6tAQbsX84h2GFLDipIiOcCRQx7StgyndFPczBulfm/WTKnKcdagvZzfSxmgUVKuGyrBoKrWEN76Nd2Mkis2cPX5M1nao3eR+nidC8fYF56h9TNUdXxxZSMOm5HBxUF7NUTDQIS5jw5jEXlqnpZW6JEdrDVdqsw04bmXX7wTWNMlxCg4qoXC0jsQUZXsEsuRHvFb7dFMlWARY/XQ8eRZh3cpjcLVBc8V/sabJqoTlbZ7lJEsGxlDd7CUM5id1DudZEPKcgkZNpZFFFXJJ5Lj7MyYOcjJhUHb7/xspI088a+7v9Bc1z22duIPu3AAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="diagram" title="" src="/static/77747e1703c0180ae5de6102493873dc/c5bb3/diagram.png" srcset="/static/77747e1703c0180ae5de6102493873dc/04472/diagram.png 170w,
/static/77747e1703c0180ae5de6102493873dc/9f933/diagram.png 340w,
/static/77747e1703c0180ae5de6102493873dc/c5bb3/diagram.png 680w,
/static/77747e1703c0180ae5de6102493873dc/dc616/diagram.png 933w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<blockquote>
<p><strong>Prerequisites:</strong> Ensure you have <a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" target="_blank" rel="noopener noreferrer">AWS CLI</a>, <a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">kubectl</a>, <a href="https://learn.hashicorp.com/tutorials/terraform/install-cli" target="_blank" rel="noopener noreferrer">Terraform</a>, and <a href="https://github.com/argoproj/argo-workflows/releases/latest" target="_blank" rel="noopener noreferrer">Argo Workflow CLI</a> installed.</p>
</blockquote>
<p>The diagram below shows the detailed technical design that will be set up in this demo:</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 35.29411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABvElEQVR42m2Q224SURSG54F8Cl/BO9/AF/CiMcaYKhpjTKxeaNOpLdQDAbFUEYRKT4BAD6lBraUHRgYGZ0+nUJihwwCfA9Y7d/Lly/+vnXWxJMcdYLb7NLt4HjDKo9cfDL3scnLWG8+NVg+9eY7wbFx0/zj1/o3cdQZIZsclV7bJbn2j+FPH7PxdaHX7bFUcdtQh24rLmxWFx6EdpsK7zCePyB90KRzaHp6PXDb2LNSTHpKw4MPyKv4bl0jF/IwyDLGcIbFsHfnFOrGcRuJrh+CGwJ/WiBZMPpc6Y1ZKLbIljbUfHRT9HKnegmA0Tn76MuvJABUxwLJsRLvHI1+Y21eu8fBehJdrNULLZeLJXeTEAa/TCgurDT7GcxjzV1GP9zFMC6kqHKYTNZ48l5Gj2yjCpd00Ma0+T+eKTF5/xtTcJnJaZ+aTymziFzNJjdmUhpxqEEgqvI8XCWc09lQbqVy3mQwq3Fw45tarCodad3xD0XJ4sFjH97bO/YjnUNVDxRe+YJTDVe563Z3IbyYCCpnvTaSG6RDJGSwVDBa/GDROnfHCM7tPNG/wLie8Xoxn/0ewlNcJZXT2azZ/AE3d4+DdQprxAAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="setup" title="" src="/static/7ca26b2a4e959d7b89e601c5b9c98a7c/c5bb3/setup.png" srcset="/static/7ca26b2a4e959d7b89e601c5b9c98a7c/04472/setup.png 170w,
/static/7ca26b2a4e959d7b89e601c5b9c98a7c/9f933/setup.png 340w,
/static/7ca26b2a4e959d7b89e601c5b9c98a7c/c5bb3/setup.png 680w,
/static/7ca26b2a4e959d7b89e601c5b9c98a7c/b12f7/setup.png 1020w,
/static/7ca26b2a4e959d7b89e601c5b9c98a7c/b5a09/setup.png 1360w,
/static/7ca26b2a4e959d7b89e601c5b9c98a7c/29007/setup.png 1600w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<h3 id="-implementation-steps" style="position:relative;"><a href="#-implementation-steps" aria-label=" implementation steps permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üöÄ Implementation Steps</h3>
<ol>
<li>
<p><strong>Clone the Repository:</strong></p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token function">git</span> clone https://github.com/awslabs/data-on-eks.git
<span class="token builtin class-name">cd</span> data-on-eks/schedulers/terraform/argo-workflow</code></pre></div>
</li>
<li>
<p><strong>Initialize and Apply Terraform:</strong></p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">terraform init
terraform apply <span class="token parameter variable">-var</span> <span class="token assign-left variable">region</span><span class="token operator">=</span>eu-west-1 --auto-approve</code></pre></div>
<p>This will create:</p>
<ul>
<li><strong>EKS and Networking Infrastructure:</strong>
<ul>
<li>VPC with Private and Public Subnets.</li>
<li>Internet Gateway (Public) and NAT Gateway (Private).</li>
<li>EKS Cluster Control Plane with managed node group.</li>
</ul>
</li>
<li><strong>EKS Managed Add-ons:</strong>
<ul>
<li>VPC_CNI, CoreDNS, Kube_Proxy, EBS_CSI_Driver.</li>
</ul>
</li>
<li><strong>Additional Kubernetes Components:</strong>
<ul>
<li>Argo Workflows, Argo Events, AWS for FluentBit, Karpenter.</li>
<li>Metrics Server, CoreDNS Autoscaler, Cluster Autoscaler.</li>
<li>Kube Prometheus Stack, Spark Operator.</li>
<li>Roles for Argo Workflows and Argo Events.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Create the SQS Queue:</strong></p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">queue_url</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>aws sqs create-queue --queue-name demo-argo-workflows <span class="token parameter variable">--region</span> eu-west-1 <span class="token parameter variable">--output</span> text<span class="token variable">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Retrieve the Queue ARN:</strong></p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">sqs_queue_arn</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>aws sqs get-queue-attributes --queue-url $queue_url --attribute-names QueueArn <span class="token parameter variable">--region</span> eu-west-1 <span class="token parameter variable">--query</span> <span class="token string">"Attributes.QueueArn"</span> <span class="token parameter variable">--output</span> text<span class="token variable">)</span></span></code></pre></div>
<p>Update the SQS access policy:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">template</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> argo-events-manifests/sqs-accesspolicy.json <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-e</span> <span class="token string">"s|&lt;sqs_queue_arn>|<span class="token variable">$sqs_queue_arn</span>|g;s|&lt;your_event_irsa_arn>|<span class="token variable">$your_event_irsa_arn</span>|g"</span><span class="token variable">`</span></span>
aws sqs set-queue-attributes --queue-url <span class="token variable">$queue_url</span> <span class="token parameter variable">--attributes</span> <span class="token variable">$template</span> <span class="token parameter variable">--region</span> eu-west-1</code></pre></div>
</li>
<li>
<p><strong>Access Argo Workflows Web UI:</strong></p>
<p>Extract the bearer token:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">argo auth token</code></pre></div>
<p>Get the load balancer URL:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">kubectl <span class="token parameter variable">-n</span> argo-workflows get <span class="token function">service</span> argo-workflows-server <span class="token parameter variable">-o</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">"{.status.loadBalancer.ingress[*].hostname}{'<span class="token entity" title="\n">\n</span>'}"</span></code></pre></div>
<p>Open your browser, enter the URL, and paste the token (including <code class="language-text">Bearer</code>) into the login prompt.</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 48.8235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVR42pWQi26CQBBF+f8va2NTWzVC5bEosBRcHgVkiRZvhxURrU1bkpuZnZl7MoxmbzzI/QHFrkZZy4tkQzX5L3U+7Xm5AntPYfoRrCCGSfLjBCIrkFc7GmpQdoa6N9YjjUBpUSm/NiXgOs5g08PhW1UUeYlaSuwPB7Rt2+tzlLc4Ho8Yfw39ZefXprqJdZQOwC5ykWNL0OTjrIo22CFVsaRYIqONOp1qlVpCAV906wrIQoElCzBdudDdgHIfOr0n8wUeZnM8LkxMFhbmtocnwxn6phf1QOMGSFpRbvixgrMwhRtuEApGWwS0LUeUrOnWHPowI5T3LvAMZX3ucEFARjeSw73qpqI+I11AA/DVsL8Br9WZQniJi6TgyIsIcbahWtD3boCzt9+AJ6jhv9OdAlg+J4U/zhLQ+QPwfAIx0n3gF2bb6WswfMI1AAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="argo" title="" src="/static/3eb6034f8353d03f9b039f02915e645f/c5bb3/argo.png" srcset="/static/3eb6034f8353d03f9b039f02915e645f/04472/argo.png 170w,
/static/3eb6034f8353d03f9b039f02915e645f/9f933/argo.png 340w,
/static/3eb6034f8353d03f9b039f02915e645f/c5bb3/argo.png 680w,
/static/3eb6034f8353d03f9b039f02915e645f/b12f7/argo.png 1020w,
/static/3eb6034f8353d03f9b039f02915e645f/b5a09/argo.png 1360w,
/static/3eb6034f8353d03f9b039f02915e645f/64639/argo.png 1568w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
</li>
<li>
<p><strong>Create a Spark Job within an Argo Workflow:</strong></p>
<p>Install the EventBus:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">kubectl apply <span class="token parameter variable">-f</span> argo-events-manifests/eventbus.yaml</code></pre></div>
<p>Set up Amazon SQS as an event source:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">queue_name</span><span class="token operator">=</span>demo-argo-workflows
<span class="token assign-left variable">region_sqs</span><span class="token operator">=</span>eu-west-1

<span class="token function">cat</span> argo-events-manifests/eventsource-sqs.yaml <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">"s/&lt;region_sqs>/<span class="token variable">$region_sqs</span>/g;s/&lt;queue_name>/<span class="token variable">$queue_name</span>/g"</span> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</code></pre></div>
<p>Deploy the sensor:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">kubectl apply <span class="token parameter variable">-f</span> argo-events-manifests/sensor-rbac.yaml</code></pre></div>
<p>Update <code class="language-text">taxi-trip.sh</code> with your S3 bucket and region:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token parameter variable">-ne</span> <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> &lt;s3_bucket> &lt;region>"</span>
  <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">s3_bucket</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
<span class="token assign-left variable">region</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$2</span>"</span>

<span class="token assign-left variable">INPUT_DATA_S3_PATH</span><span class="token operator">=</span><span class="token string">"s3://<span class="token variable">${s3_bucket}</span>/taxi-trip/input/"</span>

<span class="token function">mkdir</span> input

aws s3 <span class="token function">cp</span> pyspark-taxi-trip.py s3://<span class="token variable">${s3_bucket}</span>/taxi-trip/scripts/ <span class="token parameter variable">--region</span> <span class="token variable">${region}</span>

<span class="token function">wget</span> https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2022-01.parquet <span class="token parameter variable">-O</span> <span class="token string">"input/yellow_tripdata_2022-0.parquet"</span>

<span class="token assign-left variable">max</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> $max<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">))</span></span>
<span class="token keyword">do</span>
   <span class="token function">cp</span> <span class="token parameter variable">-rf</span> <span class="token string">"input/yellow_tripdata_2022-0.parquet"</span> <span class="token string">"input/yellow_tripdata_2022-<span class="token variable">${i}</span>.parquet"</span>
<span class="token keyword">done</span>

aws s3 <span class="token function">sync</span> <span class="token string">"input/"</span> <span class="token variable">${INPUT_DATA_S3_PATH}</span>

<span class="token function">rm</span> <span class="token parameter variable">-rf</span> input</code></pre></div>
<p>Execute the script:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">./taxi-trip.sh</code></pre></div>
<p>Apply the sensor configuration:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">kubectl apply <span class="token parameter variable">-f</span> sensor-sqs-sparkjobs.yaml</code></pre></div>
</li>
<li>
<p><strong>Test the Setup:</strong></p>
<p>Send a message from SQS:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">aws sqs send-message --queue-url <span class="token variable">$queue_url</span> --message-body <span class="token string">'{"message": "hello data on k8s"}'</span> <span class="token parameter variable">--region</span> <span class="token variable">$region_sqs</span></code></pre></div>
<p>Check the workflow status:</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">kubectl get workflows <span class="token parameter variable">-n</span> argo-workflows</code></pre></div>
<p>You can also see the SQS workflow status in the web UI:</p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 49.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVR42q2SUU/DIBDH+fZG48MSXVzsnE7jx9EHE31wc7pFN0cDbWlLKVT/Hi3GF1+0I/nljgP+3HGwvf0D3N4/4ubuAaa2RI2qxXbWfM+DH9DG/MSJsjJI8hLscHAMLlNsuIAqK2yTDHGqIFUJpQ1EViBOVGs9/pBUnU0L3SJontPejM6z4UkEYx1q5yBp02LN8Uws3wVWXGK1FQHyeYj9wssmxpJgg6MhDJXgmoZu0Ji9cczXMebe/oHZawcbnY7xCcBRhr5kv/hEgv+FRWdTyu4jCOr+guPJFJo61FDJud5BhheX11B5EQRNf8FRNEFtLfzYiWB0foWU3s532v+nvoJfHgHiSwjOf4UAAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="webui" title="" src="/static/a6886faf142fff5d7b6ed8fdb42d33f0/c5bb3/webui.png" srcset="/static/a6886faf142fff5d7b6ed8fdb42d33f0/04472/webui.png 170w,
/static/a6886faf142fff5d7b6ed8fdb42d33f0/9f933/webui.png 340w,
/static/a6886faf142fff5d7b6ed8fdb42d33f0/c5bb3/webui.png 680w,
/static/a6886faf142fff5d7b6ed8fdb42d33f0/b12f7/webui.png 1020w,
/static/a6886faf142fff5d7b6ed8fdb42d33f0/b5a09/webui.png 1360w,
/static/a6886faf142fff5d7b6ed8fdb42d33f0/29007/webui.png 1600w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
<p><span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; ">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+klEQVR42pWQbU+DMBSF+f8/S5PpPkw2NcB4aSkWWijFbcmS4SLH27gsM6kYPzzJbc/t6b0neMlLhEmG8DXBc5TiNH5gAvA5TVemm9rHeD7jeBqxSTgC2RpwqVE2LerOQtkdSt1DtBYlURFRrcDoztXCA1c91LDH42aLwD3i+gIJed1dyQhWGzwxgS19WtxoP/pki8q8YxGSIVMWuTQkEI1B4WEpBOJag/2iO9O3fofFmgy5HsBoMh9u4rTpsOQlIqnobL19zlTaPR7WKQLRDpSZnaUixIzuTJvh8L1y4XJrzB90s3pKK1e08t0qdhn23lz+Q3bJ8H4V4wsH4k7oxFSq1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="webui2" title="" src="/static/52ac3f0c144f0d186e2d73126b7d153d/c5bb3/webui2.png" srcset="/static/52ac3f0c144f0d186e2d73126b7d153d/04472/webui2.png 170w,
/static/52ac3f0c144f0d186e2d73126b7d153d/9f933/webui2.png 340w,
/static/52ac3f0c144f0d186e2d73126b7d153d/c5bb3/webui2.png 680w,
/static/52ac3f0c144f0d186e2d73126b7d153d/b12f7/webui2.png 1020w,
/static/52ac3f0c144f0d186e2d73126b7d153d/b5a09/webui2.png 1360w,
/static/52ac3f0c144f0d186e2d73126b7d153d/29007/webui2.png 1600w" sizes="(max-width: 680px) 100vw, 680px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
    </span>
          </p>
</li>
</ol>
<h3 id="-key-takeaways" style="position:relative;"><a href="#-key-takeaways" aria-label=" key takeaways permalink" class="anchor before"><svg class="anchor-icon" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>üìå Key Takeaways</h3>
<p>In this post, we explored how Argo Workflows and Argo Events can help us better manage and scale Spark applications on Amazon EKS. These tools have several advantages, such as allowing us to create and automate complex pipelines using Argo Workflows, and triggering actions based on events using Argo Events.</p>
<p><strong>Stay tuned for next blogs in this¬†seriesüéâ</strong></p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://spacelift.io/blog/argo-workflows" target="_blank" rel="noopener noreferrer">https://spacelift.io/blog/argo-workflows</a></li>
<li><a href="https://codefresh.io/learn/argo-workflows" target="_blank" rel="noopener noreferrer">https://codefresh.io/learn/argo-workflows</a></li>
<li><a href="https://codefresh.io/learn/argo-workflows/learn-argo-workflows-with-8-simple-examples" target="_blank" rel="noopener noreferrer">https://codefresh.io/learn/argo-workflows/learn-argo-workflows-with-8-simple-examples</a></li>
<li><a href="https://argo-workflows.readthedocs.io/en/latest" target="_blank" rel="noopener noreferrer">https://argo-workflows.readthedocs.io/en/latest</a></li>
<li><a href="https://awslabs.github.io/data-on-eks/docs/blueprints/job-schedulers/argo-workflows-eks" target="_blank" rel="noopener noreferrer">https://awslabs.github.io/data-on-eks/docs/blueprints/job-schedulers/argo-workflows-eks</a></li>
<li><a href="https://aws.amazon.com/blogs/containers/dynamic-spark-scaling-on-amazon-eks-with-argo-workflows-and-events" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/containers/dynamic-spark-scaling-on-amazon-eks-with-argo-workflows-and-events</a></li>
<li><a href="https://mkdev.me/posts/argo-ecosystem-argo-cd-argo-workflows-argo-events-argo-rollouts-argo-everything" target="_blank" rel="noopener noreferrer">https://mkdev.me/posts/argo-ecosystem-argo-cd-argo-workflows-argo-events-argo-rollouts-argo-everything</a></li>
<li><a href="https://dok.community/blog/scheduled-scaling-with-dask-and-argo-workflows/" target="_blank" rel="noopener noreferrer">https://dok.community/blog/scheduled-scaling-with-dask-and-argo-workflows/</a></li>
<li>
<iframe width="100%" height="315" src="https://www.youtube-nocookie.com/embed/FBRMURQYbgw?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</li>
</ul>
<p><strong>Thank You üñ§</strong></p>
<br>
<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>
<blockquote>
<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>
</blockquote>
<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>
<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href="https://www.linkedin.com/in/rajhi-saif/" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/in/rajhi-saif/</a></p>
<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href="https://x.com/rajhisaifeddine" target="_blank" rel="noopener noreferrer">https://x.com/rajhisaifeddine</a></p>
<p><strong>The end ‚úåüèª</strong></p>
<h1 align="center">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>
<p><strong>üìÖ Stay updated</strong></p>
<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p></div></div><div id="content-end"></div></article><div data-nosnippet="" class="social-share-wrapper"><h3>Share Your Love</h3><button keywords="" aria-label="Share Via Facebook" class="react-share__ShareButton social-share-item facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" class="svg-inline--fa fa-facebook " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"></path></svg></button><button keywords="" aria-label="Share Via Twitter" class="react-share__ShareButton social-share-item twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></button><button aria-label="Share Via LinkedIn" keywords="" class="react-share__ShareButton social-share-item linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></button><button keywords="" aria-label="Share Via Reddit" class="react-share__ShareButton social-share-item reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit" class="svg-inline--fa fa-reddit " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M0 256C0 114.6 114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256L37.1 512c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256zM349.6 153.6c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34c-34.5 3.7-61.4 33-61.4 68.4l0 .2c-37.5 1.6-71.8 12.3-99 29.1c-10.1-7.8-22.8-12.5-36.5-12.5c-33 0-59.8 26.8-59.8 59.8c0 24 14.1 44.6 34.4 54.1c2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54c0-33-26.8-59.8-59.8-59.8c-13.7 0-26.3 4.6-36.4 12.4c-27.4-17-62.1-27.7-100-29.1l0-.2c0-25.4 18.9-46.5 43.4-49.9l0 0c4.4 18.8 21.3 32.8 41.5 32.8zM177.1 246.9c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6s-31.4-8.8-30.4-30.5s15.4-38.3 32.1-38.3zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6c-1-21.7 11.8-39.3 28.5-39.3s31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9 .8-6.2 3.9-6.5c18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1 .3 5.1 3.6 3.9 6.5z"></path></svg></button><button keywords="" aria-label="Add to Pocket" class="react-share__ShareButton social-share-item pocket" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="get-pocket" class="svg-inline--fa fa-get-pocket " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M407.6 64h-367C18.5 64 0 82.5 0 104.6v135.2C0 364.5 99.7 464 224.2 464c124 0 223.8-99.5 223.8-224.2V104.6c0-22.4-17.7-40.6-40.4-40.6zm-162 268.5c-12.4 11.8-31.4 11.1-42.4 0C89.5 223.6 88.3 227.4 88.3 209.3c0-16.9 13.8-30.7 30.7-30.7 17 0 16.1 3.8 105.2 89.3 90.6-86.9 88.6-89.3 105.5-89.3 16.9 0 30.7 13.8 30.7 30.7 0 17.8-2.9 15.7-114.8 123.2z"></path></svg></button></div><br/><br/><br/></main><aside class="blogpost-sidebar"><div data-nosnippet="" class="blog-navigation-wrapper"><h3>Read Other Posts</h3><nav class="blog-navigation"><div class="nav-links"><a rel="next" class="next-post" href="/blog/finops-mayfly-kubernetes-ephemeral-resources/">FinOps Best Practices: Using Mayfly Kubernetes Operator for Ephemeral Resources<!-- --> ‚Üí</a><a rel="prev" class="prev-post" href="/blog/carvel-kapp-kubernetes-management/">‚Üê <!-- -->Simplify Kubernetes Application Management with Carvel kapp</a><a class="all-posts" href="/blog/">All Posts</a></div></nav></div></aside><footer data-nosnippet=""><div class="footer-wrapper"><div data-nosnippet="" class="social"><ul class="social-list"><li class="social-item social-linkedin"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="linkedin" href="https://www.linkedin.com/in/rajhi-saif/" title="Saifeddine Rajhi on LinkedIn" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin-in" class="svg-inline--fa fa-linkedin-in fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg><span>LinkedIn</span></a></li><li class="social-item social-github"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="github" href="https://github.com/seifrajhi" title="Saifeddine Rajhi on Github" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span>GitHub</span></a></li><li class="social-item social-email"><a itemProp="email" eventCategory="social" eventAction="click" eventLabel="email" href="mailto:rajhiseif@gmail.com" title="Saifeddine Rajhi&#x27;s Email"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg><span>Email</span></a></li><li class="social-item social-X/Twitter"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="X/Twitter" href="https://x.com/RajhiSaifeddine" title="Saifeddine Rajhi on X/X/Twitter" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="x-twitter" class="svg-inline--fa fa-x-twitter fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg><span>X/Twitter</span></a></li><li class="social-item social-reddit"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="reddit" href="https://www.reddit.com/user/ScoreApprehensive992/" title="Saifeddine Rajhi on Reddit" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="reddit-alien" class="svg-inline--fa fa-reddit-alien fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M373 138.6c-25.2 0-46.3-17.5-51.9-41l0 0c-30.6 4.3-54.2 30.7-54.2 62.4l0 .2c47.4 1.8 90.6 15.1 124.9 36.3c12.6-9.7 28.4-15.5 45.5-15.5c41.3 0 74.7 33.4 74.7 74.7c0 29.8-17.4 55.5-42.7 67.5c-2.4 86.8-97 156.6-213.2 156.6S45.5 410.1 43 323.4C17.6 311.5 0 285.7 0 255.7c0-41.3 33.4-74.7 74.7-74.7c17.2 0 33 5.8 45.7 15.6c34-21.1 76.8-34.4 123.7-36.4l0-.3c0-44.3 33.7-80.9 76.8-85.5C325.8 50.2 347.2 32 373 32c29.4 0 53.3 23.9 53.3 53.3s-23.9 53.3-53.3 53.3zM157.5 255.3c-20.9 0-38.9 20.8-40.2 47.9s17.1 38.1 38 38.1s36.6-9.8 37.8-36.9s-14.7-49.1-35.7-49.1zM395 303.1c-1.2-27.1-19.2-47.9-40.2-47.9s-36.9 22-35.7 49.1c1.2 27.1 16.9 36.9 37.8 36.9s39.3-11 38-38.1zm-60.1 70.8c1.5-3.6-1-7.7-4.9-8.1c-23-2.3-47.9-3.6-73.8-3.6s-50.8 1.3-73.8 3.6c-3.9 .4-6.4 4.5-4.9 8.1c12.9 30.8 43.3 52.4 78.7 52.4s65.8-21.6 78.7-52.4z"></path></svg><span>Reddit</span></a></li><li class="social-item social-stackoverflow"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://stackoverflow.com/users/21897244/saifeddine-rajhi" title="Saifeddine Rajhi on StackOverflow" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="stack-overflow" class="svg-inline--fa fa-stack-overflow fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg><span>StackOverflow</span></a></li><li class="social-item social-Goodreads"><a rel="me" eventLabel="StackOverflow" href="https://www.goodreads.com/user/show/176103378-saifeddine" title="Saifeddine Rajhi on Goodreads" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="goodreads" class="svg-inline--fa fa-goodreads fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M299.9 191.2c5.1 37.3-4.7 79-35.9 100.7-22.3 15.5-52.8 14.1-70.8 5.7-37.1-17.3-49.5-58.6-46.8-97.2 4.3-60.9 40.9-87.9 75.3-87.5 46.9-.2 71.8 31.8 78.2 78.3zM448 88v336c0 30.9-25.1 56-56 56H56c-30.9 0-56-25.1-56-56V88c0-30.9 25.1-56 56-56h336c30.9 0 56 25.1 56 56zM330 313.2s-.1-34-.1-217.3h-29v40.3c-.8.3-1.2-.5-1.6-1.2-9.6-20.7-35.9-46.3-76-46-51.9.4-87.2 31.2-100.6 77.8-4.3 14.9-5.8 30.1-5.5 45.6 1.7 77.9 45.1 117.8 112.4 115.2 28.9-1.1 54.5-17 69-45.2.5-1 1.1-1.9 1.7-2.9.2.1.4.1.6.2.3 3.8.2 30.7.1 34.5-.2 14.8-2 29.5-7.2 43.5-7.8 21-22.3 34.7-44.5 39.5-17.8 3.9-35.6 3.8-53.2-1.2-21.5-6.1-36.5-19-41.1-41.8-.3-1.6-1.3-1.3-2.3-1.3h-26.8c.8 10.6 3.2 20.3 8.5 29.2 24.2 40.5 82.7 48.5 128.2 37.4 49.9-12.3 67.3-54.9 67.4-106.3z"></path></svg><span>Goodreads</span></a></li><li class="social-item social-osi"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://ossinsight.io/analyze/seifrajhi" title="Saifeddine Rajhi on OSSInsights" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="osi" class="svg-inline--fa fa-osi fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M8 266.44C10.3 130.64 105.4 34 221.8 18.34c138.8-18.6 255.6 75.8 278 201.1 21.3 118.8-44 230-151.6 274-9.3 3.8-14.4 1.7-18-7.7q-26.7-69.45-53.4-139c-3.1-8.1-1-13.2 7-16.8 24.2-11 39.3-29.4 43.3-55.8a71.47 71.47 0 0 0-64.5-82.2c-39-3.4-71.8 23.7-77.5 59.7-5.2 33 11.1 63.7 41.9 77.7 9.6 4.4 11.5 8.6 7.8 18.4q-26.85 69.9-53.7 139.9c-2.6 6.9-8.3 9.3-15.5 6.5-52.6-20.3-101.4-61-130.8-119-24.9-49.2-25.2-87.7-26.8-108.7zm20.9-1.9c.4 6.6.6 14.3 1.3 22.1 6.3 71.9 49.6 143.5 131 183.1 3.2 1.5 4.4.8 5.6-2.3q22.35-58.65 45-117.3c1.3-3.3.6-4.8-2.4-6.7-31.6-19.9-47.3-48.5-45.6-86 1-21.6 9.3-40.5 23.8-56.3 30-32.7 77-39.8 115.5-17.6a91.64 91.64 0 0 1 45.2 90.4c-3.6 30.6-19.3 53.9-45.7 69.8-2.7 1.6-3.5 2.9-2.3 6q22.8 58.8 45.2 117.7c1.2 3.1 2.4 3.8 5.6 2.3 35.5-16.6 65.2-40.3 88.1-72 34.8-48.2 49.1-101.9 42.3-161-13.7-117.5-119.4-214.8-255.5-198-106.1 13-195.3 102.5-197.1 225.8z"></path></svg><span>OSSInsights</span></a></li><li class="social-item social-devstats"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="StackOverflow" href="https://devstats.cluster.fun/?user=seifrajhi" title="Saifeddine Rajhi on DevStats" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chart-line" class="svg-inline--fa fa-chart-line fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64L0 400c0 44.2 35.8 80 80 80l400 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 416c-8.8 0-16-7.2-16-16L64 64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"></path></svg><span>DevStats</span></a></li><li class="social-item social-RSS"><a rel="me" itemProp="url" eventCategory="social" eventAction="click" eventLabel="RSS" href="https://seifrajhi.github.io/rss.xml" title="Subscribe to my blog post" target="blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-beat fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path></svg><span>RSS</span></a></li></ul></div><div class="copyright">Saifeddine Rajhi ¬© 1994 - <!-- -->2024<!-- --> <br/><a rel="license" href="https://creativecommons.org/licenses/by/4.0/" title="Content is published under CC BY 4.0 license">CC BY 4.0</a></div><div class="pgp"><a href="https://keybase.io/saifrajhi">0C3B BABB 8BC1 EA2B</a></div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/data-on-kubernetes-argo-workflows-4/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-26cd7e4ffafe4b5866ba.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-88fb5c28d68e831e730a.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-83bdb4e48c18bf191297.js\"],\"component---src-pages-blog-js\":[\"/component---src-pages-blog-js-6c9f539d882b31737b03.js\"],\"component---src-pages-cv-platform-engineer-js\":[\"/component---src-pages-cv-platform-engineer-js-13625961a6abec0cbdf1.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-391336a56f413aaa34c1.js\"],\"component---src-pages-thoughts-js\":[\"/component---src-pages-thoughts-js-fe54f831bbb3f7f31564.js\"],\"component---src-templates-blog-template-js\":[\"/component---src-templates-blog-template-js-43b163172ed2ce4e492d.js\"],\"component---src-templates-thought-template-js\":[\"/component---src-templates-thought-template-js-7ddf4a0a920bf599f1a2.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="0ebd81c81e97d97f085d";</script><script src="/webpack-runtime-3d388d6978483882f4b9.js" async></script><script src="/framework-c989293af61a95023f7f.js" async></script><script src="/app-26cd7e4ffafe4b5866ba.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>