{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/pod-lifecycle-journey/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Key states of a Pod lifecycle</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📚 Introduction</h2>\n<p>The Pod lifecycle is crucial to managing containers in a Kubernetes environment. Understanding the pod lifecycle is important because it provides insight into the different stages that a pod goes through, from creation to termination, and the actions that are taken by the system at each stage.</p>\n<p>This understanding is necessary to effectively manage containerized applications in a production environment.</p>\n<h2 id=\"understanding-the-podsstatus\" style=\"position:relative;\"><a href=\"#understanding-the-podsstatus\" aria-label=\"understanding the podsstatus permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Understanding the pod's status</h2>\n<p>A Pod is a tiny universe of containers, housing your applications and breathing life into your cluster.</p>\n<p>Understanding the different stages of the pod lifecycle is important for several reasons:</p>\n<ul>\n<li><strong>Visibility into the status of pods:</strong> The pod lifecycle provides insight into the current state of a pod, whether it's pending, running, failed, or terminated.</li>\n<li><strong>Debugging and troubleshooting:</strong> When a pod fails, it's important to understand what stage of the lifecycle it's in, and what caused the failure.</li>\n<li><strong>Resource management:</strong> Knowing the different stages of the pod lifecycle can help in managing resources effectively. For example, if a pod is in the pending state, it means that it's waiting to be scheduled, and its resources are not being used.</li>\n<li><strong>Scheduling:</strong> Understanding the pod lifecycle can help in scheduling pods effectively.</li>\n</ul>\n<h2 id=\"states-of-apod\" style=\"position:relative;\"><a href=\"#states-of-apod\" aria-label=\"states of apod permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>States of a Pod</h2>\n<p>The pod's <em>status field</em> is a <a href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#podstatus-v1-core\" target=\"_blank\" rel=\"noopener noreferrer\">PodStatus</a> object, which has a phase field.</p>\n<p>Throughout its lifecycle, a Pod is likely to be present in any of the below-mentioned phases:</p>\n<ul>\n<li><strong>Pending:</strong> After you create the Pod object, this is its initial phase. Until the pod is scheduled to a node and the images of its containers are pulled and started, it remains in this phase.</li>\n<li><strong>Running:</strong> A Pod is said to be in the running phase when it's linked to a node, and all the containers are active.</li>\n<li><strong>Succeeded:</strong> All Containers in the Pod have terminated in success, and will not be restarted</li>\n<li><strong>Failed:</strong> All container(s) of the Pod have exited and at least one container has returned non-zero status.</li>\n<li><strong>Unknown:</strong> When there is no clarity on where and what a Pod is doing, it is said to be present in an unknown phase.</li>\n<li><strong>CrashLoopBackoff:</strong> The container fails to start and is tried again and again.</li>\n</ul>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVR42j2RW2vCQBCF8/9/R/HFPrXV+tBSEAr1xTRqiNBGglZizMVoYpLdXL7uBvQsu8wOM2fnnDWWyyWWZbFYLEjiGI2maTBNk9lshuOsKYqCGzq1yrJUeYfVaoVt23ie1/doGKfTiTRNVVHFtZR0HbTq0PkkOhKHAV3b3AnbtkXKWtV1fayJdHyDoS913VDLinQ7JnYHiLNN3cKnnfL8FbL0Ms2En/zxsRoxdSakeYKopOqte2K974RCStpGcPUnRD8PlIlFIVo+vkMep3vM3xShZO/iLW/OmHdFGOcxl/OFJEl62a7rqsklRhRFBEHA4XBg7wdkeYEWUNdSeRoSBj7XPEMoadftjuPTC+HoFamIpMppu7T/2s8syzDW63X/AfpjzPm8J9YyGmWDjl130/upHzlvNniDAbvhkNz3ydTUoqoQQtx9/AdyjcF6NuDz6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/ec06dbde20e8606c4698ebd0104643c6/c5bb3/states.png\" srcset=\"/static/ec06dbde20e8606c4698ebd0104643c6/04472/states.png 170w,\n/static/ec06dbde20e8606c4698ebd0104643c6/9f933/states.png 340w,\n/static/ec06dbde20e8606c4698ebd0104643c6/c5bb3/states.png 680w,\n/static/ec06dbde20e8606c4698ebd0104643c6/5a190/states.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"creation-of-apod\" style=\"position:relative;\"><a href=\"#creation-of-apod\" aria-label=\"creation of apod permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Creation of a Pod</h2>\n<p>To help understand how this works, let's work through an example of how things get done in Kubernetes.</p>\n<p>Now let's look at the events that lead to the creation of a Pod:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.47058823529413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR42n1TXWiSYRT+9k3XtrRaqxisn0FWzIVtubVWbkJZCRZ4Y1ExBC8G3XQl2I14ISLILnYlbuwHB5uyBYqKiuK805v9ICqoKKLi/EHBm4JdxNc58n0kZXvh5Zz3nOc87znP936ETCYbpShqsF6v1/L5PFUqlc4qlYqv1WqdNRoNqtls1k9PT4PlcpmqVqtUsVgMYgwsVavVfkA8CPFfhUKBAvxPQiAQXIxEIu+Oj4/VoVDoBZDOHR0dvUQbj8efQ+FMOp0eTyaTC7lcTpRIJPhQPB2LxRYymcxTwIwjNpVKiQA3S/D5fI7NZnu2srJyOxAIvAmHwzf39/dnDQbDdYiPE7Bggh4wLNhomdV5RtvLJLh0AeFyuWasVuuwTqcj7Xb7I5/PN39ycnIFc0tLS2yxWMwCLIlbKpVeABwLsWjxjHHEYoKkSQdgc1QqFdfj8XyDjr9vbm7OI0ir1QodDsetczpkMYk+pkO/3y8FcsHe3p4MLH9jY+MtdoU50FkM2go7JaC7w67IzpH7mFaj0egH0PIextRq9Yjb7X7IgIBsDkgf/0fTHubiNiHjwG0jEonkMsqAN66trU3AmJ9g9I+rq6sSKOIgEY/Hw3w/THIVXsaE1+u91CHFH0JYbPqM7bM1Gs3Y7u7uNBQ+MRqNYxgH0n60EJMCkejg4OCzxWKZQ1zXDuGhD+3s7AyhLtDhfSj6EgwGv25vb79CIqVSiYQEEoEko+gvLy9fczqdU/9oCBq9N5lMk+vr66/lcvlds9k8dXh4yAYwV6FQcOjO2uJDXJHNZm+gD7nevz9KW1x82Hq9/g76i4uLw0D4AH2hUIhSDKK2tN+7tbU1CX/RAD0Z2fWjnPe2aH3Jjhy7G/Y3YhRYEAbbfksAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/7bc02db52bab1b7fde9684cb20e0cdd6/c5bb3/creation.png\" srcset=\"/static/7bc02db52bab1b7fde9684cb20e0cdd6/04472/creation.png 170w,\n/static/7bc02db52bab1b7fde9684cb20e0cdd6/9f933/creation.png 340w,\n/static/7bc02db52bab1b7fde9684cb20e0cdd6/c5bb3/creation.png 680w,\n/static/7bc02db52bab1b7fde9684cb20e0cdd6/5a190/creation.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>This sequence diagram illustrates the standard process for scheduling a Pod.</p>\n<p>It depicts the infrequent scenario where the user directly creates a Pod. More commonly, the user creates an object such as a ReplicaSet, and it is the ReplicaSet that generates the Pod.</p>\n<ol>\n<li>kubectl or any other API client submits the Pod spec to the API server.</li>\n<li>The API server writes the Pod object to the etcd data store. Once the write is successful, an acknowledgment is sent back to the API server and the client.</li>\n<li>The API server now reflects the change in the state of etcd.</li>\n<li>In this case, the Kube-scheduler sees that a new Pod object is created on the API server but is not bound to any node.</li>\n<li>kube-scheduler assigns a node to the pod and updates the API server.</li>\n<li>This change is then propagated to the etcd data store. The API server also reflects this node assignment on its Pod object.</li>\n<li>Kubelet on every node also runs watchers who keep watching API server. Kubelet on the destination node sees that a new Pod is assigned to it.</li>\n<li>Kubelet starts the pod on its node by calling Docker and updates the container state back to the API server.</li>\n<li>The API server persists the pod state into etcd.</li>\n</ol>\n<h2 id=\"container-probes\" style=\"position:relative;\"><a href=\"#container-probes\" aria-label=\"container probes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Container probes</h2>\n<p>Container probes are used in Kubernetes to monitor the health and status of containers in a pod.\nThese probes provide important information to the Kubernetes control plane, allowing it to make decisions about the state of containers and pods, and to ensure that they are running optimally.</p>\n<p>The kubelet can optionally perform and react to three kinds of probes on running Containers:</p>\n<ul>\n<li><strong>Liveness probes:</strong> Liveness probes are used to check if a container is running and healthy. If the liveness probe fails, the container is automatically restarted.</li>\n<li><strong>Readiness probes:</strong> Readiness probes determine when a container is ready to start accepting traffic. This can be useful when a container needs time to start or finish a task before it can handle the traffic.</li>\n<li><strong>Startup probes:</strong> Startup probes are used to check if a container has successfully started and is initialized. Unlike liveness and readiness probes, startup probes only run once, and only during container startup.</li>\n</ul>\n<p>Each type of probe serves a different purpose and is used in different stages of a container's lifecycle.</p>\n<h2 id=\"final-thoughts\" style=\"position:relative;\"><a href=\"#final-thoughts\" aria-label=\"final thoughts permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Final Thoughts</h2>\n<p>In a nutshell, the container lifecycle and creation process involves pulling an image from a registry, creating a new container instance from the image, and running it through several stages of initialization and operation. Startup probes are used to verify that the container has started successfully, while readiness probes determine when the container is ready to handle the traffic.</p>\n<p>During operation, liveness probes are used to monitor the container's health and determine if a restart is necessary. These probes play a crucial role in ensuring the reliability and stability of containers.</p>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  <em><strong>Until next time 🎉</strong></em></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":4,"rawMarkdownBody":"\n> **Key states of a Pod lifecycle**\n\n## 📚 Introduction\n\nThe Pod lifecycle is crucial to managing containers in a Kubernetes environment. Understanding the pod lifecycle is important because it provides insight into the different stages that a pod goes through, from creation to termination, and the actions that are taken by the system at each stage.\n\nThis understanding is necessary to effectively manage containerized applications in a production environment.\n\n## Understanding the pod's status\n\nA Pod is a tiny universe of containers, housing your applications and breathing life into your cluster.\n\nUnderstanding the different stages of the pod lifecycle is important for several reasons:\n\n* **Visibility into the status of pods:** The pod lifecycle provides insight into the current state of a pod, whether it's pending, running, failed, or terminated.\n* **Debugging and troubleshooting:** When a pod fails, it's important to understand what stage of the lifecycle it's in, and what caused the failure.\n* **Resource management:** Knowing the different stages of the pod lifecycle can help in managing resources effectively. For example, if a pod is in the pending state, it means that it's waiting to be scheduled, and its resources are not being used.\n* **Scheduling:** Understanding the pod lifecycle can help in scheduling pods effectively.\n\n## States of a Pod\n\nThe pod's _status field_ is a [PodStatus](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#podstatus-v1-core) object, which has a phase field.\n\nThroughout its lifecycle, a Pod is likely to be present in any of the below-mentioned phases:\n\n* **Pending:** After you create the Pod object, this is its initial phase. Until the pod is scheduled to a node and the images of its containers are pulled and started, it remains in this phase.\n* **Running:** A Pod is said to be in the running phase when it's linked to a node, and all the containers are active.\n* **Succeeded:** All Containers in the Pod have terminated in success, and will not be restarted\n* **Failed:** All container(s) of the Pod have exited and at least one container has returned non-zero status.\n* **Unknown:** When there is no clarity on where and what a Pod is doing, it is said to be present in an unknown phase.\n* **CrashLoopBackoff:** The container fails to start and is tried again and again.\n\n![alt text](./states.png)\n\n## Creation of a Pod\n\nTo help understand how this works, let's work through an example of how things get done in Kubernetes.\n\nNow let's look at the events that lead to the creation of a Pod:\n\n![alt text](./creation.png)\n\nThis sequence diagram illustrates the standard process for scheduling a Pod.\n\nIt depicts the infrequent scenario where the user directly creates a Pod. More commonly, the user creates an object such as a ReplicaSet, and it is the ReplicaSet that generates the Pod.\n\n1. kubectl or any other API client submits the Pod spec to the API server.\n2. The API server writes the Pod object to the etcd data store. Once the write is successful, an acknowledgment is sent back to the API server and the client.\n3. The API server now reflects the change in the state of etcd.\n4. In this case, the Kube-scheduler sees that a new Pod object is created on the API server but is not bound to any node.\n5. kube-scheduler assigns a node to the pod and updates the API server.\n6. This change is then propagated to the etcd data store. The API server also reflects this node assignment on its Pod object.\n7. Kubelet on every node also runs watchers who keep watching API server. Kubelet on the destination node sees that a new Pod is assigned to it.\n8. Kubelet starts the pod on its node by calling Docker and updates the container state back to the API server.\n9. The API server persists the pod state into etcd.\n\n\n## Container probes\n\nContainer probes are used in Kubernetes to monitor the health and status of containers in a pod.\nThese probes provide important information to the Kubernetes control plane, allowing it to make decisions about the state of containers and pods, and to ensure that they are running optimally.\n\nThe kubelet can optionally perform and react to three kinds of probes on running Containers:\n\n* **Liveness probes:** Liveness probes are used to check if a container is running and healthy. If the liveness probe fails, the container is automatically restarted.\n* **Readiness probes:** Readiness probes determine when a container is ready to start accepting traffic. This can be useful when a container needs time to start or finish a task before it can handle the traffic.\n* **Startup probes:** Startup probes are used to check if a container has successfully started and is initialized. Unlike liveness and readiness probes, startup probes only run once, and only during container startup.\n\nEach type of probe serves a different purpose and is used in different stages of a container's lifecycle.\n\n## Final Thoughts\n\nIn a nutshell, the container lifecycle and creation process involves pulling an image from a registry, creating a new container instance from the image, and running it through several stages of initialization and operation. Startup probes are used to verify that the container has started successfully, while readiness probes determine when the container is ready to handle the traffic.\n\nDuring operation, liveness probes are used to monitor the container's health and determine if a restart is necessary. These probes play a crucial role in ensuring the reliability and stability of containers.\n\n<br>\n\n**_Until next time, つづく 🎉_**\n\n> 💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  _**Until next time 🎉**_\n\n🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**♻️ LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**♻️ X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ✌🏻**\n\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n\n**📅 Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":948},"frontmatter":{"id":"17ad0902cd482a329678044d","path":"/blog/pod-lifecycle-journey/","humanDate":"Oct 16, 2024","fullDate":"2024-10-16","title":"The journey of a pod: The world of pod lifecycle","keywords":["Pod lifecycle","Pod management","Optimization","Kubernetes"],"excerpt":"The journey of a pod through its lifecycle involves several key states, each critical to its functionality and performance.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC7UlEQVR42j2R309TdxjGz+3+ABMzjWa72Y3Bm02yRGMiMRqFCOoizMUli9sMKmrQoIsCOqzMzbAhqFVaoD/EQ39ZemwptGI1rMX2lAKlCDK2jlLGDwvT3X/27THh4sn7Pc/3+zzv875HyoT1LMTN5FIe3r7u453AyoSP3IR3reZSXlYnfay+8mncm9R7bg3izfK4QjbuQlqKt+O3NOA0XMfSWsedG9XYHzQQ6P5Vq9bWWrzWX5DvXaXtVg2PRLXf/xFLyxVcRh3m21ewttSimG4yqzqQsjEzEyETqt9I1G8g8kRPItBBKmRh9Gknz12thD16jR8SiPraSA6YtDu1zyC+HxBR9MQEn4k5kTJRK0vJJ7wR4+SxOtnLyqte/p3yk47aGX9mYSTYycxLG9mEW6Rwko45yI64tdEXRz0sjgmM9pARd9JcrIvMsJ2sINKqiz9f2pka7GLq90dMh2VNvCAEc8OPGRswM9zfLpIZxdmkmc+JveWNZkW6jNBLGbWLXMLJ25TC4ogwHOpm7Nl7YV6UjjrWkkV7DRo3HOhkclDmL9E8IxrOCuTrXN5wPmajP2zC+dyDN+hlSlVYTirMi5HGQ2YtTbyvnWTIKgxkpiOigSqzNGJjWfzddzMBVsSa5kVTbeTpmMz1gdtEIgpyrxdlwMWCauNv0S2b6BEGsraCfxIOUtEAsjuIUX6Bwz1IsLORjvrTuJpref3iobZH6WjpDiprKmjW6bijq6L7t2O4Gytp+v4AZ/YW8tOxXZiqi/HpSmlp+IH6mx1U1cuUn/VQUVTG/o82cHBrARcO7eH4ns+Rvij4kKZvytEdKebutQoCPY0sjfuQhWnz2XLcTdXIDd9xfl8BJ7Zv5lLVOU6d+ZmT39ZSd7SUko83cfHLEr76dAvb132AZKzcge3yYfx361B9etJjCvHHt/gj3MV/iwlyMyGSQQPXKnZSV/YZbecPc+94IY7LxVw6WERNyU5O7S6kaON6vt72Cf8DF2eT3mItDZAAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/2c2d76c4ffebe40444fde1e87c1f75b7/f31ff/lifecycle-cover.png","srcSet":"/static/2c2d76c4ffebe40444fde1e87c1f75b7/d0df2/lifecycle-cover.png 750w,\n/static/2c2d76c4ffebe40444fde1e87c1f75b7/fa96f/lifecycle-cover.png 1080w,\n/static/2c2d76c4ffebe40444fde1e87c1f75b7/ad399/lifecycle-cover.png 1366w,\n/static/2c2d76c4ffebe40444fde1e87c1f75b7/f31ff/lifecycle-cover.png 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/2c2d76c4ffebe40444fde1e87c1f75b7/b9516/lifecycle-cover.webp 750w,\n/static/2c2d76c4ffebe40444fde1e87c1f75b7/c4814/lifecycle-cover.webp 1080w,\n/static/2c2d76c4ffebe40444fde1e87c1f75b7/2a401/lifecycle-cover.webp 1366w,\n/static/2c2d76c4ffebe40444fde1e87c1f75b7/3a03f/lifecycle-cover.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5614583333333334}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/helm-charts-in-depth/","title":"An in-depth guide to building a Helm chart from the ground up","date":"2024-10-16 17:06:00"},"excerpt":"Helm chart management in Kubernetes 📌 Overview As more and more companies move to containerized applications and Kubernetes, deployment…","html":"<blockquote>\n<p><strong>Helm chart management in Kubernetes</strong></p>\n</blockquote>\n<h2 id=\"-overview\" style=\"position:relative;\"><a href=\"#-overview\" aria-label=\" overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📌 Overview</h2>\n<p>As more and more companies move to containerized applications and Kubernetes, deployment automation has become increasingly important. However, with the complexity of Kubernetes, deployment can still be challenging, especially for those new to the platform.</p>\n<p>However, Kubernetes deployments can be complex and time-consuming, particularly when deploying multiple applications or services. This can lead to delays and decreased productivity, as developers struggle to keep up with the demands of deployment.</p>\n<p>How can we simplify and automate the deployment process in Kubernetes, while still ensuring maximum efficiency and scalability?</p>\n<h2 id=\"-goals--objectives\" style=\"position:relative;\"><a href=\"#-goals--objectives\" aria-label=\" goals  objectives permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🎯 Goals &#x26; Objectives</h2>\n<p>The answer lies in Helm charts. Helm is a great Kubernetes package manager that allows developers to define, install, and upgrade complex Kubernetes applications.</p>\n<p>In this blog post, we'll provide a step-by-step guide on creating your custom Helm chart, covering its essential components and best practices for optimal performance.</p>\n<p><strong>Prerequisites</strong></p>\n<p>In order to begin using helm charts, there are certain requirements that you must have:</p>\n<ul>\n<li><a href=\"https://kubernetes.io/docs/setup/\" target=\"_blank\" rel=\"noopener noreferrer\">A working Kubernetes cluster</a>.</li>\n<li><a href=\"https://helm.sh/docs/intro/install/\" target=\"_blank\" rel=\"noopener noreferrer\">Helm installed</a> locally.</li>\n</ul>\n<h2 id=\"get-started-with-helm-chart\" style=\"position:relative;\"><a href=\"#get-started-with-helm-chart\" aria-label=\"get started with helm chart permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Get started with Helm chart</h2>\n<p>Helm charts are packages of Kubernetes YAML manifest files that define a set of Kubernetes resources needed to deploy and run an application or service on a Kubernetes cluster. Helm is a package manager for Kubernetes that allows you to define, install, and manage complex applications on Kubernetes clusters.\nLet's imagine we have an nginx project that consists of four different environments: <code class=\"language-text\">Development</code>, <code class=\"language-text\">QA</code>, <code class=\"language-text\">Staging</code>, and <code class=\"language-text\">Production</code>.</p>\n<p>In each of these environments, the parameters required for deploying <code class=\"language-text\">Nginx</code> may vary.</p>\n<p>For instance, the <strong>number of replicas</strong> needed for Nginx deployment may differ, as well as the ingress routing rules, configuration and secret parameters, and other environment-specific settings.</p>\n<p>Due to the variations in configuration and deployment parameters required for each environment, it can become cumbersome to manage multiple nginx deployment files for each environment.</p>\n<p>Alternatively, we could use a single deployment file and create a custom shell or Python script to update values based on the environment. However, this approach is not scalable and can lead to inefficiencies.</p>\n<p>This is where Helm charts come in. Helm charts are a package of Kubernetes YAML manifest templates and Helm-specific files that allow for templating.</p>\n<p>By using a Helm chart, we only need to maintain one file that can be customized for each environment through a single values file.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVR42rWTS07cQBCGB8g6Cw6QdW4AK9hwBLzKPcglWHMChJSITXYRSCgIEBLvR5jMYFuJ5Wf8HL+Gtt1dP21mMiJKUMiCkj5Vdav7Uy2qOp1xAJiSzEz4+Kj+N9OdF4u2s3GerThXeIvlKlVPfcgtcH0FlsQY1ZVhKZVqKaXzc1m+f8cYeztx/WqXapqXNYELMMOjzPDRxCV4UoIFGaogRWbGGNgphl6OwhtABEmDUbwfC19NhDLP+VHGq2JI+oXKbzRTdG9Nof3wxDfdF5rhC8OOhBekQr4VRc0F96NqLFz5q9C0AlHEOXoHZ8L1bIrDiC6vHYqThtruo6Sk825AjI3O+q1dB/ETHZZlOafqDhVhAndzg9Ikx1FXxebOIY6/agijO3za/YL1z1swnRyX/T5WP6w12+cnGAzYn8IwTOe1VlgyFGlOaVY9fNq/usCNZsF0Y+ydHUiO0Pvu4OT6FLvHO82V3odm2r8Jp0bC8DURLQ7relHePZcFyZLkzeOJebl5/I/NeHJT7gFb0Q+4LE+nNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Alt text\" title=\"\" src=\"/static/c00a75c73fc80b3f56b13303180e752d/c5bb3/use-cases.png\" srcset=\"/static/c00a75c73fc80b3f56b13303180e752d/04472/use-cases.png 170w,\n/static/c00a75c73fc80b3f56b13303180e752d/9f933/use-cases.png 340w,\n/static/c00a75c73fc80b3f56b13303180e752d/c5bb3/use-cases.png 680w,\n/static/c00a75c73fc80b3f56b13303180e752d/5a190/use-cases.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"helm-chart-tree-structure\" style=\"position:relative;\"><a href=\"#helm-chart-tree-structure\" aria-label=\"helm chart tree structure permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Helm Chart tree structure</h2>\n<p>Below is a typical tree structure of the Helm Chart repository:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">nginx/\n├── charts\n├── Chart.yaml\n├── templates\n│   ├── deployment.yaml\n│   ├── _helpers.tpl\n│   ├── hpa.yaml\n│   ├── ingress.yaml\n│   ├── NOTES.txt\n│   ├── serviceaccount.yaml\n│   ├── service.yaml\n│   └── tests\n│       └── test-connection.yaml\n└── values.yaml</code></pre></div>\n<p>The «nginx/» directory is the root directory of the Helm chart.</p>\n<p>The «Chart.yaml» file describes the chart, including its <code class=\"language-text\">version</code>, <code class=\"language-text\">name</code>, and <code class=\"language-text\">other metadata</code>.</p>\n<p>The «values.yaml» file contains the default configuration values for the chart.</p>\n<p>The «templates/» directory contains the Kubernetes YAML manifest templates that define the resources and configurations needed to deploy Nginx on a Kubernetes cluster. These templates are processed by Helm during the deployment process.</p>\n<p>The «deployment.yaml» file defines the nginx deployment, including the container image, replicas, and other deployment-related parameters.</p>\n<p>The «service.yaml» file defines the Kubernetes service for the Nginx deployment, which allows other pods within the cluster to access the nginx deployment.</p>\n<h2 id=\"hands-on-creation-of-a-custom-helm-chart\" style=\"position:relative;\"><a href=\"#hands-on-creation-of-a-custom-helm-chart\" aria-label=\"hands on creation of a custom helm chart permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-on: Creation of a custom Helm chart</h2>\n<p>To gain practical experience with creating Helm charts, we will create an <strong>Nginx chart from scratch</strong>.</p>\n<p>We can start by using the following command to generate the chart. This will create a chart named <code class=\"language-text\">nginx-demo</code> with the default files and folders.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm create nginx-demo</code></pre></div>\n<p>This will create the following files and directories:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">nginx-demo/\n├── charts\n├── Chart.yaml\n├── templates\n│   ├── deployment.yaml\n│   ├── _helpers.tpl\n│   ├── hpa.yaml\n│   ├── ingress.yaml\n│   ├── NOTES.txt\n│   ├── serviceaccount.yaml\n│   ├── service.yaml\n│   └── tests\n│       └── test-connection.yaml\n└── values.yaml\n\n<span class=\"token number\">3</span> directories, <span class=\"token number\">10</span> files</code></pre></div>\n<p>Now let's customize the necessary file.</p>\n<p><strong>Chart.yaml</strong></p>\n<p><code class=\"language-text\">Chart.yaml</code> is a YAML file that contains metadata about the Helm chart.</p>\n<p>This file is located in the root directory of the chart and is required for every chart.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v2\n<span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>demo\n<span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> My First Helm Chart\n<span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> application\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> 0.1.0\n<span class=\"token key atrule\">appVersion</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.0.0\"</span>\n<span class=\"token key atrule\">maintainers</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span> rajhiseif@gmail.com\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Saif the Containernerd</code></pre></div>\n<p>Where the fields in <code class=\"language-text\">Chart.yaml</code> are mainly:</p>\n<ul>\n<li><strong>name</strong>: The name of the chart.</li>\n<li><strong>version</strong>: The version of the chart.</li>\n<li><strong>description</strong>: A brief description of the chart.</li>\n<li><strong>apiVersion</strong>: The version of the Helm API that the chart is built for.</li>\n<li><strong>appVersion</strong>: The version of the application that the chart is deploying.</li>\n<li><strong>maintainers</strong>: A list of maintainers and their contact information.</li>\n</ul>\n<p>We should increment the <code class=\"language-text\">version</code> and <code class=\"language-text\">appVersion</code> each time we make changes to the application.</p>\n<p>There are some other fields also like <code class=\"language-text\">dependencies</code>, which specify other charts that this chart depends on, and <code class=\"language-text\">keywords</code>, which help in searching for the chart.</p>\n<p><strong>templates</strong></p>\n<p>We will delete all the default files in the templates directory by using the command <code class=\"language-text\">rm templates/*</code>, leaving an empty directory ready for you to add your own templates.</p>\n<p>To improve comprehension, we will convert our nginx YAML files into templates.</p>\n<p>To do so, start by creating a <code class=\"language-text\">deployment.yaml</code> file and then paste the following content into it.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>deployment\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"nginx:1.16.0\"</span>\n          <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> IfNotPresent\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http\n              <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP</code></pre></div>\n<p>The YAML file above has static values. Helm charts allow for templating of YAML files, enabling reuse across multiple environments with dynamic value assignment. To template a value, add the object parameter in curly braces as a template directive, using syntax specific to the Go templating.</p>\n<p>When working with Helm, there are three main keywords that you will encounter frequently: <strong>Release</strong>, <strong>Chart</strong>, and <strong>Values</strong>. Understanding the purpose and functionality of each of these keywords is essential for creating and managing Helm charts effectively.</p>\n<p><strong>Release</strong>\nA release is an instance of a chart running in a Kubernetes cluster. It is a specific version of a chart that has been installed with a unique name and set of configuration options.</p>\n<p><strong>Chart</strong>\nA chart is a collection of files that describe a set of Kubernetes resources. It includes templates for YAML files, default configuration values, and metadata such as the chart name and version.</p>\n<p><strong>Values</strong>\nValues are the configuration options that are used to configure a chart. They are defined in a <code class=\"language-text\">values.yaml</code> file and can be overridden when installing or upgrading a release. Values can also be passed to a chart through the command line or environment variables.</p>\n<p>The built-in objects are substituted in a template, as shown in the image below:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 79.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADd0lEQVR42pWTW28TVxSFRy1JyI3E8XiutmfsGXt8SwJVxeXPtCYh/JPyQKXywKVIVZWE/8ArRSoClEjYIQaKKOSGQlBS1Dap7Ta2P/ZMUp7bkZa3z5xz1l577T1Kt9vlv6LX63H09CLs7u7SaKzy8uUvHBzsRzsK//Np/dNl+0OPt3sdNvfavH63z9sPh2z/3mXrtw7Ki+dPqTVWqNXqPKnVJGOD589esPq0Qb2+8gm12grNvw7Yb3VZ3viDn3/d5n59k4eN96xstFjdbEdQAscgYanEYyqaaZJMOSQzDlpgcioT+4RRN8bdh3f5kwP2Oi2adDjs9vi7A51jK8JfpWilmM76FEtlSuVJ9LRFrKyiJvUogWYJTEmq6ywtL9Fqtlj44Tbf377Jt1evcuXKN1y79h03blzn1q2bKJ5pMZXOYGYCQRmrUMEIiriOT8pxUBNCrJrEExpLT5ZpvG5g66J4dIixU+OMT8QZGhml/+QgY7EJFMeyKSRTOFkPS4g1IylIodlpdDON5liovsa4F+en+n0a688oOC452XcyHkn5bwiHLsLSbgbFlcV0Mk1OYDs5UVnAdIPjWER3RWVGY0IUho1b29jAEwG+3HMyPn4+kJgVSwzsVBrFMEzOCNmkZHNdF1XTSGi6QDuG+KcaxNWQsBYR5uW8L8rcXI6U3NGETJU7EWG4KNlJKnJIs6Rc3YyyJYx/oxHFeOKIcH1jk0BKm3KzFHJ5fFFnyH0jUpxFCQ9npP6cnSIjL0IvImXSjAi6HimeUBPU6nXevFkjNjzC8OAQAwOD9J3o5/O+fj470Rc1R1GF0DQsyqIwSIsXXgk7fwb79BfoFU+yu+i2+CjKl5aWabfbzM8vsLiwyLzgx/l5iQsRFu/cQbFFuiVzGOSLTBcnCQR+6TSmnydRTJKYEiuyKVFq8ujR42iA2+0mzXYrIj88PKTVatNsHa2VsNWu51GRbk0J8uJL1vNlmG0MzcJIWmh5Mb2g8aD+gK2dLaZKviiXrkpVroybKR7G4irnzl9AGRAv+kM/BNboGG4sjiXexWVoh8WrwSHByRH6hwa59/ger96/kolwKDlZypVKNHshcdiLL8+eQ6nOzFKdmaF6cYa52UtclvXc3GVmL81RrV6M3of7X31dZW1tnXc7O/KpegQpGW6pJimEocJwCs6ev8BH4OO1o0BPNHsAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Alt text\" title=\"\" src=\"/static/016f289ca19b65a847b00833fc77e825/c5bb3/substitute.png\" srcset=\"/static/016f289ca19b65a847b00833fc77e825/04472/substitute.png 170w,\n/static/016f289ca19b65a847b00833fc77e825/9f933/substitute.png 340w,\n/static/016f289ca19b65a847b00833fc77e825/c5bb3/substitute.png 680w,\n/static/016f289ca19b65a847b00833fc77e825/5a190/substitute.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>First, identify which values in your YAML file could potentially change or that you want to templatize. In this example, we will templatize the following:</p>\n<ul>\n<li>\n<p><strong>Deployment Name</strong>: <code class=\"language-text\">name: {{ .Release.Name }}-nginx</code></p>\n<ul>\n<li>To avoid the installation of releases with the same name, we need to templatize the deployment name with the release name and interpolate <code class=\"language-text\">-nginx</code> along with it. This guarantees unique deployment names.</li>\n</ul>\n</li>\n<li>\n<p><strong>Container Name</strong>: <code class=\"language-text\">name: {{ .Chart.Name }}</code></p>\n<ul>\n<li>To name the container, we will make use of the Chart object and assign the chart name from the <code class=\"language-text\">Chart.yaml</code> file.</li>\n</ul>\n</li>\n<li>\n<p><strong>Replicas</strong>: <code class=\"language-text\">replicas: {{ .Values.replicaCount }}</code></p>\n<ul>\n<li>We will access the replica value from the <code class=\"language-text\">values.yaml</code> file.</li>\n</ul>\n</li>\n<li>\n<p><strong>Image</strong>: <code class=\"language-text\">image: \"{{ .Values.image.repository }}:{{ .Values.image.tag }}\"</code></p>\n<ul>\n<li>In this case, we are using multiple template directives in a single line to obtain both the repository and tag information from the Values file, specifically under the <code class=\"language-text\">image</code> key.</li>\n</ul>\n</li>\n</ul>\n<p>By using the release name and chart object, we can ensure unique deployment names and container names. We can also access the replica count from the <code class=\"language-text\">values.yaml</code> file and use multiple template directives to access the repository and tag information for the image.</p>\n<p>The final result should look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Release.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>nginx\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.replicaCount <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"{{ .Values.image.repository }}:{{ .Values.image.tag }}\"</span>\n          <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.image.pullPolicy <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http\n              <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP</code></pre></div>\n<p>Below is the YAML content for the <code class=\"language-text\">service.yaml</code> file that we need to create in the same way as the <code class=\"language-text\">deployment.yaml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">apiVersion: v1\nkind: Service\nmetadata:\n  name: <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Release.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>-service\nspec:\n  selector:\n    app.kubernetes.io/instance: <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Release.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  type: <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.service.type <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  ports:\n    - protocol: <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.service.protocol <span class=\"token operator\">|</span> default <span class=\"token string\">\"TCP\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      port: <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.service.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      targetPort: <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.service.targetPort <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Notice the protocol template directive, where you may have noticed a pipe (<code class=\"language-text\">|</code>) being used to set the default protocol value to <code class=\"language-text\">TCP</code>. Therefore, if the protocol value is not defined in the <code class=\"language-text\">values.yaml</code> file or is left empty, the protocol value will be automatically set as <code class=\"language-text\">TCP</code>.</p>\n<p>In the next step, we will enhance our Nginx server by replacing the default <code class=\"language-text\">index.html</code> page with a customized HTML page. To take it a step further, we will use a template directive to replace the environment name in the HTML file.</p>\n<p>Let's create a <code class=\"language-text\">configmap.yaml</code> file and add the following contents to give our Nginx a personal touch!</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ConfigMap\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Release.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>html<span class=\"token punctuation\">-</span>configmap\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">index.html</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n    &lt;html>\n    &lt;h1>Welcome&lt;/h1>\n    &lt;/br>\n    &lt;h1>Hi! I got deployed in {{ .Values.env.name }} Environment using Helm Chart &lt;/h1>\n    &lt;/html</span></code></pre></div>\n<p><strong>values.yaml</strong></p>\n<p>In the <code class=\"language-text\">values.yaml</code> file, we specify the values that are used to replace the template directives in the templates.</p>\n<p>The <code class=\"language-text\">deployment.yaml</code> template, for instance, includes a template directive that retrieves the image repository, tag, and pullPolicy from the <code class=\"language-text\">values.yaml</code> file.</p>\n<p>By examining the <code class=\"language-text\">values.yaml</code> file below, we can see that we have nested <code class=\"language-text\">repository</code>, <code class=\"language-text\">tag</code>, and <code class=\"language-text\">pullPolicy</code> key-value pairs under the <code class=\"language-text\">image</code> key. As a result, we used <code class=\"language-text\">Values.image.repository</code>.</p>\n<p>The final <code class=\"language-text\">values.yaml</code> should be like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">replicaCount</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n\n<span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">repository</span><span class=\"token punctuation\">:</span> nginx\n  <span class=\"token key atrule\">tag</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.16.0\"</span>\n  <span class=\"token key atrule\">pullPolicy</span><span class=\"token punctuation\">:</span> IfNotPresent\n\n<span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>service\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> ClusterIP\n  <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n  <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">9000</span>\n\n<span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> dev</code></pre></div>\n<p>The Nginx helm chart is now complete, and the final structure of the chart appears as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">nginx-demo\n├── Chart.yaml\n├── charts\n├── templates\n│   ├── configmap.yaml\n│   ├── deployment.yaml\n│   └── service.yaml\n└── values.yaml</code></pre></div>\n<h3 id=\"verify-the-helm-charts-configuration\" style=\"position:relative;\"><a href=\"#verify-the-helm-charts-configuration\" aria-label=\"verify the helm charts configuration permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Verify the Helm chart's configuration</h3>\n<p>To confirm that our chart is valid and that all the indentations are correct, we can run the following command while inside the chart directory.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm lint <span class=\"token builtin class-name\">.</span></code></pre></div>\n<p>To ensure that the values are correctly substituted in the templates, we can use the following command to render the templated YAML files with the values. This will generate and display all the manifest files with the substituted values.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm template <span class=\"token builtin class-name\">.</span></code></pre></div>\n<p>Using the <code class=\"language-text\">--dry-run</code> is also a helpful way to check for errors before actually installing the chart on the cluster.</p>\n<p>It simulates the installation process and can catch any issues that may arise.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm <span class=\"token function\">install</span> --dry-run my-nginx-release nginx-demo</code></pre></div>\n<h2 id=\"deploying-the-helm-chart-to-the-kubernetes-cluster\" style=\"position:relative;\"><a href=\"#deploying-the-helm-chart-to-the-kubernetes-cluster\" aria-label=\"deploying the helm chart to the kubernetes cluster permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Deploying the helm chart to the Kubernetes cluster</h2>\n<p>After we have initiated the deployment of the chart, Helm will retrieve both the chart and configuration values from the <code class=\"language-text\">values.yaml</code> file and use them to generate the necessary manifest files. These files will then be transmitted to the Kubernetes API server, which in turn will generate the desired resources within the cluster.</p>\n<p>At this point, we are set to proceed with installing the chart. To do so, enter the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm <span class=\"token function\">install</span> my-nginx-release nginx-demo</code></pre></div>\n<p>This will install the <code class=\"language-text\">nginx-demo</code> within the default namespace.</p>\n<p>Now we can check the release list by using this command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm list</code></pre></div>\n<p>Run the kubectl commands to check the deployment, services, and pods.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get deployment\nkubectl get services\nkubectl get configmap\nkubectl get pods</code></pre></div>\n<p>We discussed how a single Helm chart can be used for multiple environments using different <code class=\"language-text\">values.yaml</code> files. To override the default values file and install a Helm chart with an external <code class=\"language-text\">values.yaml</code> file, use the following command with the <code class=\"language-text\">--values</code> flag and the path of the values file:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm <span class=\"token function\">install</span> helm-demo nginx-demo <span class=\"token parameter variable\">--values</span> env/prod-values.yaml</code></pre></div>\n<h2 id=\"upgrade--revert-releases-with-helm\" style=\"position:relative;\"><a href=\"#upgrade--revert-releases-with-helm\" aria-label=\"upgrade  revert releases with helm permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Upgrade &#x26; revert releases with Helm</h2>\n<p>Assuming that we want to <strong>update</strong> the chart and apply the changes, we can use the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm upgrade helm-demo nginx-demo</code></pre></div>\n<p>For instance, if we have decreased the number of replicas from <code class=\"language-text\">2</code> to <code class=\"language-text\">1</code>, we will observe that the revision number is now 2, and only one pod is currently operational.</p>\n<p>In case we wish to undo the changes made earlier and redeploy the previous version, we can employ the rollback command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm rollback helm-demo</code></pre></div>\n<p>By executing the above command, the helm release will revert to the previous version.</p>\n<p>Following the rollback process, two pods should be active again. It is important to note that Helm treats the rollback action as a new revision, which is why the revision number displayed is incremented by 1.</p>\n<p>If we intend to rollback to a specific version, you can include the revision number as shown below:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm rollback <span class=\"token operator\">&lt;</span>release-name<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>revision-number<span class=\"token operator\">></span></code></pre></div>\n<p>As an example, to rollback the <strong>\"helm-demo\"</strong> release to revision **number2 **, we can use the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm rollback helm-demo <span class=\"token number\">2</span></code></pre></div>\n<p><strong>Uninstall the Helm release</strong></p>\n<p>We can use the \"uninstall\" command, which will eliminate all resources connected with the last chart release:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm uninstall frontend</code></pre></div>\n<p>Additionally, we can create a package of the chart and deploy it to various platforms such as Github or S3 by executing the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm package frontend</code></pre></div>\n<p>You can find the source code of the project <a href=\"https://github.com/seifrajhi/helm-demo\" target=\"_blank\" rel=\"noopener noreferrer\">on my Github repo</a>.</p>\n<h2 id=\"conclusion-\" style=\"position:relative;\"><a href=\"#conclusion-\" aria-label=\"conclusion  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🌟Conclusion 🌟</h2>\n<p>Helm is an extremely valuable package manager for Kubernetes, particularly in scenarios where you are managing various environments with distinct deployment specifications.</p>\n<p>It offers a remarkable solution to customize Kubernetes manifests according to your requirements through templatization.</p>\n<p>The ability of Helm to deal with chart dependencies and promote chart reusability enhances its utility as one of the preferred Kubernetes tools.</p>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  <em><strong>Until next time 🎉</strong></em></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"},"nextThought":{"frontmatter":{"path":"/blog/kubernetes-networking/","title":"Kube-Proxy and CNI: The Hidden Components of Kubernetes Networking","date":"2024-10-15 20:06:00"},"excerpt":"A Guide to Network Management in Kubernetes 🕸 📌 Overview Kubernetes networking is a complex and fascinating topic, with many moving parts…","html":"<blockquote>\n<p><strong>A Guide to Network Management in Kubernetes 🕸</strong></p>\n</blockquote>\n<h2 id=\"-overview\" style=\"position:relative;\"><a href=\"#-overview\" aria-label=\" overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📌 Overview</h2>\n<p>Kubernetes networking is a complex and fascinating topic, with many moving parts. <code class=\"language-text\">Kube-Proxy</code> and <code class=\"language-text\">CNI</code> are two essential components of Kubernetes networking, working together to enable excellent communication between various components.</p>\n<p><a href=\"https://kubernetes.io/docs/concepts/overview/components/#kube-proxy\" target=\"_blank\" rel=\"noopener noreferrer\">Kube-Proxy</a> is a network proxy that runs on each node in a Kubernetes cluster. It is responsible for maintaining network connectivity between services and pods. Kube-Proxy does this by translating service definitions into actionable networking rules.</p>\n<p><a href=\"https://www.cni.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">CNI</a>, The Container Network Interface (CNI) is a specification for configuring networking resources in Kubernetes. CNI provides a dynamic framework for provisioning IP addresses, establishing cross-host connectivity, and configuring overlay or underlay networks.</p>\n<p>This blog post will explore the inner workings of <strong>Kube-Proxy</strong> and <strong>CNI</strong>, and dive into how they integrate with Kubernetes. We will also discuss different Kubernetes network plugins.</p>\n<h2 id=\"-kube-proxy-kubernetes-networkproxy\" style=\"position:relative;\"><a href=\"#-kube-proxy-kubernetes-networkproxy\" aria-label=\" kube proxy kubernetes networkproxy permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>↳ Kube-Proxy: Kubernetes network proxy</h2>\n<p>In Kubernetes, the ephemeral nature of Pods means their IP addresses can change, making it challenging to establish stable connections 🤔. This is where the Service object comes into play. Services provide a consistent IP address to access Pods and are linked to a group of Pods. When traffic arrives at a Service, it is intelligently directed to the relevant backend Pods.</p>\n<p>But how does this mapping of <em><code class=\"language-text\">Service to Pod</code></em> actually function at the networking level? This is where Kube-Proxy excel.</p>\n<p>Kube-Proxy serves as a vital Kubernetes agent that resides on each node within the cluster. Its primary role involves monitoring changes to Service objects and their corresponding endpoints. It then translates these changes into tangible network rules within the node.</p>\n<p>Typically, Kube-Proxy operates within your cluster as a DaemonSet. However, depending on your cluster's installation type, it can also be directly installed as a Linux process on the node. Regardless of the setup, Kube-Proxy is the unsung hero ensuring that your network traffic efficiently reaches the right destinations in your Kubernetes cluster.</p>\n<h3 id=\"-how-kube-proxy-works\" style=\"position:relative;\"><a href=\"#-how-kube-proxy-works\" aria-label=\" how kube proxy works permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>💭 How Kube-proxy works</h3>\n<p>Once <code class=\"language-text\">kube-proxy</code> is installed, it establishes authentication with the <code class=\"language-text\">API server</code>. As new <strong>Services</strong> or <strong>endpoints</strong> are introduced or removed, the API server promptly communicates these changes to Kube-Proxy.</p>\n<p>Kube-Proxy takes these updates and translates them into <code class=\"language-text\">Network Address Translation (NAT)</code> rules within the node.</p>\n<blockquote>\n<p>These NAT rules are essentially mappings, linking Service IP addresses to Pod IP addresses.</p>\n</blockquote>\n<p>When traffic is directed towards a Service, it adheres to these rules, leading it to the appropriate backend Pod.</p>\n<p>To illustrate this process further, let's consider an example:</p>\n<p>Imagine we have a Service named <code class=\"language-text\">SVC01</code> with a <code class=\"language-text\">ClusterIP</code> type. When <code class=\"language-text\">SVC01</code> is created, the API server examines which Pods should be associated with this Service by matching labels to the Service's label selector. In our case, let's call these Pods <code class=\"language-text\">Pod01</code> and <code class=\"language-text\">Pod02</code>. Subsequently, the API server creates an abstraction known as an <code class=\"language-text\">endpoint</code>, representing the IP address of each of these Pods. So, <code class=\"language-text\">SVC01</code> becomes linked to <code class=\"language-text\">2 endpoints</code>, denoted as <code class=\"language-text\">EP01</code> and <code class=\"language-text\">EP02</code>.</p>\n<p>In the final step, the API server maps the IP address of <code class=\"language-text\">SVC01</code> to the IP addresses of <code class=\"language-text\">EP01</code> and <code class=\"language-text\">EP02</code>, solidifying the connection between the Service and its associated endpoints.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVR42qWRbUvDMBSF9///hh98GTg7REGHOm1FBWEyNhlzXWre2s7aOgZit+SYJtYXFD/ohYdz7yUcTpIGPpVSyvKfakRRBEopCCHgnENKiTRNUJalPTBfPGNEZgjZIybUcUczSz2PowxZvnCGlDIIITEYDFEUT1gpjZdyieVb0inPsd4J4QUcrTOG7VNq1fOF1R2fYeuYoj9OnKHW5qoGq6pCW62Mq33IcrS699i/TCzNwxHWdnvYPLjF3kVsdjHagcRwMnOGX19Af3Ta9UQU2OgQtM+lSSMMdVJmZy8QaHa5SZj+ZIhvhvHDHEdXBMGNgN/j79RzYDi5ppiy7HfDv/7yK3B6Dj0s9oEpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/5da025a9baa720d754be3a179a090889/c5bb3/step1.png\" srcset=\"/static/5da025a9baa720d754be3a179a090889/04472/step1.png 170w,\n/static/5da025a9baa720d754be3a179a090889/9f933/step1.png 340w,\n/static/5da025a9baa720d754be3a179a090889/c5bb3/step1.png 680w,\n/static/5da025a9baa720d754be3a179a090889/b12f7/step1.png 1020w,\n/static/5da025a9baa720d754be3a179a090889/00172/step1.png 1044w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          \n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 101.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACxUlEQVR42o2S+U8TURDH+/caE7wCxgT0ByP+YAyJJkYhxgBBQaStlDaiorT0oByViOFI7727u23pvVe/vvegpSiFvmQys3N83sy8dWHA4zgOms0myuUyCoUCVFVFsVhEvV6Hbdssp91uwzUIrNVqdSGNRoMVUgi1OxdUq1WWey3QsiyIosg6pEXpdBr5fJ75qBYEgeVRKO22L5B2QQ8di3ZCj6IoSCaTDEp1NptlPnroOmjutcBSqYRarcZsjuO6IArNZDLM1wHqun79yHRXkiTBNE1m53I5BqM6lUp1dyrLMrNdnW76CokbhkkKFDYS9dGO6T6ppo/SgQ30KBf2qWtEVFQrJ6hUKgxGoZ04A1qWjY3dDNZ3OAR3eyXfIxxCCQ5r8TRWo0ls/+HpLZde6jJMC+6fSXwKClgK8mciwL0hwkOE6o7fs0FyQiICkQz5jezuWnqPyyRAfzgDX0zGSkyEf1OGN5TH26U4ppcTmPb9wnKEJzGJyXJEwvetHAE5l67nH+BpkS8iMKg7mIMnlGMXdYHRAYDe9RTcZBRPSDgXMqo3LDHd66fr+BLN9gfSf2v3SMbWkYrtXjlUEN8XiC5c8McPVfxOKv89ShdIl9rSRRhaHmaRI8LDUHMwTjRW0ypK5JvEdB6WzjPbKBf6/mIu02iBX3wCcWYEmxM3sPdqCOrsPUhrM2iaDgTvc6hzI4iR2NaLm8QeBh94Dacf0DYNyN5nkN8/gDw/hhPPYzTdYyiGF9CyHKiBl1BITOrEPI+g/XjXH+hYJrKL4ziYvMOKmivjqC2NQg/Pw7Ad8J8ncDR1G/yHUTR846i7H0JduwJIR9a8T6GQMZNTt6DM3Ud9YRja+iwbWfdPQJu9i+PJodPYxxEUvr65YmTyytp+CFzMj0x0BUriG/TEKkrpPdhOG/pBFMJmgMT8KJzF9OMdtPsA/wJD+sc6L4oSlgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/4b8d8cbb049ae99e91ee2d8690609698/c5bb3/step2.png\" srcset=\"/static/4b8d8cbb049ae99e91ee2d8690609698/04472/step2.png 170w,\n/static/4b8d8cbb049ae99e91ee2d8690609698/9f933/step2.png 340w,\n/static/4b8d8cbb049ae99e91ee2d8690609698/c5bb3/step2.png 680w,\n/static/4b8d8cbb049ae99e91ee2d8690609698/f3c12/step2.png 764w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          \n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8UlEQVR42pWSbVPaQBSF+f+/oOMX25m2M1qomlHrOC2CVLQgYxWh1IQEGkISQkJeCPCB5Lh3IamMtk135mQ3d3efPffu5pCxxXGM6XQK13UxmUw2RPEoivi6XBYYLR6Px7BtG5ZlwfM8DvZ9fyO+XC6zAR3HwXw+RxAE6Ha7kCQJoiii3++j0+lwh4vFgoMzAU3T5CmTI0VRUqCqqvwAcpysywSk9MgduSBQu93m7mRZRrPZxGw2QxiGPJPc76L/WRH72LaDEatTAidXJIIkdaRa5/AfLZz6cCc2ZmHAbtfhMDqAHFJJSLnkSciqhaZooCWZL+qezXWUMaqNB9RuZQTTeZrZ07YCRkuUGioK50McfB1if629ipYq+T+8NLFT7EEbeen7jJ9QU2DlZgDhUsfxlY4jpuNvBpOJk7qFT7URjyXxQqkH3fJT4DOHEQOeM+DBhc4cDNlGA3vlHt4IN3h7dIed0w6L61w0lz8joJcFaKSbhAuNOVGQL0oonMk8RnPkOs8cDv8FrHzXIFQN7JcVfPj8gPwXkblMgN1VjI0Pqxo+lvt/T5lqWLz+hd2SincnP7BVqGErX8Nr4Q6vdq/YuM61Ldwyd328P5U2LuU5MI7wUxmh0dZx3VJZP2DS0Git+7VWcxrq9wO4fvjis3kEEgNgZwmQNEgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/fdf3dd3d45f21eaafabdd5e911f94490/c5bb3/step3.png\" srcset=\"/static/fdf3dd3d45f21eaafabdd5e911f94490/04472/step3.png 170w,\n/static/fdf3dd3d45f21eaafabdd5e911f94490/9f933/step3.png 340w,\n/static/fdf3dd3d45f21eaafabdd5e911f94490/c5bb3/step3.png 680w,\n/static/fdf3dd3d45f21eaafabdd5e911f94490/63ec5/step3.png 812w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>All of this configuration is currently only part of the control plane. We want this mapping to be actually implemented on the network. Once it is applied, traffic coming to the IP of <code class=\"language-text\">SVC01</code> will be forwarded to <code class=\"language-text\">EP01</code> or <code class=\"language-text\">EP02</code>.</p>\n<p>So here comes the <code class=\"language-text\">Kube-Proxy</code>. The API server will advertise these updates to the Kube-proxy on each node. Which will apply it as internal rules to the node.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 107.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAklEQVR42u2U246bMBCG9/0fpDfVtk2aVL2peshp8wCVsupmSTiDAuYQIEDg3xknbEFhs937Iv0aezz+PNge36Dnyw4FVEt0Zfpk/ZbPR54XF3Nv2p26rqV1dhE+/NLxaWpKDWY2BnPSzDr7yE40eGLfmdcDPFnXi/B5bmB8Z2G8tPHxp4LbH48YTLWT787GeKHDD/4R6BBwODMwWpwmv//2B+++/sbt97Xss380fytwbmLEk0lflq7UeOmcfWQXBgGTzrwrexhiMNlgOFXJbmm/ttKeRD7yDycKvNcybL6yPMIPU4goQ5wWiJICcZLLdhBnciyMUxyPx+un3MmWlGYZwkAgjiPEUQQhfCRJgqrGi18vkH+hIiuEwOr+HoqiYLVaQdN1FEWBIxGrur4OTNMUQRAgDEP4IiDYqc3wRnmeIyJfQGOeJ6TlRXmRC6DvedA1TerhUYVO2XC7veH7/V76LNOAstWgaobsp0ny/Gd/gb4PgyDr9RqbzQaGYcAkVVXVAVqmKccfKE5VVdnvB1KGDHAdB45ty0BeoJ1hQkCOsS1LxrCVGdJ29WZonrNiXQPyWKNXge3g/8C3AT06ZQZwUHMwffewiWmk0dXpvTb54YB9HFPtBrIaOBtW+23ix4BrmcefY6jffiQ6tcyX2KL7tdvtXix+zsJ1XamyLC9q+QlhAkBvqNvlwQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/7ae096e07f595ac802b4837c7ec36a3b/c5bb3/step4.png\" srcset=\"/static/7ae096e07f595ac802b4837c7ec36a3b/04472/step4.png 170w,\n/static/7ae096e07f595ac802b4837c7ec36a3b/9f933/step4.png 340w,\n/static/7ae096e07f595ac802b4837c7ec36a3b/c5bb3/step4.png 680w,\n/static/7ae096e07f595ac802b4837c7ec36a3b/b12f7/step4.png 1020w,\n/static/7ae096e07f595ac802b4837c7ec36a3b/e996b/step4.png 1050w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          \n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 118.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAACyklEQVR42p1UaU/bQBDl//+MfmypWq70UwVtgQISFVSClMRxfB+5SJo4sXNN35s0hyEWtJaednd25828nfHuyJZvPJlIs/P7RcStrgxHWc53Z3Mxn891jFs92Tt15eDcX+PMWwPro4tA3h7Xpeq01Wf217eQcP8skMPv0QIXsZSumvLpqgGiWG2ly1h2TxwQdl5L6MMxBEEkH7/a8ubgRvH+2FRbCdg9sf8lwwUhQYkfvliKfUimrXT5z4QbkgFKPYLMw4vofyR3Ze+bhQKgMKeOYn8FW8ejc0/efTakareKCZffdDaTJBlJfzBCW6QySjMdiTQby2CY6l4yHMoELVbYNvlsRbJsIiM4DYHRaKTj4+MjiBJktN2vkHA6ExkkiZTLZeCXVCpVubu7E9d1JQU592dbWFeE0+lUMYPcyWSKv2WqchKQpmmqGXKeZZnaU1xDAuljrGkbj8drQh5wbFs8RPdcT0zT0bnrOEqyWTBK5l7g+2LbrliA77kShaGeWRHyUAhj4Adiu4E0Gg21bSNkoEYciYezjhvqPAyCPKHveZqlYVTFrBniI4MiQs0eqNfrCp59liGj0hiFiAZw7iFIESEz8pFhFC2yC3OEuFDeSRMygyBEdESkQwEh7QzIcxYyJOi/KgorW76/lx/X12iPyiLyKwgdx5Oft7dye3OjCnNVZpS6aeIeUWHPhwz/BUIGDCSG5EYc5++QPRQgo1azgexCtEMgTVSOF58MBs8IKY9ENctD4FDXxIqQDc1qmbWaWJaFSi/GXrcrgy2EJpVAogU1BnxYkF6vlydstVp6mBscCWb+VDL3O+227vf7fWljzqA8uybEHVZRjMrDg9QQkYXhmvfyNMNOp6P/t2EYqopzjrSvCDlhYRiFL0qGf5dB+I8uiZYfO4KKeI7B6Mf18hnLvTaUx7uhfDoWP21zbWg2Ph+NzdfmD0dlGDKUOQMRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/21a523135ce7fd8705e614f56cb2fb8e/c5bb3/step5.png\" srcset=\"/static/21a523135ce7fd8705e614f56cb2fb8e/04472/step5.png 170w,\n/static/21a523135ce7fd8705e614f56cb2fb8e/9f933/step5.png 340w,\n/static/21a523135ce7fd8705e614f56cb2fb8e/c5bb3/step5.png 680w,\n/static/21a523135ce7fd8705e614f56cb2fb8e/cc488/step5.png 928w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Now traffic destined for the <code class=\"language-text\">SVC01</code> IP will follow this <a href=\"https://en.wikipedia.org/wiki/Network_address_translation#DNAT\" target=\"_blank\" rel=\"noopener noreferrer\">DNAT</a> rule and get forwarded to the Pods.</p>\n<blockquote>\n<p>Remember that <code class=\"language-text\">EP01</code> and <code class=\"language-text\">EP02</code> are basically the IPs of the Pods.</p>\n</blockquote>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 81.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACiUlEQVR42oWU208TQRTG+acVHogaY4xGE+OLz0qCiRJQU57gzdBoCApewGK3271fu+1utxbpbvt5vim7UgxxkpOZ3fnmd86cMzNLkFYUxbU2nU5RtbIsMeF/6YuinPdqXKg5tiUucF0XtmXBti0ZO3AcG5Z809I0rYG9Xg9GtwvH6MA1u2I67G4HltFFEIaYzWYCLAv4YQzvYBfB9lN8f/0YP7eeoL/zDNa3faTDUQ1MBhnMrx8RNx7hZP0uWi/voffuIdwPDUTJALNpOQd6UYKwuYX81TLMFzfgr6/g99Yq7MP3SPNfC0D7aA+jzVW4ojHXlpHJmnBvA2GSLgLd5ltkm7cw2n6AvHEf2Zs7sGTxVaD1pYnexm2Y66s4fb4Ca+0mAgmmBjKZvh/A67bhtQ5hnXyCeXwA98chbF1DmmV/gUkCS/65oqPWOz0S3WfYWgtRFKsCqqI4tg1N68AwbeiGCcfzEYiAxbpclESK4jiOFCCWvEfwgmje+z4iKcqURWFlLNPE7s4ODvb3YbKKUt3A8+DK4n+A4pxzvjirzBOrgerYyMKT42N0NE0toINAvF4LlDmf0AtbAJYC9BlyECCOIgWlUcDFC0DJ4f+BUhRGMj/Y8+hMw1C5onAwGNTAOI7VPOfcC6MD9mF1sHltKGQBVKQSpSdeA4mYc3me18B+vw9LAKY4p46adruNs7MzTCYTdf0UsCdAeqCIcIL5TdFlIKPl9aMmk+PEdNA5ddV9VkUhQO901HY45tZ5Z5nTfDhcAGqSX13X1Y5411utlgqEjtU5pLB6Uc7Pz9XEeDxW/2jMS9Wq8VCcED4ajeoXqWIsXRYyR4YUhNug8GqrdIRxF9x+9WxV7Q+i2qjAY9te2QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/9446bade439e11c0df96a1816c63a91e/c5bb3/step6.png\" srcset=\"/static/9446bade439e11c0df96a1816c63a91e/04472/step6.png 170w,\n/static/9446bade439e11c0df96a1816c63a91e/9f933/step6.png 340w,\n/static/9446bade439e11c0df96a1816c63a91e/c5bb3/step6.png 680w,\n/static/9446bade439e11c0df96a1816c63a91e/d48f1/step6.png 796w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          \n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 91.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACr0lEQVR42o2U22sTURDG+0fXWlAR8c0nRX1QsCI+KFarUFBBbVVQCr1AkCS72Uuyl2w2t73v5p7PmdNs0jVVPDCZ3XNmfvnOnLOzARqT8RhJkiDNBkgWJp7TFMPBAPkYjUbncYMhxQyFF89JKtZ4bPBPFEWwTRNNXUGrocA1VDh6DaauotvtLoG+78PQFFiVM2Em+/IpTJrzaG0JjOMEliajv38H1Z0tnD3aRPfVdTS/76LrhStglMAs/US4dwvykytQn20je3sT1ulXeGFyAUiSLVVC+O42ot1r8F/fQLa7DffbizWgVfqBgGLs51ehPd1E8HILztlhERiRQqehofNlB97nx+h9Ivv4ANbRewIGK2AYwyyfwP3wEMb+fchv7qK5fw/2ryMCxitgEseQqhLK5QokWYZpWWi1WrBte62G9mKNre26wjcpzve8FTCj0zw5PsbhwQFURRFJ7iLwMiCvtRwHDhn7NWBMp2waBoxGAxafNgX8D7D1NyBfG57stNtoEFSqVkUSJ/8J5D/MQU6zKWwdGIYioNvpCM+gHoHYd2huCaQkTubauYsasnGc1+8XFbIyVVVh8NbJqqSSFQVBUFCo6zrq9ToptaBpGnQyjknpHArAkFTyQkwnzs+81TF9kvw+n89FMK/3ej1hPM/vfVI2mUzWP71arYZKpQKFfK2moFQqwaXthBcUerRlSZKEelXTIcuSyOE/LyiczWaYTqfCs/lhSuqmFJSIGrJivpN8X4E5Oh43iDEp57yZUMh5S2BxzEWQF2bIqNP4voeUOozn9akDZQjiAbLhWMTlpbg4LgGej8mElEYDjMlz4mjxPiLl/xoFINfBoivQpvvIJWBQlAwRRBk1kKFQnncnvgn8peSHcSmQa8H1iuNIANeKMV/FcaPNqAR57XLgbxEiS20x1RDVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/95b897d26d864ac2a8a437b40acd8fd4/c5bb3/step7.png\" srcset=\"/static/95b897d26d864ac2a8a437b40acd8fd4/04472/step7.png 170w,\n/static/95b897d26d864ac2a8a437b40acd8fd4/9f933/step7.png 340w,\n/static/95b897d26d864ac2a8a437b40acd8fd4/c5bb3/step7.png 680w,\n/static/95b897d26d864ac2a8a437b40acd8fd4/5d72a/step7.png 834w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Now of course I tried to keep the scenario as simple as possible. This is just to focus on the important part of the Kube-Proxy.</p>\n<p>There are a couple of points that are worth mentioning:</p>\n<ul>\n<li><strong>IP and port mappings:</strong> Services and endpoints in Kubernetes represent IP and port mappings, ensuring proper routing of traffic to specific combinations of IP addresses and ports within the cluster.</li>\n<li><strong>ClusterIP and DNAT translation:</strong> ClusterIP services use DNAT (Destination Network Address Translation) on the source node, keeping their IPs hidden from external access. They function as internal NAT rules, exclusively accessible within the cluster.</li>\n<li><strong>Service types and rode rules</strong>: Different service types can lead to the installation of distinct rules within nodes. These rules may be organized into chains, specific sets of rules with defined order in the traffic path.</li>\n<li><strong>Random pod selection:</strong> By default, NAT rules select a random Pod to handle incoming traffic. However, this behavior can vary depending on the chosen Kube-Proxy mode, which determines the load balancing strategy for routing traffic to Pods.</li>\n</ul>\n<h2 id=\"-understanding-kube-proxy-modes\" style=\"position:relative;\"><a href=\"#-understanding-kube-proxy-modes\" aria-label=\" understanding kube proxy modes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>💭 Understanding Kube-Proxy modes</h2>\n<p>Kube-Proxy operates in various modes, each with its approach to implementing NAT rules. To grasp their workings and nuances, let's explore these modes:</p>\n<h3 id=\"-iptables-mode\" style=\"position:relative;\"><a href=\"#-iptables-mode\" aria-label=\" iptables mode permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>✅ IPtables mode</h3>\n<p>This is the default and widely used mode. Kube-Proxy relies on <code class=\"language-text\">IPtables</code>, a Linux feature for packet processing and filtering. In this mode, Kube-Proxy inserts <code class=\"language-text\">Service-to-Pod NAT</code> rules into IPtables, redirecting traffic from Service IP to Pod IP.</p>\n<p>However, IPtables can become less efficient with a large number of rules, as its sequential algorithm results in O(n) performance. It also lacks specific load balancing algorithms, using a random equal-cost distribution.</p>\n<p>Now the Kube-Proxy role can be described more as the \"installer\" of the rules.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 608px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 112.3529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/0lEQVR42pVUaXPaUAzM//9H6XRC2qQJCSQkYGNsfN8HNjZQSL9kKwnMmQ8tM4veIXZX0huuQJ9F0yBLEhR5foKyLDGfz1FRbOpa4nkOI88yLJdLpsIVfxVFAd/zkMQx4igSRGGIl34f3cdHPD894bbTgaooSEm4zdnnBoGI7QlnsxkC35dkJm3hOg7M6RSWacLQddm3d0x0vK6q6oiQHDLhMRkjS1Mph4V4zXm8l3Mq9djlBSGXyJGTmaAlYmK+y2g/JbcmuXXIqUcGSiLhuwvCkkrWJxOMhkMp0bYsTA0DnuvuS2IBx7al7HjXDj770uGcNjyAb9fX6Pd66Ha76Nzc4G0wkOmzCx4aR+7lRNMkcm9FkM4vSg5pUqzYPgOOXH4SJ+TMoftQcnjqPRLlyY9VVXKic8JSpuzBpZKSONojSxN5Eh6Vx+s0iUk830KEUznj3BPCLC9gOx5My4Flu/CDiJoewvMC6PoULkXZE3jdwvO2Z47r09M7eodhOse7kUOxZnjTM4ydCprLZxntU6h2RXclxQM4p81TrAppUR8Ik2JBlzXMeI27voGhOROB264GK/nANFzBCJbQ/YVg4jVQSYBjX/HxMHBQ1usDYUyEKrlLKWqGA9tP4RD8KIcb1+KQXWluTcJzAQvwfmQWeJ8WKMrVgTDKSdUp8fGxgTZWoYyG9C41SchKEnEb9EY+fj5PcE8VPA5s3PV0ITWj39CDFfLZ4tQh98gKa9hRI5FhBhV0r8KUfvQ2SYXk4dVETwmElMsXp94CeXn0bxOTQ5VcGNSric+92oGSjR3YiU39tOKN9NpKNvu7CRPOzglpKG3zW2yH0JwMo1237v6DcEFu1nDSD3K2EWdu9oecrk9E/4mQ1Znsvmfg5tcInQcF3++HuP7xihc1lJ5eEJ73ULFrulzt+8frd6NAX43wqiV4GUd4Gvr0TGYneQzNXSA7dlhUS1g0US+p5d218NMFgmxJcYmAka0opznJYdjRHPPm6B0Cn1/jc4fz9ZfYfv4Cfz5dyO3RfMgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/3b7002549d26704094bc19d0b4628f5b/18872/iptables-modes.png\" srcset=\"/static/3b7002549d26704094bc19d0b4628f5b/04472/iptables-modes.png 170w,\n/static/3b7002549d26704094bc19d0b4628f5b/9f933/iptables-modes.png 340w,\n/static/3b7002549d26704094bc19d0b4628f5b/18872/iptables-modes.png 608w\" sizes=\"(max-width: 608px) 100vw, 608px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"-ipvs-mode\" style=\"position:relative;\"><a href=\"#-ipvs-mode\" aria-label=\" ipvs mode permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>✅ IPVS mode</h3>\n<p>IPVS (IP Virtual Server) is designed for load balancing and offers efficient lookup with O(1) complexity, ensuring consistent performance regardless of rule count. Kube-Proxy in this mode inserts rules into IPVS instead of IPtables.</p>\n<p>IPVS supports various load balancing algorithms like round robin and least connections. Note that IPVS may not be available on all Linux systems, unlike IPtables.</p>\n<h3 id=\"-kernelspace-mode\" style=\"position:relative;\"><a href=\"#-kernelspace-mode\" aria-label=\" kernelspace mode permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>✅ KernelSpace mode</h3>\n<p>This mode is exclusive to Windows nodes. Kube-Proxy utilizes Windows Virtual Filtering Platform (VFP) to insert packet filtering rules. VFP works similarly to IPtables on Linux, responsible for packet encapsulation and destination IP address replacement. If you're familiar with virtual machines on the Windows platform, think of VFP as an extension of the Hyper-V switch.</p>\n<h3 id=\"-userspace-mode\" style=\"position:relative;\"><a href=\"#-userspace-mode\" aria-label=\" userspace mode permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>✅ Userspace mode</h3>\n<p>In the early days, Kube-Proxy used the Userspace mode, where it managed connections by proxying them through a user-level process. While charming and simple, this mode is less efficient than others and is akin to riding a bike with training wheels.</p>\n<p>Each Kube-Proxy mode has its advantages and limitations, making the choice of mode an essential consideration based on your specific cluster's needs and infrastructure.</p>\n<p><strong>⛓ Checking Kube-Proxy mode</strong></p>\n<p>To determine the mode in which Kube-Proxy is running, you can use the <code class=\"language-text\">/proxyMode</code> endpoint, which Kube-Proxy exposes for querying information.</p>\n<p>Here's how you can do it:</p>\n<ul>\n<li><strong>SSH into a cluster node:</strong> Connect to one of the nodes within your Kubernetes cluster using SSH.</li>\n</ul>\n<p>*** Use curl to query Kube-Proxy:** Once connected, execute the following command using curl to query the Kube-Proxy mode:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-v</span> localhost:10249/proxyMode</code></pre></div>\n<p>This command will retrieve information about the Kube-Proxy mode, helping you verify which mode it is currently operating in.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVR42o2SRwrDMBREfRrj3ntbuOOCscH3P8oP80EhgRQthmgRPU2xsu87VVVFXddRFEXk+z4lScLnOI5Z4hwEATmOQ5qmka7rH6UAeBwHnedJ0zRR0zTU9z0VRcFgKMsyFqAAmqb5VYoAbdtGy7IQHijL8uksDEOGpmnKDuHiJ/C6LhqGgeZ5prZtGQ6gqqoc7TWeYRg/YQxc15XyPOdIiAPBCbr0PI9c1+U/Wpb1F/bmEM7gEt1hJPzWdc1nPCLj7tkhXEJiIDyAPsdx5C5l3TEQECyL/rAu+sMYqABjILZt2/KR7/vmqCImYBBWxcICLg1ENPHNfbqI7mT7Y6D4RMRl2YvfgA9AtV56tDoHdAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/fcb95fb20e18694c52ba207069d16f80/c5bb3/kp-mode.png\" srcset=\"/static/fcb95fb20e18694c52ba207069d16f80/04472/kp-mode.png 170w,\n/static/fcb95fb20e18694c52ba207069d16f80/9f933/kp-mode.png 340w,\n/static/fcb95fb20e18694c52ba207069d16f80/c5bb3/kp-mode.png 680w,\n/static/fcb95fb20e18694c52ba207069d16f80/b12f7/kp-mode.png 1020w,\n/static/fcb95fb20e18694c52ba207069d16f80/b5a09/kp-mode.png 1360w,\n/static/fcb95fb20e18694c52ba207069d16f80/1134b/kp-mode.png 1470w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Here you can see the last line that Kube-Proxy is using <code class=\"language-text\">iptables</code> mode.</p>\n<p><strong>Recap: Kubernetes Service and Kube-Proxy:</strong></p>\n<ul>\n<li>A Kubernetes Service operates akin to a proxy by providing a stable IP address for client connections. It directs traffic received at this IP to the corresponding backend Pod IP, effectively solving the issue of Pods' dynamic IP changes.</li>\n<li>In terms of load balancing, it depends on which aspect of Kube-Proxy is under consideration. The Kube-Proxy agent itself does not handle traffic or perform load balancing; it's solely part of the control plane responsible for creating Service rules. However, Kube-Proxy, through the rules it generates, facilitates load balancing by distributing traffic across multiple identical Pods associated with a specific Service. These Pods serve as replicas and collectively handle incoming requests.</li>\n</ul>\n<h2 id=\"-container-network-interface-cni\" style=\"position:relative;\"><a href=\"#-container-network-interface-cni\" aria-label=\" container network interface cni permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>↳ Container Network Interface CNI</h2>\n<p>Container Network Interface (CNI) is a framework that allows you to dynamically configure networking resources for your Kubernetes clusters. It uses a plugin architecture, so you can use the CNI plugins that best meet your needs.</p>\n<p>CNI can be used to configure both <code class=\"language-text\">overlay</code> and <code class=\"language-text\">underlay</code> networks:</p>\n<ul>\n<li><strong>Overlay networks</strong> encapsulate network traffic using a virtual interface such as <a href=\"https://datatracker.ietf.org/doc/html/rfc7348\" target=\"_blank\" rel=\"noopener noreferrer\">Virtual Extensible LAN (VXLAN)</a>.</li>\n<li><strong>Underlay networks</strong> work at the physical level and comprise switches and routers.</li>\n</ul>\n<p>Once you've chosen a network configuration type, the container runtime defines the network that containers will join. The runtime adds the interface to the container namespace via a call to the CNI plugin and allocates the connected subnetwork routes via calls to the I<code class=\"language-text\">P Address Management (IPAM)</code> plugin.</p>\n<p>CNI can be used with Kubernetes and other Kubernetes-based container orchestration platforms such as OpenShift. It uses a software-defined networking (SDN) approach to unify container communication throughout clusters.</p>\n<h2 id=\"-kubernetes-networking\" style=\"position:relative;\"><a href=\"#-kubernetes-networking\" aria-label=\" kubernetes networking permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📍 Kubernetes networking</h2>\n<p>Kubernetes provides networking for containerized applications with a flat network structure. This eliminates the need to map host ports to container ports, enabling the operation of a distributed system without dynamic port allocation.</p>\n<p>The networking architecture in Kubernetes is based on the Container Network Interface (CNI) plugin specification. This plugin acts as a common interface between the Kubernetes runtime and the underlying network, supporting various networking solutions like Flannel, Calico, Weave Net, and Cilium.</p>\n<h3 id=\"how-kubernetes-networking-works\" style=\"position:relative;\"><a href=\"#how-kubernetes-networking-works\" aria-label=\"how kubernetes networking works permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>How Kubernetes networking works?</h3>\n<p>When a Kubernetes Pod is created, the CNI plugin configures the network interface, assigning an IP address to the Pod. This facilitates communication within the Kubernetes Pod network, which is a flat network accessible to all Pods in the cluster.</p>\n<p>Additionally, Pods can interact with external applications through the Kubernetes Service network, a virtual network that exposes Pods to external entities.</p>\n<p>Kubernetes networking offers several benefits:</p>\n<ul>\n<li><code class=\"language-text\">Portability</code>: Kubernetes clusters can be deployed across different cloud providers and on-premises environments.</li>\n<li><code class=\"language-text\">Scalability</code>: It supports a large number of Pods within a Kubernetes cluster.</li>\n<li><code class=\"language-text\">Reliability</code>: Ensures consistent connectivity for Pods in a Kubernetes cluster.</li>\n</ul>\n<p>Both Linux container and container networking technology are continuing to evolve to meet the needs of applications running in various environments. CNI is an initiative of the Cloud-Native Computing Foundation (CNCF), which specifies the configuration of Linux container network interfaces.</p>\n<p>CNI was created to make networking solutions integratable with a range of container orchestration systems and runtimes. Instead of making the networking solutions pluggable, it defines a common interface standard for both the networking and container execution layers.</p>\n<div class=\"note\">\n    <p><strong>🔵 Note:</strong></p>\n    <p>CNI is not native to Kubernetes. Developers using the CNI standard can create network plugins to interoperate with a variety of container runtimes. CNI networks can use an encapsulated network model,\n    such as <a href=\"https://www.techtarget.com/whatis/definition/VXLAN\">Virtual Extensible LAN (VXLAN)</a>, or an unencapsulated - also known as decapsulated - network model, such as <a href=\"https://www.techtarget.com/searchnetworking/definition/BGP-Border-Gateway-Protocol\">Border Gateway Protocol (BGP).</a></p>\n</div>\n<p><strong>How CNI works?</strong></p>\n<p>CNI uses a plugin architecture to configure the Kubernetes cluster's networking. The CNI plugin is responsible for creating and configuring the network interface for each container. When a container is created,\nthe Kubernetes kubelet calls the CNI plugin to set up the network interface, assign an IP address, and add it to the Kubernetes network.</p>\n<p>The CNI plugin also interacts with the <code class=\"language-text\">IP Address Management (IPAM) plugin</code> to allocate IP addresses to containers. This involves managing the pool of available IP addresses and assigning them as needed. Once the network interface is established, the kubelet starts the container,\nenabling it to communicate with other containers on the Kubernetes network.</p>\n<p>CNI focuses on the connectivity of container networks and the removal of allocated resources upon the termination of containers. This focus makes CNI specifications simple and allows them to be widely adopted.\nFor additional information on CNI specifications, including third-party plugins and runtimes, refer to the <a href=\"https://github.com/containernetworking/cni\" target=\"_blank\" rel=\"noopener noreferrer\">CNI GitHub project</a>.</p>\n<h2 id=\"diverse-kubernetes-network-plugins-necessity\" style=\"position:relative;\"><a href=\"#diverse-kubernetes-network-plugins-necessity\" aria-label=\"diverse kubernetes network plugins necessity permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🧵Diverse Kubernetes network plugins necessity</h2>\n<p>Kubernetes relies on a rich ecosystem of network plugins, many of which are endorsed and widely adopted by major container orchestration platforms, with Kubernetes at the forefront.</p>\n<p>These plugins play a crucial role in enabling various container networking functions, all while adhering to the rigorous standards set forth in the Container Network Interface (CNI) specification. Given the inherent complexity of networking, CNI thoughtfully delineates specifications for multiple plugins, recognizing that user requirements can greatly vary.</p>\n<p>Within the realm of CNI, networks can be instantiated using two primary models: <code class=\"language-text\">encapsulated</code> and <code class=\"language-text\">unencapsulated</code>.</p>\n<p><strong>The encapsulated(Overlay) network model:</strong></p>\n<p>This model is represented by technologies like <code class=\"language-text\">VXLAN</code> and <code class=\"language-text\">IPsec</code>, overlays a logical Layer 2 network over an existing Layer 3 network topology. This approach simplifies routing complexity and minimizes overhead.</p>\n<p>It relies on UDP ports to disseminate encapsulation data among Kubernetes workers, creating a bridge connecting these workers and pods. Communication management within pods is then expertly handled by Docker or alternative container engines.</p>\n<p>This encapsulated network model proves particularly advantageous for scenarios that favor a Layer 2 bridge, especially those sensitive to Kubernetes worker latencies in a Layer 3 environment.</p>\n<p>For distributed data centers spanning distinct geographic locales, minimizing latency is pivotal in preventing network segmentation.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBElEQVR42jXO2VfaQBQHYP93+1DPqYdz2oc+tVbKVgVDtYhsAbKyBUIxELZQaRAkrGFmEkKWJlTvuTMP85vv3HviOE777zL1u3RfJ3Hh8Vd5lawuYvQ63QCOY6+BkeeXOL/M8tsMD6muXOgMqO5wA5ALT9DeiTJShf/Ild/l+Pj7UO883PTF5+e3O4AMbgBP/cKHcMsXV84wmOXjBH2aKfuqQ/k/tq+ZVYIZ4GwXYyZBCoUpFGFQkASrnVGXtMsiitAoTKPvJExWOqUymWZKtLg6Yt26KQGsolyR4581ECBgkPTaXwBrFw+1r/guRLkvXoSVIcbMovS81n9d24oy6i2j3LOzG3YdIIH7z53vJzQPS/pFQXvD4IpVrxklSCxKPehhuLdi9IZJ12oPVAqXA5QdIvVQcePPztbA5AbgIjWNUDBEaG6Uyj/X0iz9UOXax7WNgxVj1W85NZCfXOYqFzgXpJXPd0+fAqxuOvXe4uxL0V/QA+QfN4rgZSwnRdLPjf7Ow+5Rtsbj2Bi8qCOlJcpVUZYbQyhNd7ZtArRvjdSmhMSJJDyxw3lbmCBBNrW99YrdMk1ju1ktlNVmoxrG/mBohq5D6N7IPrgNzb1umZZpOrZlOW/lYdu2HdtpDjiMCGW4uxyfIBoFMitS2c5LPzntxpajxEz8IYjNaGFc76+PxMP/AEh1+jWVe4GGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/fe31a7b21e4d40d9442e70ac58134af8/c5bb3/overlay.png\" srcset=\"/static/fe31a7b21e4d40d9442e70ac58134af8/04472/overlay.png 170w,\n/static/fe31a7b21e4d40d9442e70ac58134af8/9f933/overlay.png 340w,\n/static/fe31a7b21e4d40d9442e70ac58134af8/c5bb3/overlay.png 680w,\n/static/fe31a7b21e4d40d9442e70ac58134af8/442cb/overlay.png 752w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p><strong>🧩 The unencapsulated(Underlay) network model:</strong></p>\n<p>This model extends a Layer 3 network to facilitate the routing of packets among containers. Unlike the encapsulated counterpart, this model does not introduce an isolated Layer 2 network or any associated overhead. However, it places the onus of managing necessary route distribution squarely on the shoulders of Kubernetes workers.</p>\n<p>To make this work, a network protocol is put into action, connecting Kubernetes workers and utilizing the Border Gateway Protocol (BGP) to efficiently propagate routing information to pods. Within these pods, the role of overseeing communication with workloads is assumed by Docker or a comparable container engine. The unencapsulated network model is ideally suited for scenarios favoring a routed Layer 3 network.</p>\n<p>Here, routes for Kubernetes workers undergo dynamic updates at the operating system level, effectively mitigating latency concerns. In essence, Kubernetes networking unfolds as a multifaceted landscape, offering a plethora of plugin choices while accommodating diverse network models tailored to the distinct needs of your containerized workloads.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACMElEQVR42rWRy44SURCGe8aZuBvnbYwrFz6BUde+gnE1sOEJdDITdxqN0bhgw0o2xGDUKDGsgOF+a+jmkqaBgaGhOacp/78zjKOuPUlxiqqv/qpTbZjdUeR7eSPFUkUV8nnJX5rjODKZTFQQbGTiOqdnDff4Z02kWCyqfC4nORh8MjIej/VqtZLRaBQ1bLt/tFhpqVSqvmm2AyQDJIJmsxnUajVfay29Xu8E3DMPXLlc9m3bDlzXDa1er5Nb+74viEcM/ohspFQqKSQFEDsJBMOY4FhW77RnWcf0C4WCMk0zfAHZarWKYSpaKSXdbjcaCs5mM06hBoOBEO50OtLv9xHrq6W3kEHPOh06znPP8xhXYK841kBDT6fT34IE8UexI6FWq8W9iG119fhiKZ+zhVefUqmXDiaHmCbHF5Alh1vP5/MrwSNOiHuFbhvcLJLhcLjp25bfGc3kzcevH96/ff3OsixO6CO/IcNXsAZxnxOGO0SHCHeDWwHgkjUWrznJyHXDHV6cT1543vKEPvarIKDJcXfg+CE1Px5EowaSj2EFjPttsVjM+RwufImDjj+QK+KjPEX+CfwzCGSwojV3x6ngn+PJX5DLU8u4dnbW6/Wddrv9sNFoPAB4FwPtGX8dxPbR6x4mvA+BR6i5fRnfCYFkMnkznU4fplKpW7FYbBf+Xjab3SeQyWQOGAdzQNv6rLvG7SYSiUNqUOuP7vF4/AZBGsT/mW57tgyNNcb/PL8AAgKbi/2oqAgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/27ed908cc7970fd2efa2a90f6893ba20/c5bb3/underlay.png\" srcset=\"/static/27ed908cc7970fd2efa2a90f6893ba20/04472/underlay.png 170w,\n/static/27ed908cc7970fd2efa2a90f6893ba20/9f933/underlay.png 340w,\n/static/27ed908cc7970fd2efa2a90f6893ba20/c5bb3/underlay.png 680w,\n/static/27ed908cc7970fd2efa2a90f6893ba20/17a7a/underlay.png 753w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-cni-withcilium\" style=\"position:relative;\"><a href=\"#-cni-withcilium\" aria-label=\" cni withcilium permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🐝 CNI with Cilium</h2>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 148px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEaklEQVR42nWTC0xbVRjHLw9xThJhWWFtb+/j3EIftLePW9oU6JPHeFXAhYc42GADhGEcZAMxhLr6YkG2xW0aNXsyMUF0JtMsxgc4zdTB5piyYWJMNp2JccuccQ4c8HluKVi67SYnN+ec7/t9/+9xCIIgoiJXeXl5jCAIDwCIe9cKj8vSX1dpHMr1Wl4jHslKxDaEeO9yuWLv4X/XQbR4KELFv95ga/zszRSA7yX/jg1ykGlP7w6/D9nfF0hotdo4SqbPYam0dQRhsrdsMJ6ePycBGE/8ByZWQVcLf5GIdzpIg7V0jcZWIBWElSHwMiARkk8oWX7djr4K+GCkGbZ1l/6h1ZiPfHOUAbiwan5qmAZzhm2ws8h05VxLGhxdbwResDWH+S8Bo0NRVtY/WTA58dt2uHitc/rbn9qh6FHvxxkO09vVtcYfXWvNw16r9b1f29QAXWganuGg22e8SjxsTwpLfxkwpro299TZy9vh57+77nwx8TQ4ihwnKtLMn+7QmH+p1Vu+tGZZhy61agC60exsVyq0F5p/wPriI4HiChZZJlFlNLcVXt39RvX1DU3545ka8/CkzgDAaWYva3nINdo+3Jhn/uqdavX153z6ayxvL75XyksqadqQwPOm9y3pxnHEm/bVC+mjN1J08BernrmlTIN2k3CWFKx79Ol5Z9IEx0m9Xk5GdHsBuNgUu93WHRj0woHvPHMde50zHG89uI833ZpS8XBQZ55TC/yh+pKOmy9ufhc6a/aDI9P9atgYRTbFkFDdmnnl8KQb3jrvvH3gvAdKnsj6nFNpd1rM/IiKV+3KdhceD2waghc2H7/d2/jRXGVR881ERFCLPSD+fx0LG0+e7fX+k9lwZMo76z/mBjOvHSioavu9quMYFNc8+6eBVx1uqXhpurfpxHxP/QDkuIqGRT8g4K7BDgKliQKV67N9UtmUOebMNg5kecpGGvpOQ+PuC3cad42Du/jxMbvFeqgkr+ZMjqv4lJpHujB1UUTElC+B/X5/sAzOHN/wpt5RaNp7aabhla/BU1g5Siz/7vuWl7pUPkTELJZAJYtTeX0bb5Q29UFOWcO0jpPZF56oP87l8seGBERHAhcfOiFnGIOEpteQiC6jxT/HKdWrCSmbQPApSQ+ikPKosFGJjhQkTmUswzA0SZIPyWjamExRLIlQD0VRUilNqyNSC44XQihJotXGSySSeJZlk8NsCIJCqFPBsgEM0clZdj2JSB3et5Esmy5HlBef17E6XTLJ0flyjnaTDLMN23WRiOnHNq147cFCTEGYAiGLguMCiykrOPZ58RIbbSE5Zi1OvYpWKtuC6SNUJkfoMQwL4P0KSok6xBKJQWglqgsCZAyjwgr3S1OlqyVaSbyC5QJSijKLCmmOy1dwTAUOuhU72nCAp+SILsCgHuwap1CirXQqrcaKXaSSrV/qO0lzpVj+y1KOE2QUlS2VSils5MQq1HiZFAqFTFRFstQWURkO5hObIILEWuLaK8WAIuw/tjlgLzd8QcAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/1158931f050c8b09edd6350c1eca9d0c/12f09/cilium.png\" srcset=\"/static/1158931f050c8b09edd6350c1eca9d0c/12f09/cilium.png 148w\" sizes=\"(max-width: 148px) 100vw, 148px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p><a href=\"https://www.solo.io/topics/cilium/\" target=\"_blank\" rel=\"noopener noreferrer\">Cilium</a> is an open-source project that enables networking, security, and observability for Kubernetes clusters and other containerized environments.</p>\n<p>It is based on a technology called <a href=\"https://ebpf.io/\" target=\"_blank\" rel=\"noopener noreferrer\">eBPF</a>, which can inject network control logic, security controls, and observability features directly into the Linux kernel.</p>\n<p><a href=\"https://docs.cilium.io/en/stable/\" target=\"_blank\" rel=\"noopener noreferrer\">Cilium CNI</a> is a powerful networking plugin for Kubernetes which provides enhanced security and networking capabilities for containerised applications. It leverages the power of eBPF (extended Berkeley Packet Filter), a highly efficient and programmable kernel-level technology, to deliver transparent network security and traffic monitoring features.</p>\n<p>Cilium uses VXLAN to form an overlay network and extended Berkeley Packet Filter to manage network connectivity and application rules. It supports both IPv4 and IPv6 addressing and uses BGP for unencapsulated routing. Cilium can support multiple Kubernetes clusters and, like Multus, provides multi-CNI capabilities.</p>\n<p>Cilium handles aspects of network management, such as network policies, through HTTP request filters. Policies can be written to YAML or JSON files, both of which provide network traffic enforcement for incoming and outgoing traffic.</p>\n<blockquote>\n<p>Cilium can run using VXLAN as an overlay network for encapsulation and routingor BGP routing as an underlay network. Cilium used to rely on metallb to power it's BGP features, but since Cilium 1.3 it is possible to use their own implementation built on GoBGP.</p>\n</blockquote>\n<p>Cilium Is the only CNI with L7 aware policies. This means you can write Kubernetes networking policies that understand DNS, HTTP, and even Kafka.</p>\n<p>For example, you can write a DNS L7 networking policy to:</p>\n<p><strong>🧩 Restrict DNS Resolution to Subset:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cilium.io/v2\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> CiliumClusterwideNetworkPolicy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> dns<span class=\"token punctuation\">-</span>allow<span class=\"token punctuation\">-</span>list\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">endpointSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">egress</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">toEndpoints</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">io.kubernetes.pod.namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n        <span class=\"token key atrule\">k8s-app</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>dns\n      <span class=\"token key atrule\">toPorts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"53\"</span>\n            <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> UDP\n          <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">dns</span><span class=\"token punctuation\">:</span>\n              <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchPattern</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"*.abc.xyz\"</span>\n              <span class=\"token punctuation\">-</span> </code></pre></div>\n<p><strong>🧩 Allow POST HTTP requests to abc.xyz:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cilium.io/v2\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> CiliumNetworkPolicy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">-</span>post<span class=\"token punctuation\">-</span>abc<span class=\"token punctuation\">-</span>xyz\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">endpointSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">egress</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">toPorts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"443\"</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">method</span><span class=\"token punctuation\">:</span> POST\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">toFQDNs</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchPattern</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"*.abc.xyz\"</span></code></pre></div>\n<p><strong>🧩 Restrict Kafka Topic Access to the Following Pods:</strong></p>\n<p>Typically, we're forced to write networking policies like: \"Allow any application with the label kafka-consumer\" to speak to Kafka. This casts a rather wide net, when with L7 policies we can limit the access to individual topics depending on the labels. As such, we can say that only the \"beer-brewer\" can publish to the hops topic. Amazing, right?</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cilium.io/v2\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> CiliumNetworkPolicy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> beer<span class=\"token punctuation\">-</span>brewers\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ingress</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">fromEndpoints</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> beer<span class=\"token punctuation\">-</span>brewer\n      <span class=\"token key atrule\">toPorts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">9092</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n          <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">kafka</span><span class=\"token punctuation\">:</span>\n              <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> produce\n                <span class=\"token key atrule\">topic</span><span class=\"token punctuation\">:</span> hops</code></pre></div>\n<h3 id=\"-developer-experience\" style=\"position:relative;\"><a href=\"#-developer-experience\" aria-label=\" developer experience permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🎩 Developer experience</h3>\n<p>Now don't worry if these resources look difficult, because Cilium has that covered too. All of these network policies can be visualised, modified, and event constructed through an entirely point and click visual builder.</p>\n<p>Check out the <a href=\"https://editor.networkpolicy.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Cilium Editor</a> to see for yourself.</p>\n<h3 id=\"-installing-cilium\" style=\"position:relative;\"><a href=\"#-installing-cilium\" aria-label=\" installing cilium permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🐧 Installing Cilium</h3>\n<p>Cilium is installable as a Helm chart. So you'll first need to make the repository available:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm repo <span class=\"token function\">add</span> cilium https://helm.cilium.io/</code></pre></div>\n<p>Next, we can begin to understand and tweak the default values for the installation we require.</p>\n<p>The highlights are:</p>\n<p><strong>IPAM mode:</strong></p>\n<p>Cilium has a few different modes to manage IPAM.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.ipam.mode</span><span class=\"token operator\">=</span>cluster-pool\n<span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.ipam.operator.clusterPoolIPv4PodCIDR</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.0/16\n<span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.ipam.operator.clusterPoolIPv4MaskSize</span><span class=\"token operator\">=</span><span class=\"token number\">23</span></code></pre></div>\n<p>Cilium also has a preview feature where the IPAM mode can be set to <code class=\"language-text\">cluster-pool-v2beta</code>,\nwhich allows for dynamic, resource usage-based, allocation of node CIDRs.</p>\n<p><strong>eBPF and XDP:</strong></p>\n<p>eBPF is a relatively new technology that runs within the Linux kernel and enables the execution of eBPF programs, which run in a sandbox environment.</p>\n<p>These programs allow for user-land code to run within the kernel with unprecedented performance; extending the capabilities of the kernel.</p>\n<p>XDP leverages eBPF to provide a highly performant packet processing pipeline that runs as soon as the networking driver receives the packet. What does this actually mean? Well, with XDP - Cilium can help mitigate DDOS attacks by dropping packets before they even hit the traditional networking stack.</p>\n<p>Cilium's use of eBPF and XDP means we're not reliant on iptables, so we can actually disable the kube-proxy altogether. You'll need to do this with kubeadm and through Cilium's deploy.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">kubeProxyReplacement</span><span class=\"token operator\">=</span>probe</code></pre></div>\n<p><strong>Native routing:</strong></p>\n<p>As discussed above, Cilium doesn't need encapsulation to handle the routing of packets within our cluster; so let's ensure we enable it.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token parameter variable\">--nativeRoutingCIDR</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.0/16</code></pre></div>\n<p><strong>Hubble:</strong></p>\n<p>As Hubble and Cilium observability is a big part of the appeal, let's not forget to enable it.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.relay.enabled</span><span class=\"token operator\">=</span>true\n<span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.enabled</span><span class=\"token operator\">=</span>true\n<span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.listenAddress</span><span class=\"token operator\">=</span><span class=\"token string\">\":4244\"</span>\n<span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.ui.enabled</span><span class=\"token operator\">=</span>true</code></pre></div>\n<p><strong>Complete install:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm repo <span class=\"token function\">add</span> cilium https://helm.cilium.io/\nhelm upgrade <span class=\"token parameter variable\">--install</span> cilium/cilium cilium <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--version</span> <span class=\"token number\">1.13</span>.4 <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--namespace</span> kube-system <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">image.repository</span><span class=\"token operator\">=</span>quay.io/cilium/cilium <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.ipam.mode</span><span class=\"token operator\">=</span>cluster-pool <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.ipam.operator.clusterPoolIPv4PodCIDR</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.0/16 <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.ipam.operator.clusterPoolIPv4MaskSize</span><span class=\"token operator\">=</span><span class=\"token number\">23</span> <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.nativeRoutingCIDR</span><span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.0/16 <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.endpointRoutes.enabled</span><span class=\"token operator\">=</span>true <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.relay.enabled</span><span class=\"token operator\">=</span>true <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.enabled</span><span class=\"token operator\">=</span>true <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.listenAddress</span><span class=\"token operator\">=</span><span class=\"token string\">\":4244\"</span> <span class=\"token punctuation\">\\</span>\n                <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">global.hubble.ui.enabled</span><span class=\"token operator\">=</span>true <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">kubeProxyReplacement</span><span class=\"token operator\">=</span>probe <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">k8sServiceHost</span><span class=\"token operator\">=</span><span class=\"token variable\">${PUBLIC_IPv4}</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--set</span> <span class=\"token assign-left variable\">k8sServicePort</span><span class=\"token operator\">=</span><span class=\"token number\">6443</span></code></pre></div>\n<p>Cilium might be much newer to the Kubernetes CNI landscape, but in its short time,\nit has become the gold standard for Kubernetes networking.</p>\n<p>While Calico is also a great option, Cilium's adoption of eBPF and XDP provides a future-facing solution,\nenriched with the best debugging tool available (Hubble) and the best developer experience with the assistance of the Cilium Editor.</p>\n<h2 id=\"closing-thoughts\" style=\"position:relative;\"><a href=\"#closing-thoughts\" aria-label=\"closing thoughts permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Closing thoughts</h2>\n<p>Kubernetes networking is powered by two vital components: Kube-Proxy and CNI.</p>\n<p>Kube-Proxy maintains network rules and forwards traffic to Pods, while CNI provides a common interface to the underlying network. These components are essential for running containerized applications on Kubernetes.</p>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  <em><strong>Until next time 🎉</strong></em></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}