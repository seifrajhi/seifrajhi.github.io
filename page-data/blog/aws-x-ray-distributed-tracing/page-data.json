{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/aws-x-ray-distributed-tracing/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>End-to-end performance visibility of containerized Workloads on AWSüî•</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Introduction</h2>\n<p><a href=\"https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html\" target=\"_blank\" rel=\"noopener noreferrer\">AWS X-Ray</a> is a distributed tracing service that provides deep insights into how containerized applications perform on AWS.¬†</p>\n<p>By instrumenting your containers with the X-Ray SDK and deploying the X-Ray daemon, you can gain end-to-end visibility into requests flowing through your containerized services running on ECS or EKS.</p>\n<blockquote>\n<p>X-Ray creates detailed trace maps that show how requests are processed across multiple components, helping you identify performance bottlenecks, debug issues, and optimize your containerized applications.</p>\n</blockquote>\n<p>In this post, we'll explore how to enable X-Ray tracing for containers on ECS and EKS, the key concepts and components involved, and best practices for instrumenting and deploying your containerized workloads with X-Ray.</p>\n<h2 id=\"tracing-with-awsx-ray\" style=\"position:relative;\"><a href=\"#tracing-with-awsx-ray\" aria-label=\"tracing with awsx ray permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Tracing with AWS¬†X-Ray</h2>\n<p><a href=\"https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html\" target=\"_blank\" rel=\"noopener noreferrer\">X-Ray</a> creates detailed trace maps that show how requests are processed across multiple components, helping you identify performance bottlenecks, debug issues, and optimize your containerized applications. It integrates seamlessly with other AWS services like API Gateway, Lambda, EKS, ECS, and more to provide a comprehensive view of your distributed architecture.</p>\n<p><img src=\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3peeq41tyum7hx5ljt7a.png\" alt=\"Image description\" loading=\"lazy\">\n          </p>\n<h3 id=\"instrumenting-containerized-applications-with-aws-x-ray\" style=\"position:relative;\"><a href=\"#instrumenting-containerized-applications-with-aws-x-ray\" aria-label=\"instrumenting containerized applications with aws x ray permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Instrumenting Containerized Applications with AWS X-Ray</h3>\n<p>Instrumenting your containerized application for X-Ray tracing involves sending trace data for incoming and outbound requests, along with metadata about each request.</p>\n<p>This is done by integrating the X-Ray SDK into your application code. Many instrumentation scenarios require only configuration changes, such as instrumenting all incoming HTTP requests and downstream calls to AWS services.</p>\n<p>There are several SDKs, agents, and tools that can be used to instrument your application for X-Ray tracing, depending on the language and framework you are using.</p>\n<p>Once instrumented, your application will send trace data to the X-Ray daemon, which collects and processes the data before sending it to the X-Ray service.</p>\n<h2 id=\"hands-on-example\" style=\"position:relative;\"><a href=\"#hands-on-example\" aria-label=\"hands on example permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-On example</h2>\n<p>The first step is to install x-ray in our cluster. Let's use the <a href=\"https://github.com/okgolove/helm-charts/tree/master/charts/aws-xray\" target=\"_blank\" rel=\"noopener noreferrer\">okgolove/aws-xray</a> Helm chart.\nAdd the okgolove Helm repository.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ helm repo <span class=\"token function\">add</span> okgolove https://okgolove.github.io/helm-charts/</code></pre></div>\n<p>Create a <code class=\"language-text\">xray-values.yaml</code> file, see the default values in values.yaml:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">serviceAccount</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span> \n    <span class=\"token key atrule\">eks.amazonaws.com/role-arn</span><span class=\"token punctuation\">:</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>&lt;ACCOUNT_ID<span class=\"token punctuation\">></span><span class=\"token punctuation\">:</span>role/XRayAccessRole\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws<span class=\"token punctuation\">-</span>xray\n<span class=\"token key atrule\">xray</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> eu<span class=\"token punctuation\">-</span>west<span class=\"token punctuation\">-</span><span class=\"token number\">1</span>\n  <span class=\"token key atrule\">loglevel</span><span class=\"token punctuation\">:</span> pro</code></pre></div>\n<p>In order for the X-Ray daemon to communicate with the service, we should to create a Kubernetes service account and attach an AWS Identity and Access Management (IAM) role and policy with necessary permissions.</p>\n<p>For this, we will use eksctl</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">eksctl create iamserviceaccount <span class=\"token parameter variable\">--name</span> aws-xray <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--namespace</span> xray --role-name XRayAccessRole <span class=\"token parameter variable\">--cluster</span> aws-xray <span class=\"token punctuation\">\\</span> \n--attach-policy-arn arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--approve</span> --override-existing-serviceaccounts</code></pre></div>\n<p>Install the chart into the cluster, this will create a DaemonSet and a Service:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ helm <span class=\"token parameter variable\">-n</span> xray <span class=\"token function\">install</span> aws-xray okgolove/aws-xray <span class=\"token parameter variable\">-f</span> xray-values.yaml</code></pre></div>\n<p>This will deploy the X-Ray DaemonSet to the EKS cluster. The X-Ray daemon will be deployed to each worker node in the EKS cluster.\nFor reference, see the example implementation used in this module.</p>\n<h3 id=\"checking-x-ray-inaction\" style=\"position:relative;\"><a href=\"#checking-x-ray-inaction\" aria-label=\"checking x ray inaction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Checking X-Ray in¬†action</h3>\n<p>The AWS X-Ray SDKs are used to instrument your microservices. When using the DaemonSet in the example implementation, you need to configure it to point to <code class=\"language-text\">aws-xray.xray:2000</code>.</p>\n<p>The following showcases how to configure the X-Ray SDK for Go. This is merely an example and not a required step in the workshop.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">func <span class=\"token function-name function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  xray.Configure<span class=\"token punctuation\">(</span>xray.Config<span class=\"token punctuation\">{</span>\n      DaemonAddr:     <span class=\"token string\">\"aws-xray.xray:2000\"</span>,\n      LogLevel:       <span class=\"token string\">\"info\"</span>,\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We now have the foundation in place to deploy microservices, which are instrumented with X-Ray SDKs, to the EKS cluster.</p>\n<p>In this step, we are going to deploy example front-end and back-end  microservices to the cluster.</p>\n<blockquote>\n<p>The example services are already instrumented using the X-Ray SDK for Go. Currently, X-Ray has SDKs for Go, Python, Node.js, Ruby,¬†.NET and Java.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> clome https://github.com/seifrajhi/aws-xray-eks-containers-tracing.git\n<span class=\"token builtin class-name\">cd</span> aws-xray-eks-containers-tracing/\nkubeclt apply <span class=\"token parameter variable\">-f</span> backend/x-ray-sample-back-k8s.yml\nkubectl apply <span class=\"token parameter variable\">-f</span> frontend/x-ray-sample-front-k8s.yml</code></pre></div>\n<p>To review the status of the deployments, you can run:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ kubectl describe deployments x-ray-sample-front-k8s x-ray-sample-back-k8s</code></pre></div>\n<p>For the status of the services, run the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl describe services x-ray-sample-front-k8s x-ray-sample-back-k8s</code></pre></div>\n<p>Once the front-end service is deployed, run the following command to get the Elastic Load Balancer (ELB) endpoint and open it in a browser.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get <span class=\"token function\">service</span> x-ray-sample-front-k8s <span class=\"token parameter variable\">-o</span> wide</code></pre></div>\n<p>After your ELB is deployed and available, open up the endpoint returned by the previous command in your browser and allow it to remain open. The front-end application makes a new request to the /api endpoint once per second, which in turn calls the back-end service.\nThe JSON document displayed in the browser is the result of the request made to the back-end service.</p>\n<p>We now have the example microservices deployed, so we are going to investigate our Service Graph and Traces in X-Ray section of the AWS Management Console.</p>\n<p>The Service map in the console provides a visual representation of the steps identified by X-Ray for a particular trace. Each resource that sends data to X-Ray within the same context appears as a service in the graph.</p>\n<p>Next, go to the traces section in the AWS Management Console to view the execution times for the segments in the requests. At the top of the page, we can see the URL for the ELB endpoint and the corresponding traces below.</p>\n<p><img src=\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/9mdd2ry811mz9kn200s4.png\" alt=\"Image description\" loading=\"lazy\">\n          </p>\n<p>If you click on the link on the left in the Trace list section you will see the overall execution time for the request (0.5ms for the x-ray-sample-front-k8s which wraps other segments and subsegments), as well as a breakdown of the individual segments in the request.</p>\n<p>In this visualization, you can see the front-end and back-end segments and a subsegment named x-ray-sample-back-k8s-gen In the back-end service source code, we instrumented a subsegment that surrounds a random number generator.</p>\n<p>In the Go example, the main segment is initialized in the xray.Handler helper, which in turn sets all necessary information in the http.Request context struct, so that it can be used when initializing the subsegment.</p>\n<p><img src=\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/p8pyq9snjctsuib6cerm.png\" alt=\"Image description\" loading=\"lazy\">\n          </p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>AWS X-Ray provides valuable end-to-end visibility into containerized applications on ECS and EKS, enabling teams to optimize performance, identify issues, and deliver reliable services. By instrumenting containers with the X-Ray SDK and deploying the daemon, developers can easily trace requests across microservices and AWS resources. The intuitive X-Ray console allows quick analysis of trace data for comprehensive insights.\nAs containerized architectures grow in complexity, X-Ray is a must-have tool for maintaining high-quality, performant applications on AWS.</p>\n<p><strong>References:</strong></p>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html</a></li>\n<li><a href=\"https://aws.amazon.com/blogs/compute/application-tracing-on-kubernetes-with-aws-x-ray/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws.amazon.com/blogs/compute/application-tracing-on-kubernetes-with-aws-x-ray/</a></li>\n<li><a href=\"https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/container-tracing-with-aws-xray/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/container-tracing-with-aws-xray/</a></li>\n<li><a href=\"https://archive.eksworkshop.com/intermediate/245_x-ray/\" target=\"_blank\" rel=\"noopener noreferrer\">https://archive.eksworkshop.com/intermediate/245_x-ray/</a></li>\n</ul>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":5,"rawMarkdownBody":"\n> **End-to-end performance visibility of containerized Workloads on AWSüî•**\n\n## üìå Introduction\n\n[AWS X-Ray](https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html) is a distributed tracing service that provides deep insights into how containerized applications perform on AWS.¬†\n\nBy instrumenting your containers with the X-Ray SDK and deploying the X-Ray daemon, you can gain end-to-end visibility into requests flowing through your containerized services running on ECS or EKS.\n\n> X-Ray creates detailed trace maps that show how requests are processed across multiple components, helping you identify performance bottlenecks, debug issues, and optimize your containerized applications.\n\nIn this post, we'll explore how to enable X-Ray tracing for containers on ECS and EKS, the key concepts and components involved, and best practices for instrumenting and deploying your containerized workloads with X-Ray.\n\n\n## Tracing with AWS¬†X-Ray\n\n[X-Ray](https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html) creates detailed trace maps that show how requests are processed across multiple components, helping you identify performance bottlenecks, debug issues, and optimize your containerized applications. It integrates seamlessly with other AWS services like API Gateway, Lambda, EKS, ECS, and more to provide a comprehensive view of your distributed architecture.\n\n\n![Image description](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3peeq41tyum7hx5ljt7a.png)\n\n### Instrumenting Containerized Applications with AWS X-Ray\n\nInstrumenting your containerized application for X-Ray tracing involves sending trace data for incoming and outbound requests, along with metadata about each request.\n\nThis is done by integrating the X-Ray SDK into your application code. Many instrumentation scenarios require only configuration changes, such as instrumenting all incoming HTTP requests and downstream calls to AWS services.\n\nThere are several SDKs, agents, and tools that can be used to instrument your application for X-Ray tracing, depending on the language and framework you are using.\n\nOnce instrumented, your application will send trace data to the X-Ray daemon, which collects and processes the data before sending it to the X-Ray service.\n\n## Hands-On example\n\nThe first step is to install x-ray in our cluster. Let's use the [okgolove/aws-xray](https://github.com/okgolove/helm-charts/tree/master/charts/aws-xray) Helm chart.\nAdd the okgolove Helm repository.\n\n```shell\n$ helm repo add okgolove https://okgolove.github.io/helm-charts/\n```\n\nCreate a `xray-values.yaml` file, see the default values in values.yaml:\n\n```yaml\nserviceAccount:\n  annotations: \n    eks.amazonaws.com/role-arn: arn:aws:iam::<ACCOUNT_ID>:role/XRayAccessRole\n    name: aws-xray\nxray:\n  region: eu-west-1\n  loglevel: pro\n```\n\nIn order for the X-Ray daemon to communicate with the service, we should to create a Kubernetes service account and attach an AWS Identity and Access Management (IAM) role and policy with necessary permissions.\n\nFor this, we will use eksctl\n\n```shell\neksctl create iamserviceaccount --name aws-xray \\\n--namespace xray --role-name XRayAccessRole --cluster aws-xray \\ \n--attach-policy-arn arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess \\\n--approve --override-existing-serviceaccounts\n```\n\nInstall the chart into the cluster, this will create a DaemonSet and a Service:\n\n```shell\n$ helm -n xray install aws-xray okgolove/aws-xray -f xray-values.yaml\n```\n\nThis will deploy the X-Ray DaemonSet to the EKS cluster. The X-Ray daemon will be deployed to each worker node in the EKS cluster.\nFor reference, see the example implementation used in this module.\n\n### Checking X-Ray in¬†action\n\n\nThe AWS X-Ray SDKs are used to instrument your microservices. When using the DaemonSet in the example implementation, you need to configure it to point to `aws-xray.xray:2000`.\n\nThe following showcases how to configure the X-Ray SDK for Go. This is merely an example and not a required step in the workshop.\n\n```shell\nfunc init() {\n  xray.Configure(xray.Config{\n      DaemonAddr:     \"aws-xray.xray:2000\",\n      LogLevel:       \"info\",\n  })\n}\n```\n\nWe now have the foundation in place to deploy microservices, which are instrumented with X-Ray SDKs, to the EKS cluster.\n\nIn this step, we are going to deploy example front-end and back-end  microservices to the cluster.\n\n> The example services are already instrumented using the X-Ray SDK for Go. Currently, X-Ray has SDKs for Go, Python, Node.js, Ruby,¬†.NET and Java.\n\n```shell\ngit clome https://github.com/seifrajhi/aws-xray-eks-containers-tracing.git\ncd aws-xray-eks-containers-tracing/\nkubeclt apply -f backend/x-ray-sample-back-k8s.yml\nkubectl apply -f frontend/x-ray-sample-front-k8s.yml\n```\n\nTo review the status of the deployments, you can run:\n\n```shell\n$ kubectl describe deployments x-ray-sample-front-k8s x-ray-sample-back-k8s\n```\n\nFor the status of the services, run the following command:\n\n```shell\nkubectl describe services x-ray-sample-front-k8s x-ray-sample-back-k8s\n```\n\nOnce the front-end service is deployed, run the following command to get the Elastic Load Balancer (ELB) endpoint and open it in a browser.\n\n```shell\nkubectl get service x-ray-sample-front-k8s -o wide\n```\n\nAfter your ELB is deployed and available, open up the endpoint returned by the previous command in your browser and allow it to remain open. The front-end application makes a new request to the /api endpoint once per second, which in turn calls the back-end service. \nThe JSON document displayed in the browser is the result of the request made to the back-end service.\n\nWe now have the example microservices deployed, so we are going to investigate our Service Graph and Traces in X-Ray section of the AWS Management Console.\n\nThe Service map in the console provides a visual representation of the steps identified by X-Ray for a particular trace. Each resource that sends data to X-Ray within the same context appears as a service in the graph.\n\nNext, go to the traces section in the AWS Management Console to view the execution times for the segments in the requests. At the top of the page, we can see the URL for the ELB endpoint and the corresponding traces below.\n\n![Image description](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/9mdd2ry811mz9kn200s4.png)\n\nIf you click on the link on the left in the Trace list section you will see the overall execution time for the request (0.5ms for the x-ray-sample-front-k8s which wraps other segments and subsegments), as well as a breakdown of the individual segments in the request.\n\nIn this visualization, you can see the front-end and back-end segments and a subsegment named x-ray-sample-back-k8s-gen In the back-end service source code, we instrumented a subsegment that surrounds a random number generator.\n\nIn the Go example, the main segment is initialized in the xray.Handler helper, which in turn sets all necessary information in the http.Request context struct, so that it can be used when initializing the subsegment.\n\n![Image description](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/p8pyq9snjctsuib6cerm.png)\n\n## Conclusion\n\nAWS X-Ray provides valuable end-to-end visibility into containerized applications on ECS and EKS, enabling teams to optimize performance, identify issues, and deliver reliable services. By instrumenting containers with the X-Ray SDK and deploying the daemon, developers can easily trace requests across microservices and AWS resources. The intuitive X-Ray console allows quick analysis of trace data for comprehensive insights.\nAs containerized architectures grow in complexity, X-Ray is a must-have tool for maintaining high-quality, performant applications on AWS.\n\n**References:**\n\n- https://docs.aws.amazon.com/xray/latest/devguide/aws-xray.html\n- https://aws.amazon.com/blogs/compute/application-tracing-on-kubernetes-with-aws-x-ray/\n- https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/container-tracing-with-aws-xray/\n- https://archive.eksworkshop.com/intermediate/245_x-ray/\n  \n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  _**Until next time üéâ**_\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1021},"frontmatter":{"id":"93bc475d115b5952b44a9bbd","path":"/blog/aws-x-ray-distributed-tracing/","humanDate":"Oct 16, 2024","fullDate":"2024-10-16","title":"Enabling distributed tracing for containerized apps with AWS X-Ray","keywords":["AWS EKS","Distributed tracing","AWS X-Ray","Containerized applications","Performance visibility"],"excerpt":"Learn how to enable distributed tracing for containerized applications using AWS X-Ray, providing end-to-end performance visibility and insights into your workloads on AWS.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2klEQVR42i2SWU9TARCFb2uLBAiIiVtQQVxAEGNFENQ0ghoVEcSu3BYJFKFlkTWUFtoiIEtZyiIgBgGFuCQaH3xRH/wH+uyTf+VzeuHh5C6Zc+acmVGKB1Y45nlBljeKNbpD1cQ76uY/Ujv7ntvD61SOb+GOfaBibIPHU9saKl9s8mjqHTfDr7klNVWLn3DtfMe+/gOlaGCZ40/HOVA/QkHPAmfaZ8j0RTnXMUuR/yX53fPkPJvjfOcc2W3T5Ml3bmeMk94pjrdMcqo1Sk7PPNdG3lAcXke5oglOkCaCD8XNVf8yJYEVqife8mBsk/ujG9wVXAuucE9IZaHXlAts0zs4JUWp1MaT1IjzXGmsXJUfRyWy3hFkn2NoF84hdPZBkt3D3Bh8pZEuivtccRl3bepdJEuc7VfDGJwhDI4QevsuTzndMY3eGUGxRjQxvWMQnTwVEUx58pyS4ColksLUu6A5MPlXZW4b5ApPsQREKCi1fo2nj/MUS5gUaxsnPD4M1iB6W5gEewCDCBqkWFfTL0R5WgelaZAkaxdJtj55H5EUkso1QYq6LJyIGBHx0s4uWoYf0zdvpm0tQJqrm8SyJpJvNQo87KvuJdMxQIG1F6M0+uw9S6yxEJ9q5nDdOOk9fzmhfuNi9S+MjhEUk7eB2FYbc9vtRHaekejs47zLS5bazgW1ieyGVswVXnxlThIcfn56M0TsDl8aMshpXuJgx2+SLCFyLD9JtkZlhrUWqtQ8XB2l1HSbSfeMke3u4nq9m/wnLaSrfokWkjmFMNoCbDzNZ6apGLWukoOuiAj+4UjPPw40fSWpNr6U+kbK3ZdpGS2kvNNOZusk+ysDGMua0Zk96CxDMsuQNlO9bDNBu4SwNBhFZwtq201tWCVDbrmgO4aS2rVMVv8Ml8KTnOzf5JhvjYzGJQ65Y6Q5xkm0RTDY9s5CoNs7LaMsIH4yqXXDZHvHMPUtciO0xn+h0cWaanXrogAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/aa7f3ca604ad2b61c101694c37257795/30e2d/xray-cover.png","srcSet":"/static/aa7f3ca604ad2b61c101694c37257795/3ed30/xray-cover.png 750w,\n/static/aa7f3ca604ad2b61c101694c37257795/30e2d/xray-cover.png 800w","sizes":"100vw"},"sources":[{"srcSet":"/static/aa7f3ca604ad2b61c101694c37257795/d8ba7/xray-cover.webp 750w,\n/static/aa7f3ca604ad2b61c101694c37257795/e95cd/xray-cover.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.54}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/manage-kubernetes-with-iac/","title":"Simplify Kubernetes management with Infrastructure as Code (IaC) tools","date":"2024-10-17 10:34:00"},"excerpt":"How to automate, secure, and scale your Kubernetes infra üóØ Introduction Kubernetes is probably the most well-known solution for deploying‚Ä¶"},"nextThought":{"frontmatter":{"path":"/blog/generative-ai-on-aws/","title":"Generative AI on AWS ‚òÅÔ∏è","date":"2024-10-16 20:06:00"},"excerpt":"A Focus on SageMaker, Bedrock, and More üìù üìå Introduction Generative AI is a powerful technology that enables machines to generate content‚Ä¶"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}