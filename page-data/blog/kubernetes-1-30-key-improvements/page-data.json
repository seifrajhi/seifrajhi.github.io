{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/kubernetes-1-30-key-improvements/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>v1.30 brings significant security enhancements and improved resource management</strong></p>\n</blockquote>\n<h2 id=\"Ô∏è-introduction\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-introduction\" aria-label=\"Ô∏è introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ò∏Ô∏è Introduction</h2>\n<p>Kubernetes 1.30, set to be released on April 17th, 2024, introduces a host of new features and improvements that focus on enhancing the security, resource management, and overall cluster management capabilities of the popular container orchestration platform.</p>\n<h3 id=\"Ô∏è-apps-in-kubernetes-130\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-apps-in-kubernetes-130\" aria-label=\"Ô∏è apps in kubernetes 130 permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Apps in Kubernetes 1.30</h3>\n<p>Kubernetes 1.30 introduces more granular failure reasons for <code class=\"language-text\">Job PodFailurePolicy</code>, a <code class=\"language-text\">PodHealthyPolicy</code> for <a href=\"https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-apps%22+&#x26;pane=issue&#x26;itemId=50864904\" target=\"_blank\" rel=\"noopener noreferrer\">PodDisruptionBudget</a>, and a Job <a href=\"https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-apps%22+&#x26;pane=issue&#x26;itemId=51299612\" target=\"_blank\" rel=\"noopener noreferrer\">Success/Completion Policy</a>. These features provide greater flexibility and control for managing and monitoring application workloads.</p>\n<h3 id=\"Ô∏è-cli-in-kubernetes-130\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-cli-in-kubernetes-130\" aria-label=\"Ô∏è cli in kubernetes 130 permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üñ•Ô∏è CLI in Kubernetes 1.30</h3>\n<p>The CLI in Kubernetes 1.30 also sees several enhancements, such as the ability to <a href=\"https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-cli%22+&#x26;pane=issue&#x26;itemId=50111976\" target=\"_blank\" rel=\"noopener noreferrer\">customize</a> debug resources using the <code class=\"language-text\">--custom</code> flag in <code class=\"language-text\">kubectl debug</code>, the addition of subresource support to <code class=\"language-text\">kubectl</code>, and the introduction of an <code class=\"language-text\">--interactive</code> flag for the <code class=\"language-text\">kubectl delete</code> command to prevent accidental deletions.</p>\n<h3 id=\"-instrumentation\" style=\"position:relative;\"><a href=\"#-instrumentation\" aria-label=\" instrumentation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìà Instrumentation</h3>\n<p>Instrumentation has also been a focus in this release, with improvements to API Server tracing, metric cardinality enforcement, and the introduction of contextual logging. These features aim to enhance debugging, monitoring, and overall observability within Kubernetes environments.</p>\n<h3 id=\"-networking\" style=\"position:relative;\"><a href=\"#-networking\" aria-label=\" networking permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåê Networking</h3>\n<p>On the networking front, Kubernetes 1.30 introduces changes to the Kubernetes cloud <a href=\"https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-network%22+&#x26;pane=issue&#x26;itemId=50945844\" target=\"_blank\" rel=\"noopener noreferrer\">controller manager's service controller</a>, including the removal of transient node predicates and improvements to Ingress connectivity reliability. Additionally, the release makes Kubernetes more aware of LoadBalancer behavior, allowing cloud providers to better integrate their infrastructure with Kubernetes.</p>\n<h3 id=\"Ô∏è-nodes\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-nodes\" aria-label=\"Ô∏è nodes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üñ•Ô∏è Nodes</h3>\n<p>Enhancements to node management include the introduction of a 'sleep' action for the <code class=\"language-text\">PreStop</code> lifecycle hook, <a href=\"https://github.com/kubernetes/enhancements/issues/2400\" target=\"_blank\" rel=\"noopener noreferrer\">node memory swap support</a>, and the integration of AppArmor for defining and enforcing security policies at the container level.</p>\n<h3 id=\"-scheduling\" style=\"position:relative;\"><a href=\"#-scheduling\" aria-label=\" scheduling permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìÖ Scheduling</h3>\n<p>Scheduling improvements in Kubernetes 1.30 include the introduction of <a href=\"https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-scheduling%22+&#x26;pane=issue&#x26;itemId=50057836\" target=\"_blank\" rel=\"noopener noreferrer\">MatchLabelKeys</a> for <code class=\"language-text\">PodAffinity</code> and <code class=\"language-text\">PodAntiAffinity</code>, the decoupling of <code class=\"language-text\">TaintManager</code> from the <code class=\"language-text\">NodeLifecycleController</code>, and the ability to make pod scheduling directives mutable when gated.</p>\n<h3 id=\"-storage\" style=\"position:relative;\"><a href=\"#-storage\" aria-label=\" storage permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üíæ Storage</h3>\n<p>Finally, in the storage domain, Kubernetes 1.30 introduces a feature to <a href=\"https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-storage%22+&#x26;pane=issue&#x26;itemId=50211943\" target=\"_blank\" rel=\"noopener noreferrer\">prevent unauthorized volume mode conversio</a>n during volume restore, addressing a potential security gap in the <code class=\"language-text\">VolumeSnapshot</code> functionality.</p>\n<h3 id=\"-support-for-user-namespaces-in-pods\" style=\"position:relative;\"><a href=\"#-support-for-user-namespaces-in-pods\" aria-label=\" support for user namespaces in pods permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîí Support for User Namespaces in Pods</h3>\n<p><a href=\"https://kubernetes.io/docs/concepts/workloads/pods/user-namespaces\" target=\"_blank\" rel=\"noopener noreferrer\">User namespaces</a> is a Linux-only feature that better isolates pods to prevent or mitigate several CVEs rated high/critical, including <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-21626\" target=\"_blank\" rel=\"noopener noreferrer\">CVE-2024-21626</a>, published in January 2024. In Kubernetes 1.30, support for user namespaces is migrating to beta and now supports pods with and without volumes, custom UID/GID ranges, and more!</p>\n<h3 id=\"-cel-for-admission-control\" style=\"position:relative;\"><a href=\"#-cel-for-admission-control\" aria-label=\" cel for admission control permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìù CEL for Admission Control</h3>\n<p>Integrating Common Expression Language (CEL) for admission control in Kubernetes introduces a more dynamic and expressive way of evaluating admission requests. This feature allows complex, fine-grained policies to be defined and enforced directly through the Kubernetes API, enhancing security and governance capabilities without compromising performance or flexibility.</p>\n<p><a href=\"https://github.com/kubernetes/enhancements/issues/3221\" target=\"_blank\" rel=\"noopener noreferrer\">CEL's addition to Kubernetes admission control</a> empowers cluster administrators to craft intricate rules that can evaluate the content of API requests against the desired state and policies of the cluster without resorting to Webhook-based access controllers. For more information on using CEL for admission control, see the <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/validating-admission-policy/\" target=\"_blank\" rel=\"noopener noreferrer\">API documentation</a>.</p>\n<h3 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèÅ Conclusion</h3>\n<p>Overall, Kubernetes 1.30 represents a significant step forward in enhancing the security, flexibility, and manageability of the platform, providing users with a more robust and reliable Kubernetes environment.</p>\n<p><strong>References:</strong></p>\n<ul>\n<li><a href=\"https://github.com/orgs/kubernetes/projects/175/views/1\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/orgs/kubernetes/projects/175/views/1</a></li>\n<li><a href=\"https://kubernetes.io/blog/2024/03/12/kubernetes-1-30-upcoming-changes/\" target=\"_blank\" rel=\"noopener noreferrer\">https://kubernetes.io/blog/2024/03/12/kubernetes-1-30-upcoming-changes/</a></li>\n<li><a href=\"https://collabnix.com/whats-new-in-kubernetes-1-30-release/\" target=\"_blank\" rel=\"noopener noreferrer\">https://collabnix.com/whats-new-in-kubernetes-1-30-release/</a></li>\n<li><a href=\"https://www.reddit.com/r/kubernetes/comments/1c57j8z/whats_new_in_kubernetes_130/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.reddit.com/r/kubernetes/comments/1c57j8z/whats_new_in_kubernetes_130/</a></li>\n<li><a href=\"https://sysdig.com/blog/whats-new-in-kubernetes-1-30/\" target=\"_blank\" rel=\"noopener noreferrer\">https://sysdig.com/blog/whats-new-in-kubernetes-1-30/</a></li>\n</ul>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":3,"rawMarkdownBody":"\n> **v1.30 brings significant security enhancements and improved resource management**\n\n## ‚ò∏Ô∏è Introduction\n\nKubernetes 1.30, set to be released on April 17th, 2024, introduces a host of new features and improvements that focus on enhancing the security, resource management, and overall cluster management capabilities of the popular container orchestration platform.\n\n### üõ†Ô∏è Apps in Kubernetes 1.30\n\nKubernetes 1.30 introduces more granular failure reasons for `Job PodFailurePolicy`, a `PodHealthyPolicy` for [PodDisruptionBudget](https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-apps%22+&pane=issue&itemId=50864904), and a Job [Success/Completion Policy](https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-apps%22+&pane=issue&itemId=51299612). These features provide greater flexibility and control for managing and monitoring application workloads.\n\n### üñ•Ô∏è CLI in Kubernetes 1.30\n\nThe CLI in Kubernetes 1.30 also sees several enhancements, such as the ability to [customize](https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-cli%22+&pane=issue&itemId=50111976) debug resources using the `--custom` flag in `kubectl debug`, the addition of subresource support to `kubectl`, and the introduction of an `--interactive` flag for the `kubectl delete` command to prevent accidental deletions.\n\n### üìà Instrumentation\n\nInstrumentation has also been a focus in this release, with improvements to API Server tracing, metric cardinality enforcement, and the introduction of contextual logging. These features aim to enhance debugging, monitoring, and overall observability within Kubernetes environments.\n\n### üåê Networking\n\nOn the networking front, Kubernetes 1.30 introduces changes to the Kubernetes cloud [controller manager's service controller](https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-network%22+&pane=issue&itemId=50945844), including the removal of transient node predicates and improvements to Ingress connectivity reliability. Additionally, the release makes Kubernetes more aware of LoadBalancer behavior, allowing cloud providers to better integrate their infrastructure with Kubernetes.\n\n### üñ•Ô∏è Nodes\n\nEnhancements to node management include the introduction of a 'sleep' action for the `PreStop` lifecycle hook, [node memory swap support](https://github.com/kubernetes/enhancements/issues/2400), and the integration of AppArmor for defining and enforcing security policies at the container level.\n\n### üìÖ Scheduling\n\nScheduling improvements in Kubernetes 1.30 include the introduction of [MatchLabelKeys](https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-scheduling%22+&pane=issue&itemId=50057836) for `PodAffinity` and `PodAntiAffinity`, the decoupling of `TaintManager` from the `NodeLifecycleController`, and the ability to make pod scheduling directives mutable when gated.\n\n### üíæ Storage\n\nFinally, in the storage domain, Kubernetes 1.30 introduces a feature to [prevent unauthorized volume mode conversio](https://github.com/orgs/kubernetes/projects/175/views/1?filterQuery=sig%3A%22sig-storage%22+&pane=issue&itemId=50211943)n during volume restore, addressing a potential security gap in the `VolumeSnapshot` functionality.\n\n### üîí Support for User Namespaces in Pods\n\n[User namespaces](https://kubernetes.io/docs/concepts/workloads/pods/user-namespaces) is a Linux-only feature that better isolates pods to prevent or mitigate several CVEs rated high/critical, including [CVE-2024-21626](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-21626), published in January 2024. In Kubernetes 1.30, support for user namespaces is migrating to beta and now supports pods with and without volumes, custom UID/GID ranges, and more!\n\n### üìù CEL for Admission Control\n\nIntegrating Common Expression Language (CEL) for admission control in Kubernetes introduces a more dynamic and expressive way of evaluating admission requests. This feature allows complex, fine-grained policies to be defined and enforced directly through the Kubernetes API, enhancing security and governance capabilities without compromising performance or flexibility.\n\n[CEL's addition to Kubernetes admission control](https://github.com/kubernetes/enhancements/issues/3221) empowers cluster administrators to craft intricate rules that can evaluate the content of API requests against the desired state and policies of the cluster without resorting to Webhook-based access controllers. For more information on using CEL for admission control, see the [API documentation](https://kubernetes.io/docs/reference/access-authn-authz/validating-admission-policy/).\n\n### üèÅ Conclusion\n\nOverall, Kubernetes 1.30 represents a significant step forward in enhancing the security, flexibility, and manageability of the platform, providing users with a more robust and reliable Kubernetes environment.\n\n**References:**\n\n- https://github.com/orgs/kubernetes/projects/175/views/1\n- https://kubernetes.io/blog/2024/03/12/kubernetes-1-30-upcoming-changes/\n- https://collabnix.com/whats-new-in-kubernetes-1-30-release/\n- https://www.reddit.com/r/kubernetes/comments/1c57j8z/whats_new_in_kubernetes_130/\n- https://sysdig.com/blog/whats-new-in-kubernetes-1-30/\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":592},"frontmatter":{"id":"4920d0ccf88c1505963a3090","path":"/blog/kubernetes-1-30-key-improvements/","humanDate":"Apr 19, 2024","fullDate":"2024-04-19","title":"Kubernetes 1.30: Key Improvements You Need to¬†Know","keywords":["Kubernetes","Kubernetes 1.30","Container Orchestration","Security Enhancements","Resource Management"],"excerpt":"Discover the key improvements in Kubernetes 1.30, including security enhancements, resource management, and more.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/klEQVR42h2T/VPSWRSH+dd2aqqpbbdZ07VRdyvtZRDXrXyJ3HwBVATNQCFMwRVBNEIk31JEa9YGstatZmpntumnRpQvfHkTE4zdZ6/+dO49M/e5n3PO5yg+xwq8+bTP/EYWdyiNcynLg1kRV9IM+lMYpmS6PEk6JxIYvUn6fEn0kzIdThm1I07DUAKVReaKSeKiMY7in2iR+c0i05EDfC+KuFcPcD/7yvP34FrNYw4UMPj26fYW6PDk6RTRNFtEf3ifyHN79At1ljjX+iV+NkooxrwvuKV1YRiao8Xop380TP/wE9oMdgbGn9Ns8KPUPaVG7aaszkGJyknFjTGqGqYorXdzoWkR1aBEzX0BNMRQ6K1zVCm7uNo4iN0TwuUPc/3O71TXd9J0b41f2pzcty9RrrJwqqqX05csnLig4XztMGev2DhX60Y5IID9Cap6hEJ/OM90uEggUuD1J/AsfaTdHGB05k/UPY/RDATRWYLU6eYp+/UR1dowuqk8Gs8e7e4cjSO7KM0JqvviVB4CJ1Yz2BfTzKynCf5VQPdwgxadFXXfE2612rjaZKNUaeJyg43jFUZKGtf49m6MMy1RSjQxMRCJ66Y4lwSwQi9Kdi7nmHy2S3Bzj8iHLyxv5ln/8B/LAr7y9l8eC/X+yFd8Iup9B5y8m6DhYQyzX6JUG+Vs+7ZQKB8NpLx7B4V9MYtHqHSFMqy+28cqLDO5lsG/vov3jywdrjj2p2kGZlLUil5917bFyqbMy7+TWGZ3+KZ5i+p7CX4SA/lRJ4AjC8JvgRQmX4qxYIaFV3ssbOzRM5XCsZI9glrn0zSPyFzslTj52xZDCzHmIhIto9scux09KrdSlFsqWqDwrucwi99N0yn0wsSu0C7TIuday+EU5/FQFrVd5oYtwU1h4nPi0ZnWKGVd2xwXsHJ9nMt9Mcq7dvhBIxQGIjkcYjsMQpHhUYrhxQzaiSTt40nuOGT0ItcqtkJlSVBvlUUueeS5im7hu95Du0hUdsco0+7wfds2/wPEZJJpN+3NUgAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/1e7fadd08be11e8b62590542e95d54e0/e66c2/k8s-1-30-cover.png","srcSet":"/static/1e7fadd08be11e8b62590542e95d54e0/dc458/k8s-1-30-cover.png 750w,\n/static/1e7fadd08be11e8b62590542e95d54e0/25cea/k8s-1-30-cover.png 1080w,\n/static/1e7fadd08be11e8b62590542e95d54e0/e66c2/k8s-1-30-cover.png 1200w","sizes":"100vw"},"sources":[{"srcSet":"/static/1e7fadd08be11e8b62590542e95d54e0/4ff4a/k8s-1-30-cover.webp 750w,\n/static/1e7fadd08be11e8b62590542e95d54e0/afcae/k8s-1-30-cover.webp 1080w,\n/static/1e7fadd08be11e8b62590542e95d54e0/78def/k8s-1-30-cover.webp 1200w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.55}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/communicate-through-code/","title":"Communicate Through Code","date":"2024-08-30 13:06:00"},"excerpt":"I had been a technical lead for more than 3 years. One of my responsibilities was to make sure that my teams produced quality eCommerce‚Ä¶","html":"<p>I had been a technical lead for more than 3 years. One of my responsibilities was to make sure that my teams produced quality eCommerce solutions. During code reviews, I frequently saw one particular problem which did a great job at <strong>killing software maintainability</strong>. This problem is better known by the people management area, but, believe me, it's vitally important for software development as well. The problem is called <strong>\"poorly communicated intent\"</strong>.</p>\n<h2 id=\"code-lifecycle\" style=\"position:relative;\"><a href=\"#code-lifecycle\" aria-label=\"code lifecycle permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Code Lifecycle</h2>\n<p>When you write code, there is a problem you want to solve. So you do research and brainstorm possible approaches. You evaluate them and stick to one solution that you finally implement.</p>\n<p>This is actually where the hardest part starts.</p>\n<p>Your solution becomes <strong>a part of a bigger codebase</strong>. A whole team of several people may maintain it. They will read your code, analyze it and <strong>build on top of it</strong>. They may also <strong>evolve that piece of code</strong> to keep up with <strong>ever-changing requirements</strong>.</p>\n<p>At the same time, it's <strong>unlikely</strong> you are around all the time to ask you about your code. You may switch the team or change the company you work at. Perhaps, new members may join your team and they have not heard your cool story on why you had to solve that problem the way you had done.</p>\n<p>\n\t\t<video\n\t\t\tsrc=https://media.giphy.com/media/F7yLXA5fJ5sLC/giphy.mp4\n\t\t\twidth=\"100%\"\n\t\t\theight=\"auto\"\n\t\t\tpreload=\"auto\"\n\t\t\tmuted=\"true\"\n\t\t\ttitle=\"Be ready to support your code\"\n\t\t\tautoplay\n\t\t\tplaysinline\n\t\t\tcontrols\n\t\t\tloop\n\t\t></video>\n\t</p>\n<p>Being always around is a synchronous communication and it <strong>doesn't scale</strong> well.</p>\n<p>In the worse case, when the code owner is not available, you can still review all places that consume the code and make sure your changes will not break them. This rather tedious process significantly slows down the progress of the application development and frequently slips your deadlines.</p>\n<p>When you adjust code that you don't understand completely, there is a constant fear that there is a subtle use case which you may miss and which eventually will break. Those situations turn codebase maintenance and evolution into a desperately painful task.</p>\n<p>Poorly written code is extremely contingent and over time there will be even more code like that. One day technical debt will make you hate every Monday when you have to return to work.</p>\n<p>This is not a way to go.</p>\n<h2 id=\"intention-in-code\" style=\"position:relative;\"><a href=\"#intention-in-code\" aria-label=\"intention in code permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Intention in Code</h2>\n<p>The root of the problem is that people don't always realize that they actually <strong>communicate their intent when they do coding</strong>. Think for a moment. It's called \"programing language\", hence, it must have something <strong>in common with natural languages</strong>. Just like natural languages are useful for communicating your ideas, programing languages inherit pretty much the same idea, but <strong>language expressions</strong> are slightly different. If so, then each expression exists to convey some information, meaning and intention.</p>\n<p>Problems start when you try to <strong>misuse</strong> those expressions. This leads to implementations that are hard to read, understand, maintain and change.</p>\n<h2 id=\"complexity\" style=\"position:relative;\"><a href=\"#complexity\" aria-label=\"complexity permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Complexity</h2>\n<p>This is how we can get <strong>a complex solution</strong>, but why it's actually complex?</p>\n<p>Primarily, there are two sources of complexity:</p>\n<ul>\n<li><strong>domain complexity</strong> - implementation is complex because the problem it solves is complex (e.g. plane's runway scheduling)</li>\n<li><strong>accidental complexity</strong> - implementation could be simpler but we have implemented it in an unmaintainable way</li>\n</ul>\n<p>Domain complexity is something we can't do much about. We just need to deal with it and there are a few approaches like <a href=\"https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215\" target=\"_blank\" rel=\"noopener noreferrer\">domain-driven design</a>.</p>\n<p>At the same time, accidental complexity is something we <strong>can and should avoid</strong>. Let's take a look at the following real-world example:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token comment\"># bad code below, don't copy-paste it</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">remove_duplicates</span><span class=\"token punctuation\">(</span>clean_tokens<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    clean_dict <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">for</span> tok <span class=\"token keyword\">in</span> clean_tokens<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> tok<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isalnum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> tok<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span> clean_dict<span class=\"token punctuation\">:</span>\n                clean_dict<span class=\"token punctuation\">[</span>tok<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> tok<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                clean_dict<span class=\"token punctuation\">[</span>tok<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> tok<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n\n    result <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">,</span> clean_dict<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> result</code></pre></div>\n<p>Try to read this function a few times. What are your impressions?</p>\n<ul>\n<li>the function is called <code class=\"language-text\">remove_duplicates()</code> but it seems to omit only non-alpha-numerical values, not duplicated values</li>\n<li>what values are inside <code class=\"language-text\">tok[0]</code> and <code class=\"language-text\">tok[2]</code> items? How many items are there in each <code class=\"language-text\">tok</code> array?</li>\n<li>what's the meaning of <code class=\"language-text\">tok[2]</code> sum for each <code class=\"language-text\">tok[0]</code>?</li>\n</ul>\n<p>I can say without doubts that this piece of code is complex and it's hard to understand. However, this piece is not about launching a SpaceX shuttle (hopefully). It does something very simple, but what exactly it does was highly obscured by a poor choice of language expressions. This is what <strong>accidental complexity</strong> really means.</p>\n<h2 id=\"communication-tools\" style=\"position:relative;\"><a href=\"#communication-tools\" aria-label=\"communication tools permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Communication Tools</h2>\n<p>I hope that at this point you are already eager to know how to improve your \"communicate through code\" skills.</p>\n<p>There are two main ways to communicate your intent better:</p>\n<ul>\n<li>via programing language expressions and idioms</li>\n<li>via comments</li>\n</ul>\n<p>Each of them deserves a detailed view, so let's dive into it.</p>\n<h2 id=\"language-expressions\" style=\"position:relative;\"><a href=\"#language-expressions\" aria-label=\"language expressions permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Language Expressions</h2>\n<h3 id=\"python-vs-php\" style=\"position:relative;\"><a href=\"#python-vs-php\" aria-label=\"python vs php permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Python vs PHP</h3>\n<p>Surprisingly, let's talk about PHP for a second.</p>\n<p>I started delving into Python after I had spent quite a few years dealing with PHP.\nAfter looking at Python, my first question was: \"Why does Python have so many data structures?\". There are lists, tuples, sets, frozen sets, dicts and this are just a few to name.</p>\n<p>In the PHP world, there are arrays and associative arrays (counterparts of Python's lists and dicts). That's it. Interestingly, there are PHP's <a href=\"https://www.php.net/manual/en/book.spl.php\" target=\"_blank\" rel=\"noopener noreferrer\">SPL</a> and <a href=\"https://www.php.net/manual/en/book.ds.php\" target=\"_blank\" rel=\"noopener noreferrer\">Data Structures</a>, but, to be honest, I have hardly ever seen them in use in the wild.</p>\n<p>So I was really curious. The understanding has come to me later.</p>\n<p>It's all about communication of your intent. Python provides many more expressions, built-in functions and approaches that should be used in specific cases to <strong>offload meaning</strong> that each of them should deliver. Conversely, in PHP people often get arrays <strong>overloaded</strong> in terms of the meaning arrays should convey which makes code harder to grasp.</p>\n<p>Let's review a few examples.</p>\n<h3 id=\"types-and-collections\" style=\"position:relative;\"><a href=\"#types-and-collections\" aria-label=\"types and collections permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Types and Collections</h3>\n<p>Python has many data types and a good part of them are covered by syntax sugar to make them easier to use. Remaining data types can be found in the <code class=\"language-text\">collections</code> package.</p>\n<h4 id=\"mutable-and-unmutable\" style=\"position:relative;\"><a href=\"#mutable-and-unmutable\" aria-label=\"mutable and unmutable permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Mutable and Unmutable</h4>\n<p><strong>Lists</strong> and <strong>sets</strong> are among the basic data structures that are built-in into Python's syntax.</p>\n<p>Lists are <strong>mutable</strong> containers for items. Their items should not be necessarily the same type. Lists may contain duplicates. It's rare to see someone accesses items from the middle of the list. Sets are <strong>mutable</strong> containers with no <strong>duplicates</strong> or <strong>a specific order</strong>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">langs<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Golang\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"PHP\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"R\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Julia\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"JavaScript\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Python\"</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> lang <span class=\"token keyword\">in</span> langs<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Outputs:</span>\n<span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># Golang</span>\n<span class=\"token comment\"># PHP</span>\n<span class=\"token comment\"># R</span>\n<span class=\"token comment\"># ...</span>\n<span class=\"token comment\"># Python</span></code></pre></div>\n<p>Lists and sets have their <strong>immutable</strong> counterparts which are <strong>tuples</strong> and <strong>frozen sets</strong>. Tuples and frozen sets cannot be modified after creation. They can be used to say that it doesn't make sense to change them because they represent constants or some well-defined structure where each item has a special meaning like a database row.</p>\n<p>Python goes even further and lets you name each item in the tuples via the <code class=\"language-text\">NamedTuple</code> class:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> NamedTuple\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Student</span><span class=\"token punctuation\">(</span>NamedTuple<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    score<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span>\n\n\nstudent <span class=\"token operator\">=</span> Student<span class=\"token punctuation\">(</span><span class=\"token string\">\"Roma\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10.4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>student<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 10.4</span>\n\n<span class=\"token comment\"># equivalent to:</span>\n<span class=\"token comment\"># print(student[1])</span>\n<span class=\"token comment\"># but a way more readable</span></code></pre></div>\n<h4 id=\"dicts\" style=\"position:relative;\"><a href=\"#dicts\" aria-label=\"dicts permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Dicts</h4>\n<p>Dicts are the members of the royal family in Python. The whole Python language is based on them. Essentially, <strong>dicts</strong> are <strong>mutable</strong> mappings of <strong>unique keys</strong> to corresponding values. Dicts are typically iterated over or accesses by keys:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lang_mascots<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"python\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"üêç\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"rust\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ü¶Ä\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"golang\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"üêπ\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>lang_mascots<span class=\"token punctuation\">[</span><span class=\"token string\">\"python\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># üêç</span>\n\n<span class=\"token keyword\">for</span> lang<span class=\"token punctuation\">,</span> mascot <span class=\"token keyword\">in</span> lang_mascots<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>lang<span class=\"token punctuation\">}</span></span><span class=\"token string\"> -> </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>mascot<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># python -> üêç</span>\n<span class=\"token comment\"># rust -> ü¶Ä</span>\n<span class=\"token comment\"># golang -> üêπ</span></code></pre></div>\n<p>Even though dicts have <a href=\"https://stackoverflow.com/questions/39980323/are-dictionaries-ordered-in-python-3-6\" target=\"_blank\" rel=\"noopener noreferrer\">become ordered recently (remembers order of adding keys)</a>, you may still want to consider them unordered and use a whole another <code class=\"language-text\">OrderedDict</code> class as a means of emphasizing that you need key ordering.</p>\n<p>You can be even more specific if your values are the same type. The <code class=\"language-text\">defaultdict</code> class will help you to automatically init all non-existing keys:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> collections <span class=\"token keyword\">import</span> defaultdict\n\n\nPokemonList <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span>\n\npokemons_by_owner<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> PokemonList<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\npokemons_by_owner_safe<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> PokemonList<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> defaultdict<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># list is a factory of empty values</span>\n\npokemons_by_owner<span class=\"token punctuation\">[</span><span class=\"token string\">\"Ash\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">\"Pikachu\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># KeyError :(</span>\n\npokemons_by_owner_safe<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">\"Pikachu\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># all good, one more pokemon has been added</span></code></pre></div>\n<h4 id=\"counters\" style=\"position:relative;\"><a href=\"#counters\" aria-label=\"counters permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Counters</h4>\n<p>Often we need to count how many times each item occurs in the list or dict or to sum up items' weights. I'm sure we could do that via dicts, but Python has a better way to achieve that via the Counter class:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> collections <span class=\"token keyword\">import</span> Counter\n\n\nlangs<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Golang\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"PHP\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Golang\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"PHP\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Fortran\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\nlang_popularity<span class=\"token punctuation\">:</span> Counter <span class=\"token operator\">=</span> Counter<span class=\"token punctuation\">(</span>langs<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>lang_popularity<span class=\"token punctuation\">.</span>most_common<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [('Python', 2), ('Golang', 2), ('PHP', 2)]</span></code></pre></div>\n<p>Now let's compare this implementation with a dict-based:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> collections <span class=\"token keyword\">import</span> defaultdict\n<span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> Dict<span class=\"token punctuation\">,</span> List\n\n\nlangs<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Golang\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"PHP\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Golang\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"PHP\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Fortran\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\ncounter<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> defaultdict<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> lang <span class=\"token keyword\">in</span> langs<span class=\"token punctuation\">:</span>\n    counter<span class=\"token punctuation\">[</span>lang<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n\nmost_common <span class=\"token operator\">=</span> <span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span>counter<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> key<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> item<span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> reverse<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>most_common<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [('Python', 2), ('Golang', 2), ('PHP', 2)]</span></code></pre></div>\n<p>As we can see, the dict-based implementation has much more cognitive burden and it's harder and longer to realize that we were just looking for the three most popular languages.</p>\n<h3 id=\"looping\" style=\"position:relative;\"><a href=\"#looping\" aria-label=\"looping permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Looping</h3>\n<p>Data structures are not the only way to express your intention in code. Loops are good examples of another abstraction that is commonly used and sometimes misused.</p>\n<h4 id=\"for-and-while-loops\" style=\"position:relative;\"><a href=\"#for-and-while-loops\" aria-label=\"for and while loops permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>For and While loops</h4>\n<p>The for loop is the most frequently used loop in Python. It helps to iterate through the collection or its range and perform some actions on each item.</p>\n<p>The while loop is used less frequently and it's aimed to iterate until some condition holds true and we usually don't know the exact number of iterations to take.</p>\n<p>Consequently, we can explain why using the while loop for iterating through a collection bloats our cognitive burden:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token comment\"># bad code below, don't copy-paste it</span>\n\npets<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"dog\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"parrot\"</span><span class=\"token punctuation\">]</span>\ni<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span>  <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n<span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>pets<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pets<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></code></pre></div>\n<p>In such cases, we need to pay attention to the condition and analyze how it changes with every iteration. This is a lot to think about when we just want to check every item in collections. The \"for\" loop hides this complexity and focuses us on the item processing part:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pets<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"dog\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"parrot\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> pet <span class=\"token keyword\">in</span> pets<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pet<span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"comprehensions\" style=\"position:relative;\"><a href=\"#comprehensions\" aria-label=\"comprehensions permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Comprehensions</h4>\n<p>Often we need to keep data from collection <strong>unmodified</strong>, but just to change its output format. For example, we may have a plain list of JSON strings and we need to convert them to the list of dicts. In such cases, there are no side effects to the data itself, we just convert <strong>one collection into another</strong>. Python has brilliant constructions called list/dict/set comprehensions that are designed to be helpful here:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">raw_orders<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"{...}\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"{...}\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"{...}\"</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># each item is a JSON string that contains order information</span>\n\norders<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span>Order<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>Order<span class=\"token punctuation\">(</span>raw_order_info<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> raw_order_info <span class=\"token keyword\">in</span> raw_orders<span class=\"token punctuation\">]</span></code></pre></div>\n<p>However, if there is a need for side effects during enumeration, it's recommended to fallback into good old loops.</p>\n<h3 id=\"exceptions-and-assertions\" style=\"position:relative;\"><a href=\"#exceptions-and-assertions\" aria-label=\"exceptions and assertions permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Exceptions and Assertions</h3>\n<p>Exceptions have a special place in Python. They are used to control code flows and to implement <a href=\"https://devblogs.microsoft.com/python/idiomatic-python-eafp-versus-lbyl/\" target=\"_blank\" rel=\"noopener noreferrer\">the EAFP pattern</a> (which stands for \"it‚Äôs easier to ask for forgiveness than permission\"). Python code developers spent some time optimizing performance of exception raising. In fact, they are now even using exceptions internally to handle things like <a href=\"https://peps.python.org/pep-0234/\" target=\"_blank\" rel=\"noopener noreferrer\">ending the iteration process by raising the StopIteration exception</a>.</p>\n<p>In our case, we can use exceptions in the following way:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> os <span class=\"token keyword\">import</span> PathLike\n\n<span class=\"token keyword\">import</span> yaml\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">InvalidConfigFormat</span><span class=\"token punctuation\">(</span>RuntimeError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># a custom exception</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Occurs when config file is not in the valid YAML format\n    \"\"\"</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_config</span><span class=\"token punctuation\">(</span>config_path<span class=\"token punctuation\">:</span> PathLike<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Loads the application configurations\n    \"\"\"</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> yaml<span class=\"token punctuation\">.</span>safe_load<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>config_path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> FileNotFoundError<span class=\"token punctuation\">:</span>\n        yaml<span class=\"token punctuation\">.</span>safe_dump<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>config_path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">except</span> yaml<span class=\"token punctuation\">.</span>YAMLError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">raise</span> InvalidConfigFormat<span class=\"token punctuation\">(</span>\n            <span class=\"token string-interpolation\"><span class=\"token string\">f\"Oh no, </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>config_path<span class=\"token conversion-option punctuation\">!r</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> doesn't seem to be a valid config file: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token conversion-option punctuation\">!r</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span>\n            <span class=\"token string\">\"Please, double check the file content\"</span>\n        <span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> e\n</code></pre></div>\n<p>Pay attention to how exceptions helped us to separate different scenarios in the get_config() function:</p>\n<ul>\n<li>the main \"success path\" case (between try and the first except statements)</li>\n<li>the no config file case (the content of the FileNotFoundError handler)</li>\n<li>the wrong config format case (the YAMLError handler)</li>\n</ul>\n<p>That separation improves the readability of the code compared to retrieving some flags or status codes like in the Linux system programing.</p>\n<p>With heavy use of exceptions, it becomes important to create a custom one, so it's going to be easier to perform the granular error handling. The snippet above introduces a new InvalidConfigFormat exception that they can be caught by consumer code. It's also a common practice to reraise a custom exception that makes more sense for the concrete application and then connects it with the initial exception via the <a href=\"https://docs.python.org/3/tutorial/errors.html#exception-chaining\" target=\"_blank\" rel=\"noopener noreferrer\">raise from</a> expression.</p>\n<p>Another useful case to know is how to ignore some specific exceptions if you are okay that they can happen:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> contextlib <span class=\"token keyword\">import</span> suppress\n\n\n<span class=\"token keyword\">with</span> suppress<span class=\"token punctuation\">(</span>ImportError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># I'm fine with no pandas installed in the project</span>\n    <span class=\"token keyword\">import</span> pandas</code></pre></div>\n<p>It's also useful to know about <code class=\"language-text\">assert</code> and <code class=\"language-text\">AssertionError</code>s. Usually, you will see assert expression is being used in tests, but that's not the only use. <code class=\"language-text\">assert</code>'s may be also used to <a href=\"https://realpython.com/python-assert-statement/\" target=\"_blank\" rel=\"noopener noreferrer\">dump some assumptions about the code that has to be true</a> in the 95% of the cases but which may still be violated accidentally during the refactoring or other code adjustments. So having such sanity checks could reduce the ripple effect of the error and help to find the cause quicker:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">get_discount</span><span class=\"token punctuation\">(</span>price<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">assert</span> price <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"Price cannot be less than zero (</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>price<span class=\"token punctuation\">}</span></span><span class=\"token string\"> was given)\"</span></span>\n\n    <span class=\"token keyword\">return</span> price <span class=\"token operator\">*</span> <span class=\"token number\">0.005</span></code></pre></div>\n<p>In order to let <code class=\"language-text\">assert</code>'s work, you should not catch any <code class=\"language-text\">AssertionError</code> and let them fail as soon as possible in your development flow.</p>\n<h3 id=\"decorators\" style=\"position:relative;\"><a href=\"#decorators\" aria-label=\"decorators permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Decorators</h3>\n<p>Most likely you have heard about the decorator design pattern that is a part of <a href=\"https://en.wikipedia.org/wiki/Design_Patterns\" target=\"_blank\" rel=\"noopener noreferrer\">the GoF's design patterns</a>. The pattern is all about wrapping a function or a method into a code that will be running before or after the original one, or even replacing the original code under needed conditions. It's a transparent way to extend the code without modifying it.</p>\n<p>Python took this idea to the next level. It has <a href=\"https://peps.python.org/pep-0318/\" target=\"_blank\" rel=\"noopener noreferrer\">a dedicated syntax to register decorators</a> in a declarative way:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> functools\n<span class=\"token keyword\">from</span> collections <span class=\"token keyword\">import</span> Callable\n<span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> TypeVar<span class=\"token punctuation\">,</span> cast<span class=\"token punctuation\">,</span> Any\n\n\ntasks<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> Callable<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> Any<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\nT <span class=\"token operator\">=</span> TypeVar<span class=\"token punctuation\">(</span><span class=\"token string\">\"T\"</span><span class=\"token punctuation\">,</span> bound<span class=\"token operator\">=</span>Callable<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> Any<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">register_task</span><span class=\"token punctuation\">(</span>func<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> T<span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Registers a task function into the task registry\n    \"\"\"</span>\n    tasks<span class=\"token punctuation\">[</span>func<span class=\"token punctuation\">.</span>__name__<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> func\n\n    <span class=\"token decorator annotation punctuation\">@functools<span class=\"token punctuation\">.</span>wraps</span><span class=\"token punctuation\">(</span>func<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># BTW this is a built-in decorator</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">wrapper</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># modify behavior of the original function</span>\n        <span class=\"token keyword\">return</span> func<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">,</span> decorated<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> cast<span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">,</span> wrapper<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Usage of the decorator</span>\n\n<span class=\"token decorator annotation punctuation\">@register_task</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">sample_task</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sample task has been executed\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>To give you a better idea of how decorators are used in the wild, let's go through just a few very common problems that can be solved with decorators:</p>\n<ul>\n<li>register a new item in some registry. Let's say, you want to give an elegant way to extend a list webapp routes that you don't know beforehand. The example above illustrates the \"register\" pattern you can use to achieve that. Many Python web frameworks use decorators for that purpose like <a href=\"https://flask.palletsprojects.com/en/1.0.x/tutorial/layout/\" target=\"_blank\" rel=\"noopener noreferrer\">Flask</a>, <a href=\"https://bottlepy.org/docs/dev/\" target=\"_blank\" rel=\"noopener noreferrer\">Bottle</a>, <a href=\"https://fastapi.tiangolo.com/tutorial/first-steps/\" target=\"_blank\" rel=\"noopener noreferrer\">FastAPI</a> and others. Another example is <a href=\"https://python-socketio.readthedocs.io/en/latest/intro.html#client-examples\" target=\"_blank\" rel=\"noopener noreferrer\">Python's Socket.io client</a> which uses decorators to register handlers to some events. Yet another example is <a href=\"https://docs.celeryq.dev/en/stable/getting-started/first-steps-with-celery.html#application\" target=\"_blank\" rel=\"noopener noreferrer\">Celery</a> which uses decorators to register their tasks.</li>\n<li>do caching of some function results without modifying the function code. The built-in <code class=\"language-text\">functools</code> package contains <code class=\"language-text\">lru_cache</code> decorator that can be used to cache the output of any function.</li>\n<li>add some markers to the function for the following processing. Tensorflow, for example, has a <a href=\"https://github.com/tensorflow/tensorflow/blob/299cb76dd913e7bb0349a13c1165459dac4ea81e/tensorflow/tools/docs/doc_controls.py#L46\" target=\"_blank\" rel=\"noopener noreferrer\"><code class=\"language-text\">do_not_generate_docs()</code></a> decorator that marks functions that should not be exposed in its documentation.</li>\n<li>mark route as one that requires authorization. <a href=\"https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#the-staff-member-required-decorator\" target=\"_blank\" rel=\"noopener noreferrer\">Django</a> and many Flask extensions use decorators to mark webapp routes as ones that require authorization.</li>\n<li>parametrize a test function. <a href=\"https://docs.pytest.org/en/6.2.x/example/parametrize.html\" target=\"_blank\" rel=\"noopener noreferrer\">Pytest</a> uses decorators heavily and one of the use cases is to pass a few test cases to the same test function.</li>\n<li>MANY more...</li>\n</ul>\n<h3 id=\"context-managers\" style=\"position:relative;\"><a href=\"#context-managers\" aria-label=\"context managers permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Context Managers</h3>\n<p>Finally, let's review another case where Python has a concise solution.</p>\n<p>You have probably noticed that quite a few components in programming require us to do three steps:</p>\n<ul>\n<li>initialization (beginning of a context)</li>\n<li>the actual business logic</li>\n<li>clean up (end of the context)</li>\n</ul>\n<p>You can think about working with database, acquiring locks, working with files, mocking something in tests and so on.\nThose initialization and cleanup stages create some kind of context where you can perform some business logic.</p>\n<p>This pattern is so common that Python has got separate support on the language level to write those things in a readable way. It's called context manager. Here is an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> contextlib <span class=\"token keyword\">import</span> contextmanager\n<span class=\"token keyword\">import</span> time\n\n\n<span class=\"token decorator annotation punctuation\">@contextmanager</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">timer</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Generator<span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Timer Context Manager\n    \"\"\"</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># initialization</span>\n        start <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>perf_counter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># business logic part is decoupled from the context management</span>\n        <span class=\"token keyword\">yield</span>\n    <span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># clean up</span>\n        end <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>perf_counter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>end <span class=\"token operator\">-</span> start<span class=\"token punctuation\">:</span><span class=\"token format-spec\">0.4f</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> seconds\"</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">with</span> timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"factorial\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># business logic</span>\n    factorial<span class=\"token punctuation\">(</span><span class=\"token number\">1e3</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Context managers help to decouple business logic from the context creation. That makes the usage of contexts more cleaner without the unnecessary burden that initialization/cleanup code could bring to the code.</p>\n<p>Here are just a few examples of using context managers in the wild:</p>\n<ul>\n<li>work with files. Python vanilla <a href=\"https://docs.python.org/3/library/functions.html#open\" target=\"_blank\" rel=\"noopener noreferrer\"><code class=\"language-text\">open()</code></a> function is implemented as a context manager.</li>\n<li>create a request context. <a href=\"https://www.python-httpx.org/async/\" target=\"_blank\" rel=\"noopener noreferrer\">HTTPX</a> uses an async context manager to create a request session.</li>\n<li>mock objects for testing purposes. <a href=\"https://docs.python.org/3/library/unittest.mock.html\" target=\"_blank\" rel=\"noopener noreferrer\">Python's mock object library</a> uses a context manager to create a context where some object is going to be mocked for the sake of unit testing.</li>\n<li>control over backpropagation. <a href=\"https://keras.io/getting_started/intro_to_keras_for_researchers/\" target=\"_blank\" rel=\"noopener noreferrer\">Tensorflow and Keras</a> use a context manager to give fine-grained control over DNN backprogation gradients.</li>\n<li>define event emitting scope. I have used context managers to elaborate the scope to which you want to emit Socket.io events in <a href=\"https://github.com/seifrajhi/socket.io-redis-emitter\" target=\"_blank\" rel=\"noopener noreferrer\">the socket.io-redis-emitter project</a></li>\n<li>etc.</li>\n</ul>\n<h2 id=\"comments\" style=\"position:relative;\"><a href=\"#comments\" aria-label=\"comments permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Comments</h2>\n<p>Knowing the full context of the solution will help other contributors to evolve it. Some solutions are suboptimal because the code owner did not know a better way to implement them. So someone can understand the context and refactor the code.</p>\n<p>More frequently there are external requirements and conditions that prompt us to write suboptimal code. We need to specify them in order to let everyone know in the team. There is probably no better place for that than a comment near the code it belongs to.</p>\n<p>In other situations, we may place a summary of the solutions you considered during the research. This may save a lot of time for other people and open a door for new solutions in the future when someone comes up with even smarter ideas.</p>\n<p>In all these cases, <strong>comments are a great tool to convey your intention</strong>. They serve best when you specify:</p>\n<ul>\n<li><strong>why</strong> do you need this code</li>\n<li>and <strong>what</strong> it's intended to do</li>\n</ul>\n<p>Make sure you <strong>don't describe self-obvious details</strong> that may be easily figured out by reading the code.</p>\n<p>\n\t\t<video\n\t\t\tsrc=https://media.giphy.com/media/R2Rn1PLeMUsyTwj7wa/giphy.mp4\n\t\t\twidth=\"100%\"\n\t\t\theight=\"auto\"\n\t\t\tpreload=\"auto\"\n\t\t\tmuted=\"true\"\n\t\t\ttitle=\"Obvious comments looks like this\"\n\t\t\tautoplay\n\t\t\tplaysinline\n\t\t\tcontrols\n\t\t\tloop\n\t\t></video>\n\t</p>\n<p>The following example should be a good illustration:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\n\n<span class=\"token keyword\">from</span> somelib <span class=\"token keyword\">import</span> client\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_books</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> List<span class=\"token punctuation\">[</span>Book<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Retrieve a list of available books\n    \"\"\"</span>\n    <span class=\"token keyword\">return</span> client<span class=\"token punctuation\">.</span>get_books<span class=\"token punctuation\">(</span>page<span class=\"token operator\">=</span>page<span class=\"token punctuation\">,</span> count<span class=\"token operator\">=</span>count<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">search_books</span><span class=\"token punctuation\">(</span>keywords<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> List<span class=\"token punctuation\">[</span>Book<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Search books by keywords\n    \"\"\"</span>\n    response <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>\n        <span class=\"token string-interpolation\"><span class=\"token string\">f\"/api/v1/books/search?p=</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>page<span class=\"token punctuation\">}</span></span><span class=\"token string\">&amp;c=</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">,</span>\n        json<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"keywords\"</span><span class=\"token punctuation\">:</span> keywords<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># process edge cases</span>\n    <span class=\"token comment\"># ...</span>\n\n    <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>json<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>It's not clear why <code class=\"language-text\">search_books()</code> method doesn't use <code class=\"language-text\">somelib.client</code> for the search request and it falls back to low level <code class=\"language-text\">requests</code> calls. This question will be raised many times. In order to make this piece of code better, we should have left a comment explaining the astonishing part:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">search_books</span><span class=\"token punctuation\">(</span>keywords<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> List<span class=\"token punctuation\">[</span>Book<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Search books by keywords\n\n    somelib.client doesn't support search APIs at this point. We had to use requests to access them.\n    \"\"\"</span>\n\n    <span class=\"token comment\"># ...</span></code></pre></div>\n<p>This little comment answers all our questions and it also provides additional clues on how to refactor it (e.g. looking at release notes of the somelib to find the search method implemented).</p>\n<p>Code comments are far from being the only tool to convey your intention, but it's one of the most obvious one. The code itself should be expressive and <strong>language constructions</strong> are your best friends on this way.</p>\n<h2 id=\"dont-make-me-read-twice\" style=\"position:relative;\"><a href=\"#dont-make-me-read-twice\" aria-label=\"dont make me read twice permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Don't Make Me Read Twice</h2>\n<p>Finally, how can we identify spots in our codebase that don't communicate their intend well?</p>\n<p>One of the <a href=\"https://en.wikipedia.org/wiki/Zen_of_Python\" target=\"_blank\" rel=\"noopener noreferrer\">Python's Zens</a> is \"there should be one and only one way to do things\". The obvious and expected approaches should be preferably used to solve problems. The approaches don't surprise you when you read the code. That would reduce the mental burden and significantly improve codebase maintenance. All code pieces that can not be described that way should be on the list of candidates to be refactored or revisited.</p>\n<p>This rule from the Python Zen is related to another famous rule which is <a href=\"https://en.wikipedia.org/wiki/Principle_of_least_astonishment\" target=\"_blank\" rel=\"noopener noreferrer\">the rule of the least surprise</a>. Your code should not astonish its readers and it should make them read it twice to understand.</p>\n<p>In the real life, it may be harder to achieve high brevity of the code. After all, it's all about trade-offs. However, you should always remember about your best friends on this way: language idioms and comments, because using them does take you closer to that goal.</p>\n<h2 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>References</h2>\n<ul>\n<li><a href=\"https://www.oreilly.com/library/view/robust-python/9781098100650/\">Robust Python by Patrick Viafore</a></li>\n</ul>"},"nextThought":{"frontmatter":{"path":"/blog/kubernetes-1-28-new-features/","title":"Kubernetes 1.28: New Features for Sidecar Containers, Jobs, and Proxies","date":"2023-08-16 20:00:00"},"excerpt":"Kubernetes 1.28: What's New? üìö Introduction Kubernetes 1.28 is here, with 44 new or improved enhancements! This release includes a number‚Ä¶","html":"<blockquote>\n<p><strong>Kubernetes 1.28: What's New?</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìö Introduction</h2>\n<p>Kubernetes 1.28 is here, with 44 new or improved enhancements! This release includes a number of major features, such as built-in support for sidecar containers, job optimizations, and better proxies. These new features can help you improve the performance, efficiency, and security of your Kubernetes clusters.</p>\n<p>In this blog post, we will take a closer look at some of the key features of Kubernetes 1.28. We will also discuss how you can use these features to improve your Kubernetes deployments.</p>\n<p>Before updating, we recommend that you <a href=\"https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.28.md#urgent-upgrade-notes\" target=\"_blank\" rel=\"noopener noreferrer\">familiarize yourself with the CHANGELOG</a>.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACNUlEQVR42oWTy2sTQRzH84/24EUU7x5760kRUS96KIhChdoSqSIVWhFbtQ1N4zaxSZp389xms5tsstnHzHzc3aRPRX/sD2bYmc98f6+EUop/OeF37vH2L2eklBfrxP+AgfIZKh1bmUglEIHAnfooqWKP7Or5P4CRSSVjRYHyqIksRZmiHZQZoZPSjki+26FSbRMIgW076D1rdk9eBSLxfJ9e+DNwBZYPA0/gYWELi4m06MkmJ/0CmWqGvLNHrpNnZ6dBo352HRjlIDJdt1h9fYjtGHwbeWR1Sb7qU+2GShwRKrqMoNRskGtl+VnPhmr7sxTMQp6FN1FDOhRYe97mezrLpt6iNoB23+PhusXdZ30WXw3oDoIISb7UIF3WyDm7cSoiRvRQIlr4yqUqNJrsk3xzTHItzdtsnUl4dSs9YeGBzupXmztP+yytmLHK4iRDzkxRNgqY4gbQEB0apNj+csziQpatHy02Cg5jAS8+DLm/bKBVXJY3Rzx+PwrzKinaGkX3gKp5ghtML6odA7tBjRaHrL3bZeneASXrmI81g94ofGwYcPvJWRzyrUc6mTCfpc4QTU/RELkwCnPeo+oS2BN16qRZ2Uzycn2DithjRetS0Wcd3ewH7Oam/Dr1qHTHVMo9bHfIgDY1ecRYnUOjkMOaTOWYM3XKp+19tj4fobt1tI5BrSdioJhX13EDmk2TkeUgPBhJA13V8JRzoTJxbcS4HLOrEyDClgiEnIPn4zbvDm6M42/76oaot+926AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Kubernetes\" title=\"\" src=\"/static/8153fc277fa5be1000be90fe29006dd9/c5bb3/kep1-28.png\" srcset=\"/static/8153fc277fa5be1000be90fe29006dd9/04472/kep1-28.png 170w,\n/static/8153fc277fa5be1000be90fe29006dd9/9f933/kep1-28.png 340w,\n/static/8153fc277fa5be1000be90fe29006dd9/c5bb3/kep1-28.png 680w,\n/static/8153fc277fa5be1000be90fe29006dd9/b12f7/kep1-28.png 1020w,\n/static/8153fc277fa5be1000be90fe29006dd9/c1b63/kep1-28.png 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"-sidecar-containers\" style=\"position:relative;\"><a href=\"#-sidecar-containers\" aria-label=\" sidecar containers permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Sidecar Containers</h3>\n<p>Sidecar containers are a popular pattern for adding functionality to Kubernetes pods. They are often used for tasks such as service meshes, gathering metrics, and fetching secrets. However, implementing sidecar containers has not been easy.</p>\n<p>Until now, there was no way to tell Kubernetes that a container is a sidecar container. This meant that sidecar containers could be killed before the main container finished, or they could stay alive after messing up with jobs.</p>\n<p>Now, you can set the <code class=\"language-text\">restartPolicy</code> field to <code class=\"language-text\">Always</code> on an init container. This tells Kubernetes to treat the container as a sidecar container. Kubernetes will handle sidecar containers differently than regular containers:</p>\n<ul>\n<li>The kubelet will not wait for the container to finish. It will only wait until the startup has completed.</li>\n<li>The sidecar container will be restarted if it fails during startup, unless the pod's <code class=\"language-text\">restartPolicy</code> is <code class=\"language-text\">Never</code>. In this case, the entire pod will fail.</li>\n<li>The sidecar container will keep running as long as the main container is running.</li>\n<li>The sidecar container will be terminated once all regular containers have completed. This ensures that sidecar containers do not prevent jobs from completing after the main container has finished.</li>\n</ul>\n<p>Here is an example of how to use the <code class=\"language-text\">restartPolicy</code> field to create a sidecar container:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token punctuation\">...</span>\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">initContainers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> vault<span class=\"token punctuation\">-</span>agent\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> hashicorp/vault<span class=\"token punctuation\">:</span>1.12.1\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> istio<span class=\"token punctuation\">-</span>proxy\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> istio/proxyv2<span class=\"token punctuation\">:</span>1.16.0\n        <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"proxy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sidecar\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always\n    <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">...</span></code></pre></div>\n<h3 id=\"Ô∏è-optimizations-for-jobs\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-optimizations-for-jobs\" aria-label=\"Ô∏è optimizations for jobs permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚öôÔ∏è Optimizations for Jobs</h3>\n<p>Jobs in Kubernetes have received a lot of attention in this release. Jobs in Kubernetes can start a large number of repetitive parallel tasks at once, which is ideal for machine learning workloads. Kubernetes is becoming a major player in this area, thanks to its ongoing improvements to tools like jobs.</p>\n<p>We already discussed the <a href=\"https://github.com/kubernetes/enhancements/issues/753\" target=\"_blank\" rel=\"noopener noreferrer\">Sidecar Container feature</a>. This feature has a few surprises for job users, such as ensuring that sidecars do not prevent a job from completing.</p>\n<p><a href=\"https://github.com/kubernetes/enhancements/issues/3329\" target=\"_blank\" rel=\"noopener noreferrer\">The Retriable and Non-retriable Pod Failures for Jobs</a> and <a href=\"https://github.com/kubernetes/enhancements/issues/3850\" target=\"_blank\" rel=\"noopener noreferrer\">Backoff Limit Per Index For Indexed Jobs</a> enhancements will provide more granularity for handling job failures. Some failures are temporary or expected, and handling them differently can prevent a whole job from failing.</p>\n<p>Finally, the <a href=\"https://github.com/kubernetes/enhancements/issues/3939\" target=\"_blank\" rel=\"noopener noreferrer\">Allow for Recreation of Pods Once Fully Terminated in the Job Controller</a> provides more control options for handling jobs that have finished. This can help avoid some edge cases and race conditions.</p>\n<p>Once again, Kubernetes jobs continue to improve with each release, demonstrating the community's (machine learning) interest in this feature.</p>\n<h3 id=\"-kubernetes-packages-on-community-infrastructure\" style=\"position:relative;\"><a href=\"#-kubernetes-packages-on-community-infrastructure\" aria-label=\" kubernetes packages on community infrastructure permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üì¶ Kubernetes Packages on Community Infrastructure</h3>\n<p>The Kubernetes project is moving its package repositories to <a href=\"https://github.com/kubernetes/enhancements/issues/1731\" target=\"_blank\" rel=\"noopener noreferrer\">community-owned infrastructure</a>. This is to decouple the project from Google's infrastructure and make it more resilient and sustainable.</p>\n<p>The new repository is <a href=\"https://pkgs.k8s.io\" target=\"_blank\" rel=\"noopener noreferrer\">pkgs.k8s.io</a>. It adds to the existing repositories apt.kubernetes.io and yum.kubernetes.io. The old repositories will be deprecated at some point in the future.</p>\n<p>The Kubernetes team will publish a blog post with instructions on how to migrate to the new repositories around the time of the release.</p>\n<h3 id=\"-support-user-namespaces-in-pods\" style=\"position:relative;\"><a href=\"#-support-user-namespaces-in-pods\" aria-label=\" support user namespaces in pods permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîí Support User Namespaces in Pods</h3>\n<ul>\n<li><strong>SIG group:</strong> sig-node</li>\n<li><strong>Stage:</strong> Graduating to Alpha</li>\n<li><strong>Feature Gate:</strong> UserNamespacesStatelessPodsSupport</li>\n<li><strong>Default:</strong> false</li>\n</ul>\n<p>User namespaces is a Linux feature that allows you to run processes in pods with a different user than in the host. This can be used to improve the security of your Kubernetes cluster by limiting the damage that a compromised pod can do.</p>\n<p>For example, you could run a pod with the root user in the container, but as an unprivileged user in the host. This way, if the pod is compromised, the attacker would only have the privileges of the unprivileged user.</p>\n<p>To use user namespaces in Kubernetes, you need:</p>\n<ul>\n<li>At least a Linux 6.3 Kernel.</li>\n<li>A filesystem that supports idmap (i.e. ext4, btrfs, xfs, fat, ‚Ä¶).</li>\n<li>A container runtime with support for idmap (i.e. CRI-O 1.25, containerd 1.7).</li>\n</ul>\n<h3 id=\"-reserve-nodeport-ranges-for-dynamic-and-static-allocation\" style=\"position:relative;\"><a href=\"#-reserve-nodeport-ranges-for-dynamic-and-static-allocation\" aria-label=\" reserve nodeport ranges for dynamic and static allocation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîß Reserve NodePort Ranges for Dynamic and Static Allocation</h3>\n<ul>\n<li><strong>SIG group:</strong> sig-network</li>\n<li><strong>Stage:</strong> Graduating to Beta</li>\n<li><strong>Feature Gate:</strong> ServiceNodePortStaticSubrange</li>\n<li><strong>Default:</strong> true</li>\n</ul>\n<p>When using a NodePort service, you may want to allocate a port statically, manually defining which port to use within the service-node-port-range (default 30000-32767).</p>\n<p>However, you may find that your port has been already assigned dynamically to another service. This new feature reserves the first ports in service-node-port-range to be assigned statically.</p>\n<p>The number of reserved ports is defined by this formula <code class=\"language-text\">min(max(16, nodeport-size / 32), 128)</code>, which returns a number between 16 and 128.</p>\n<p>For example, for the default range (30000-32767), it returns 86 ports. The range 30000-30085 will be reserved for static allocations, the rest for dynamic allocations.</p>\n<p>If you want to learn more, check this blog <a href=\"https://kubernetes.io/blog/2023/05/11/nodeport-dynamic-and-static-allocation/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes 1.27: Avoid Collisions Assigning Ports to NodePort Services</a>.</p>\n<h3 id=\"-rolling-upgrades\" style=\"position:relative;\"><a href=\"#-rolling-upgrades\" aria-label=\" rolling upgrades permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîÑ Rolling Upgrades</h3>\n<p>Three new enhancements will make upgrades more reliable, and will reduce downtime. Definitely a quality of life improvement for administrators, for whom leaving the app in maintenance mode is a big fear.</p>\n<p>With <a href=\"https://kubernetes.io/blog/kubernetes-1-28/#4020\" target=\"_blank\" rel=\"noopener noreferrer\">#4020 Unknown Version Interoperability Proxy</a>, rolling upgrades of the cluster components will be better handled. Rolling upgrades meaning that not all the same components are upgraded at once, rather one by one, keeping old and new coexisting. In this case, when traffic is sent to a Kubernetes component that is down, it will be redirected to a peer that is ready.</p>\n<p>Finally, <a href=\"https://kubernetes.io/blog/kubernetes-1-28/#3836\" target=\"_blank\" rel=\"noopener noreferrer\">#3836 Kube-proxy improved ingress connectivity reliability</a> and <a href=\"https://kubernetes.io/blog/kubernetes-1-28/#1669\" target=\"_blank\" rel=\"noopener noreferrer\">#1669 Proxy terminating endpoints</a> will reduce the amount of killed connections when doing rolling upgrades. When a Pod is terminated to leave room for the new version, all its connections are killed too, leaving customers unhappy. With these enhancements, these connections will be let alone, letting the Pod terminate gracefully.</p>\n<h3 id=\"-kube-proxy-improved-ingress-connectivity-reliability\" style=\"position:relative;\"><a href=\"#-kube-proxy-improved-ingress-connectivity-reliability\" aria-label=\" kube proxy improved ingress connectivity reliability permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåê Kube-proxy Improved Ingress Connectivity Reliability</h3>\n<ul>\n<li><strong>SIG group:</strong> sig-network</li>\n<li><strong>Stage:</strong> Net New to Alpha</li>\n<li><strong>Feature Gate:</strong> KubeProxyDrainingTerminatingNodes</li>\n<li><strong>Default:</strong> false</li>\n</ul>\n<p>This enhancement adds some features to kube-proxy to better manage the health of connections.</p>\n<p>In particular:</p>\n<ul>\n<li>Once a node is terminating, kube-proxy won't immediately terminate all the connections and will let them terminate gracefully.</li>\n<li>A new <code class=\"language-text\">/livez</code> path is added where vendors and users can define a livenessProbe to determine kube-proxy health. This method is more specific than just checking if the node is terminating.</li>\n<li>Provide guidelines for vendors to implement those health checks (Aligning them into a standard is not a goal at this stage).</li>\n</ul>\n<h3 id=\"-consistent-reads-from-cache\" style=\"position:relative;\"><a href=\"#-consistent-reads-from-cache\" aria-label=\" consistent reads from cache permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìà Consistent Reads From Cache</h3>\n<ul>\n<li><strong>SIG group:</strong> sig-api-machinery</li>\n<li><strong>Stage:</strong> Net New to Alpha</li>\n<li><strong>Feature Gate:</strong> ConsistentListFromCache</li>\n<li><strong>Default:</strong> false</li>\n</ul>\n<p>This enhancement will improve the performance of some API requests like GET or LIST, by reading information from the watch cache of etcd, instead of reading it from etcd itself.</p>\n<p>This is possible thanks to WatchProgressRequest in etcd 3.4+, and will improve performance and scalability hugely on big deployments like 5k+ node clusters.</p>\n<p>If you want to read more about the technical details and how data consistency is ensured, <a href=\"https://github.com/kubernetes/enhancements/blob/master/keps/sig-api-machinery/2340-Consistent-reads-from-cache/README.md\" target=\"_blank\" rel=\"noopener noreferrer\">tap into the KEP</a>.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQH/xAAVAQEBAAAAAAAAAAAAAAAAAAAAA//aAAwDAQACEAMQAAAB3Kc6yeqiUkDoP//EABwQAAIBBQEAAAAAAAAAAAAAAAECAAMEEBESE//aAAgBAQABBQJm5C1yXlwu55mKCFz/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAERIP/aAAgBAwEBPwFW4//EABcRAAMBAAAAAAAAAAAAAAAAAAERICH/2gAIAQIBAT8BxGP/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEQICFRgf/aAAgBAQAGPwKPWB5onsBb0//EABwQAQEAAQUBAAAAAAAAAAAAAAERABAgITFBYf/aAAgBAQABPyE7ZaAfOkyvwZF6lxYADl2f/9oADAMBAAIAAwAAABAPDwD/xAAVEQEBAAAAAAAAAAAAAAAAAAAxIP/aAAgBAwEBPxAoj//EABcRAQADAAAAAAAAAAAAAAAAAAEgITH/2gAIAQIBAT8QBItmQ//EAB8QAQEAAgIBBQAAAAAAAAAAAAERACExURBBgZHh8P/aAAgBAQABPxCwFX9cCKBJEWcz5waCcOJ66E5jdMcig4nTd1evf6zQyTsxKRyeP//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Kubernetes Logo\" title=\"\" src=\"/static/2cccaa282f93543b811f1859782f90dc/7bf67/logo.jpg\" srcset=\"/static/2cccaa282f93543b811f1859782f90dc/651be/logo.jpg 170w,\n/static/2cccaa282f93543b811f1859782f90dc/d30a3/logo.jpg 340w,\n/static/2cccaa282f93543b811f1859782f90dc/7bf67/logo.jpg 680w,\n/static/2cccaa282f93543b811f1859782f90dc/4b190/logo.jpg 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèÅ Conclusion</h2>\n<p>Kubernetes is a powerful tool for managing containerized applications, and it's constantly evolving. I'm glad I could help you stay up-to-date on the latest features.</p>\n<p>I hope you found this blog helpful.</p>\n<p>If you have any other questions about Kubernetes, please don't hesitate to ask. I'm always happy to help.</p>\n<p>If you are interested in Kubernetes you may consider:</p>\n<ul>\n<li><a href=\"https://kubernetes.io/blog/\" target=\"_blank\" rel=\"noopener noreferrer\">Reading the Kubernetes blog</a>.</li>\n<li><a href=\"https://kubernetes.slack.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Tapping into the Kubernetes Slack</a>.</li>\n<li><a href=\"https://www.kubernetes.dev/docs/guide/\" target=\"_blank\" rel=\"noopener noreferrer\">Contributing to the Kubernetes project</a>.</li>\n</ul>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ üáµüá∏</em></strong></p>\n<p><br><br></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}