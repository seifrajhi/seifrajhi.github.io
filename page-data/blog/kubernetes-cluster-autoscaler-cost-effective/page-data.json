{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/kubernetes-cluster-autoscaler-cost-effective/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Optimal AWS EKS resource utilization</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🌃 Introduction</h2>\n<p>Kubernetes <a href=\"https://github.com/kubernetes/autoscaler\" target=\"_blank\" rel=\"noopener noreferrer\">Cluster Autoscaler</a> is an excellent tool that can help you save money and improve the performance of your Kubernetes cluster. By automatically scaling the number of nodes in your cluster based on the demand of your workloads, Cluster Autoscaler can help you avoid over-provisioning resources, which can lead to wasted costs.</p>\n<p>Additionally, Cluster Autoscaler can help ensure that your pods have the resources they need to run at peak performance.</p>\n<p>In this blog post, we will discuss how Cluster Autoscaler works, the benefits of using it, and how to configure it for your Kubernetes cluster.</p>\n<p>We will also provide a hands-on guide to deploying Cluster Autoscaler on <a href=\"https://aws.amazon.com/eks/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS Elastic Kubernetes Service (EKS)</a>.</p>\n<h2 id=\"-what-is-cluster-autoscaler-ca\" style=\"position:relative;\"><a href=\"#-what-is-cluster-autoscaler-ca\" aria-label=\" what is cluster autoscaler ca permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📈 What is Cluster Autoscaler (CA)?</h2>\n<p><a href=\"https://github.com/kubernetes/autoscaler\" target=\"_blank\" rel=\"noopener noreferrer\">Cluster Autoscaler</a> is a Kubernetes add-on that automatically scales the number of nodes in a cluster based on the resource requests of pods. It does not directly measure CPU or memory usage, but instead checks for pods in a pending state, which means that they cannot be scheduled to run on any of the existing nodes. When CA detects pending pods, it will add new nodes to the cluster until all pods are scheduled.</p>\n<h3 id=\"how-does-cluster-autoscaler-work\" style=\"position:relative;\"><a href=\"#how-does-cluster-autoscaler-work\" aria-label=\"how does cluster autoscaler work permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>How does Cluster Autoscaler work?</h3>\n<p>The following are the steps involved in how Cluster Autoscaler works:</p>\n<ol>\n<li><strong>CA checks for pending pods every 10 seconds.</strong></li>\n<li><strong>If there are any pending pods, CA will add a new node to the cluster, as long as it is within the constraints configured by the administrator.</strong></li>\n<li><strong>Kubernetes registers the newly provisioned node with the control plane.</strong></li>\n<li><strong>The Kubernetes scheduler then allocates the pending pods to the new node.</strong></li>\n</ol>\n<h3 id=\"limitations-of-ca\" style=\"position:relative;\"><a href=\"#limitations-of-ca\" aria-label=\"limitations of ca permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Limitations of CA</h3>\n<p>Cluster Autoscaler has a couple of limitations:</p>\n<ul>\n<li><strong>It does not make scaling decisions based on CPU or memory usage.</strong> This means that it may not scale the cluster up even if there are pods that are not scheduled due to resource shortages.</li>\n<li><strong>There is a delay between when CA requests a new node from the cloud provider and when the node is actually provisioned.</strong> This delay can cause performance degradation for pods that are waiting to be scheduled.</li>\n</ul>\n<h2 id=\"eks-example-how-to-implement-cluster-autoscaler\" style=\"position:relative;\"><a href=\"#eks-example-how-to-implement-cluster-autoscaler\" aria-label=\"eks example how to implement cluster autoscaler permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>EKS Example: How to implement Cluster Autoscaler</h2>\n<p>To implement Cluster Autoscaler on AWS Elastic Kubernetes Service (EKS), you can follow these steps:</p>\n<ol>\n<li><strong>Review the prerequisites for Cluster Autoscaler.</strong></li>\n<li><strong>Create an EKS cluster in AWS.</strong></li>\n<li><strong>Create an IAM OIDC provider.</strong></li>\n<li><strong>Create an IAM policy for Cluster Autoscaler.</strong></li>\n<li><strong>Create an IAM role for Cluster Autoscaler.</strong></li>\n<li><strong>Deploy Kubernetes Cluster Autoscaler.</strong></li>\n<li><strong>Create an Nginx deployment to test the CA functionality.</strong></li>\n</ol>\n<h3 id=\"prerequisites\" style=\"position:relative;\"><a href=\"#prerequisites\" aria-label=\"prerequisites permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Prerequisites</h3>\n<p>Cluster Autoscaler relies on the following tags to identify the AWS Auto Scaling groups that it should manage:</p>\n<ul>\n<li><code class=\"language-text\">k8s.io/cluster-autoscaler/enabled</code>: This tag must be set to true for CA to manage the Auto Scaling group.</li>\n<li><code class=\"language-text\">k8s.io/cluster-autoscaler/&lt;cluster-name>: \"owned\"</code>: This tag specifies the name of the node group that CA should manage.</li>\n</ul>\n<p>If these tags are not present, CA will not discover the Auto Scaling group and will not add or remove nodes from the EKS cluster.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">k8s.io/cluster<span class=\"token punctuation\">-</span>autoscaler/enabled=true\n<span class=\"token key atrule\">k8s.io/cluster-autoscaler/&lt;cluster-name></span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"owned\"</span></code></pre></div>\n<p>These tags are correct and CA will be able to discover and manage this Auto Scaling group.</p>\n<h3 id=\"create-an-eks-cluster\" style=\"position:relative;\"><a href=\"#create-an-eks-cluster\" aria-label=\"create an eks cluster permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Create an EKS cluster</h3>\n<p>This walkthrough will create an EKS cluster in AWS with two Auto Scaling groups to demonstrate how Cluster Autoscaler uses the autoscaling group to manage the EKS cluster.</p>\n<h4 id=\"steps\" style=\"position:relative;\"><a href=\"#steps\" aria-label=\"steps permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Steps</h4>\n<p>Create an EKS cluster configuration file using the content shown below:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> eksctl.io/v1alpha5\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterConfig\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>cluster\n    <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> eu<span class=\"token punctuation\">-</span>west<span class=\"token punctuation\">-</span><span class=\"token number\">1</span>\n<span class=\"token key atrule\">nodeGroups</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> default\n        <span class=\"token key atrule\">minSize</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n        <span class=\"token key atrule\">maxSize</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n        <span class=\"token key atrule\">nodeSelector</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">beta.kubernetes.io/os</span><span class=\"token punctuation\">:</span> linux\n        <span class=\"token comment\"># The following tags are required by Cluster Autoscaler to discover the Auto Scaling group.</span>\n        <span class=\"token key atrule\">tags</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">k8s.io/cluster-autoscaler/enabled</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"true\"</span>\n            <span class=\"token key atrule\">k8s.io/cluster-autoscaler/node-group-name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"default\"</span></code></pre></div>\n<p>Create the EKS cluster using the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">eksctl create cluster <span class=\"token parameter variable\">-f</span> cluster.yaml</code></pre></div>\n<p>Wait for the EKS cluster to be created. This may take a few minutes.</p>\n<h3 id=\"create-an-iam-oidc-provider\" style=\"position:relative;\"><a href=\"#create-an-iam-oidc-provider\" aria-label=\"create an iam oidc provider permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Create an IAM OIDC provider</h3>\n<p>IAM OIDC is used to authorize the Cluster Autoscaler to launch or terminate instances under an Auto Scaling group. In this section, we will see how to configure it with the EKS cluster.</p>\n<p><strong>Steps</strong></p>\n<ol>\n<li><strong>In the EKS cluster console, navigate to the configuration tab and copy the OpenID connect URL.</strong></li>\n<li><strong>Go to the IAM console, and select Identity providers.</strong></li>\n<li><strong>Click Add provider, select OpenID Connect, and click Get thumbprint.</strong></li>\n<li><strong>In the Audience field, enter the following value: <code class=\"language-text\">sts.amazonaws.com</code></strong></li>\n<li><strong>Click Add provider.</strong></li>\n</ol>\n<h3 id=\"create-an-iam-policy\" style=\"position:relative;\"><a href=\"#create-an-iam-policy\" aria-label=\"create an iam policy permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Create an IAM policy</h3>\n<p>Next, we need to create an IAM policy that allows the Cluster Autoscaler to increase or decrease the number of nodes in the cluster.</p>\n<p>To create the policy with the necessary permissions, save the following JSON file as <code class=\"language-text\">AmazonEKSClusterAutoscalerPolicy.json</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Statement\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"Action\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string\">\"autoscaling:DescribeAutoScalingGroups\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"autoscaling:DescribeAutoScalingInstances\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"autoscaling:DescribeLaunchConfigurations\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"autoscaling:DescribeTags\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"autoscaling:SetDesiredCapacity\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"autoscaling:TerminateInstanceInAutoScalingGroup\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"ec2:DescribeLaunchTemplateVersions\"</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"Resource\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"Effect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Allow\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then, create the policy by running the following AWS CLI command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">aws iam create-policy --policy-name AmazonEKSClusterAutoscalerPolicy --policy-document file://AmazonEKSClusterAutoscalerPolicy.json</code></pre></div>\n<p>To verify that the policy was created successfully, run the following AWS CLI command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">aws iam list-policies --max-items <span class=\"token number\">1</span></code></pre></div>\n<p>The output of this command should include a policy named <code class=\"language-text\">AmazonEKSClusterAutoscalerPolicy</code> that was created on the current date.</p>\n<h3 id=\"iam-policy-permissions\" style=\"position:relative;\"><a href=\"#iam-policy-permissions\" aria-label=\"iam policy permissions permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>IAM policy permissions</h3>\n<p>The IAM policy that you created allows the Cluster Autoscaler to perform the following actions:</p>\n<ul>\n<li><strong>Describe Auto Scaling groups</strong></li>\n<li><strong>Describe Auto Scaling instances</strong></li>\n<li><strong>Describe launch configurations</strong></li>\n<li><strong>Describe tags</strong></li>\n<li><strong>Set the desired capacity of an Auto Scaling group</strong></li>\n<li><strong>Terminate an instance in an Auto Scaling group</strong></li>\n<li><strong>Describe launch template versions</strong></li>\n</ul>\n<p>These permissions are necessary for the Cluster Autoscaler to manage the number of nodes in the cluster.</p>\n<h3 id=\"configuring-the-iam-role-for-the-provider\" style=\"position:relative;\"><a href=\"#configuring-the-iam-role-for-the-provider\" aria-label=\"configuring the iam role for the provider permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Configuring the IAM Role for the Provider</h3>\n<p>Following our previous discussion, a critical task lies ahead — establishing an IAM role and linking it to the provider that was set up in Step 3 of our process.</p>\n<ol>\n<li><strong>Access the IAM service:</strong> Begin by accessing the console of the AWS Identity and Access Management (IAM) service.</li>\n<li><strong>Role Establishment:</strong> Opt for creating a fresh role. Specify that the trusted entity is a web identity.</li>\n<li><strong>Target Audience Selection:</strong> Pick <code class=\"language-text\">sts.amazonaws.com</code> as the intended audience. This choice establishes a secure and dependable connection.</li>\n<li><strong>Policy Connection:</strong> Associate the meticulously crafted policy with this role. This policy dictates the permissions and access rights of the role.</li>\n<li><strong>Validation:</strong> Prior to moving forward, it’s imperative to validate the role and confirm the accurate attachment of the policy.</li>\n<li><strong>Refining Trust Relationships:</strong> Proceed to modify the trust relationships of the role that was generated.</li>\n<li><strong>Adjusting OIDC Settings:</strong> In this stage, enhance the settings for OIDC (OpenID Connect). Integrate the provided code snippet into the existing configuration:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"Condition\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"StringEquals\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"oidc.eks.AWS_REGION.amazonaws.com/id/EXAMPLED539D4633E53DE1B716D3041E:aud\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sts.amazonaws.com\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"oidc.eks.AWS_REGION.amazonaws.com/id/EXAMPLED539D4633E53DE1B716D3041E:sub\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"system:serviceaccount:SERVICE_ACCOUNT_NAMESPACE:SERVICE_ACCOUNT_NAME\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"8\">\n<li><strong>Save Your Modifications:</strong> After implementing these adjustments, preserve the updated trust policy. Your IAM role is now fully equipped with the necessary configurations to operate seamlessly.</li>\n</ol>\n<h3 id=\"deploy-cluster-autoscaler\" style=\"position:relative;\"><a href=\"#deploy-cluster-autoscaler\" aria-label=\"deploy cluster autoscaler permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Deploy Cluster Autoscaler</h3>\n<p>Deploying Cluster Autoscaler is the next step. This involves using the Amazon Resource Names (ARN) number of the previously created IAM role.</p>\n<p>To deploy Cluster Autoscaler, follow these steps:</p>\n<ol>\n<li><strong>Save the content provided below after the command into a file.</strong></li>\n<li><strong>Run the command provided below using the saved file:</strong></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> cluster-autoscaler.yaml</code></pre></div>\n<p>Ensure you copy the entire content:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ServiceAccount\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">k8s-addon</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler.addons.k8s.io\n    <span class=\"token key atrule\">k8s-app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">eks.amazonaws.com/role-arn</span><span class=\"token punctuation\">:</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>847845718389<span class=\"token punctuation\">:</span>role/AmazonEKSClusterAutoscalerRole\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterRole\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">k8s-addon</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler.addons.k8s.io\n    <span class=\"token key atrule\">k8s-app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"events\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"endpoints\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"create\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"patch\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"pods/eviction\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"create\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"pods/status\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"update\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"endpoints\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resourceNames</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"cluster-autoscaler\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"update\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"nodes\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"update\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"pods\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"services\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"replicationcontrollers\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"persistentvolumeclaims\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"persistentvolumes\"</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"extensions\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"replicasets\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"daemonsets\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"policy\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"poddisruptionbudgets\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"apps\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"statefulsets\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"replicasets\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"daemonsets\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"storage.k8s.io\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"storageclasses\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"csinodes\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"batch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"extensions\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"jobs\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"patch\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"coordination.k8s.io\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"leases\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"create\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"coordination.k8s.io\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resourceNames</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"cluster-autoscaler\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"leases\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"update\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Role\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">k8s-addon</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler.addons.k8s.io\n    <span class=\"token key atrule\">k8s-app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"configmaps\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"create\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"list\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"configmaps\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">resourceNames</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"cluster-autoscaler-status\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cluster-autoscaler-priority-expander\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">verbs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"delete\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"update\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterRoleBinding\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">k8s-addon</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler.addons.k8s.io\n    <span class=\"token key atrule\">k8s-app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">roleRef</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">apiGroup</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io\n  <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterRole\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">subjects</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ServiceAccount\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n    <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> RoleBinding\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">k8s-addon</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler.addons.k8s.io\n    <span class=\"token key atrule\">k8s-app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">roleRef</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">apiGroup</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io\n  <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Role\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">subjects</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ServiceAccount\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n    <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>system\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n      <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">cluster-autoscaler.kubernetes.io/safe-to-evict</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'false'</span>\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">serviceAccountName</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> k8s.gcr.io/autoscaling/cluster<span class=\"token punctuation\">-</span>autoscaler<span class=\"token punctuation\">:</span>v1.20.0\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>autoscaler\n          <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">limits</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 100m\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 500Mi\n            <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 100m\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 500Mi\n          <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> ./cluster<span class=\"token punctuation\">-</span>autoscaler\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>v=4\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>stderrthreshold=info\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>cloud<span class=\"token punctuation\">-</span>provider=aws\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>skip<span class=\"token punctuation\">-</span>nodes<span class=\"token punctuation\">-</span>with<span class=\"token punctuation\">-</span>local<span class=\"token punctuation\">-</span>storage=false\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>expander=least<span class=\"token punctuation\">-</span>waste\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>node<span class=\"token punctuation\">-</span>group<span class=\"token punctuation\">-</span>auto<span class=\"token punctuation\">-</span>discovery=asg<span class=\"token punctuation\">:</span>tag=k8s.io/cluster<span class=\"token punctuation\">-</span>autoscaler/enabled<span class=\"token punctuation\">,</span>k8s.io/cluster<span class=\"token punctuation\">-</span>autoscaler/demo<span class=\"token punctuation\">-</span>ca<span class=\"token punctuation\">-</span>cluster\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>balance<span class=\"token punctuation\">-</span>similar<span class=\"token punctuation\">-</span>node<span class=\"token punctuation\">-</span>groups\n            <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>skip<span class=\"token punctuation\">-</span>nodes<span class=\"token punctuation\">-</span>with<span class=\"token punctuation\">-</span>system<span class=\"token punctuation\">-</span>pods=false\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> ssl<span class=\"token punctuation\">-</span>certs\n              <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /etc/ssl/certs/ca<span class=\"token punctuation\">-</span>certificates.crt <span class=\"token comment\">#/etc/ssl/certs/ca-bundle.crt for Amazon Linux Worker Nodes</span>\n              <span class=\"token key atrule\">readOnly</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n          <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Always\"</span>\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> ssl<span class=\"token punctuation\">-</span>certs\n          <span class=\"token key atrule\">hostPath</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/etc/ssl/certs/ca-bundle.crt\"</span></code></pre></div>\n<p>Next, verify the logs by issuing this command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl logs <span class=\"token parameter variable\">-l</span> <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>cluster-autoscaler <span class=\"token parameter variable\">-n</span> kube-system <span class=\"token parameter variable\">-f</span></code></pre></div>\n<p>CA will now check for unscheduled pods and try to schedule them. You can see those actions from the logs. Check the status of the pods by issuing the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get pods <span class=\"token parameter variable\">-n</span> kube-system</code></pre></div>\n<h3 id=\"️-create-an-nginx-deployment-to-test-autoscaler-functionality\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-create-an-nginx-deployment-to-test-autoscaler-functionality\" aria-label=\"️ create an nginx deployment to test autoscaler functionality permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🛠️ Create an Nginx Deployment to Test Autoscaler Functionality</h3>\n<p>We are going to create two deployments: one for the managed node group, and another deployment for the unmanaged node group.</p>\n<h4 id=\"managed-node-group-deployment\" style=\"position:relative;\"><a href=\"#managed-node-group-deployment\" aria-label=\"managed node group deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Managed Node Group Deployment</h4>\n<p>Create a configuration file based on the content below:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>managed\n    <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n    <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>managed\n    <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>managed\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>managed\n                <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">:</span>latest\n                <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n            <span class=\"token key atrule\">affinity</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">nodeAffinity</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">requiredDuringSchedulingIgnoredDuringExecution</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">nodeSelectorTerms</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> role\n                                <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n                                <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n                                <span class=\"token punctuation\">-</span> managed<span class=\"token punctuation\">-</span>nodes\n                <span class=\"token key atrule\">podAntiAffinity</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">requiredDuringSchedulingIgnoredDuringExecution</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">labelSelector</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> app\n                                <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n                                <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n                                <span class=\"token punctuation\">-</span> nginx<span class=\"token punctuation\">-</span>managed\n                        <span class=\"token key atrule\">topologyKey</span><span class=\"token punctuation\">:</span> kubernetes.io/hostname\n                        <span class=\"token key atrule\">namespaces</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token punctuation\">-</span> default</code></pre></div>\n<blockquote>\n<p><strong>Note:</strong> The above configurations make use of <code class=\"language-text\">nodeAffinity</code> to select the node group with the label <code class=\"language-text\">role=managed-nodes</code> to help control where the scheduler provisions the pods.</p>\n</blockquote>\n<p>Apply the changes:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> <span class=\"token number\">1</span>-nginx-managed.yaml</code></pre></div>\n<h4 id=\"unmanaged-node-group-deployment\" style=\"position:relative;\"><a href=\"#unmanaged-node-group-deployment\" aria-label=\"unmanaged node group deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Unmanaged Node Group Deployment</h4>\n<p>For the unmanaged node group, create a configuration file using the content below:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>unmanaged\n    <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n    <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>unmanaged\n    <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>unmanaged\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>unmanaged\n                <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">:</span>1.14.2\n                <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n            <span class=\"token key atrule\">affinity</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">nodeAffinity</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">requiredDuringSchedulingIgnoredDuringExecution</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">nodeSelectorTerms</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> role\n                                <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n                                <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n                                <span class=\"token punctuation\">-</span> unmanaged<span class=\"token punctuation\">-</span>nodes\n                <span class=\"token key atrule\">podAntiAffinity</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">requiredDuringSchedulingIgnoredDuringExecution</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">labelSelector</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> app\n                                <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n                                <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n                                <span class=\"token punctuation\">-</span> nginx<span class=\"token punctuation\">-</span>unmanaged\n                        <span class=\"token key atrule\">topologyKey</span><span class=\"token punctuation\">:</span> kubernetes.io/hostname\n                        <span class=\"token key atrule\">namespaces</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token punctuation\">-</span> default</code></pre></div>\n<p>Apply the changes:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> <span class=\"token number\">2</span>-nginx-unmanaged.yaml</code></pre></div>\n<p>Check the status of the pods:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get pods <span class=\"token parameter variable\">-n</span> default</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">NAME                               READY   STATUS    RESTARTS   AGE\nnginx-managed-7cf8b6449c-mctsg     <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          60s\nnginx-managed-7cf8b6449c-vjvxf     <span class=\"token number\">0</span>/1     Pending   <span class=\"token number\">0</span>          60s\nnginx-unmanaged-67dcfb44c9-gvjg4   <span class=\"token number\">0</span>/1     Pending   <span class=\"token number\">0</span>          52s\nnginx-unmanaged-67dcfb44c9-wqnvr   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          52s</code></pre></div>\n<p>Now, you can see two of the four pods are running because we have only two nodes in the cluster. Please note that we have used a <a href=\"https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity\" target=\"_blank\" rel=\"noopener noreferrer\">pod AntiAffinity</a> configuration to prevent Kubernetes from provisioning multiple pods of this deployment on the same node (thereby avoiding the need for the additional capacity required to demonstrate CA’s functionality).</p>\n<p>The Cluster Autoscaler will check the state of the pods, discover that some are in a “pending” state, and try to provision new nodes in the cluster. In a few minutes, you will see a third node provisioned.</p>\n<p>One pod is still in a pending state because we did not add the label when we created the EKS cluster with managed/unmanaged node groups. If the label is not present in the Auto Scaling group, then the Cluster Autoscaler will not discover the Auto Scaling group to scale the cluster.</p>\n<h2 id=\"-summary\" style=\"position:relative;\"><a href=\"#-summary\" aria-label=\" summary permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🔚 Summary</h2>\n<p>Kubernetes Cluster Autoscaler (CA) is a tool that automatically scales up or down the number of nodes in a Kubernetes cluster based on the number of pods that are running. This can help to improve resource utilization and reduce costs.</p>\n<p>In this blog post, we discussed how CA works and how to deploy it in your cluster. We also looked at some of the best practices for configuring CA to optimize resource utilization and performance.</p>\n<p>By following the tips in this blog post, you can use CA to automatically scale your cluster and ensure that you are only paying for the resources that you need. This can help you to save money and improve the performance of your applications.</p>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  <strong><em>Until next time 🎉</em></strong></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p><strong>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</strong></p>","timeToRead":10,"rawMarkdownBody":"\n> **Optimal AWS EKS resource utilization**\n\n## 🌃 Introduction\n\nKubernetes [Cluster Autoscaler](https://github.com/kubernetes/autoscaler) is an excellent tool that can help you save money and improve the performance of your Kubernetes cluster. By automatically scaling the number of nodes in your cluster based on the demand of your workloads, Cluster Autoscaler can help you avoid over-provisioning resources, which can lead to wasted costs.\n\nAdditionally, Cluster Autoscaler can help ensure that your pods have the resources they need to run at peak performance.\n\nIn this blog post, we will discuss how Cluster Autoscaler works, the benefits of using it, and how to configure it for your Kubernetes cluster.\n\nWe will also provide a hands-on guide to deploying Cluster Autoscaler on [AWS Elastic Kubernetes Service (EKS)](https://aws.amazon.com/eks/).\n\n## 📈 What is Cluster Autoscaler (CA)?\n\n[Cluster Autoscaler](https://github.com/kubernetes/autoscaler) is a Kubernetes add-on that automatically scales the number of nodes in a cluster based on the resource requests of pods. It does not directly measure CPU or memory usage, but instead checks for pods in a pending state, which means that they cannot be scheduled to run on any of the existing nodes. When CA detects pending pods, it will add new nodes to the cluster until all pods are scheduled.\n\n### How does Cluster Autoscaler work?\n\nThe following are the steps involved in how Cluster Autoscaler works:\n\n1. **CA checks for pending pods every 10 seconds.**\n2. **If there are any pending pods, CA will add a new node to the cluster, as long as it is within the constraints configured by the administrator.**\n3. **Kubernetes registers the newly provisioned node with the control plane.**\n4. **The Kubernetes scheduler then allocates the pending pods to the new node.**\n\n### Limitations of CA\n\nCluster Autoscaler has a couple of limitations:\n\n- **It does not make scaling decisions based on CPU or memory usage.** This means that it may not scale the cluster up even if there are pods that are not scheduled due to resource shortages.\n- **There is a delay between when CA requests a new node from the cloud provider and when the node is actually provisioned.** This delay can cause performance degradation for pods that are waiting to be scheduled.\n\n## EKS Example: How to implement Cluster Autoscaler\n\nTo implement Cluster Autoscaler on AWS Elastic Kubernetes Service (EKS), you can follow these steps:\n\n1. **Review the prerequisites for Cluster Autoscaler.**\n2. **Create an EKS cluster in AWS.**\n3. **Create an IAM OIDC provider.**\n4. **Create an IAM policy for Cluster Autoscaler.**\n5. **Create an IAM role for Cluster Autoscaler.**\n6. **Deploy Kubernetes Cluster Autoscaler.**\n7. **Create an Nginx deployment to test the CA functionality.**\n\n### Prerequisites\n\nCluster Autoscaler relies on the following tags to identify the AWS Auto Scaling groups that it should manage:\n\n- `k8s.io/cluster-autoscaler/enabled`: This tag must be set to true for CA to manage the Auto Scaling group.\n- `k8s.io/cluster-autoscaler/<cluster-name>: \"owned\"`: This tag specifies the name of the node group that CA should manage.\n\nIf these tags are not present, CA will not discover the Auto Scaling group and will not add or remove nodes from the EKS cluster.\n\n```yaml\nk8s.io/cluster-autoscaler/enabled=true\nk8s.io/cluster-autoscaler/<cluster-name>: \"owned\"\n```\n\nThese tags are correct and CA will be able to discover and manage this Auto Scaling group.\n\n### Create an EKS cluster\n\nThis walkthrough will create an EKS cluster in AWS with two Auto Scaling groups to demonstrate how Cluster Autoscaler uses the autoscaling group to manage the EKS cluster.\n\n#### Steps\n\nCreate an EKS cluster configuration file using the content shown below:\n\n```yaml\napiVersion: eksctl.io/v1alpha5\nkind: ClusterConfig\nmetadata:\n    name: my-cluster\n    region: eu-west-1\nnodeGroups:\n    - name: default\n        minSize: 2\n        maxSize: 5\n        nodeSelector:\n            beta.kubernetes.io/os: linux\n        # The following tags are required by Cluster Autoscaler to discover the Auto Scaling group.\n        tags:\n            k8s.io/cluster-autoscaler/enabled: \"true\"\n            k8s.io/cluster-autoscaler/node-group-name: \"default\"\n```\n\nCreate the EKS cluster using the following command:\n\n```shell\neksctl create cluster -f cluster.yaml\n```\n\nWait for the EKS cluster to be created. This may take a few minutes.\n\n### Create an IAM OIDC provider\n\nIAM OIDC is used to authorize the Cluster Autoscaler to launch or terminate instances under an Auto Scaling group. In this section, we will see how to configure it with the EKS cluster.\n\n**Steps**\n\n1. **In the EKS cluster console, navigate to the configuration tab and copy the OpenID connect URL.**\n2. **Go to the IAM console, and select Identity providers.**\n3. **Click Add provider, select OpenID Connect, and click Get thumbprint.**\n4. **In the Audience field, enter the following value: `sts.amazonaws.com`**\n5. **Click Add provider.**\n\n### Create an IAM policy\n\nNext, we need to create an IAM policy that allows the Cluster Autoscaler to increase or decrease the number of nodes in the cluster.\n\nTo create the policy with the necessary permissions, save the following JSON file as `AmazonEKSClusterAutoscalerPolicy.json`:\n\n```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"autoscaling:DescribeAutoScalingGroups\",\n                \"autoscaling:DescribeAutoScalingInstances\",\n                \"autoscaling:DescribeLaunchConfigurations\",\n                \"autoscaling:DescribeTags\",\n                \"autoscaling:SetDesiredCapacity\",\n                \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n                \"ec2:DescribeLaunchTemplateVersions\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        }\n    ]\n}\n```\n\nThen, create the policy by running the following AWS CLI command:\n\n```shell\naws iam create-policy --policy-name AmazonEKSClusterAutoscalerPolicy --policy-document file://AmazonEKSClusterAutoscalerPolicy.json\n```\n\nTo verify that the policy was created successfully, run the following AWS CLI command:\n\n```shell\naws iam list-policies --max-items 1\n```\n\nThe output of this command should include a policy named `AmazonEKSClusterAutoscalerPolicy` that was created on the current date.\n\n### IAM policy permissions\n\nThe IAM policy that you created allows the Cluster Autoscaler to perform the following actions:\n\n- **Describe Auto Scaling groups**\n- **Describe Auto Scaling instances**\n- **Describe launch configurations**\n- **Describe tags**\n- **Set the desired capacity of an Auto Scaling group**\n- **Terminate an instance in an Auto Scaling group**\n- **Describe launch template versions**\n\nThese permissions are necessary for the Cluster Autoscaler to manage the number of nodes in the cluster.\n\n### Configuring the IAM Role for the Provider\n\nFollowing our previous discussion, a critical task lies ahead — establishing an IAM role and linking it to the provider that was set up in Step 3 of our process.\n\n1. **Access the IAM service:** Begin by accessing the console of the AWS Identity and Access Management (IAM) service.\n2. **Role Establishment:** Opt for creating a fresh role. Specify that the trusted entity is a web identity.\n3. **Target Audience Selection:** Pick `sts.amazonaws.com` as the intended audience. This choice establishes a secure and dependable connection.\n4. **Policy Connection:** Associate the meticulously crafted policy with this role. This policy dictates the permissions and access rights of the role.\n5. **Validation:** Prior to moving forward, it’s imperative to validate the role and confirm the accurate attachment of the policy.\n6. **Refining Trust Relationships:** Proceed to modify the trust relationships of the role that was generated.\n7. **Adjusting OIDC Settings:** In this stage, enhance the settings for OIDC (OpenID Connect). Integrate the provided code snippet into the existing configuration:\n\n```json\n\"Condition\": {\n    \"StringEquals\": {\n        \"oidc.eks.AWS_REGION.amazonaws.com/id/EXAMPLED539D4633E53DE1B716D3041E:aud\": \"sts.amazonaws.com\",\n        \"oidc.eks.AWS_REGION.amazonaws.com/id/EXAMPLED539D4633E53DE1B716D3041E:sub\": \"system:serviceaccount:SERVICE_ACCOUNT_NAMESPACE:SERVICE_ACCOUNT_NAME\"\n    }\n}\n```\n\n8. **Save Your Modifications:** After implementing these adjustments, preserve the updated trust policy. Your IAM role is now fully equipped with the necessary configurations to operate seamlessly.\n\n### Deploy Cluster Autoscaler\n\nDeploying Cluster Autoscaler is the next step. This involves using the Amazon Resource Names (ARN) number of the previously created IAM role.\n\nTo deploy Cluster Autoscaler, follow these steps:\n\n1. **Save the content provided below after the command into a file.**\n2. **Run the command provided below using the saved file:**\n\n```shell\nkubectl apply -f cluster-autoscaler.yaml\n```\n\nEnsure you copy the entire content:\n\n```yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  labels:\n    k8s-addon: cluster-autoscaler.addons.k8s.io\n    k8s-app: cluster-autoscaler\n  annotations:\n    eks.amazonaws.com/role-arn: arn:aws:iam::847845718389:role/AmazonEKSClusterAutoscalerRole\n  name: cluster-autoscaler\n  namespace: kube-system\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: cluster-autoscaler\n  labels:\n    k8s-addon: cluster-autoscaler.addons.k8s.io\n    k8s-app: cluster-autoscaler\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"events\", \"endpoints\"]\n    verbs: [\"create\", \"patch\"]\n  - apiGroups: [\"\"]\n    resources: [\"pods/eviction\"]\n    verbs: [\"create\"]\n  - apiGroups: [\"\"]\n    resources: [\"pods/status\"]\n    verbs: [\"update\"]\n  - apiGroups: [\"\"]\n    resources: [\"endpoints\"]\n    resourceNames: [\"cluster-autoscaler\"]\n    verbs: [\"get\", \"update\"]\n  - apiGroups: [\"\"]\n    resources: [\"nodes\"]\n    verbs: [\"watch\", \"list\", \"get\", \"update\"]\n  - apiGroups: [\"\"]\n    resources:\n      - \"pods\"\n      - \"services\"\n      - \"replicationcontrollers\"\n      - \"persistentvolumeclaims\"\n      - \"persistentvolumes\"\n    verbs: [\"watch\", \"list\", \"get\"]\n  - apiGroups: [\"extensions\"]\n    resources: [\"replicasets\", \"daemonsets\"]\n    verbs: [\"watch\", \"list\", \"get\"]\n  - apiGroups: [\"policy\"]\n    resources: [\"poddisruptionbudgets\"]\n    verbs: [\"watch\", \"list\"]\n  - apiGroups: [\"apps\"]\n    resources: [\"statefulsets\", \"replicasets\", \"daemonsets\"]\n    verbs: [\"watch\", \"list\", \"get\"]\n  - apiGroups: [\"storage.k8s.io\"]\n    resources: [\"storageclasses\", \"csinodes\"]\n    verbs: [\"watch\", \"list\", \"get\"]\n  - apiGroups: [\"batch\", \"extensions\"]\n    resources: [\"jobs\"]\n    verbs: [\"get\", \"list\", \"watch\", \"patch\"]\n  - apiGroups: [\"coordination.k8s.io\"]\n    resources: [\"leases\"]\n    verbs: [\"create\"]\n  - apiGroups: [\"coordination.k8s.io\"]\n    resourceNames: [\"cluster-autoscaler\"]\n    resources: [\"leases\"]\n    verbs: [\"get\", \"update\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: cluster-autoscaler\n  namespace: kube-system\n  labels:\n    k8s-addon: cluster-autoscaler.addons.k8s.io\n    k8s-app: cluster-autoscaler\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"configmaps\"]\n    verbs: [\"create\",\"list\",\"watch\"]\n  - apiGroups: [\"\"]\n    resources: [\"configmaps\"]\n    resourceNames: [\"cluster-autoscaler-status\", \"cluster-autoscaler-priority-expander\"]\n    verbs: [\"delete\", \"get\", \"update\", \"watch\"]\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: cluster-autoscaler\n  labels:\n    k8s-addon: cluster-autoscaler.addons.k8s.io\n    k8s-app: cluster-autoscaler\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-autoscaler\nsubjects:\n  - kind: ServiceAccount\n    name: cluster-autoscaler\n    namespace: kube-system\n\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: cluster-autoscaler\n  namespace: kube-system\n  labels:\n    k8s-addon: cluster-autoscaler.addons.k8s.io\n    k8s-app: cluster-autoscaler\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: cluster-autoscaler\nsubjects:\n  - kind: ServiceAccount\n    name: cluster-autoscaler\n    namespace: kube-system\n\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cluster-autoscaler\n  namespace: kube-system\n  labels:\n    app: cluster-autoscaler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cluster-autoscaler\n  template:\n    metadata:\n      labels:\n        app: cluster-autoscaler\n      annotations:\n        cluster-autoscaler.kubernetes.io/safe-to-evict: 'false'\n    spec:\n      serviceAccountName: cluster-autoscaler\n      containers:\n        - image: k8s.gcr.io/autoscaling/cluster-autoscaler:v1.20.0\n          name: cluster-autoscaler\n          resources:\n            limits:\n              cpu: 100m\n              memory: 500Mi\n            requests:\n              cpu: 100m\n              memory: 500Mi\n          command:\n            - ./cluster-autoscaler\n            - --v=4\n            - --stderrthreshold=info\n            - --cloud-provider=aws\n            - --skip-nodes-with-local-storage=false\n            - --expander=least-waste\n            - --node-group-auto-discovery=asg:tag=k8s.io/cluster-autoscaler/enabled,k8s.io/cluster-autoscaler/demo-ca-cluster\n            - --balance-similar-node-groups\n            - --skip-nodes-with-system-pods=false\n          volumeMounts:\n            - name: ssl-certs\n              mountPath: /etc/ssl/certs/ca-certificates.crt #/etc/ssl/certs/ca-bundle.crt for Amazon Linux Worker Nodes\n              readOnly: true\n          imagePullPolicy: \"Always\"\n      volumes:\n        - name: ssl-certs\n          hostPath:\n            path: \"/etc/ssl/certs/ca-bundle.crt\"\n```\n\nNext, verify the logs by issuing this command:\n\n```shell\nkubectl logs -l app=cluster-autoscaler -n kube-system -f\n```\n\nCA will now check for unscheduled pods and try to schedule them. You can see those actions from the logs. Check the status of the pods by issuing the following command:\n\n```shell\nkubectl get pods -n kube-system\n```\n\n### 🛠️ Create an Nginx Deployment to Test Autoscaler Functionality\n\nWe are going to create two deployments: one for the managed node group, and another deployment for the unmanaged node group.\n\n#### Managed Node Group Deployment\n\nCreate a configuration file based on the content below:\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: nginx-managed\n    namespace: default\nspec:\n    replicas: 2\n    selector:\n        matchLabels:\n            app: nginx-managed\n    template:\n        metadata:\n            labels:\n                app: nginx-managed\n        spec:\n            containers:\n            - name: nginx-managed\n                image: nginx:latest\n                ports:\n                - containerPort: 80\n            affinity:\n                nodeAffinity:\n                    requiredDuringSchedulingIgnoredDuringExecution:\n                        nodeSelectorTerms:\n                        - matchExpressions:\n                            - key: role\n                                operator: In\n                                values:\n                                - managed-nodes\n                podAntiAffinity:\n                    requiredDuringSchedulingIgnoredDuringExecution:\n                    - labelSelector:\n                            matchExpressions:\n                            - key: app\n                                operator: In\n                                values:\n                                - nginx-managed\n                        topologyKey: kubernetes.io/hostname\n                        namespaces:\n                        - default\n```\n\n> **Note:** The above configurations make use of `nodeAffinity` to select the node group with the label `role=managed-nodes` to help control where the scheduler provisions the pods.\n\nApply the changes:\n\n```shell\nkubectl apply -f 1-nginx-managed.yaml\n```\n\n#### Unmanaged Node Group Deployment\n\nFor the unmanaged node group, create a configuration file using the content below:\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: nginx-unmanaged\n    namespace: default\nspec:\n    replicas: 2\n    selector:\n        matchLabels:\n            app: nginx-unmanaged\n    template:\n        metadata:\n            labels:\n                app: nginx-unmanaged\n        spec:\n            containers:\n            - name: nginx-unmanaged\n                image: nginx:1.14.2\n                ports:\n                - containerPort: 80\n            affinity:\n                nodeAffinity:\n                    requiredDuringSchedulingIgnoredDuringExecution:\n                        nodeSelectorTerms:\n                        - matchExpressions:\n                            - key: role\n                                operator: In\n                                values:\n                                - unmanaged-nodes\n                podAntiAffinity:\n                    requiredDuringSchedulingIgnoredDuringExecution:\n                    - labelSelector:\n                            matchExpressions:\n                            - key: app\n                                operator: In\n                                values:\n                                - nginx-unmanaged\n                        topologyKey: kubernetes.io/hostname\n                        namespaces:\n                        - default\n```\n\nApply the changes:\n\n```shell\nkubectl apply -f 2-nginx-unmanaged.yaml\n```\n\nCheck the status of the pods:\n\n```shell\nkubectl get pods -n default\n```\n\n```shell\nNAME                               READY   STATUS    RESTARTS   AGE\nnginx-managed-7cf8b6449c-mctsg     1/1     Running   0          60s\nnginx-managed-7cf8b6449c-vjvxf     0/1     Pending   0          60s\nnginx-unmanaged-67dcfb44c9-gvjg4   0/1     Pending   0          52s\nnginx-unmanaged-67dcfb44c9-wqnvr   1/1     Running   0          52s\n```\n\nNow, you can see two of the four pods are running because we have only two nodes in the cluster. Please note that we have used a [pod AntiAffinity](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity) configuration to prevent Kubernetes from provisioning multiple pods of this deployment on the same node (thereby avoiding the need for the additional capacity required to demonstrate CA’s functionality).\n\nThe Cluster Autoscaler will check the state of the pods, discover that some are in a “pending” state, and try to provision new nodes in the cluster. In a few minutes, you will see a third node provisioned.\n\nOne pod is still in a pending state because we did not add the label when we created the EKS cluster with managed/unmanaged node groups. If the label is not present in the Auto Scaling group, then the Cluster Autoscaler will not discover the Auto Scaling group to scale the cluster.\n\n## 🔚 Summary\n\nKubernetes Cluster Autoscaler (CA) is a tool that automatically scales up or down the number of nodes in a Kubernetes cluster based on the number of pods that are running. This can help to improve resource utilization and reduce costs.\n\nIn this blog post, we discussed how CA works and how to deploy it in your cluster. We also looked at some of the best practices for configuring CA to optimize resource utilization and performance.\n\nBy following the tips in this blog post, you can use CA to automatically scale your cluster and ensure that you are only paying for the resources that you need. This can help you to save money and improve the performance of your applications.\n\n<br>\n\n**_Until next time, つづく 🎉_**\n\n> 💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  **_Until next time 🎉_**\n\n🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**♻️ LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**♻️ X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ✌🏻**\n\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n\n**📅 Stay updated**\n\n**Subscribe to our newsletter for more insights on AWS cloud computing and containers.**\n","wordCount":{"words":1530},"frontmatter":{"id":"e47b0fca551b34c5379ee736","path":"/blog/kubernetes-cluster-autoscaler-cost-effective/","humanDate":"Oct 27, 2024","fullDate":"2024-10-27","title":"Kubernetes Cluster autoscaler: automatically scale your AWS EKS cluster for cost savings and performance","keywords":["Kubernetes","Cluster Autoscaler","AWS EKS","Cost Savings","SRE"],"excerpt":"How to use the Kubernetes Cluster Autoscaler to automatically adjust your AWS EKS cluster size, optimizing both cost and performance for your applications.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABaklEQVR42p1U2W7CMBDs/39XH/pUVbwhVUAiSi43IYdvk+muEQhKgKYrrbJeb8az4+NlPBwwjuONHyg/5VO1l/4yPiiaslmAJwYhBFRVhTzPIYRAWZYQlUCRF7DWPgS+AjwZAzrn4Nm9P8bBwzp7jCl3r/0zINswDPgmRuluB7lewa0+YXneBexUjUWbIt0kSNIkLvoUkNthUKU0dLuH7TsYo2G1xmAUatVDSQlN43ktU84TA0U/ZkIiLRX6XiJQu8GHq1NwF5AnT/p47yKzrhvwsXF4XTqIRsIyW9LxcvFJQLamabBcLrHdbmHSd9hOQGqDr0pinSl0xNBQ22nzhnpf0CkQyLKMcuYK+MxQKRXdGIugSTstI2OtDOUt6WtgyJXbU57HLmr+u+0bDWNMXy70nmQwJZxOYsw7eyzC45and4wBADVsINsFbRJi7t9Xj40lKIqK9KrRtu38q/fsPj8D+xPgnJeGAX8A4z6a1ykeU88AAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/c3a464e14023ce88e0f96b150c7aa7ff/8bb49/k8s-ca-cover.png","srcSet":"/static/c3a464e14023ce88e0f96b150c7aa7ff/86cae/k8s-ca-cover.png 750w,\n/static/c3a464e14023ce88e0f96b150c7aa7ff/8f979/k8s-ca-cover.png 1080w,\n/static/c3a464e14023ce88e0f96b150c7aa7ff/8bb49/k8s-ca-cover.png 1304w","sizes":"100vw"},"sources":[{"srcSet":"/static/c3a464e14023ce88e0f96b150c7aa7ff/ab5d4/k8s-ca-cover.webp 750w,\n/static/c3a464e14023ce88e0f96b150c7aa7ff/37e7f/k8s-ca-cover.webp 1080w,\n/static/c3a464e14023ce88e0f96b150c7aa7ff/553d5/k8s-ca-cover.webp 1304w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.763803680981595}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/lambda-container-image-deployment/","title":"How to Package and Deploy a Lambda Function as a Container Image","date":"2024-10-27 21:34:00"},"excerpt":"Go beyond built-in runtimes ℹ️ Overview AWS Lambda allows you to run your code inside Docker containers! This feature opens up a lot of…","html":"<blockquote>\n<p><strong>Go beyond built-in runtimes</strong></p>\n</blockquote>\n<h2 id=\"ℹ️-overview\" style=\"position:relative;\"><a href=\"#%E2%84%B9%EF%B8%8F-overview\" aria-label=\"ℹ️ overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>ℹ️ Overview</h2>\n<p>AWS Lambda allows you to run your code inside Docker containers! This feature opens up a lot of possibilities. You can use any programming language or framework by packaging it into a container image.</p>\n<p>There are no limitations from Lambda's built-in runtimes. Deploying Lambda functions also becomes much easier.</p>\n<p>Instead of zipping up code and dependencies, we can build a Docker image with everything our function needs. Just push the image to Amazon's container registry and configure Lambda to use it.</p>\n<p>In this blog post, we'll show you how to create a Lambda function that runs in a Docker container.</p>\n<h3 id=\"amazon-ecr\" style=\"position:relative;\"><a href=\"#amazon-ecr\" aria-label=\"amazon ecr permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><strong>Amazon ECR:</strong></h3>\n<p>Amazon Elastic Container Registry (ECR) is a fully managed container registry provided by AWS. It allows you to store, manage, and deploy container images securely.</p>\n<p><strong>Key points about ECR:</strong></p>\n<ul>\n<li>🛠️ Eliminates the need to operate your own container repository.</li>\n<li>🔗 Integrates natively with other AWS services like ECS, EKS, and Lambda.</li>\n<li>🚀 Provides high-performance hosting for your images.</li>\n<li>🔒 Automatically encrypts images at rest and transfers them over HTTPS.</li>\n<li>📝 Offers resource-based permissions and lifecycle policies for images.</li>\n</ul>\n<h2 id=\"using-ecr-with-awslambda\" style=\"position:relative;\"><a href=\"#using-ecr-with-awslambda\" aria-label=\"using ecr with awslambda permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Using ECR with AWS Lambda</h2>\n<p>Traditionally, you deployed Lambda functions by uploading a ZIP file containing your code and dependencies. However, AWS now allows you to package your Lambda function code as a container image and deploy it from ECR.</p>\n<p>The main benefits of using container images for Lambda functions include:</p>\n<ul>\n<li>🌐 Use any programming language, framework, or base image by customizing the container.</li>\n<li>📦 Larger deployment packages up to 10GB compared to 50MB zipped archives.</li>\n<li>🛠️ Easier dependency management and code organization within the container.</li>\n<li>🔄 Consistent build and deployment process across different environments.</li>\n</ul>\n<p>To use a container image for your Lambda function, you first build and push the Docker image to an ECR repository. Then, you create the Lambda function and specify the ECR image URI as the deployment package.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 7.0588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAR0lEQVR42h3LwQkAIQwAweu/HzHRRwJCRFF/1rMHfpfZb85JRHDOwd0REcyMlBK1VsYYr/fen7v30loj54yqstZ6bymFvTc/W3NBueEIZggAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"steps\" title=\"\" src=\"/static/1fe011f1f462d0e3501c9340ce1ee528/c5bb3/steps.png\" srcset=\"/static/1fe011f1f462d0e3501c9340ce1ee528/04472/steps.png 170w,\n/static/1fe011f1f462d0e3501c9340ce1ee528/9f933/steps.png 340w,\n/static/1fe011f1f462d0e3501c9340ce1ee528/c5bb3/steps.png 680w,\n/static/1fe011f1f462d0e3501c9340ce1ee528/b12f7/steps.png 1020w,\n/static/1fe011f1f462d0e3501c9340ce1ee528/c1b63/steps.png 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"hands-on-walkthrough\" style=\"position:relative;\"><a href=\"#hands-on-walkthrough\" aria-label=\"hands on walkthrough permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-On Walkthrough</h2>\n<p>To show how this works in practice, this walkthrough uses an environment with the <a href=\"https://aws.amazon.com/cli/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS CLI</a>, <a href=\"https://www.python.org/downloads/\" target=\"_blank\" rel=\"noopener noreferrer\">Python</a>, and <a href=\"https://docs.docker.com/get-docker/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker</a> installed.</p>\n<p>Create a <code class=\"language-text\">Dockerfile</code> file and paste the following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> amazon/aws-lambda-python:3.10</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> app.py ./</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"app.handler\"</span>]</span></code></pre></div>\n<p>Create <code class=\"language-text\">app.py</code> as lambda handler:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">def</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Hello from AWS Lambda using Python container image'</span> <span class=\"token operator\">+</span> sys<span class=\"token punctuation\">.</span>version <span class=\"token operator\">+</span> <span class=\"token string\">'!'</span></code></pre></div>\n<p>Next, run the following command in the console to authenticate to the ECR registry. Replace with the account ID of the AWS account you are using and with the code of the region you are using.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">aws ecr get-login-password <span class=\"token parameter variable\">--region</span> <span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token function\">docker</span> login <span class=\"token parameter variable\">--username</span> AWS --password-stdin <span class=\"token operator\">&lt;</span>Account-ID<span class=\"token operator\">></span>.dkr.ecr.<span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span>.amazonaws.com</code></pre></div>\n<p>Create a new repository in ECR and push the Docker image to the repo.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">aws ecr create-repository --repository-name demo-lambda --image-scanning-configuration <span class=\"token assign-left variable\">scanOnPush</span><span class=\"token operator\">=</span>true</code></pre></div>\n<p>After that, run the following command to create the container image:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">docker</span> build <span class=\"token parameter variable\">-t</span> demo-lambda <span class=\"token builtin class-name\">.</span></code></pre></div>\n<p>Then, run the following commands to tag and push the image:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">docker</span> tag get-customer:latest <span class=\"token operator\">&lt;</span>Account-ID<span class=\"token operator\">></span>.dkr.ecr.<span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span>.amazonaws.com/get-customer:latest\n\n<span class=\"token function\">docker</span> push <span class=\"token operator\">&lt;</span>Account-ID<span class=\"token operator\">></span>.dkr.ecr.<span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span>.amazonaws.com/get-customer:latest</code></pre></div>\n<p>Next step is to create the Lambda function:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">aws lambda create-function <span class=\"token punctuation\">\\</span>\n    --function-name demo-lambda <span class=\"token punctuation\">\\</span>\n    --package-type Image <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--code</span> <span class=\"token assign-left variable\">ImageUri</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>Account-ID<span class=\"token operator\">></span>.dkr.ecr.<span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span>.amazonaws.com/demo-lambda:latest <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--role</span> arn:aws:iam::<span class=\"token operator\">&lt;</span>Account-ID<span class=\"token operator\">></span>:role/execution_role <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--region</span> <span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--timeout</span> <span class=\"token number\">15</span> <span class=\"token punctuation\">\\</span>\n    --memory-size <span class=\"token number\">512</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--description</span> <span class=\"token string\">\"A Lambda function created using a container image.\"</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">--function-name</code>: The name you want to assign to your Lambda function (demo-lambda).</li>\n<li><code class=\"language-text\">--package-type Image</code>: Specifies that the deployment package is a container image.</li>\n<li><code class=\"language-text\">--code ImageUri=...</code>: The URI of the container image in ECR.</li>\n<li><code class=\"language-text\">--role</code>: The ARN of the IAM role that Lambda assumes when it executes your function. Ensure this role has the necessary permissions.</li>\n<li><code class=\"language-text\">--region</code>: The AWS region where you want to create the Lambda function.</li>\n<li><code class=\"language-text\">--timeout</code>: The maximum execution time in seconds for the function.</li>\n<li><code class=\"language-text\">--memory-size</code>: The amount of memory available to the function at runtime.</li>\n<li><code class=\"language-text\">--description</code>: A description of the function.</li>\n</ul>\n<p>Make sure to replace placeholders like with your actual values.</p>\n<p>After, you can invoke the container image as a Lambda function:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">aws lambda invoke --function-name demo-lambda <span class=\"token parameter variable\">--region</span> <span class=\"token operator\">&lt;</span>Region<span class=\"token operator\">></span> outfile                                                                                                                          \n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"StatusCode\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">200</span>,\n    <span class=\"token string\">\"ExecutedVersion\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"<span class=\"token variable\">$LATEST</span>\"</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">cat</span> outfile                                                                                                                                                                                                    \n<span class=\"token string\">\"Hello from AWS Lambda using Python3.10.2 (default, June 01 2024, 09:22:02) <span class=\"token entity\" title=\"\\n\">\\n</span>[GCC 8.3.0]!\"</span></code></pre></div>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>This blog post showed an easy way to use Docker containers with AWS Lambda functions.</p>\n<p>By building a Docker image with your code, you can run any programming language or tools on Lambda. Deploying is simple - just upload your container image to AWS. Give it a try to make Lambda more flexible for your apps!</p>\n<h2 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>References</h2>\n<ul>\n<li><a href=\"https://dev.to/vumdao/deploy-python-lambda-functions-with-container-image-5hgj\" target=\"_blank\" rel=\"noopener noreferrer\">Deploy Python Lambda Functions with Container Image</a></li>\n<li><a href=\"https://www.pluralsight.com/resources/blog/cloud/packaging-aws-lambda-functions-as-container-images\" target=\"_blank\" rel=\"noopener noreferrer\">Packaging AWS Lambda Functions as Container Images</a></li>\n<li><a href=\"https://community.aws/content/2Z4KyWJP5qXDD6StOWJZFXzoRZq/creating-a-lambda-function-with-a-container-based-runtime\" target=\"_blank\" rel=\"noopener noreferrer\">Creating a Lambda Function with a Container-Based Runtime</a></li>\n</ul>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  <strong><em>Until next time 🎉</em></strong></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p><strong>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</strong></p>"},"nextThought":{"frontmatter":{"path":"/blog/cve-vulnerability-database-devsecops/","title":"CVE Vulnerability Database: What It Is and How to Use It in DevSecOps","date":"2024-10-27 20:22:00"},"excerpt":"Shifting Security Left\n🔄 Shifting Security Left 📌 Introduction Common Vulnerabilities and Exposures (CVE) is a standardized dictionary of…","html":"<blockquote>\n<p><strong>Shifting Security Left</strong>\n<strong>🔄 Shifting Security Left</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📌 Introduction</h2>\n<p>Common Vulnerabilities and Exposures (CVE) is a standardized dictionary of publicly known information security vulnerabilities and exposures. It is maintained by <a href=\"https://www.mitre.org/\" target=\"_blank\" rel=\"noopener noreferrer\">MITRE</a> and is used by many security-related products and services, including vulnerability management and remediation, intrusion detection, and incident management.</p>\n<p>In <a href=\"https://www.devsecops.org/\" target=\"_blank\" rel=\"noopener noreferrer\">DevSecOps</a>, the <a href=\"https://cve.mitre.org/\" target=\"_blank\" rel=\"noopener noreferrer\">CVE</a> vulnerability database is an essential tool for tracking and responding to vulnerabilities in software and systems. By integrating the CVE database into your DevSecOps pipeline, you can identify and fix vulnerabilities early in the development process, before they can be exploited by attackers.</p>\n<p>This blog post will explain what the CVE vulnerability database is, how to use it in DevSecOps, and how to respond to CVEs in builds. We will also discuss CVE severity and how to prioritize remediation efforts.</p>\n<h2 id=\"-rationale\" style=\"position:relative;\"><a href=\"#-rationale\" aria-label=\" rationale permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🧠 Rationale</h2>\n<p>Reacting to CVEs in the real world requires careful consideration. You need to assess whether each CVE is serious enough to warrant the rejection of a build and a delay of a release. This is a careful balancing act, as you don't want to release code with serious known vulnerabilities, but you also don't want to cause constant delays due to unexpected CVE announcements.</p>\n<h3 id=\"the-cve-system\" style=\"position:relative;\"><a href=\"#the-cve-system\" aria-label=\"the cve system permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>The CVE System</h3>\n<p>The CVE List is a set of records that describe specific vulnerabilities or exposures. It is maintained by a large community of trusted entities and individuals.</p>\n<ul>\n<li><strong>Vulnerability</strong>: A flaw in a software, firmware, hardware, or service component that can be exploited to cause a negative impact to the confidentiality, integrity, or availability of an impacted component or components.</li>\n<li><strong>Exposure</strong>: A code or configuration error that can be exploited to gain indirect and often hard-to-discover access to application data such as customer information.</li>\n</ul>\n<h3 id=\"assessing-cve-severity\" style=\"position:relative;\"><a href=\"#assessing-cve-severity\" aria-label=\"assessing cve severity permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Assessing CVE Severity</h3>\n<p>There are a number of factors to consider when assessing the severity of a CVE, including:</p>\n<ul>\n<li><strong>Exploitability</strong>: How easy is it for an attacker to exploit the vulnerability?</li>\n<li><strong>Impact</strong>: What is the potential impact of the vulnerability if it is exploited?</li>\n<li><strong>Prevalence</strong>: How widespread is the vulnerability?</li>\n<li><strong>Patch Availability</strong>: Is there a patch available to fix the vulnerability?</li>\n</ul>\n<p>You can use these factors to prioritize remediation efforts and decide which CVEs warrant the rejection of a build and a delay of a release.</p>\n<h3 id=\"cve-security-and-beyond\" style=\"position:relative;\"><a href=\"#cve-security-and-beyond\" aria-label=\"cve security and beyond permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>CVE, Security and Beyond</h3>\n<p>The CVE List plays a vital role in the cybersecurity world as an essential resource around which security products and services can share standardized information. However, the CVE List alone is not sufficient for building an effective vulnerability remediation program. Other information sources as well as advanced analytic capabilities are required in order to achieve the risk assessment and actionable remediation guidelines that are the hallmarks of a cutting-edge vulnerability remediation solution.</p>\n<h3 id=\"quick-cve-recap\" style=\"position:relative;\"><a href=\"#quick-cve-recap\" aria-label=\"quick cve recap permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Quick CVE Recap</h3>\n<p>First, though, a brief definition of CVEs. Short for Common Vulnerabilities and Exposures, a CVE is a known vulnerability in a certain piece of software.</p>\n<p>The concept of CVEs was introduced in 1999 in an effort to provide a universal framework for identifying security issues. The idea is that whenever a vulnerability is discovered, a CVE entry will be created for it. The CVE entry can then be accessed and shared by the public. The <a href=\"https://www.cve.org/\" target=\"_blank\" rel=\"noopener noreferrer\">official CVE list</a> is maintained by MITRE, a nonprofit group also known for the <a href=\"https://www.splunk.com/en_us/data-insider/what-is-the-mitre-att-and-ck-framework.html\" target=\"_blank\" rel=\"noopener noreferrer\">MITRE ATT&#x26;CK methodology</a>.</p>\n<p>The big caveat here is that the official CVE list does not include an assessment of the severity of each CVE. Other organizations that maintain their own lists of CVEs, most notably <a href=\"https://nvd.nist.gov/\" target=\"_blank\" rel=\"noopener noreferrer\">NIST's National Vulnerability Database</a>, assign severity categories (such as \"medium,\" \"high,\" and \"critical\") and/or numerical severity scores to CVEs.</p>\n<p><a href=\"https://www.nist.gov/\" target=\"_blank\" rel=\"noopener noreferrer\">NIST</a> (National Institute of Standards and Technology) is a non-regulatory agency of the U.S. Department of Commerce that promotes innovation and industrial competitiveness by advancing measurement science, standards, and technology in ways that enhance economic security and improve our quality of life.</p>\n<p>NIST plays an important role in the CVE program by providing funding and technical support. NIST also maintains the National Vulnerability Database (NVD), which is a comprehensive database of vulnerabilities that includes CVE information.</p>\n<p>The NVD is used by organizations around the world to track and respond to vulnerabilities. NIST also develops and maintains a number of other resources related to vulnerabilities, such as the Common Weakness Enumeration (CWE) and the CVSS vulnerability scoring system.</p>\n<h2 id=\"-how-to-react-to-a-cve\" style=\"position:relative;\"><a href=\"#-how-to-react-to-a-cve\" aria-label=\" how to react to a cve permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📌 How to React to a CVE</h2>\n<p>There are a variety of tools that will automatically monitor and scan <a href=\"https://www.splunk.com/en_us/data-insider/what-is-source-code-management.html\" target=\"_blank\" rel=\"noopener noreferrer\">your application code</a>, dependencies, or environments in an effort to detect components that are subject to known CVEs, then alert you to them. Thus, it's relatively easy to find CVEs that are relevant to an application you develop or manage.</p>\n<p>The harder task is what to do when you discover a CVE that impacts your application. As noted above, it's not always practical to delay the release of your application until the CVE is addressed. Importantly, though, patches to correct CVEs sometimes appear almost as quickly as a CVE is announced. In some cases, it can take months or longer before a CVE solution becomes available (and it's not always clear how long it's going to take for a fix to arrive). You may not be able to wait that long.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdsJAP/EABYQAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAQABBQKI7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAQMf/aAAgBAQAGPwJU/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARITH/2gAIAQEAAT8h3LZTXY3ACf/aAAwDAQACAAMAAAAQj/8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEAAwEAAAAAAAAAAAAAAREAMUFRof/aAAgBAQABPxAHUE5DvRUpvzLnyDd//9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"scan\" title=\"\" src=\"/static/5a14f70da52f7044b7fb7240ae5fa7c3/7bf67/scan.jpg\" srcset=\"/static/5a14f70da52f7044b7fb7240ae5fa7c3/651be/scan.jpg 170w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/d30a3/scan.jpg 340w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/7bf67/scan.jpg 680w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/990cb/scan.jpg 1020w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/15ae0/scan.jpg 1092w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Also, you may simply get so many CVE alerts that <a href=\"https://www.splunk.com/en_us/blog/learn/devops-release-management.html\" target=\"_blank\" rel=\"noopener noreferrer\">delaying a release</a> in response to each one is not feasible. If your application is complex and has lots of dependencies, you could get multiple CVE alerts each week. Delaying your release pipeline in response to each one would create a lot of confusion and impact your ability to deliver continuously.</p>\n<h2 id=\"-devsecops\" style=\"position:relative;\"><a href=\"#-devsecops\" aria-label=\" devsecops permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>👮 DevSecOps</h2>\n<p>DevSecOps stands for Development, Security, and Operations. In the most basic meaning, it's defined as an approach that promotes security in the SDLC (Software Development Life Cycle). The primary goal is to shift-to-left the responsibility. Security tools are integrated early in the development cycle, usually in CI/CD pipelines, to let Devs find vulnerabilities as early as possible and fix them before reaching production environments.</p>\n<h3 id=\"️-shift-to-left\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-shift-to-left\" aria-label=\"️ shift to left permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>◀️ Shift-to-left</h3>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAdtbocwuF//EABkQAAIDAQAAAAAAAAAAAAAAAAABAhESMf/aAAgBAQABBQJtmpEbppMxE4f/xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAwEBPwFGL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAIBBQAAAAAAAAAAAAAAAAABIQIQMTJB/9oACAEBAAY/AuGaSSUaq3//xAAaEAEBAAMBAQAAAAAAAAAAAAABABEx8SFh/9oACAEBAAE/ISD6G6E1oz8tINxYAYDF/9oADAMBAAIAAwAAABB/D//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8QW8YYY3//xAAWEQEBAQAAAAAAAAAAAAAAAAABEEH/2gAIAQIBAT8QE2f/xAAcEAADAAIDAQAAAAAAAAAAAAAAAREhQTFRYZH/2gAIAQEAAT8Q5e3FeqXfp1Gdu9bDesPVRIePlJhJbEf/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Shift-to-left\" title=\"\" src=\"/static/184cc666bc517be49b078ac9ea273044/7bf67/Shift-to-left.jpg\" srcset=\"/static/184cc666bc517be49b078ac9ea273044/651be/Shift-to-left.jpg 170w,\n/static/184cc666bc517be49b078ac9ea273044/d30a3/Shift-to-left.jpg 340w,\n/static/184cc666bc517be49b078ac9ea273044/7bf67/Shift-to-left.jpg 680w,\n/static/184cc666bc517be49b078ac9ea273044/990cb/Shift-to-left.jpg 1020w,\n/static/184cc666bc517be49b078ac9ea273044/e5166/Shift-to-left.jpg 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Maybe you heard it, maybe not, let me explain what it means. Shifting security controls to the left means putting the security tools more left in the pipelines, and by consequence, in the development process. The more left it's, the better because remediation is easier and it's done before reaching production.</p>\n<h3 id=\"devsecops-best-practices\" style=\"position:relative;\"><a href=\"#devsecops-best-practices\" aria-label=\"devsecops best practices permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>DevSecOps Best Practices</h3>\n<ul>\n<li><strong>🔄 Automate as much as you can</strong>: Automation is the key to successfully leveraging security in the pipelines.</li>\n<li><strong>✅ Define must-checks to deploy</strong>: If you have some must-pass security checks, define them in the CI/CD pipelines, especially for production.</li>\n<li><strong>📚 Encourage and train</strong>: Whenever possible, promote security training to your Devs. They'll be more motivated and with the knowledge to fix vulnerabilities and avoid them in the future.</li>\n</ul>\n<p>The advantages are pretty clear, automation is the key like it's in common DevOps practices, and we benefit from it by adding the compliance checks in our pipelines. Some of those checks will be mandatory, so you're gonna put your barriers of trust in the automation, ensuring that nothing will go through those controls unless it has the level of trust you've defined.</p>\n<h3 id=\"️-infrastructure-as-code\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-infrastructure-as-code\" aria-label=\"️ infrastructure as code permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🏗️ Infrastructure-As-Code</h3>\n<p>One of the best open-source tools to analyze IaC is <a href=\"https://github.com/Checkmarx/kics\" target=\"_blank\" rel=\"noopener noreferrer\">Kics</a>. It's a tool designed to find security vulnerabilities, compliance issues, and infrastructure misconfigurations. It supports multiple platforms, such as Terraform, Kubernetes, Docker, Helm. It comes with a lot of predefined checks to assess your infrastructure, containers, and deployments.</p>\n<p>One of the key benefits of this tool is that it's designed to let you expand the analyzing capabilities. Using the extensible query configuration, you can create your checks, adapted to your staff and environment, and disable the ones that are less important to the company.</p>\n<h3 id=\"-dependency-checks\" style=\"position:relative;\"><a href=\"#-dependency-checks\" aria-label=\" dependency checks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📦 Dependency Checks</h3>\n<p>You didn't write all the code of your applications, nobody does it in WebApps today. You use libraries, and probably a lot of them. Like any piece of code, it has its vulnerabilities, and you should check them. Dependency checking is the process of finding what vulnerable versions of third-party you're using. Most tools do that by comparing the version with popular vuln databases, such as <a href=\"https://nvd.nist.gov/\" target=\"_blank\" rel=\"noopener noreferrer\">NIST</a> and <a href=\"https://cve.mitre.org/\" target=\"_blank\" rel=\"noopener noreferrer\">CVE</a>.</p>\n<h3 id=\"️-static-application-security-testing-sast\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-static-application-security-testing-sast\" aria-label=\"️ static application security testing sast permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🛠️ Static Application Security Testing (SAST)</h3>\n<p>These tools are designed to scan your code to find flaws in your project. It could help to find SQL Injection, Buffer Overflows, Memory Leaks, XSS (Cross-Site-Scripting), and more. SAST is known as white-box scanning because it works by analyzing your source code and finding vulnerabilities based on your implementation.</p>\n<p>The downside is that they aren't perfect, they have a lot of false positives, and the worst: false negatives. Despite its shortcomings, it's another layer of defense to add to our pipelines.</p>\n<ul>\n<li><a href=\"https://github.com/PyCQA/bandit\" target=\"_blank\" rel=\"noopener noreferrer\">Bandit</a>: SAST tool for Python.</li>\n<li><a href=\"https://brakemanscanner.org/\" target=\"_blank\" rel=\"noopener noreferrer\">BrakeMan</a>: SAST tool for Ruby on Rails.</li>\n<li><a href=\"https://rubygems.org/gems/dawnscanner\" target=\"_blank\" rel=\"noopener noreferrer\">DawnScanner</a>: Another SAST tool for Ruby, but in this case with support for the most MVC frameworks, like Rails, Padrino, and Sinatra. It provides more than 150 security checks, with remediation suggestions.</li>\n<li><a href=\"https://find-sec-bugs.github.io/\" target=\"_blank\" rel=\"noopener noreferrer\">FindSecBugs</a>: SAST tool for Java code. Includes 100 security checks and supports all major Java frameworks.</li>\n<li><a href=\"https://github.com/ZupIT/horusec\" target=\"_blank\" rel=\"noopener noreferrer\">HoruSec</a>: It supports multiple languages, and it has an extension for VSCode. Very interesting tool. You must give it a shot.</li>\n</ul>\n<h3 id=\"-dynamic-application-security-testing-dast\" style=\"position:relative;\"><a href=\"#-dynamic-application-security-testing-dast\" aria-label=\" dynamic application security testing dast permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🔍 Dynamic Application Security Testing (DAST)</h3>\n<p>In comparison with SAST, as its name suggests, it dynamically analyzes your live application and performs different types of attacks against it, to find vulnerabilities. It's also known as black-box scanning since it doesn't analyze your code, it analyzes the live web server.</p>\n<p>The best way to integrate these kinds of tools in pipelines is after deployment in lower environments, like Dev or Stage. After the deployment step in the CD process, you should have another step to perform the scanning, and if the results are not good enough, revert the deployment and flag the artifact as vulnerable to prevent production deployments.</p>\n<ul>\n<li><a href=\"https://www.zaproxy.org/getting-started/\" target=\"_blank\" rel=\"noopener noreferrer\">ZedAttackProxy (ZAP)</a>: It's a well-known tool to do pentesting, but it also has a lot of automated scanning capabilities to test your app. It could be deployed using GithubActions too.</li>\n<li><a href=\"https://www.arachni-scanner.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Arachni</a>: DAST tool with high performance and multiple types of integrations, including a WebServer where you can check scanning results.</li>\n</ul>\n<h2 id=\"-final-words\" style=\"position:relative;\"><a href=\"#-final-words\" aria-label=\" final words permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📝 Final Words</h2>\n<p>The CVE vulnerability database is an essential tool for tracking and responding to vulnerabilities in software and systems. By integrating the CVE database into your DevSecOps pipeline, you can shift security to the left and identify and fix vulnerabilities early in the development process.</p>\n<p><strong>Thank You 🖤</strong></p>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘 <strong><em>Until next time 🎉</em></strong></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>\n<h2 id=\"-introduction-1\" style=\"position:relative;\"><a href=\"#-introduction-1\" aria-label=\" introduction 1 permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>📌 Introduction</h2>\n<p>Common Vulnerabilities and Exposures (CVE) is a standardized dictionary of publicly known information security vulnerabilities and exposures. It is maintained by MITRE and is used by many security-related products and services, including vulnerability management and remediation, intrusion detection, and incident management.\nIn <a href=\"https://www.devsecops.org/\" target=\"_blank\" rel=\"noopener noreferrer\">DevSecOps</a>, the <a href=\"https://cve.mitre.org/\" target=\"_blank\" rel=\"noopener noreferrer\">CVE</a> vulnerability database is an essential tool for tracking and responding to vulnerabilities in software and systems. By integrating the CVE database into your DevSecOps pipeline, you can identify and fix vulnerabilities early in the development process, before they can be exploited by attackers.\nThis blog post will explain what the CVE vulnerability database is, how to use it in DevSecOps, and how to respond to CVEs in builds. We will also discuss CVE severity and how to prioritize remediation efforts.</p>\n<h2 id=\"-rationale-1\" style=\"position:relative;\"><a href=\"#-rationale-1\" aria-label=\" rationale 1 permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>🧠 Rationale</h2>\n<p>Reacting to CVEs in the real world requires careful consideration. You need to assess whether each CVE is serious enough to warrant the rejection of a build and a delay of a release. This is a careful balancing act, as you don't want to release code with serious known vulnerabilities, but you also don't want to cause constant delays due to unexpected CVE announcements.\nThe CVE System:\nThe CVE List is a set of records that describe specific vulnerabilities or exposures. It is maintained by a large community of trusted entities and individuals.\nA vulnerability is a flaw in a software, firmware, hardware, or service component that can be exploited to cause a negative impact to the confidentiality, integrity, or availability of an impacted component or components.\nAn exposure is a code or configuration error that can be exploited to gain indirect and often hard-to-discover access to application data such as customer information.\nAssessing CVE Severity:\nThere are a number of factors to consider when assessing the severity of a CVE, including:\nThe exploitability of the CVE: How easy is it for an attacker to exploit the vulnerability?\nThe impact of the CVE: What is the potential impact of the vulnerability if it is exploited?\nThe prevalence of the CVE: How widespread is the vulnerability?\nThe availability of a patch: Is there a patch available to fix the vulnerability?</p>\n<p>You can use these factors to prioritize remediation efforts and decide which CVEs warrant the rejection of a build and a delay of a release.\nCVE, Security and Beyond:\nThe CVE List plays a vital role in the cybersecurity world as an essential resource around which security products and services can share standardized information. However, the CVE List alone is not sufficient for building an effective vulnerability remediation program. Other information sources as well as advanced analytic capabilities are required in order to achieve the risk assessment and actionable remediation guidelines that are the hallmarks of a cutting-edge vulnerability remediation solution.\nQuick CVE recap:\nFirst, though, a brief definition of CVEs. Short for Common Vulnerabilities and Exposures, a CVE is a known vulnerability in a certain piece of software.\nThe concept of CVEs were introduced in 1999 in an effort to provide a universal framework for identifying security issues. The idea is that whenever a vulnerability is discovered, a CVE entry will be created for it. The CVE entry can then be accessed and shared by the public. The <a href=\"https://www.cve.org/\" target=\"_blank\" rel=\"noopener noreferrer\">official CVE list</a> is maintained by MITRE, a nonprofit group who's also known for the <a href=\"https://www.splunk.com/en_us/data-insider/what-is-the-mitre-att-and-ck-framework.html\" target=\"_blank\" rel=\"noopener noreferrer\">MITRE ATT&#x26;CK methodology</a>.\nThe big caveat here is that the official CVE list does not include an assessment of the severity of each CVE. Other organizations that maintain their own lists of CVEs, most notably <a href=\"https://nvd.nist.gov/\" target=\"_blank\" rel=\"noopener noreferrer\">NIST's National Vulnerability Database</a>, assign severity categories (such as \"medium,\" \"high\" and \"critical\") and/or numerical severity scores to CVEs.\nNIST (National Institute of Standards and Technology) is a non-regulatory agency of the U.S. Department of Commerce that promotes innovation and industrial competitiveness by advancing measurement science, standards, and technology in ways that enhance economic security and improve our quality of life.\nNIST plays an important role in the CVE program by providing funding and technical support. NIST also maintains the National Vulnerability Database (NVD), which is a comprehensive database of vulnerabilities that includes CVE information.\nThe NVD is used by organizations around the world to track and respond to vulnerabilities. NIST also develops and maintains a number of other resources related to vulnerabilities, such as the Common Weakness Enumeration (CWE) and the CVSS vulnerability scoring system.\n📌 How to react to a CVE:\nThere are a variety of tools that will automatically monitor and scan <a href=\"https://www.splunk.com/en_us/data-insider/what-is-source-code-management.html\" target=\"_blank\" rel=\"noopener noreferrer\">your application code</a>, dependencies or environments in an effort to detect components that are subject to known CVEs, then alert you to them. Thus, it's relatively easy to find CVEs that are relevant to an application you develop or manage.</p>\n<p>The harder task is what to do when you discover a CVE that impacts your application. As noted above, it's not always practical to delay the release of your application until the CVE is addressed. Importantly, though, patches to correct CVEs sometimes appear almost as quickly as a CVE is announced. In some cases, it can take months or longer before a CVE solution becomes available (and it's not always clear how long it's going to take for a fix to arrive). You may not be able to wait that long.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdsJAP/EABYQAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAQABBQKI7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAQMf/aAAgBAQAGPwJU/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARITH/2gAIAQEAAT8h3LZTXY3ACf/aAAwDAQACAAMAAAAQj/8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEAAwEAAAAAAAAAAAAAAREAMUFRof/aAAgBAQABPxAHUE5DvRUpvzLnyDd//9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"scan\" title=\"\" src=\"/static/5a14f70da52f7044b7fb7240ae5fa7c3/7bf67/scan.jpg\" srcset=\"/static/5a14f70da52f7044b7fb7240ae5fa7c3/651be/scan.jpg 170w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/d30a3/scan.jpg 340w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/7bf67/scan.jpg 680w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/990cb/scan.jpg 1020w,\n/static/5a14f70da52f7044b7fb7240ae5fa7c3/15ae0/scan.jpg 1092w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Also, you may simply get so many CVE alerts that <a href=\"https://www.splunk.com/en_us/blog/learn/devops-release-management.html\" target=\"_blank\" rel=\"noopener noreferrer\">delaying a release</a> in response to each one is not feasible. If your application is complex and has lots of dependencies, you could get multiple CVE alerts each week. Delaying your release pipeline in response to each one would create a lot of confusion and impact your ability to deliver continuously.</p>\n<p><strong>Thank You 🖤</strong></p>\n<br>\n<p><strong><em>Until next time, つづく 🎉</em></strong></p>\n<blockquote>\n<p>💡 Thank you for Reading !! 🙌🏻😁📃, see you in the next blog.🤘  <strong><em>Until next time 🎉</em></strong></p>\n</blockquote>\n<p>🚀 Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>♻️ LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>♻️ X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ✌🏻</strong></p>\n<h1 align=\"center\">🔰 Keep Learning !! Keep Sharing !! 🔰</h1>\n<p><strong>📅 Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}