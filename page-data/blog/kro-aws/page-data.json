{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/kro-aws/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Simplify Kubernetes Resource Management with kro by AWS</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ö° Introduction</h2>\n<p><a href=\"https://aws.amazon.com/blogs/opensource/introducing-open-source-kro-kube-resource-orchestrator/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS recently introduced Kube Resource Orchestrator (kro)</a> that simplifies managing Kubernetes resources. kro allows you to define and manage complex Kubernetes resources as reusable components, making your life easier and your deployments more efficient.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACpElEQVR42k2T2U9TQRTG+6f45kNTKsSwyCIhVEI00ASwtHdpL7QsQY2AUVKwQtt7u1EENEGCIT4oifLkg0viA4QClU0aWkpLW0wjrg8a/4LPM7eoPHw5d2bO/ObMd+ZqRO8eLGNbEJR9cO4dmO6tQ5DjMNMc542BV+LqWPQlwct7EP0HEGiP2fOh8O3bJyUh+JPqWNMkTENX1gBtgwR9PY/yunbUtcuobOpHUU0rdBdNqDYOoviShHLSOUMHatpGoLtgRFlzP8432FHS6EAFm+98CE2zbQbaikZoa1qgqzVBX9UCbZ0ZeoMEnUEkuBuVV26gqLQeJQQupfUzxdWoMg5AX8uhXhyHrvQyzpYZUNs1C43oiYEbicA0vIKrg6/RdP0FWp2raLn9Du0jKxA8u7DQmuXuGsyjm+Bd6zBTvkh2tN16A250A5wrSnFTtUZjDRzCFsxAInXez0IMHsE5l8G1BzmIgRxsbD1EMZhV81hkuYI/B6P3NzhfvpDD1gNpAvpTEJUE+NEobPOvYFF2sLadR/hZEq1jh2AHshwrGc7EjJeCaQw9/gr7xGcMzHxB9wQV4jtQ8wpA1sGxDYQDc3AoW1hYPkT46S7s3lX0BqLU3fgJMKVulEJHGJr/RcBPkBd+omcyrzL+A+UYebIL06MULP445Ofr8MxvocP1Ft3yEnjy2arEC0A/WTP1DWLoGANzP+CYPMbN2e8Qgh9hY8+GnSzQm2Lqf7JIvm1j8WUE7tkoTN4cXTlDSp9cOwVJTqAvnIGdKuoZz6KTKu4dJ1vcCQImCxVaWbmkvqllqiCBO9MblBSjB5tWT/0LY2C76z0cQ0twUOftzgi6KDqGI+h2LsNGP0cB6E+rEpScGnkCMdg/0CmJ1GExxF5DtvB9KjIP/wCsJjinOz8CqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/b45c2eb83b98e4a693e092d6a41058af/c5bb3/kro-cover.png\" srcset=\"/static/b45c2eb83b98e4a693e092d6a41058af/04472/kro-cover.png 170w,\n/static/b45c2eb83b98e4a693e092d6a41058af/9f933/kro-cover.png 340w,\n/static/b45c2eb83b98e4a693e092d6a41058af/c5bb3/kro-cover.png 680w,\n/static/b45c2eb83b98e4a693e092d6a41058af/b12f7/kro-cover.png 1020w,\n/static/b45c2eb83b98e4a693e092d6a41058af/b5a09/kro-cover.png 1360w,\n/static/b45c2eb83b98e4a693e092d6a41058af/36405/kro-cover.png 2486w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"what-is-kro\" style=\"position:relative;\"><a href=\"#what-is-kro\" aria-label=\"what is kro permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>What is kro?</h2>\n<p><a href=\"https://kro.run/\" target=\"_blank\" rel=\"noopener noreferrer\">Kube Resource Orchestrator (kro)</a> is an open-source project by AWS that helps you create and manage custom groups of Kubernetes resources. By defining these groups as ResourceGroups, you can deploy multiple resources together in a consistent and controlled way.</p>\n<h2 id=\"how-does-kro-work\" style=\"position:relative;\"><a href=\"#how-does-kro-work\" aria-label=\"how does kro work permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>How does kro work?</h2>\n<p>kro uses core Kubernetes primitives to simplify resource grouping and dependency management. When you apply a ResourceGroup to your cluster, kro:</p>\n<ol>\n<li>Verifies the ResourceGroup specification.</li>\n<li>Creates a new Custom Resource Definition (CRD).</li>\n<li>Deploys a dedicated controller to manage the lifecycle of the resources.</li>\n</ol>\n<h2 id=\"resourcegroups\" style=\"position:relative;\"><a href=\"#resourcegroups\" aria-label=\"resourcegroups permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>ResourceGroups</h2>\n<p><a href=\"https://kro.run/docs/concepts/resource-groups\" target=\"_blank\" rel=\"noopener noreferrer\">A ResourceGroup</a> is the fundamental building block in kro. It allows you to define, organize, and manage sets of related Kubernetes resources as a single, reusable unit. A ResourceGroup acts as a blueprint, defining:</p>\n<ul>\n<li><strong>Schema</strong>: What users can configure.</li>\n<li><strong>Resources</strong>: What resources to create.</li>\n<li><strong>Dependencies</strong>: How resources reference each other.</li>\n<li><strong>Conditions</strong>: When resources should be included.</li>\n<li><strong>Status</strong>: What status to expose.</li>\n</ul>\n<h3 id=\"anatomy-of-a-resourcegroup\" style=\"position:relative;\"><a href=\"#anatomy-of-a-resourcegroup\" aria-label=\"anatomy of a resourcegroup permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Anatomy of a ResourceGroup</h3>\n<p>A ResourceGroup consists of three main parts:</p>\n<ol>\n<li><strong>Metadata</strong>: Includes name, namespace, labels, etc.</li>\n<li><strong>Spec</strong>: Defines the structure and properties of the ResourceGroup.</li>\n<li><strong>Status</strong>: Reflects the current state of the ResourceGroup.</li>\n</ol>\n<p>The <code class=\"language-text\">spec</code> section contains:</p>\n<ul>\n<li><strong>Schema</strong>: Defines the API structure, including fields users can configure and status information.</li>\n<li><strong>Resources</strong>: Specifies the Kubernetes resources to create, their templates, dependencies, conditions for inclusion, and readiness criteria.</li>\n</ul>\n<h3 id=\"example-resourcegroup\" style=\"position:relative;\"><a href=\"#example-resourcegroup\" aria-label=\"example resourcegroup permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Example ResourceGroup</h3>\n<p>Here's an example of a ResourceGroup that includes a Deployment, Service, and Ingress:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> kro.run/v1alpha1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ResourceGroup\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>application\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schema</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1alpha1\n    <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Application\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> string\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> string <span class=\"token punctuation\">|</span> default=\"nginx\"\n      <span class=\"token key atrule\">ingress</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> boolean <span class=\"token punctuation\">|</span> default=false\n    <span class=\"token key atrule\">status</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">deploymentConditions</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>deployment.status.conditions<span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">availableReplicas</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>deployment.status.availableReplicas<span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> deployment\n      <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n          <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n            <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n                  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.image<span class=\"token punctuation\">}</span>\n                  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> service\n      <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>service\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>deployment.spec.selector.matchLabels<span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n              <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n              <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> ingress\n      <span class=\"token key atrule\">includeWhen</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>schema.spec.ingress.enabled<span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.k8s.io/v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Ingress\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>ingress\n          <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">kubernetes.io/ingress.class</span><span class=\"token punctuation\">:</span> alb\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/scheme</span><span class=\"token punctuation\">:</span> internet<span class=\"token punctuation\">-</span>facing\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/target-type</span><span class=\"token punctuation\">:</span> ip\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/healthcheck-path</span><span class=\"token punctuation\">:</span> /health\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/listen-ports</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'[{\"HTTP\": 80}]'</span>\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/target-group-attributes</span><span class=\"token punctuation\">:</span> stickiness.enabled=true<span class=\"token punctuation\">,</span>stickiness.lb_cookie.duration_seconds=60\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span>\n                    <span class=\"token key atrule\">pathType</span><span class=\"token punctuation\">:</span> Prefix\n                    <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span>\n                      <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>service.metadata.name<span class=\"token punctuation\">}</span>\n                        <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n                          <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n<h2 id=\"resourcegroup-instances\" style=\"position:relative;\"><a href=\"#resourcegroup-instances\" aria-label=\"resourcegroup instances permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>ResourceGroup Instances</h2>\n<p>Once kro processes your ResourceGroup, it creates a new API in your cluster. Users can then create <a href=\"https://kro.run/docs/concepts/instances\" target=\"_blank\" rel=\"noopener noreferrer\">instances</a> of this API to deploy resources in a consistent, controlled way. An instance represents your deployed application and contains your configuration values, serving as the single source of truth for your application's desired state.</p>\n<h3 id=\"example-resourcegroup-instance\" style=\"position:relative;\"><a href=\"#example-resourcegroup-instance\" aria-label=\"example resourcegroup instance permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Example ResourceGroup Instance</h3>\n<p>Here's an example of how an instance for the SimpleWebApp might look:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> kro.run/v1alpha1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> SimpleWebApp\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>web<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">appName</span><span class=\"token punctuation\">:</span> awesome<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">:</span>latest\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span></code></pre></div>\n<h2 id=\"getting-started-with-kro\" style=\"position:relative;\"><a href=\"#getting-started-with-kro\" aria-label=\"getting started with kro permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Getting Started with kro</h2>\n<h3 id=\"installation\" style=\"position:relative;\"><a href=\"#installation\" aria-label=\"installation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Installation</h3>\n<p>To install kro, you need Helm and kubectl configured for your Kubernetes cluster. Follow these steps:</p>\n<ol>\n<li>\n<p><strong>Fetch the latest release version:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">KRO_VERSION</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-sL</span> https://api.github.com/repos/awslabs/kro/releases/latest <span class=\"token operator\">|</span> jq <span class=\"token parameter variable\">-r</span> <span class=\"token string\">'.tag_name | ltrimstr(\"v\")'</span><span class=\"token variable\">)</span></span></code></pre></div>\n</li>\n<li>\n<p><strong>Install kro using Helm:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm <span class=\"token function\">install</span> kro oci://public.ecr.aws/kro/kro <span class=\"token parameter variable\">--namespace</span> kro --create-namespace <span class=\"token parameter variable\">--version</span><span class=\"token operator\">=</span><span class=\"token variable\">${KRO_VERSION}</span></code></pre></div>\n</li>\n<li>\n<p><strong>Verify the installation:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm <span class=\"token parameter variable\">-n</span> kro list\nkubectl get pods <span class=\"token parameter variable\">-n</span> kro</code></pre></div>\n</li>\n</ol>\n<h3 id=\"creating-your-first-resourcegroup\" style=\"position:relative;\"><a href=\"#creating-your-first-resourcegroup\" aria-label=\"creating your first resourcegroup permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Creating Your First ResourceGroup</h3>\n<ol>\n<li>\n<p><strong>Define a ResourceGroup:</strong>\nSave the following as <code class=\"language-text\">resourcegroup.yaml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> kro.run/v1alpha1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ResourceGroup\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>application\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schema</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1alpha1\n    <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Application\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> string\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> string <span class=\"token punctuation\">|</span> default=\"nginx\"\n      <span class=\"token key atrule\">ingress</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> boolean <span class=\"token punctuation\">|</span> default=false\n    <span class=\"token key atrule\">status</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">deploymentConditions</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>deployment.status.conditions<span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">availableReplicas</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>deployment.status.availableReplicas<span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> deployment\n      <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n          <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n            <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span>\n                  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.image<span class=\"token punctuation\">}</span>\n                  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> service\n      <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>service\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>deployment.spec.selector.matchLabels<span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n              <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n              <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> ingress\n      <span class=\"token key atrule\">includeWhen</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>schema.spec.ingress.enabled<span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.k8s.io/v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Ingress\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>schema.spec.name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>ingress\n          <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">kubernetes.io/ingress.class</span><span class=\"token punctuation\">:</span> alb\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/scheme</span><span class=\"token punctuation\">:</span> internet<span class=\"token punctuation\">-</span>facing\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/target-type</span><span class=\"token punctuation\">:</span> ip\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/healthcheck-path</span><span class=\"token punctuation\">:</span> /health\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/listen-ports</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'[{\"HTTP\": 80}]'</span>\n            <span class=\"token key atrule\">alb.ingress.kubernetes.io/target-group-attributes</span><span class=\"token punctuation\">:</span> stickiness.enabled=true<span class=\"token punctuation\">,</span>stickiness.lb_cookie.duration_seconds=60\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span>\n                    <span class=\"token key atrule\">pathType</span><span class=\"token punctuation\">:</span> Prefix\n                    <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span>\n                      <span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>service.metadata.name<span class=\"token punctuation\">}</span>\n                        <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span>\n                          <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n</li>\n<li>\n<p><strong>Apply the ResourceGroup:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl apply <span class=\"token parameter variable\">-f</span> resourcegroup.yaml</code></pre></div>\n</li>\n<li>\n<p><strong>Inspect the ResourceGroup:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl get rg my-application <span class=\"token parameter variable\">-o</span> wide</code></pre></div>\n</li>\n</ol>\n<h3 id=\"creating-an-application-instance\" style=\"position:relative;\"><a href=\"#creating-an-application-instance\" aria-label=\"creating an application instance permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Creating an Application Instance</h3>\n<ol>\n<li>\n<p><strong>Define an Application instance:</strong>\nSave the following as <code class=\"language-text\">instance.yaml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> kro.run/v1alpha1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Application\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>application<span class=\"token punctuation\">-</span>instance\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>awesome<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">ingress</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n</li>\n<li>\n<p><strong>Apply the Application instance:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl apply <span class=\"token parameter variable\">-f</span> instance.yaml</code></pre></div>\n</li>\n<li>\n<p><strong>Inspect the Application instance:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl get applications</code></pre></div>\n</li>\n<li>\n<p><strong>Inspect the resources:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl get deployments,services,ingresses</code></pre></div>\n</li>\n</ol>\n<h3 id=\"deleting-the-application-instance\" style=\"position:relative;\"><a href=\"#deleting-the-application-instance\" aria-label=\"deleting the application instance permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Deleting the Application Instance</h3>\n<p>To clean up resources, delete the Application instance:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl delete application my-application-instance</code></pre></div>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Conclusion</h2>\n<p>kro by AWS simplifies Kubernetes resource management by allowing you to define and manage complex resource configurations as reusable components. Whether you're deploying simple applications or complex multi-service architectures, kro can help streamline your Kubernetes operations.</p>\n<h2 id=\"-community-participation\" style=\"position:relative;\"><a href=\"#-community-participation\" aria-label=\" community participation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåê Community Participation</h2>\n<p>Development and discussion are coordinated in the <a href=\"https://communityinviter.com/apps/kubernetes/community\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Slack (invite link)</a> channel <a href=\"https://kubernetes.slack.com/archives/XXX-TBD\" target=\"_blank\" rel=\"noopener noreferrer\">#kro</a> channel.</p>\n<p>We welcome questions, suggestions, and contributions from the community! To get involved, check out our contributing guide. For bugs or feature requests, feel free to submit an issue. You‚Äôre also invited to join our community.</p>\n<h2 id=\"-documentation\" style=\"position:relative;\"><a href=\"#-documentation\" aria-label=\" documentation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìö Documentation</h2>\n<p>For more detailed information, check out the following resources:</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":5,"rawMarkdownBody":"\n> **Simplify Kubernetes Resource Management with kro by AWS**\n\n## ‚ö° Introduction\n\n[AWS recently introduced Kube Resource Orchestrator (kro)](https://aws.amazon.com/blogs/opensource/introducing-open-source-kro-kube-resource-orchestrator/) that simplifies managing Kubernetes resources. kro allows you to define and manage complex Kubernetes resources as reusable components, making your life easier and your deployments more efficient.\n\n![alt text](kro-cover.png)\n\n## What is kro?\n\n[Kube Resource Orchestrator (kro)](https://kro.run/) is an open-source project by AWS that helps you create and manage custom groups of Kubernetes resources. By defining these groups as ResourceGroups, you can deploy multiple resources together in a consistent and controlled way.\n\n## How does kro work?\n\nkro uses core Kubernetes primitives to simplify resource grouping and dependency management. When you apply a ResourceGroup to your cluster, kro:\n\n1. Verifies the ResourceGroup specification.\n2. Creates a new Custom Resource Definition (CRD).\n3. Deploys a dedicated controller to manage the lifecycle of the resources.\n\n## ResourceGroups\n\n[A ResourceGroup](https://kro.run/docs/concepts/resource-groups) is the fundamental building block in kro. It allows you to define, organize, and manage sets of related Kubernetes resources as a single, reusable unit. A ResourceGroup acts as a blueprint, defining:\n\n- **Schema**: What users can configure.\n- **Resources**: What resources to create.\n- **Dependencies**: How resources reference each other.\n- **Conditions**: When resources should be included.\n- **Status**: What status to expose.\n\n### Anatomy of a ResourceGroup\n\nA ResourceGroup consists of three main parts:\n\n1. **Metadata**: Includes name, namespace, labels, etc.\n2. **Spec**: Defines the structure and properties of the ResourceGroup.\n3. **Status**: Reflects the current state of the ResourceGroup.\n\nThe `spec` section contains:\n\n- **Schema**: Defines the API structure, including fields users can configure and status information.\n- **Resources**: Specifies the Kubernetes resources to create, their templates, dependencies, conditions for inclusion, and readiness criteria.\n\n### Example ResourceGroup\n\nHere's an example of a ResourceGroup that includes a Deployment, Service, and Ingress:\n\n```yaml\napiVersion: kro.run/v1alpha1\nkind: ResourceGroup\nmetadata:\n  name: my-application\nspec:\n  schema:\n    apiVersion: v1alpha1\n    kind: Application\n    spec:\n      name: string\n      image: string | default=\"nginx\"\n      ingress:\n        enabled: boolean | default=false\n    status:\n      deploymentConditions: ${deployment.status.conditions}\n      availableReplicas: ${deployment.status.availableReplicas}\n  resources:\n    - id: deployment\n      template:\n        apiVersion: apps/v1\n        kind: Deployment\n        metadata:\n          name: ${schema.spec.name}\n        spec:\n          replicas: 3\n          selector:\n            matchLabels:\n              app: ${schema.spec.name}\n          template:\n            metadata:\n              labels:\n                app: ${schema.spec.name}\n            spec:\n              containers:\n                - name: ${schema.spec.name}\n                  image: ${schema.spec.image}\n                  ports:\n                    - containerPort: 80\n    - id: service\n      template:\n        apiVersion: v1\n        kind: Service\n        metadata:\n          name: ${schema.spec.name}-service\n        spec:\n          selector: ${deployment.spec.selector.matchLabels}\n          ports:\n            - protocol: TCP\n              port: 80\n              targetPort: 80\n    - id: ingress\n      includeWhen:\n        - ${schema.spec.ingress.enabled}\n      template:\n        apiVersion: networking.k8s.io/v1\n        kind: Ingress\n        metadata:\n          name: ${schema.spec.name}-ingress\n          annotations:\n            kubernetes.io/ingress.class: alb\n            alb.ingress.kubernetes.io/scheme: internet-facing\n            alb.ingress.kubernetes.io/target-type: ip\n            alb.ingress.kubernetes.io/healthcheck-path: /health\n            alb.ingress.kubernetes.io/listen-ports: '[{\"HTTP\": 80}]'\n            alb.ingress.kubernetes.io/target-group-attributes: stickiness.enabled=true,stickiness.lb_cookie.duration_seconds=60\n        spec:\n          rules:\n            - http:\n                paths:\n                  - path: \"/\"\n                    pathType: Prefix\n                    backend:\n                      service:\n                        name: ${service.metadata.name}\n                        port:\n                          number: 80\n```\n\n## ResourceGroup Instances\n\nOnce kro processes your ResourceGroup, it creates a new API in your cluster. Users can then create [instances](https://kro.run/docs/concepts/instances) of this API to deploy resources in a consistent, controlled way. An instance represents your deployed application and contains your configuration values, serving as the single source of truth for your application's desired state.\n\n### Example ResourceGroup Instance\n\nHere's an example of how an instance for the SimpleWebApp might look:\n\n```yaml\napiVersion: kro.run/v1alpha1\nkind: SimpleWebApp\nmetadata:\n  name: my-web-app\nspec:\n  appName: awesome-app\n  image: nginx:latest\n  replicas: 3\n```\n\n## Getting Started with kro\n\n### Installation\n\nTo install kro, you need Helm and kubectl configured for your Kubernetes cluster. Follow these steps:\n\n1. **Fetch the latest release version:**\n   \n    ```sh\n    export KRO_VERSION=$(curl -sL https://api.github.com/repos/awslabs/kro/releases/latest | jq -r '.tag_name | ltrimstr(\"v\")')\n    ```\n\n2. **Install kro using Helm:**\n    ```sh\n    helm install kro oci://public.ecr.aws/kro/kro --namespace kro --create-namespace --version=${KRO_VERSION}\n    ```\n\n3. **Verify the installation:**\n    ```sh\n    helm -n kro list\n    kubectl get pods -n kro\n    ```\n\n### Creating Your First ResourceGroup\n\n1. **Define a ResourceGroup:**\n    Save the following as `resourcegroup.yaml`:\n    ```yaml\n    apiVersion: kro.run/v1alpha1\n    kind: ResourceGroup\n    metadata:\n      name: my-application\n    spec:\n      schema:\n        apiVersion: v1alpha1\n        kind: Application\n        spec:\n          name: string\n          image: string | default=\"nginx\"\n          ingress:\n            enabled: boolean | default=false\n        status:\n          deploymentConditions: ${deployment.status.conditions}\n          availableReplicas: ${deployment.status.availableReplicas}\n      resources:\n        - id: deployment\n          template:\n            apiVersion: apps/v1\n            kind: Deployment\n            metadata:\n              name: ${schema.spec.name}\n            spec:\n              replicas: 3\n              selector:\n                matchLabels:\n                  app: ${schema.spec.name}\n              template:\n                metadata:\n                  labels:\n                    app: ${schema.spec.name}\n                spec:\n                  containers:\n                    - name: ${schema.spec.name}\n                      image: ${schema.spec.image}\n                      ports:\n                        - containerPort: 80\n        - id: service\n          template:\n            apiVersion: v1\n            kind: Service\n            metadata:\n              name: ${schema.spec.name}-service\n            spec:\n              selector: ${deployment.spec.selector.matchLabels}\n              ports:\n                - protocol: TCP\n                  port: 80\n                  targetPort: 80\n        - id: ingress\n          includeWhen:\n            - ${schema.spec.ingress.enabled}\n          template:\n            apiVersion: networking.k8s.io/v1\n            kind: Ingress\n            metadata:\n              name: ${schema.spec.name}-ingress\n              annotations:\n                kubernetes.io/ingress.class: alb\n                alb.ingress.kubernetes.io/scheme: internet-facing\n                alb.ingress.kubernetes.io/target-type: ip\n                alb.ingress.kubernetes.io/healthcheck-path: /health\n                alb.ingress.kubernetes.io/listen-ports: '[{\"HTTP\": 80}]'\n                alb.ingress.kubernetes.io/target-group-attributes: stickiness.enabled=true,stickiness.lb_cookie.duration_seconds=60\n            spec:\n              rules:\n                - http:\n                    paths:\n                      - path: \"/\"\n                        pathType: Prefix\n                        backend:\n                          service:\n                            name: ${service.metadata.name}\n                            port:\n                              number: 80\n    ```\n\n2. **Apply the ResourceGroup:**\n    ```sh\n    kubectl apply -f resourcegroup.yaml\n    ```\n\n3. **Inspect the ResourceGroup:**\n    ```sh\n    kubectl get rg my-application -o wide\n    ```\n\n### Creating an Application Instance\n\n1. **Define an Application instance:**\n    Save the following as `instance.yaml`:\n    ```yaml\n    apiVersion: kro.run/v1alpha1\n    kind: Application\n    metadata:\n      name: my-application-instance\n    spec:\n      name: my-awesome-app\n      ingress:\n        enabled: true\n    ```\n\n1. **Apply the Application instance:**\n\n    ```sh\n    kubectl apply -f instance.yaml\n    ```\n\n2. **Inspect the Application instance:**\n\n    ```sh\n    kubectl get applications\n    ```\n\n3. **Inspect the resources:**\n\n    ```sh\n    kubectl get deployments,services,ingresses\n    ```\n\n### Deleting the Application Instance\n\nTo clean up resources, delete the Application instance:\n\n```sh\nkubectl delete application my-application-instance\n```\n\n## üåü Conclusion\n\nkro by AWS simplifies Kubernetes resource management by allowing you to define and manage complex resource configurations as reusable components. Whether you're deploying simple applications or complex multi-service architectures, kro can help streamline your Kubernetes operations.\n\n## üåê Community Participation\n\nDevelopment and discussion are coordinated in the [Kubernetes Slack (invite link)][k8s-slack] channel [#kro][kro-channel] channel.\n\n[k8s-slack]: https://communityinviter.com/apps/kubernetes/community\n[kro-channel]: https://kubernetes.slack.com/archives/XXX-TBD\n\nWe welcome questions, suggestions, and contributions from the community! To get involved, check out our contributing guide. For bugs or feature requests, feel free to submit an issue. You‚Äôre also invited to join our community.\n\n## üìö Documentation\n\nFor more detailed information, check out the following resources:\n\n[kro-overview]: https://kro.run/docs/overview\n[kro-installation]: https://kro.run/docs/getting-started/Installation\n[kro-getting-started]: https://kro.run/docs/getting-started/deploy-a-resource-group\n[kro-concepts]: https://kro.run/docs/concepts/resource-groups/\n[kro-examples]: https://kro.run/examples/\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":598},"frontmatter":{"id":"5248a7723e9b59c7be525eb3","path":"/blog/kro-aws/","humanDate":"Nov 16, 2024","fullDate":"2024-11-16","title":"Simplify Kubernetes Resource Management with KRO by AWS","keywords":["Kubernetes","AWS","Resource Management","DevOps","k8s","kro"],"excerpt":"Learn how kro by AWS can simplify the creation and management of complex Kubernetes resources.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACpElEQVR42k2T2U9TQRTG+6f45kNTKsSwyCIhVEI00ASwtHdpL7QsQY2AUVKwQtt7u1EENEGCIT4oifLkg0viA4QClU0aWkpLW0wjrg8a/4LPM7eoPHw5d2bO/ObMd+ZqRO8eLGNbEJR9cO4dmO6tQ5DjMNMc542BV+LqWPQlwct7EP0HEGiP2fOh8O3bJyUh+JPqWNMkTENX1gBtgwR9PY/yunbUtcuobOpHUU0rdBdNqDYOoviShHLSOUMHatpGoLtgRFlzP8432FHS6EAFm+98CE2zbQbaikZoa1qgqzVBX9UCbZ0ZeoMEnUEkuBuVV26gqLQeJQQupfUzxdWoMg5AX8uhXhyHrvQyzpYZUNs1C43oiYEbicA0vIKrg6/RdP0FWp2raLn9Du0jKxA8u7DQmuXuGsyjm+Bd6zBTvkh2tN16A250A5wrSnFTtUZjDRzCFsxAInXez0IMHsE5l8G1BzmIgRxsbD1EMZhV81hkuYI/B6P3NzhfvpDD1gNpAvpTEJUE+NEobPOvYFF2sLadR/hZEq1jh2AHshwrGc7EjJeCaQw9/gr7xGcMzHxB9wQV4jtQ8wpA1sGxDYQDc3AoW1hYPkT46S7s3lX0BqLU3fgJMKVulEJHGJr/RcBPkBd+omcyrzL+A+UYebIL06MULP445Ofr8MxvocP1Ft3yEnjy2arEC0A/WTP1DWLoGANzP+CYPMbN2e8Qgh9hY8+GnSzQm2Lqf7JIvm1j8WUE7tkoTN4cXTlDSp9cOwVJTqAvnIGdKuoZz6KTKu4dJ1vcCQImCxVaWbmkvqllqiCBO9MblBSjB5tWT/0LY2C76z0cQ0twUOftzgi6KDqGI+h2LsNGP0cB6E+rEpScGnkCMdg/0CmJ1GExxF5DtvB9KjIP/wCsJjinOz8CqAAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/b45c2eb83b98e4a693e092d6a41058af/85f54/kro-cover.png","srcSet":"/static/b45c2eb83b98e4a693e092d6a41058af/dc458/kro-cover.png 750w,\n/static/b45c2eb83b98e4a693e092d6a41058af/25cea/kro-cover.png 1080w,\n/static/b45c2eb83b98e4a693e092d6a41058af/3ce46/kro-cover.png 1366w,\n/static/b45c2eb83b98e4a693e092d6a41058af/85f54/kro-cover.png 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/b45c2eb83b98e4a693e092d6a41058af/4ff4a/kro-cover.webp 750w,\n/static/b45c2eb83b98e4a693e092d6a41058af/afcae/kro-cover.webp 1080w,\n/static/b45c2eb83b98e4a693e092d6a41058af/a6801/kro-cover.webp 1366w,\n/static/b45c2eb83b98e4a693e092d6a41058af/16aac/kro-cover.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5505208333333333}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/cedar-aws-k8s/","title":"Simplify Authorization Management with Cedar by AWS","date":"2024-11-22 21:40:00"},"excerpt":"Simplify Authorization Management with Cedar by AWS ‚ö° Introduction AWS recently introduced Cedar that simplifies managing authorization‚Ä¶","html":"<blockquote>\n<p><strong>Simplify Authorization Management with Cedar by AWS</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ö° Introduction</h2>\n<p>AWS recently introduced Cedar that simplifies managing authorization policies. Cedar allows you to define and manage complex authorization rules as reusable components, making your life easier and your applications more secure.</p>\n<h2 id=\"what-is-cedar\" style=\"position:relative;\"><a href=\"#what-is-cedar\" aria-label=\"what is cedar permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>What is Cedar?</h2>\n<p>Cedar is an open-source project by AWS that helps you create and manage fine-grained authorization policies. By defining these policies separately from your application code, you can update, analyze, and audit them independently.</p>\n<h2 id=\"how-does-cedar-work\" style=\"position:relative;\"><a href=\"#how-does-cedar-work\" aria-label=\"how does cedar work permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>How does Cedar work?</h2>\n<p>Cedar uses a simple yet expressive language to define authorization policies. When you apply a policy, Cedar:</p>\n<ol>\n<li>Validates the policy against a schema.</li>\n<li>Evaluates access requests in real-time.</li>\n<li>Provides detailed analysis and optimization tools.</li>\n</ol>\n<h2 id=\"cedar-policies\" style=\"position:relative;\"><a href=\"#cedar-policies\" aria-label=\"cedar policies permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Cedar Policies</h2>\n<p>A Cedar policy specifies who can do what with which resources. It supports common authorization models like Role-Based Access Control (RBAC) and Attribute-Based Access Control (ABAC).</p>\n<h3 id=\"example-cedar-policy\" style=\"position:relative;\"><a href=\"#example-cedar-policy\" aria-label=\"example cedar policy permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Example Cedar Policy</h3>\n<p>Here's an example of a Cedar policy that allows a user named \"alice\" to view photos in the \"jane_vacation\" album:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">permit <span class=\"token punctuation\">(</span>\n  principal <span class=\"token operator\">==</span> User::<span class=\"token string\">\"alice\"</span>,\n  action <span class=\"token operator\">==</span> Action::<span class=\"token string\">\"view\"</span>,\n  resource <span class=\"token keyword\">in</span> Album::<span class=\"token string\">\"jane_vacation\"</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"example-entities\" style=\"position:relative;\"><a href=\"#example-entities\" aria-label=\"example entities permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Example Entities</h3>\n<p>Cedar represents principals, resources, and actions as entities. Here's an example of entities in JSON format:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"uid\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"User\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"alice\"</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"attrs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token property\">\"age\"</span><span class=\"token operator\">:</span> <span class=\"token number\">18</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"parents\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"uid\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Photo\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"VacationPhoto94.jpg\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"attrs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"parents\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Album\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"jane_vacation\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<h2 id=\"getting-started-with-cedar\" style=\"position:relative;\"><a href=\"#getting-started-with-cedar\" aria-label=\"getting started with cedar permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Getting Started with Cedar</h2>\n<h3 id=\"installation\" style=\"position:relative;\"><a href=\"#installation\" aria-label=\"installation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Installation</h3>\n<p>To use Cedar in your application, add the <code class=\"language-text\">cedar-policy</code> crate as a dependency:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">cargo</span> <span class=\"token function\">add</span> cedar-policy</code></pre></div>\n<h3 id=\"testing-your-policy\" style=\"position:relative;\"><a href=\"#testing-your-policy\" aria-label=\"testing your policy permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Testing Your Policy</h3>\n<p>You can test your policy using the Cedar CLI:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">cargo</span> run authorize <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--policies</span> policy.cedar <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--entities</span> entities.json <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--principal</span> <span class=\"token string\">'User::\"alice\"'</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--action</span> <span class=\"token string\">'Action::\"view\"'</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--resource</span> <span class=\"token string\">'Photo::\"VacationPhoto94.jpg\"'</span></code></pre></div>\n<p>CLI output:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ALLOW</code></pre></div>\n<p>This request is allowed because \"VacationPhoto94.jpg\" belongs to \"jane_vacation\", and \"alice\" can view photos in that album.</p>\n<h2 id=\"cedar-for-kubernetes\" style=\"position:relative;\"><a href=\"#cedar-for-kubernetes\" aria-label=\"cedar for kubernetes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Cedar for Kubernetes</h2>\n<p>Cedar for Kubernetes allows users to enforce access control on Kubernetes API requests using Cedar policies. Users can dynamically create authorization policies for Kubernetes that support features like request or user attribute-based rules, label-based access controls, conditions, and enforce denial policies. Users can also create admission policies in the same file as authorization policy, giving policy authors a single language to write and reason about.</p>\n<h3 id=\"cedar-access-controls-for-kubernetes\" style=\"position:relative;\"><a href=\"#cedar-access-controls-for-kubernetes\" aria-label=\"cedar access controls for kubernetes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Cedar Access Controls for Kubernetes</h3>\n<p>AWS has announced a new open-source project, Cedar access controls for Kubernetes. This project brings the power of Cedar to Kubernetes authorization and admission validation, enabling cluster administrators to use a unified access control language for principals making API calls. With Cedar access controls for Kubernetes, administrators can dynamically create authorization policies that support features like request or user attribute-based rules, label-based access controls, conditions, and denial policies.</p>\n<h3 id=\"background-kubernetes-authorization-and-admission\" style=\"position:relative;\"><a href=\"#background-kubernetes-authorization-and-admission\" aria-label=\"background kubernetes authorization and admission permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Background: Kubernetes Authorization and Admission</h3>\n<p>Kubernetes is an open-source system for automating deployment, scaling, and management of containerized applications. Central to Kubernetes is an API server that supports multiple extension points, and Cedar integrates into two of these steps: the authorization and validating admission phase. After a request is authenticated, Kubernetes performs authorization for nodes, a pluggable authorization to an external webhook (powered by Cedar in this case), and the built-in Role-Based Access Control (RBAC).</p>\n<p>Authorization in Kubernetes is intended to be fast, so the body of the requested action is not serialized or evaluated: just the authentication information, the verb, and the contents of the URL are evaluated. In a Kubernetes request, the URL contains data like the API group, what resource type is being acted on (\"pods\", \"secrets\", \"nodes\", etc.), a possible namespace, or the specific resource's name. If a request passes authorization, it proceeds through several phases and then reaches the validating admission step. Admission validation allows administrators to allow or deny mutating requests (create/update/delete) with the requested object included, and Cedar policies can also be evaluated in this step.</p>\n<h3 id=\"demonstration\" style=\"position:relative;\"><a href=\"#demonstration\" aria-label=\"demonstration permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Demonstration</h3>\n<p>Let's walk through an example of capabilities that Cedar enables. As a Kubernetes administrator, you want to allow some users to create and manage Kubernetes ConfigMaps to store configuration data, but you only want those users to view and modify ConfigMaps they own. Enforcing this kind of control is possible today in Kubernetes, but requires you to use RBAC and a validating admission webhook with a separate policy language.</p>\n<p>First, we'll write an authorization policy permitting users to view and manage ConfigMaps.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">permit <span class=\"token punctuation\">(</span>\n    principal <span class=\"token keyword\">in</span> k8s::Group::<span class=\"token string\">\"requires-labels\"</span>,\n    action <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span>\n        k8s::Action::<span class=\"token string\">\"create\"</span>,\n        k8s::Action::<span class=\"token string\">\"update\"</span>,\n        k8s::Action::<span class=\"token string\">\"patch\"</span>,\n        k8s::Action::<span class=\"token string\">\"delete\"</span>,\n        k8s::Action::<span class=\"token string\">\"list\"</span>,\n        k8s::Action::<span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">]</span>,\n    resource is k8s::Resource\n<span class=\"token punctuation\">)</span> when <span class=\"token punctuation\">{</span>\n    resource.apiGroup <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">&amp;&amp;</span> // <span class=\"token string\">\"\"</span> is the core Kubernetes API group\n    resource.resource <span class=\"token operator\">==</span> <span class=\"token string\">\"configmaps\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This policy grants users in the group \"requires-labels\" the ability to create, update, patch, delete, list, and watch ConfigMap objects. So far, this is comparable to an RBAC policy in Kubernetes. Now, let's add a policy to prevent users from listing or watching for ConfigMaps they do not own.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">forbid <span class=\"token punctuation\">(</span>\n    principal is k8s::User <span class=\"token keyword\">in</span> k8s::Group::<span class=\"token string\">\"requires-labels\"</span>,\n    action <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span>k8s::Action::<span class=\"token string\">\"list\"</span>, k8s::Action::<span class=\"token string\">\"watch\"</span><span class=\"token punctuation\">]</span>,\n    resource is k8s::Resource\n<span class=\"token punctuation\">)</span> unless <span class=\"token punctuation\">{</span>\n    resource has labelSelector <span class=\"token operator\">&amp;&amp;</span>\n    resource.labelSelector.contains<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"key\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"owner\"</span>,\n        <span class=\"token string\">\"operator\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"=\"</span>,\n        <span class=\"token string\">\"values\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>principal.name<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Unlike RBAC, we can define explicit denials in authorization. This policy forbids users in the group \"requires-labels\" from making list or watch requests against any resource unless they include a label selector in their request. This policy leverages a new alpha-level feature gate AuthorizeWithSelectors in Kubernetes v1.31 that allows the Cedar authorizer to make decisions on field and label selectors included in a request. Now let's restrict what the users can create or update.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">forbid <span class=\"token punctuation\">(</span>\n    principal is k8s::User <span class=\"token keyword\">in</span> k8s::Group::<span class=\"token string\">\"requires-labels\"</span>,\n    action <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span>\n        k8s::admission::Action::<span class=\"token string\">\"create\"</span>,\n        k8s::admission::Action::<span class=\"token string\">\"update\"</span>,\n        k8s::admission::Action::<span class=\"token string\">\"delete\"</span><span class=\"token punctuation\">]</span>,\n    resource\n<span class=\"token punctuation\">)</span> unless <span class=\"token punctuation\">{</span>\n    resource has metadata <span class=\"token operator\">&amp;&amp;</span>\n    resource.metadata has labels <span class=\"token operator\">&amp;&amp;</span>\n    resource.metadata.labels.contains<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"key\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"owner\"</span>, <span class=\"token string\">\"value\"</span><span class=\"token builtin class-name\">:</span> principal.name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You may notice that the action in this policy has a different prefix than the authorization policies. Because Kubernetes does not include the content of the resource in authorization but does in admission validations, we use actions in separate Cedar namespaces for authorization and admission. Authorization actions apply to k8s::Resource types and admission actions apply to Kubernetes types. Finally, we need one more admission policy:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">forbid <span class=\"token punctuation\">(</span>\n    principal is k8s::User <span class=\"token keyword\">in</span> k8s::Group::<span class=\"token string\">\"requires-labels\"</span>,\n    action <span class=\"token operator\">==</span> k8s::admission::Action::<span class=\"token string\">\"update\"</span>,\n    resource\n<span class=\"token punctuation\">)</span> unless <span class=\"token punctuation\">{</span>\n    resource has oldObject <span class=\"token operator\">&amp;&amp;</span>\n    resource.oldObject has metadata <span class=\"token operator\">&amp;&amp;</span>\n    resource.oldObject.metadata has labels <span class=\"token operator\">&amp;&amp;</span>\n    resource.oldObject.metadata.labels.contains<span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">{</span><span class=\"token string\">\"key\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"owner\"</span>, <span class=\"token string\">\"value\"</span><span class=\"token builtin class-name\">:</span> principal.name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Similar to the first admission policy, we write a policy that applies to update operations. When a user makes an update request, the validating admission request not only includes the updated object, but also includes the object before it was modified. This enables us to prevent principals from overwriting the owner label on a resource that doesn't belong to the principal.</p>\n<p>Now we can try this policy out! We have created a local Kubernetes cluster in a VM using Kind, and applied the above policy. We have created a kubeconfig for a user named \"sample-user\", and included them in the group \"requires-labels\" (the GitHub project has full setup instructions for you to try this out).</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token comment\"># set our KUBECONFIG file to a sample user in our Kind cluster</span>\n$ <span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">KUBECONFIG</span><span class=\"token operator\">=</span>./mount/sample-user-kubeconfig.yaml\n$ kubectl auth <span class=\"token function\">whoami</span>\nATTRIBUTE   VALUE\nUsername    sample-user\nGroups      <span class=\"token punctuation\">[</span>sample-group requires-labels system:authenticated<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Now, let's see what that user can do. First, we'll try to see what ConfigMaps exist, and create a new one.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ kubectl get configmap\nError from server <span class=\"token punctuation\">(</span>Forbidden<span class=\"token punctuation\">)</span>: configmaps is forbidden: <span class=\"token punctuation\">\\</span>\n  User <span class=\"token string\">\"sample-user\"</span> cannot list resource <span class=\"token string\">\"configmaps\"</span> <span class=\"token keyword\">in</span> API group <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token keyword\">in</span> the namespace <span class=\"token string\">\"default\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token punctuation\">{</span><span class=\"token string\">\"reasons\"</span>:<span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"policy\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"label-enforcement-policy1\"</span>,<span class=\"token string\">\"position\"</span>:<span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"filename\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"label-enforcement-policy\"</span>,<span class=\"token string\">\"offset\"</span>:671,<span class=\"token string\">\"line\"</span>:21,<span class=\"token string\">\"column\"</span>:1<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ kubectl create configmap sample-config --from-literal<span class=\"token operator\">=</span>k1<span class=\"token operator\">=</span>v1\nerror: failed to create configmap: <span class=\"token punctuation\">\\</span>\n    admission webhook <span class=\"token string\">\"vpolicy.cedar.k8s.aws\"</span> denied the request: <span class=\"token punctuation\">\\</span>\n    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"policy\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"label-enforcement-policy2\"</span>,<span class=\"token string\">\"position\"</span>:<span class=\"token punctuation\">{</span>\n         <span class=\"token string\">\"filename\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"label-enforcement-policy\"</span>,<span class=\"token string\">\"offset\"</span>:1226,<span class=\"token string\">\"line\"</span>:36,<span class=\"token string\">\"column\"</span>:1<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>In the first request, our kubectl get request resulted in a list operation. This was permitted in the first policy, but denied in the second policy (the zero-indexed \"label-enforcement-policy1\") that forbids list/watch resource requests without a label selector. The second request was similarly permitted in the first authorization policy, but denied in admission policy \"label-enforcement-policy2\".</p>\n<p>Next, let's try to make requests that use ownership labels.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ kubectl get configmap <span class=\"token parameter variable\">--selector</span> <span class=\"token assign-left variable\">owner</span><span class=\"token operator\">=</span>sample-user --show-labels\nNo resources found <span class=\"token keyword\">in</span> default namespace.\n\n<span class=\"token comment\"># Construct a configmap with the proper owner label</span>\n$ <span class=\"token function\">cat</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">EOF<span class=\"token bash punctuation\"> <span class=\"token operator\">></span> sample-config.yaml</span>\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: sample-config\n  labels:\n    owner: sample-user\ndata:\n  stage: test\nEOF</span>\n\n$ kubectl create <span class=\"token parameter variable\">-f</span> ./sample-config.yaml\nconfigmap/sample-config created\n\n$ kubectl get configmap <span class=\"token parameter variable\">--selector</span> <span class=\"token assign-left variable\">owner</span><span class=\"token operator\">=</span>sample-user --show-labels\nNAME            DATA   AGE   LABELS\nsample-config   <span class=\"token number\">1</span>      19s   <span class=\"token assign-left variable\">owner</span><span class=\"token operator\">=</span>sample-user</code></pre></div>\n<p>And they all succeeded! When we made list or create requests using the owner labels, they were permitted because each forbid statement's unless clause was satisfied.</p>\n<h3 id=\"additional-features\" style=\"position:relative;\"><a href=\"#additional-features\" aria-label=\"additional features permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Additional Features</h3>\n<p>Beyond the ability to enforce Cedar-based permissions in Kubernetes, the project provides a few other features:</p>\n<ul>\n<li>A Custom Resource Definition (CRD) for storing Cedar policies in a Kubernetes cluster.</li>\n<li>A converter that works with any RBAC bindings and policies to rewrite them in Cedar. RBAC policies continue to work in clusters with Cedar enabled, they are only evaluated when no Cedar rules explicitly allow or forbid a request.</li>\n<li>Support for authorizing Kubernetes impersonation on UIDs, usernames, and groups.</li>\n<li>A Cedar schema generator for Kubernetes built-in types and CRDs, so policies can be validated before creation.</li>\n</ul>\n<h3 id=\"limitations\" style=\"position:relative;\"><a href=\"#limitations\" aria-label=\"limitations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Limitations</h3>\n<p>This project is a public experiment for how Cedar policies can be used to enforce authorization in Kubernetes. We think this project holds a lot of possibilities for enabling more secure policies in Kubernetes, but there are limitations and tradeoffs to be aware of. One worth mentioning here is that Cedar doesn't work well with optional nested fields on sets of structures. While Cedar has operators that can test set membership or set overlap, it does not have a way to map a general operation on a set of objects. This is by design: It ensures that Cedar policies are efficiently and precisely analyzable, in the sense that they can be represented in formal logic for purposes of automating policy reasoning. As a result, Cedar is not able to enforce common Kubernetes policies like ensuring all container images on a pod are from a specific container registry, or that all containers have CPU and memory limits set. If this is an issue for you, Cedar is still a great upgrade for the authorization component, but other tooling like Open Policy Agent Gatekeeper or Kyverno may be a better fit for those policies. For a full list of features, limitations, and a walkthrough to try this out for yourself in a Kind cluster, see the GitHub repository. We can't wait to see what kind of policies you write!</p>\n<h3 id=\"can-i-use-cedar-for-kubernetes-policy-enforcement\" style=\"position:relative;\"><a href=\"#can-i-use-cedar-for-kubernetes-policy-enforcement\" aria-label=\"can i use cedar for kubernetes policy enforcement permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Can I use Cedar for Kubernetes policy enforcement?</h3>\n<p>While Cedar offers powerful authorization guarantees, there are policy enforcement requirements common to Kubernetes that are not formally analyzable. For example, enforcing that all containers in all pods have a maximum memory limit set. Cedar is powered by automated reasoning, including an SMT solver, which does not implement loops or map functions. Rather than viewing Cedar as a replacement for tools like Open Policy Agent/Gatekeeper or Kyverno, it is best seen as an additional tool for access control enforcement.</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>Cedar by AWS offers a powerful and flexible way to manage authorization policies. By separating policy management from application code, you can ensure your security model is robust and adaptable. For more details, check out the Cedar documentation.</p>\n<blockquote>\n<p>üìªüß° For more information, check out the <a href=\"https://docs.cedarpolicy.com\" target=\"_blank\" rel=\"noopener noreferrer\">Cedar documentation</a> and explore the <a href=\"https://github.com/cedar-policy/cedar-examples\" target=\"_blank\" rel=\"noopener noreferrer\">Cedar examples repository</a>.</p>\n</blockquote>\n<br>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"},"nextThought":{"frontmatter":{"path":"/blog/kubernetes-containerd-cilium-setup/","title":"Guide to Setting Up Kubernetes 1.31 with containerd v2 and Cilium","date":"2024-11-11 20:00:00"},"excerpt":"Definitive Guide to Setting Up Kubernetes 1.31 with containerd v2 and Cilium Introduction Welcome to this guide on setting up Kubernetes‚Ä¶","html":"<blockquote>\n<p><strong>Definitive Guide to Setting Up Kubernetes 1.31 with containerd v2 and Cilium</strong></p>\n</blockquote>\n<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Introduction</h2>\n<p>Welcome to this guide on setting up <a href=\"https://kubernetes.io/blog/2024/08/13/kubernetes-v1-31-release/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes 1.31</a> with the <a href=\"https://github.com/containerd/containerd/releases/tag/v2.0.0\" target=\"_blank\" rel=\"noopener noreferrer\">containerd v2</a> runtime and <a href=\"https://isovalent.com/blog/post/cilium-1-16/\" target=\"_blank\" rel=\"noopener noreferrer\">Cilium</a> for networking. This guide is designed to be a comprehensive reference for professionals worldwide, ensuring a robust and efficient container orchestration environment with advanced networking capabilities.</p>\n<p>This guide is designed to be a comprehensive reference for professionals worldwide, ensuring an efficient container orchestration environment with advanced networking capabilities.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACr0lEQVR42lWTW08TcRDFt3ttd7fdLsWqLRdFKrGgVe4ooKgRjSYoSBVErbYKCYpXjARNUULAS1ASfdDE6JuJL4YPYXxAv4h+iJ/Ten84u5Od+Z+ZM/+ziun47I5t4Gg8wf7K9eyOeLREInSFbAabGvm0ssiBWCWtEZ+dusnT7AlWbk6yVdPZ53k02jbHJN/ox9HtKIpmhdnk+qQjMdJhnz1uhF1OmJagQ0eyis+vl8l1dVIbMNluh1ldmOVBboSUorHDdmiwLLaEHNYJmSpcih6MoEhgyHtPtJLesMfBaAXdjsdAzSY+Fqd5KFNlDJvh1FZW5+4we+wwvZrJXtslI0oU1UCT82Wu0qNEZpZguehSqOtBAoqBXxFnYjxHoXCOoFNBe0cHM3enaG1rxXGi1G2ul1oLTWAEvb+Ev1GSr2qSFGJbVhBP1jJ6ZoT85Tw72joZGBri0niBVMM2Xrx8xdraF6pr6lAUFVMk/0doWDa65UhSx48l6OnrZ3j0LPeKRW5MT7Ow9IiZ+0UeLy9z8vQZJq7e5tbdOTZv2VY+8w+hh2baBKwEqiEfAkGqqhJszzSRSrfS3tPL4Okxxq9MMZrLMzyWI1ad4tlCka8f31BXnxZCSwh/SVbFCm6yndl33+nOPiMolnk608/80V1Y7jpMfz1Doxc4NJDl3OUpOvuOSNMo2e4M7yf7RE2sPKER+ocwnGxj5u03uk89l046FwtDDO7LY4Y3kG5uY+nJEsX5ORYfLzKSu0hS9lZf6XH/eAOJZDO211ReV0ntT8lGSIIoAc1GUy0xaBzNLRk1Rl//YQoTBa7fvsaV65OM5S/Q1ZLhQ7aalf4YNXXn2VgzjGpavwl/3XL5UlwCqikwpCCEGopILM2UoED8prgCh4Dp01zfQIX8BJruykDuH6f8AJtsTGizTAFfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/12cdd828513870f8806426a0fb0e22b5/c5bb3/k8s-containerd-cilium-cover.png\" srcset=\"/static/12cdd828513870f8806426a0fb0e22b5/04472/k8s-containerd-cilium-cover.png 170w,\n/static/12cdd828513870f8806426a0fb0e22b5/9f933/k8s-containerd-cilium-cover.png 340w,\n/static/12cdd828513870f8806426a0fb0e22b5/c5bb3/k8s-containerd-cilium-cover.png 680w,\n/static/12cdd828513870f8806426a0fb0e22b5/b12f7/k8s-containerd-cilium-cover.png 1020w,\n/static/12cdd828513870f8806426a0fb0e22b5/b5a09/k8s-containerd-cilium-cover.png 1360w,\n/static/12cdd828513870f8806426a0fb0e22b5/0e758/k8s-containerd-cilium-cover.png 2502w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"prerequisites\" style=\"position:relative;\"><a href=\"#prerequisites\" aria-label=\"prerequisites permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Prerequisites</h2>\n<p>Before we begin, ensure you have the following prerequisites:</p>\n<ul>\n<li>A system running <a href=\"https://releases.ubuntu.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Ubuntu 22.04 LTS</a> or higher, 64-bit x86, and kernel 6.8.</li>\n<li>Root or sudo access to the system.</li>\n<li>Basic knowledge of <a href=\"https://kubernetes.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes</a>, <a href=\"https://containerd.io/\" target=\"_blank\" rel=\"noopener noreferrer\">containerd</a>, and <a href=\"https://cilium.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Cilium</a>.</li>\n</ul>\n<h2 id=\"step-by-step-guide\" style=\"position:relative;\"><a href=\"#step-by-step-guide\" aria-label=\"step by step guide permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step-by-Step Guide</h2>\n<h3 id=\"1-install-required-tools\" style=\"position:relative;\"><a href=\"#1-install-required-tools\" aria-label=\"1 install required tools permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>1. Install Required Tools</h3>\n<p>First, we need to ensure that <code class=\"language-text\">figlet</code> and <code class=\"language-text\">toilet</code> are installed for printing colorful messages.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">if</span> <span class=\"token operator\">!</span> <span class=\"token builtin class-name\">command</span> <span class=\"token parameter variable\">-v</span> figlet <span class=\"token operator\">&amp;></span> /dev/null <span class=\"token operator\">||</span> <span class=\"token operator\">!</span> <span class=\"token builtin class-name\">command</span> <span class=\"token parameter variable\">-v</span> toilet <span class=\"token operator\">&amp;></span> /dev/null<span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\033\">\\033</span>[0;33mFiglet or Toilet not found, installing...\"</span>\n    <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> figlet toilet\n<span class=\"token keyword\">fi</span></code></pre></div>\n<h3 id=\"2-print-the-title\" style=\"position:relative;\"><a href=\"#2-print-the-title\" aria-label=\"2 print the title permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>2. Print the Title</h3>\n<p>Use <code class=\"language-text\">figlet</code> to print the title of the script.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">figlet <span class=\"token parameter variable\">-f</span> smblock <span class=\"token string\">\"Setup Kubernetes 1.31 with containerd v2 and Cilium\"</span></code></pre></div>\n<h3 id=\"3-disable-swap\" style=\"position:relative;\"><a href=\"#3-disable-swap\" aria-label=\"3 disable swap permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>3. Disable Swap</h3>\n<p>Disabling swap is crucial for Kubernetes to function correctly. Kubernetes requires swap to be disabled to ensure optimal performance and stability.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">swapoff <span class=\"token parameter variable\">-a</span>\n<span class=\"token function\">sed</span> <span class=\"token parameter variable\">-i</span> <span class=\"token string\">'/swap/d'</span> /etc/fstab</code></pre></div>\n<blockquote>\n<p><strong>Note</strong>: Disabling swap ensures that Kubernetes can manage resources more effectively, preventing potential issues with resource allocation.</p>\n</blockquote>\n<h3 id=\"4-load-necessary-kernel-modules\" style=\"position:relative;\"><a href=\"#4-load-necessary-kernel-modules\" aria-label=\"4 load necessary kernel modules permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>4. Load Necessary Kernel Modules</h3>\n<p>Load the required kernel modules for containerd.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> <span class=\"token operator\">>></span>/etc/modules-load.d/containerd.conf<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\noverlay\nbr_netfilter\nEOF</span>\nmodprobe overlay\nmodprobe br_netfilter</code></pre></div>\n<h3 id=\"5-configure-sysctl-for-kubernetes\" style=\"position:relative;\"><a href=\"#5-configure-sysctl-for-kubernetes\" aria-label=\"5 configure sysctl for kubernetes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>5. Configure sysctl for Kubernetes</h3>\n<p>Configure sysctl parameters required by Kubernetes.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> <span class=\"token operator\">>></span>/etc/sysctl.d/kubernetes.conf<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables  = 1\nnet.ipv4.ip_forward                 = 1\nEOF</span>\n<span class=\"token function\">sysctl</span> <span class=\"token parameter variable\">--system</span></code></pre></div>\n<h3 id=\"6-disable-ufw\" style=\"position:relative;\"><a href=\"#6-disable-ufw\" aria-label=\"6 disable ufw permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>6. Disable UFW</h3>\n<p>Disable the Uncomplicated Firewall (UFW) to avoid network issues.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ufw disable</code></pre></div>\n<h3 id=\"7-remove-unnecessary-packages\" style=\"position:relative;\"><a href=\"#7-remove-unnecessary-packages\" aria-label=\"7 remove unnecessary packages permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>7. Remove Unnecessary Packages</h3>\n<p>Remove unnecessary packages to avoid conflicts.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> remove containernetworking-plugins <span class=\"token parameter variable\">-y</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> remove conmon <span class=\"token parameter variable\">-y</span></code></pre></div>\n<h3 id=\"8-create-keyrings-directory\" style=\"position:relative;\"><a href=\"#8-create-keyrings-directory\" aria-label=\"8 create keyrings directory permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>8. Create Keyrings Directory</h3>\n<p>Create the keyrings directory for storing GPG keys.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /etc/apt/keyrings/</code></pre></div>\n<h3 id=\"9-install-containerd\" style=\"position:relative;\"><a href=\"#9-install-containerd\" aria-label=\"9 install containerd permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>9. Install containerd</h3>\n<p>Download and install containerd.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/containerd/containerd/releases/download/v2.0.0/containerd-2.0.0-linux-amd64.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-C</span> /usr/local <span class=\"token parameter variable\">-xzvf</span> containerd-2.0.0-linux-amd64.tar.gz</code></pre></div>\n<h3 id=\"10-configure-containerd\" style=\"position:relative;\"><a href=\"#10-configure-containerd\" aria-label=\"10 configure containerd permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>10. Configure containerd</h3>\n<p>Create a systemd service file for containerd and start the service.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /usr/local/lib/systemd/system/\n<span class=\"token function\">cat</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF<span class=\"token bash punctuation\"> <span class=\"token operator\">></span> /usr/local/lib/systemd/system/containerd.service</span>\n[Unit]\nDescription=containerd container runtime\nDocumentation=https://containerd.io\nAfter=network.target local-fs.target dbus.service\n\n[Service]\nExecStartPre=-/sbin/modprobe overlay\nExecStart=/usr/local/bin/containerd\n\nType=notify\nDelegate=yes\nKillMode=process\nRestart=always\nRestartSec=5\n\nLimitNPROC=infinity\nLimitCORE=infinity\nTasksMax=infinity\nOOMScoreAdjust=-999\n\n[Install]\nWantedBy=multi-user.target\nEOF</span>\n\nsystemctl daemon-reload\nsystemctl <span class=\"token builtin class-name\">enable</span> <span class=\"token parameter variable\">--now</span> containerd</code></pre></div>\n<h3 id=\"11-install-runc\" style=\"position:relative;\"><a href=\"#11-install-runc\" aria-label=\"11 install runc permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>11. Install runc</h3>\n<p>Download and install runc.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/opencontainers/runc/releases/download/v1.2.1/runc.amd64\n<span class=\"token function\">install</span> <span class=\"token parameter variable\">-m</span> <span class=\"token number\">755</span> runc.amd64 /usr/local/sbin/runc</code></pre></div>\n<h3 id=\"12-install-cni-plugins\" style=\"position:relative;\"><a href=\"#12-install-cni-plugins\" aria-label=\"12 install cni plugins permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>12. Install CNI Plugins</h3>\n<p>Download and install CNI plugins.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/containernetworking/plugins/releases/download/v1.6.0/cni-plugins-linux-amd64-v1.6.0.tgz\n<span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /opt/cni/bin\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-C</span> /opt/cni/bin <span class=\"token parameter variable\">-xzvf</span> cni-plugins-linux-amd64-v1.6.0.tgz\nsystemctl restart containerd</code></pre></div>\n<h3 id=\"13-verify-containerd-installation\" style=\"position:relative;\"><a href=\"#13-verify-containerd-installation\" aria-label=\"13 verify containerd installation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>13. Verify containerd Installation</h3>\n<p>Verify the installation of containerd.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">containerd <span class=\"token parameter variable\">-v</span></code></pre></div>\n<h3 id=\"14-add-kubernetes-repository-and-install-components\" style=\"position:relative;\"><a href=\"#14-add-kubernetes-repository-and-install-components\" aria-label=\"14 add kubernetes repository and install components permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>14. Add Kubernetes Repository and Install Components</h3>\n<p>Add the Kubernetes repository and install the necessary components.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/apt/sources.list.d/kubernetes.list\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-fsSL</span> https://pkgs.k8s.io/core:/stable:/v1.31/deb/Release.key <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> gpg <span class=\"token parameter variable\">--dearmor</span> <span class=\"token parameter variable\">-o</span> /etc/apt/keyrings/kubernetes-apt-keyring.gpg\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> kubelet kubeadm kubectl <span class=\"token parameter variable\">-y</span>\n<span class=\"token function\">sudo</span> apt-mark hold kubelet kubeadm kubectl</code></pre></div>\n<h3 id=\"15-output-versions-of-kubernetes-components\" style=\"position:relative;\"><a href=\"#15-output-versions-of-kubernetes-components\" aria-label=\"15 output versions of kubernetes components permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>15. Output Versions of Kubernetes Components</h3>\n<p>Output the versions of the installed Kubernetes components.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubeadm version\nkubelet <span class=\"token parameter variable\">--version</span>\nkubectl version <span class=\"token parameter variable\">--client</span></code></pre></div>\n<h3 id=\"16-enable-and-start-kubelet\" style=\"position:relative;\"><a href=\"#16-enable-and-start-kubelet\" aria-label=\"16 enable and start kubelet permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>16. Enable and Start kubelet</h3>\n<p>Enable and start the kubelet service.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> <span class=\"token parameter variable\">--now</span> kubelet</code></pre></div>\n<h3 id=\"17-initialize-kubernetes-cluster-with-kubeadm\" style=\"position:relative;\"><a href=\"#17-initialize-kubernetes-cluster-with-kubeadm\" aria-label=\"17 initialize kubernetes cluster with kubeadm permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>17. Initialize Kubernetes Cluster with kubeadm</h3>\n<p>Initialize the Kubernetes cluster with the specified pod network CIDR using <code class=\"language-text\">kubeadm</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubeadm init --pod-network-cidr<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.0/16 --cri-socket unix:///run/containerd/containerd.sock --ignore-preflight-errors<span class=\"token operator\">=</span>NumCPU</code></pre></div>\n<h3 id=\"18-configure-kubectl-for-the-current-user\" style=\"position:relative;\"><a href=\"#18-configure-kubectl-for-the-current-user\" aria-label=\"18 configure kubectl for the current user permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>18. Configure kubectl for the Current User</h3>\n<p>Set up <code class=\"language-text\">kubectl</code> for the current user.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> <span class=\"token environment constant\">$HOME</span>/.kube\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> <span class=\"token parameter variable\">-i</span> /etc/kubernetes/admin.conf <span class=\"token environment constant\">$HOME</span>/.kube/config\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">id</span> <span class=\"token parameter variable\">-u</span><span class=\"token variable\">)</span></span><span class=\"token builtin class-name\">:</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">id</span> <span class=\"token parameter variable\">-g</span><span class=\"token variable\">)</span></span> <span class=\"token environment constant\">$HOME</span>/.kube/config\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">KUBECONFIG</span><span class=\"token operator\">=</span>/etc/kubernetes/admin.conf\nkubectl cluster-info dump</code></pre></div>\n<h3 id=\"19-remove-taints-on-control-plane-nodes\" style=\"position:relative;\"><a href=\"#19-remove-taints-on-control-plane-nodes\" aria-label=\"19 remove taints on control plane nodes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>19. Remove Taints on Control-Plane Nodes</h3>\n<p>Remove taints on control-plane nodes to allow scheduling of pods.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl taint nodes <span class=\"token parameter variable\">--all</span> node-role.kubernetes.io/control-plane-\nkubectl get nodes <span class=\"token parameter variable\">-o</span> wide</code></pre></div>\n<h3 id=\"20-install-cilium-cni\" style=\"position:relative;\"><a href=\"#20-install-cilium-cni\" aria-label=\"20 install cilium cni permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>20. Install Cilium CNI</h3>\n<p>Cilium is a networking, observability, and security solution with an eBPF-based data plane. Cilium provides a simple flat Layer 3 network with the ability to span multiple clusters in either a native routing or overlay/encapsulation mode, and can enforce network policies on L3-L7 using an identity-based security model that is decoupled from network addressing. Cilium can act as a replacement for kube-proxy; it also offers additional, opt-in observability and security features. Cilium is a CNCF project at the Graduated level.</p>\n<p>Install Cilium CNI for networking.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">CILIUM_CLI_VERSION</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> https://raw.githubusercontent.com/cilium/cilium-cli/main/stable.txt<span class=\"token variable\">)</span></span>\n<span class=\"token assign-left variable\">CLI_ARCH</span><span class=\"token operator\">=</span>amd64\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-m</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"aarch64\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span> <span class=\"token assign-left variable\">CLI_ARCH</span><span class=\"token operator\">=</span>arm64<span class=\"token punctuation\">;</span> <span class=\"token keyword\">fi</span>\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-L</span> <span class=\"token parameter variable\">--fail</span> --remote-name-all https://github.com/cilium/cilium-cli/releases/download/<span class=\"token variable\">${CILIUM_CLI_VERSION}</span>/cilium-linux-<span class=\"token variable\">${CLI_ARCH}</span>.tar.gz<span class=\"token punctuation\">{</span>,.sha256sum<span class=\"token punctuation\">}</span>\nsha256sum <span class=\"token parameter variable\">--check</span> cilium-linux-<span class=\"token variable\">${CLI_ARCH}</span>.tar.gz.sha256sum\n<span class=\"token function\">sudo</span> <span class=\"token function\">tar</span> xzvfC cilium-linux-<span class=\"token variable\">${CLI_ARCH}</span>.tar.gz /usr/local/bin\n<span class=\"token function\">rm</span> cilium-linux-<span class=\"token variable\">${CLI_ARCH}</span>.tar.gz<span class=\"token punctuation\">{</span>,.sha256sum<span class=\"token punctuation\">}</span>\n\ncilium <span class=\"token function\">install</span> <span class=\"token parameter variable\">--version</span> <span class=\"token number\">1.16</span>.3</code></pre></div>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>By following these steps, you can set up Kubernetes 1.31 with the containerd v2 runtime and Cilium for networking using <code class=\"language-text\">kubeadm</code>. This setup provides a robust and efficient container orchestration environment with advanced networking capabilities.</p>\n<blockquote>\n<p><strong>Troubleshooting Tips</strong>: If you encounter any issues during the setup, refer to the official documentation for <a href=\"https://kubernetes.io/docs/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes</a>, <a href=\"https://containerd.io/docs/\" target=\"_blank\" rel=\"noopener noreferrer\">containerd</a>, and <a href=\"https://docs.cilium.io/en/stable/\" target=\"_blank\" rel=\"noopener noreferrer\">Cilium</a>. Additionally, check the logs for any error messages and ensure all prerequisites are met.</p>\n</blockquote>\n<blockquote>\n<p><strong>Security Considerations</strong>: Ensure that your Kubernetes cluster is secured by following best practices, such as enabling RBAC, using network policies, and regularly updating your components.</p>\n</blockquote>\n<blockquote>\n<p><strong>Performance Tips</strong>: Optimize your cluster's performance by monitoring resource usage, scaling appropriately, and tuning configurations based on your workload requirements.</p>\n</blockquote>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}