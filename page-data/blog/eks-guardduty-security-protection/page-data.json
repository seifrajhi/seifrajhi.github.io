{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/eks-guardduty-security-protection/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Top-Notch Protection for EKS with Amazon GuardDuty</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìö Introduction</h2>\n<p><a href=\"https://aws.amazon.com/guardduty/\" target=\"_blank\" rel=\"noopener noreferrer\">Amazon GuardDuty</a> offers extended coverage, allowing for ongoing monitoring and profiling of Amazon EKS cluster activities.</p>\n<p>This involves identifying any potentially harmful or suspicious behavior that could pose threats to container workloads. The EKS Protection feature within Amazon GuardDuty delivers threat detection capabilities specifically designed to safeguard Amazon EKS clusters within your AWS setup.</p>\n<blockquote>\n<p>This protection encompasses two key components: <a href=\"https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/\" target=\"_blank\" rel=\"noopener noreferrer\">EKS Audit Log Monitoring</a> and <a href=\"https://aws.amazon.com/blogs/aws/amazon-guardduty-now-supports-amazon-eks-runtime-monitoring/\" target=\"_blank\" rel=\"noopener noreferrer\">EKS Runtime Monitoring</a>.</p>\n</blockquote>\n<p>In this blog post, we'll explore how Amazon GuardDuty can help you enhance the security of your EKS clusters, providing you with the tools and insights needed to keep your Kubernetes infrastructure safe and secure.</p>\n<h2 id=\"Ô∏è-amazon-guardduty\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-amazon-guardduty\" aria-label=\"Ô∏è amazon guardduty permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ°Ô∏è Amazon GuardDuty</h2>\n<p><a href=\"https://aws.amazon.com/guardduty/\" target=\"_blank\" rel=\"noopener noreferrer\">Amazon GuardDuty</a> is a managed threat detection service that uses a combination of machine learning, anomaly detection, and integrated threat intelligence to identify, flag, and prioritize potential threats.</p>\n<p>In <a href=\"https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/\" target=\"_blank\" rel=\"noopener noreferrer\">January 2022</a>, its capabilities were expanded to include Amazon EKS. Key features include:</p>\n<ul>\n<li><strong>No additional software required:</strong> Runs without the need for extra software.</li>\n<li><strong>Continuous 24/7 monitoring:</strong> Monitors your AWS implementation without added cost or complexity.</li>\n<li><strong>Global coverage:</strong> Provides worldwide protection.</li>\n<li><strong>Comprehensive monitoring:</strong> Monitors everything in your account and infrastructure, alerting you of any anomalous behavior.</li>\n<li><strong>Intuitive threat severity levels:</strong> Helps cybersecurity specialists prioritize potential threats.</li>\n</ul>\n<p>EKS Protection includes <strong>EKS Audit Log Monitoring</strong> and <strong>EKS Runtime Monitoring</strong>.</p>\n<h3 id=\"-eks-audit-log-monitoring\" style=\"position:relative;\"><a href=\"#-eks-audit-log-monitoring\" aria-label=\" eks audit log monitoring permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîç EKS Audit Log Monitoring</h3>\n<p>EKS Audit Log Monitoring helps you detect potentially suspicious activities in EKS clusters within Amazon Elastic Kubernetes Service (Amazon EKS). It uses Kubernetes audit logs to capture chronological activities from users, applications using the Kubernetes API, and the control plane. For more information, see <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/features-kubernetes-protection.html#guardduty_k8s-audit-logs\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes audit logs</a>.</p>\n<h3 id=\"Ô∏è-eks-runtime-monitoring\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-eks-runtime-monitoring\" aria-label=\"Ô∏è eks runtime monitoring permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è EKS Runtime Monitoring</h3>\n<p>EKS Runtime Monitoring uses operating system-level events to help you detect potential threats in Amazon EKS nodes and containers within your Amazon EKS clusters. For more information, see <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring.html\" target=\"_blank\" rel=\"noopener noreferrer\">Runtime Monitoring</a>.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHcbogZH//EABkQAAIDAQAAAAAAAAAAAAAAAAABECExQf/aAAgBAQABBQLliFkf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAARAgIf/aAAgBAQAGPwLEY//EABoQAAIDAQEAAAAAAAAAAAAAAAABETFBEKH/2gAIAQEAAT8hUwVDGDeirv8A/9oADAMBAAIAAwAAABDg/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAeEAACAgEFAQAAAAAAAAAAAAABEQAhMRBBUWGh8P/aAAgBAQABPxABCYZf3cBNiBS7gmxBvu1PFpzP/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"GuardDuty EKS\" title=\"\" src=\"/static/1ec49407ca31a1e25bba98e61520350b/7bf67/runtime-sec.jpg\" srcset=\"/static/1ec49407ca31a1e25bba98e61520350b/651be/runtime-sec.jpg 170w,\n/static/1ec49407ca31a1e25bba98e61520350b/d30a3/runtime-sec.jpg 340w,\n/static/1ec49407ca31a1e25bba98e61520350b/7bf67/runtime-sec.jpg 680w,\n/static/1ec49407ca31a1e25bba98e61520350b/4b190/runtime-sec.jpg 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-enable-amazon-guardduty-for-eks\" style=\"position:relative;\"><a href=\"#-enable-amazon-guardduty-for-eks\" aria-label=\" enable amazon guardduty for eks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Enable Amazon GuardDuty for EKS</h2>\n<p>Run the following command to enable Amazon GuardDuty and then also enable EKS Protection for both EKS Audit Log Monitoring and EKS Runtime Monitoring.</p>\n<p><strong><em>config.json:</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"Name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"EKS_AUDIT_LOGS\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"Status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ENABLED\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"Name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"EKS_RUNTIME_MONITORING\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"Status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ENABLED\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"AdditionalConfiguration\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"Name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"EKS_ADDON_MANAGEMENT\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"Status\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ENABLED\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Run the below command to enable EKS Protection for Amazon GuardDuty.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws guardduty create-detector <span class=\"token parameter variable\">--enable</span> <span class=\"token parameter variable\">--features</span> file://config.json <span class=\"token operator\">|</span> jq <span class=\"token parameter variable\">-r</span> <span class=\"token string\">'.DetectorId'</span></code></pre></div>\n<p>After EKS Protection in Amazon GuardDuty is enabled, it looks like below in the AWS GuardDuty Console:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 78.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXUlEQVR42m1T22rbQBDV//9GHwqFvrUPTSClKaUhkCaxndixLMfSaiXLK632KlnyXjryJXGhw2ER7J6ZM2dGAWMsiiIppfd+2++SUnJSLT5+f/5wVfwaY7JBKU5xhnC2IUQIwTh/Q9B1HRei7XogW+dU2wkpyWZDNkVJq7KmNWMlpfBdca7bdnuKtm0DuCsI7Yw/hLFWKoVfUTiZLadhOJ4BFk8v0dMMRXFVMihIaa2UNsYEQkgQ4507kp2TUOV2pNO8RVmDcJtmOsFkEuWjuRotbLPdWWsNqHSDbEjT9/2R7J2s6uznDXp4rGdzNg95uKDT+e/P3358+kJuJn5nj3W8D5iURVkKrU6yjdRay0bUwvRmsGGP462xu7MI2PUkubiT108H5dAzGJZiHCdJghCcMUKvqziOk5xUSjeNbvZH04BhJESL0WI9XTlr3gwjpMRZnufrLMthTkOKBOH1pmYcDAbT6pqB4QHkIDUF2e5Q2Rilh4Anw1QZhxr+fzEYBtIPwzuSnZWMk9txPQnFdAmnnscmLvpl1s9Tl9ED72jYQclbPpAOBuL7+1wWVBGqS97SdI0ur64vvl7KUTRwT/4No9L6XRjMWdW8eYz4PLFp5XPmM0DtcOVWhUfkn8rgUN/v3snWQs9d026VbqUCaCG2WrudcW3nd+a87QB2F6UZdP5OFpI8vBT3s3IUAtZ/pnwWe0z9WY0jGXyCbXMnJdZ7Rar14xgaFoJwWUoFq0xanPtK7jWfkWElhFT7c0AtxXqVop93i/HzZhnTBNM4rdKMPS9FnItGD//C6fFfFouGti1X+4IAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"GuardDuty Console\" title=\"\" src=\"/static/aa7246d05f61b1b14b3787897d170213/c5bb3/console.png\" srcset=\"/static/aa7246d05f61b1b14b3787897d170213/04472/console.png 170w,\n/static/aa7246d05f61b1b14b3787897d170213/9f933/console.png 340w,\n/static/aa7246d05f61b1b14b3787897d170213/c5bb3/console.png 680w,\n/static/aa7246d05f61b1b14b3787897d170213/5a190/console.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Go to <strong>Findings</strong>. You should see there are no findings available yet.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVR42jVQ2U7EMAzs/38aDyBA4oVdwWqXbZvEuU/nKG5hR1aUOPaMx5NamGJi27ZaK+ccjNPWW+dzzumBXApF2jM5pqhBXl/f7PPTBKfvJCQ1994BQCk1rzzmUlsfY/tDPdB6pwRiJd4xOrY2EV/cHzsEgDaGcUEXZR1i24ihj+ADIcZYCu51RxIRJ5ICkLsMNXPu1tUzZubFrwyl7Fo3pYuUGaBrU5XOUkYBYVnpnKx1XMiQkcZjyxI5772lEGrBkNAnsorWR0/j1b67IcVSig+Ji8k6x4RQPpEfNs9FKWIZh92TzC/n+8fX9f18+byzC1iZ2/8aWkOtp/rYBk0OnBfGtpRGCN0Hp/1tlrcfLphaF6Aw0tLXiHEYg1z8AqQukHivz0QpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"No Findings\" title=\"\" src=\"/static/1ed09e4201f866ffc7dc85d162b7c120/c5bb3/findings.png\" srcset=\"/static/1ed09e4201f866ffc7dc85d162b7c120/04472/findings.png 170w,\n/static/1ed09e4201f866ffc7dc85d162b7c120/9f933/findings.png 340w,\n/static/1ed09e4201f866ffc7dc85d162b7c120/c5bb3/findings.png 680w,\n/static/1ed09e4201f866ffc7dc85d162b7c120/5a190/findings.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>GuardDuty Findings are automatically sent to EventBridge. You can also export findings to an S3 bucket. New findings are exported within 5 minutes. You can modify the frequency for updated findings below. Update to EventBridge and S3 occurs every 6 hours by default. Let us change it to 15 mins.</p>\n<p>Go to the <strong><em>Settings --> Findings export options</em></strong> and click on <strong>Edit</strong>.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVR42nVRy07DMBDM/38ViBOIHjggToCUtk6aOImfa8ePhHFSqkqIkRN7Vzvj3XElhOy6fl3XnJK1tm1bPoxziAhjjOEO84b7sNIA+XUDEY3jhIWcEML7a94Yw1jDhwFy6y9yziCbWxHIIUaIO+/JuXIPylPSxlx6jiTOJbMBZRVUpVTLsoBsiTgfcIObQ87p1mFRuJvBb3DOVZOQGHInI+45v3QdMpMQaB7S+CmlJAXpotQI9V6cUqrkZhikdzKo7Zmd6mPLGu+LQ35fIZa1ndE87Cxt+xiMo5xymVmb4+Pr18NL/XRon9/LhVpLbEpLWfbyISMV3ghdVdPbN52HYteykKXp2Iw1sxc+c5GEDuR2e8rk4WbWZhieyk86WLe77ZTuDh+iboj1lnX685TZVXf9g/JUCpZYWwpAtmTqdu6nNKo0ytRPi6b1H+ScfwBYd0B2naGyJAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Edit Settings\" title=\"\" src=\"/static/b37952cd8653cdd4cca7fecd38118f84/c5bb3/settings.png\" srcset=\"/static/b37952cd8653cdd4cca7fecd38118f84/04472/settings.png 170w,\n/static/b37952cd8653cdd4cca7fecd38118f84/9f933/settings.png 340w,\n/static/b37952cd8653cdd4cca7fecd38118f84/c5bb3/settings.png 680w,\n/static/b37952cd8653cdd4cca7fecd38118f84/5a190/settings.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Select <strong><em>15 minutes</em></strong> and click on <strong><em>Save Changes</em></strong>.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 23.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVR42k2OS07DMBCGfU4WnIENC07AkgNAkZCQ2JYz9AIskCDEsl1C3BQ5zqNJbI/HBtMA7adfo39emiF5nnMuio+Cc04pFUIwxl6zrCylOyagC96hh4Dw47EfBqJrndS2rVK12lPvaZrG/2OdYxsntkmWFoa+mzcx8ZKkYbmpSimttTFGB2Cs1boZx9F7hJQj+m6gq4y9FOyZKeX77qvTcco+CQDMf3k8kIrpXvgjpp7Uw7oyT7m/v+xvL/rrc3y8I2nNztsAs+yR/62kGFCZcbeW08NZtTitbk7c8uobickVSt0WSwYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Save Changes\" title=\"\" src=\"/static/8e8a56db564de89dd98a7b14183f3d26/c5bb3/saved.png\" srcset=\"/static/8e8a56db564de89dd98a7b14183f3d26/04472/saved.png 170w,\n/static/8e8a56db564de89dd98a7b14183f3d26/9f933/saved.png 340w,\n/static/8e8a56db564de89dd98a7b14183f3d26/c5bb3/saved.png 680w,\n/static/8e8a56db564de89dd98a7b14183f3d26/5a190/saved.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>With Amazon GuardDuty already turned on with protection for your EKS clusters, you are now ready to see it in action. GuardDuty for EKS does not require you to turn on or store EKS Control Plane logs. GuardDuty can look at the EKS cluster audit logs through direct integration.</p>\n<p>It will look at the audit log activity and report on the new GuardDuty finding types that are specific to your Kubernetes resources.</p>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèÅ Conclusion</h2>\n<p>In summary, Amazon GuardDuty delivers advanced security for Amazon EKS. With features like EKS Audit Log Monitoring and EKS Runtime Monitoring, it offers top-notch protection against potential threats.</p>\n<p>By integrating GuardDuty, you ensure continuous monitoring and quick mitigation of security risks, maintaining a secure environment for your container workloads.</p>\n<p><strong>References:</strong></p>\n<ul>\n<li><a href=\"https://aws.amazon.com/blogs/aws/amazon-guardduty-now-supports-amazon-eks-runtime-monitoring/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws.amazon.com/blogs/aws/amazon-guardduty-now-supports-amazon-eks-runtime-monitoring/</a></li>\n<li><a href=\"https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/</a></li>\n<li><a href=\"https://catalog.workshops.aws/eks-security-immersionday/en-US/5-detective-controls/1-guardduty-protection-for-eks\" target=\"_blank\" rel=\"noopener noreferrer\">https://catalog.workshops.aws/eks-security-immersionday/en-US/5-detective-controls/1-guardduty-protection-for-eks</a></li>\n</ul>\n<br> \n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":3,"rawMarkdownBody":"\n> **Top-Notch Protection for EKS with Amazon GuardDuty**\n\n## üìö Introduction\n\n[Amazon GuardDuty](https://aws.amazon.com/guardduty/) offers extended coverage, allowing for ongoing monitoring and profiling of Amazon EKS cluster activities.\n\nThis involves identifying any potentially harmful or suspicious behavior that could pose threats to container workloads. The EKS Protection feature within Amazon GuardDuty delivers threat detection capabilities specifically designed to safeguard Amazon EKS clusters within your AWS setup.\n\n> This protection encompasses two key components: [EKS Audit Log Monitoring](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/) and [EKS Runtime Monitoring](https://aws.amazon.com/blogs/aws/amazon-guardduty-now-supports-amazon-eks-runtime-monitoring/).\n\nIn this blog post, we'll explore how Amazon GuardDuty can help you enhance the security of your EKS clusters, providing you with the tools and insights needed to keep your Kubernetes infrastructure safe and secure.\n\n## üõ°Ô∏è Amazon GuardDuty\n\n[Amazon GuardDuty](https://aws.amazon.com/guardduty/) is a managed threat detection service that uses a combination of machine learning, anomaly detection, and integrated threat intelligence to identify, flag, and prioritize potential threats.\n\nIn [January 2022](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/), its capabilities were expanded to include Amazon EKS. Key features include:\n\n- **No additional software required:** Runs without the need for extra software.\n- **Continuous 24/7 monitoring:** Monitors your AWS implementation without added cost or complexity.\n- **Global coverage:** Provides worldwide protection.\n- **Comprehensive monitoring:** Monitors everything in your account and infrastructure, alerting you of any anomalous behavior.\n- **Intuitive threat severity levels:** Helps cybersecurity specialists prioritize potential threats.\n\nEKS Protection includes **EKS Audit Log Monitoring** and **EKS Runtime Monitoring**.\n\n### üîç EKS Audit Log Monitoring\n\nEKS Audit Log Monitoring helps you detect potentially suspicious activities in EKS clusters within Amazon Elastic Kubernetes Service (Amazon EKS). It uses Kubernetes audit logs to capture chronological activities from users, applications using the Kubernetes API, and the control plane. For more information, see [Kubernetes audit logs](https://docs.aws.amazon.com/guardduty/latest/ug/features-kubernetes-protection.html#guardduty_k8s-audit-logs).\n\n### üõ†Ô∏è EKS Runtime Monitoring\n\nEKS Runtime Monitoring uses operating system-level events to help you detect potential threats in Amazon EKS nodes and containers within your Amazon EKS clusters. For more information, see [Runtime Monitoring](https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring.html).\n\n![GuardDuty EKS](./runtime-sec.jpg)\n\n## üöÄ Enable Amazon GuardDuty for EKS\n\nRun the following command to enable Amazon GuardDuty and then also enable EKS Protection for both EKS Audit Log Monitoring and EKS Runtime Monitoring.\n\n**_config.json:_**\n\n```json\n[\n    {\n        \"Name\": \"EKS_AUDIT_LOGS\",\n        \"Status\": \"ENABLED\",\n        \"Name\": \"EKS_RUNTIME_MONITORING\",\n        \"Status\": \"ENABLED\",\n        \"AdditionalConfiguration\": [\n            {\n                \"Name\": \"EKS_ADDON_MANAGEMENT\",\n                \"Status\": \"ENABLED\"\n            }\n        ]\n    }\n]\n```\n\nRun the below command to enable EKS Protection for Amazon GuardDuty.\n\n```bash\naws guardduty create-detector --enable --features file://config.json | jq -r '.DetectorId'\n```\n\nAfter EKS Protection in Amazon GuardDuty is enabled, it looks like below in the AWS GuardDuty Console:\n\n![GuardDuty Console](./console.png)\n\nGo to **Findings**. You should see there are no findings available yet.\n\n![No Findings](./findings.png)\n\nGuardDuty Findings are automatically sent to EventBridge. You can also export findings to an S3 bucket. New findings are exported within 5 minutes. You can modify the frequency for updated findings below. Update to EventBridge and S3 occurs every 6 hours by default. Let us change it to 15 mins.\n\nGo to the **_Settings --> Findings export options_** and click on **Edit**.\n\n![Edit Settings](./settings.png)\n\nSelect **_15 minutes_** and click on **_Save Changes_**.\n\n![Save Changes](./saved.png)\n\nWith Amazon GuardDuty already turned on with protection for your EKS clusters, you are now ready to see it in action. GuardDuty for EKS does not require you to turn on or store EKS Control Plane logs. GuardDuty can look at the EKS cluster audit logs through direct integration.\n\nIt will look at the audit log activity and report on the new GuardDuty finding types that are specific to your Kubernetes resources.\n\n## üèÅ Conclusion\n\nIn summary, Amazon GuardDuty delivers advanced security for Amazon EKS. With features like EKS Audit Log Monitoring and EKS Runtime Monitoring, it offers top-notch protection against potential threats.\n\nBy integrating GuardDuty, you ensure continuous monitoring and quick mitigation of security risks, maintaining a secure environment for your container workloads.\n\n**References:**\n\n- https://aws.amazon.com/blogs/aws/amazon-guardduty-now-supports-amazon-eks-runtime-monitoring/\n- https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-guardduty-elastic-kubernetes-service-clusters/\n- https://catalog.workshops.aws/eks-security-immersionday/en-US/5-detective-controls/1-guardduty-protection-for-eks\n  \n<br> \n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  _**Until next time üéâ**_\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":664},"frontmatter":{"id":"ddbb7cf862ab3bfab714f92e","path":"/blog/eks-guardduty-security-protection/","humanDate":"Oct 20, 2024","fullDate":"2024-10-20","title":"How Amazon GuardDuty can help keep Amazon EKS secure","keywords":["Amazon EKS","GuardDuty","Kubernetes security","threat detection"],"excerpt":"Discover how Amazon GuardDuty enhances the security of your Amazon EKS environment. Learn about its features, benefits, and best practices for maintaining a secure Kubernetes cluster.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5UlEQVR42h2SWU9TURSF771tnICiIA8gL06oIYCROCDSCsggCEhLHIjGCNIWW0ChjDJUCpYKglqDmqAxCrTIKFhmwSH6tz53edi55+6TfGutfbaS0DrPkc4l4lvmSWhZ4Hj7AomuWQ41zZIolSB1suPbzn9C4wyn5JzcuUiinOMbptn/MCgV4IBzGsO9tyipT5e57v9J8cgWRu8qpa+2KHu9heXNT8z+bc72hiiR3vXX2+QNbXDn/R+ujfzghtznD24QYZskxvkVg3UCnekRSoQjyAlRNQ2skda9xMX+VYy+NdJ7l8mS74W+FdKfhkRsjeyBdS54ljE9WyXDs0Jc3VeiHWHYJLrCHjSTCyVamilyWeT/xeneFS4938Ay+psMAV9+vk6uVEb/CucElONbJ0eEC4c2MYnAATFjqPmMrsKPmutCy7KhRApwd+McerGtr58hrm0Ri8QqGN7ciZsjwPOe0E68YzJnXdUX9jyYYK81QJTE1ZmHUEueoRX1oOZ3iMOwinMKg2OKCIHHCzDNHSJF4id3hzgr7s+4JbZ7mSPN80TXBogV8egw7MYoaqnAiiVuXgtafjtKjIDCr3W0eY7DrjkOCnSfLUCkfZLEmvcU3G8ltWYQg+0zEfagvKYIy51meYF6zY2urBOtwiMOWyR2A0qUPcCJtgUefPzH1eEfxNjHibJPkGQdJdPqo8T+BJPTy7n6F8Q5J4m0BdHdHhOYOBOgdtOLrnYCvWsJtaxXXlmsp3YtUTX2l3L/b2IrfRjKu0iqHuFS7SBmZxvGBi/GJgFaP6EWSLxir5QHNace7ZYP/ZMt9I4AWnmfzFAWMxy79NU2KV3fiaz5QpR1nKSH78h29mOs81LR2k2Zw4liakbLtKFdkXkVScwrj1GltMqXaOZ+mecASnjTw9CkpiDxdQEMtVOyDlM7vcOOMTIbh0mu9rDrtBk11SKrIa4y7qPmdaBlN6AVdqFedcsI+th19wP/AQHW3Vg8sYMyAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/7875ec594ced517a82e12351b7034376/c8069/guardduty-eks-cover.png","srcSet":"/static/7875ec594ced517a82e12351b7034376/24579/guardduty-eks-cover.png 750w,\n/static/7875ec594ced517a82e12351b7034376/c8069/guardduty-eks-cover.png 800w","sizes":"100vw"},"sources":[{"srcSet":"/static/7875ec594ced517a82e12351b7034376/ee3fa/guardduty-eks-cover.webp 750w,\n/static/7875ec594ced517a82e12351b7034376/8e613/guardduty-eks-cover.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5525}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/python-diagrams-as-code-architecture/","title":"Simplify Software architecture with Diagrams as Code DaC üìà","date":"2024-10-20 21:06:00"},"excerpt":"Using diagrams tool to visualize your architectureüî• üìä Introduction In the software development ecosystem, clear and effective‚Ä¶"},"nextThought":{"frontmatter":{"path":"/blog/semantic-release-version-management/","title":"Automated Version management and Release Strategies with Semantic Release SemVer ‚òÅÔ∏è","date":"2024-10-20 18:06:00"},"excerpt":"Consistency through Semantic Versioning üß© üí¨ Introduction Stay nimble and consistent by automating change communication with Semantic‚Ä¶"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}