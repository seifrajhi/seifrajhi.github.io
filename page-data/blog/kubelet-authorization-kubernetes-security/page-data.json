{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/kubelet-authorization-kubernetes-security/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Kubelet Authorization: A Must-Know for Kubernetes Admins üîê</strong></p>\n</blockquote>\n<h2 id=\"Ô∏è-introduction\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-introduction\" aria-label=\"Ô∏è introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚≠êÔ∏è Introduction</h2>\n<p>Kubernetes, the cornerstone of modern container orchestration, relies on various components to ensure the efficient management of container workloads. Among these components, the Kubelet plays a vital role in overseeing worker nodes within the Kubernetes cluster. It manages container runtimes and communicates with the Kubernetes API server, ensuring that containers are correctly created and managed on individual nodes.</p>\n<p>If an attacker breaks out from a container to the host node, they often gain access to a set of kubelet credentials. These credentials could then potentially be exploited to elevate their privileges within the cluster. Consequently, the Kubernetes project has implemented measures to limit the actions that the Kubelet can perform to reduce the risk of privilege escalation.</p>\n<h2 id=\"-objectives-of-the-blog\" style=\"position:relative;\"><a href=\"#-objectives-of-the-blog\" aria-label=\" objectives of the blog permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>ü•Ö Objectives of the Blog</h2>\n<p>In this blog post, we'll explore a critical aspect of Kubernetes security: <strong>Kubelet Authorization</strong>. For Kubernetes administrators, understanding the importance of Kubelet credentials from a security perspective is essential. Our goal here is to highlight the significance of these credentials, their security implications, and the measures put in place by the Kubernetes project to minimize potential risks.</p>\n<h2 id=\"-exploring-kubernetes-authorization-modes\" style=\"position:relative;\"><a href=\"#-exploring-kubernetes-authorization-modes\" aria-label=\" exploring kubernetes authorization modes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üí± Exploring Kubernetes Authorization Modes</h2>\n<p>Before discussing the specifics of Kubelet authorization, it's crucial to understand how Kubernetes handles authorization on a broader scale. Kubernetes provides multiple authorization modes, allowing cluster administrators to tailor access control to their specific needs.</p>\n<p>The most commonly used authorization mode is <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\" target=\"_blank\" rel=\"noopener noreferrer\">Role-Based Access Control (RBAC)</a>, which allows administrators to define fine-grained permissions for users and service accounts. However, Kubernetes also supports other authorization modes, such as <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/node/\" target=\"_blank\" rel=\"noopener noreferrer\">Node Authorizer</a>, <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/webhook/\" target=\"_blank\" rel=\"noopener noreferrer\">Webhook</a>, and <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/abac/\" target=\"_blank\" rel=\"noopener noreferrer\">Attribute-Based Access Control (ABAC)</a>, each serving distinct use cases.</p>\n<p>It's essential to recognize that in Kubernetes, rights provided by each authorization mode are cumulative. This means that a user's permissions result from the combined effects of all active authorization modes. Therefore, careful consideration is necessary to avoid inadvertently granting excessive privileges to users.</p>\n<p>Kubernetes provides a built-in tool for enumerating a user's permissions using the <code class=\"language-text\">kubectl auth can-i --list</code> command. However, it's important to note that this tool is optimized for RBAC. Permissions granted through other authorization modes, such as Node Authorizer or Webhook, will not be included in the analysis. To assess individual permissions granted via any authorization mode, you can use the <code class=\"language-text\">kubectl auth can-i</code> command.</p>\n<p>This nuanced approach ensures a comprehensive evaluation of user rights, regardless of the chosen authorization mode within your Kubernetes cluster. Understanding and effectively managing these authorization modes is fundamental to maintaining a secure and well-controlled Kubernetes environment.</p>\n<h2 id=\"-understanding-kubelet-authorization\" style=\"position:relative;\"><a href=\"#-understanding-kubelet-authorization\" aria-label=\" understanding kubelet authorization permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üó∫ Understanding Kubelet Authorization</h2>\n<p>Now that we have covered the essential concepts, let's delve into the mechanics of Kubelet authorization. We will initiate our exploration with a Kubernetes in Docker (<a href=\"https://kind.sigs.k8s.io/\" target=\"_blank\" rel=\"noopener noreferrer\">KinD</a>) cluster, examining the observable aspects within this context.</p>\n<p>To facilitate this exploration, we will set up a cluster comprising two worker nodes. We'll configure this cluster using a straightforward KinD configuration, as demonstrated below:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># Configuration for a three-node (two workers) cluster</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Cluster\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> kind.x<span class=\"token punctuation\">-</span>k8s.io/v1alpha4\n<span class=\"token key atrule\">nodes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> control<span class=\"token punctuation\">-</span>plane\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> worker\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> worker</code></pre></div>\n<p>This KinD cluster configuration serves as our starting point for understanding how Kubelet authorization functions within the Kubernetes ecosystem.</p>\n<p>After configuring the KinD cluster as outlined above, we can proceed to start it up using the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kind create cluster <span class=\"token parameter variable\">--config</span> kind-config.yaml <span class=\"token parameter variable\">--name</span> kubeletauthz</code></pre></div>\n<p>Once the cluster is successfully launched and operational, we can access one of the worker nodes to examine the Kubelet credentials. To determine the Kubeconfig file used by the Kubelet, inspect the command line parameters. In many cases, including Kubeadm setups, the default path for the Kubeconfig file is specified as <code class=\"language-text\">--kubeconfig=/etc/kubernetes/kubelet.conf</code>.</p>\n<p>Armed with this information, you can utilize <code class=\"language-text\">kubectl</code> to access cluster resources. For example, you can retrieve a list of pods within the cluster by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl <span class=\"token parameter variable\">--kubeconfig</span><span class=\"token operator\">=</span>/etc/kubernetes/kubelet.conf get pods <span class=\"token parameter variable\">-n</span> <span class=\"token operator\">&lt;</span>namespace<span class=\"token operator\">></span></code></pre></div>\n<p>This process allows us to gain insights into the Kubelet's configuration and its interaction with the Kubernetes cluster.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">root@kubeletauthz-worker:/<span class=\"token comment\"># kubectl --kubeconfig=/etc/kubernetes/kubelet.conf get po -A</span>\nNAMESPACE            NAME                                                 READY   STATUS    RESTARTS   AGE\nkube-system          coredns-5d78c9869d-hqnmt                             <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          coredns-5d78c9869d-mcvv7                             <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          etcd-kubeletauthz-control-plane                      <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          kindnet-ccht8                                        <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          22m\nkube-system          kindnet-hj2dh                                        <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          kindnet-ttdr7                                        <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          22m\nkube-system          kube-apiserver-kubeletauthz-control-plane            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          kube-controller-manager-kubeletauthz-control-plane   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          kube-proxy-2gn7z                                     <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          22m\nkube-system          kube-proxy-bspz6                                     <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nkube-system          kube-proxy-trgxh                                     <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          22m\nkube-system          kube-scheduler-kubeletauthz-control-plane            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m\nlocal-path-storage   local-path-provisioner-6bc4bddd6b-jrxmn              <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          23m</code></pre></div>\n<p>Usually, to check the rights of a principal in Kubernetes we'd use the command <code class=\"language-text\">kubectl auth can-i --list</code> and if we try that with the Kubelet credentials we get back something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl <span class=\"token parameter variable\">--kubeconfig</span><span class=\"token operator\">=</span>/etc/kubernetes/kubelet.conf auth can-i <span class=\"token parameter variable\">--list</span>\n\nWarning: the list may be incomplete: <span class=\"token function\">node</span> authorizer does not support user rule resolution\nResources                                                       Non-Resource URLs   Resource Names   Verbs\nselfsubjectaccessreviews.authorization.k8s.io                   <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>                  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>create<span class=\"token punctuation\">]</span>\nselfsubjectrulesreviews.authorization.k8s.io                    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>                  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>create<span class=\"token punctuation\">]</span>\ncertificatesigningrequests.certificates.k8s.io/selfnodeclient   <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>                  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>create<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/api/*<span class=\"token punctuation\">]</span>            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/api<span class=\"token punctuation\">]</span>              <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/apis/*<span class=\"token punctuation\">]</span>           <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/apis<span class=\"token punctuation\">]</span>             <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/healthz<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/healthz<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/livez<span class=\"token punctuation\">]</span>            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/livez<span class=\"token punctuation\">]</span>            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/openapi/*<span class=\"token punctuation\">]</span>        <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/openapi<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/readyz<span class=\"token punctuation\">]</span>           <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/readyz<span class=\"token punctuation\">]</span>           <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/version/<span class=\"token punctuation\">]</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/version/<span class=\"token punctuation\">]</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/version<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span>\n                                                                                                                                <span class=\"token punctuation\">[</span>/version<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>               <span class=\"token punctuation\">[</span>get<span class=\"token punctuation\">]</span></code></pre></div>\n<p>A noteworthy observation is the absence of permissions associated with the pod objects we've examined. The key to understanding this situation lies in the warning message at the top, which explicitly mentions that the node authorizer lacks support for user rule resolution.</p>\n<p>As a quick aside, it might be perplexing that the Kubelet doesn't utilize Role-Based Access Control (RBAC), especially considering the presence of the clusterrole named <code class=\"language-text\">system:node</code> that seemingly grants rights to nodes. However, it's important to note that the corresponding clusterrolebinding associated with <code class=\"language-text\">system:node</code> lacks any subjects, rendering it ineffectual. This peculiarity adds an intriguing layer to the authorization mechanisms within the cluster.</p>\n<h2 id=\"Ô∏è-understanding-the-node-authorizer\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-understanding-the-node-authorizer\" aria-label=\"Ô∏è understanding the node authorizer permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üëÆ‚Äç‚ôÄÔ∏è Understanding the Node Authorizer</h2>\n<p>To shed light on this scenario, let's take a closer look at how the Kubernetes API server is configured. If you examine the parameters provided to the kube-apiserver component, you'll notice the line <code class=\"language-text\">--authorization-mode=Node,RBAC</code>. This configuration tells us that two authorization modes are in play, and, as mentioned earlier, their permissions stack up.</p>\n<p>The Node authorization mode has a singular purpose: to grant permissions to Kubelets. According to the documentation, this mode specifically allows access to resources that Kubelets require, such as pods, nodes, configmaps, and secrets. However, it's important to note that it also enforces restrictions to ensure that a Kubelet on one node can't access secrets meant for pods running on a different node.</p>\n<p>For the nitty-gritty details of what's allowed and what's restricted, you'd need to dive into the codebase, where the rules governing Kubelet access within the cluster are defined. Understanding these rules is essential for maintaining security and proper access control in your Kubernetes environment.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token comment\">// NodeAuthorizer authorizes requests from kubelets, with the following logic:</span>\n<span class=\"token comment\">//  1. If a request is not from a node (NodeIdentity() returns isNode=false), reject</span>\n<span class=\"token comment\">//  2. If a specific node cannot be identified (NodeIdentity() returns nodeName=\"\"), reject</span>\n<span class=\"token comment\">//  3. If a request is for a secret, configmap, persistent volume, resource claim, or persistent volume claim, reject unless the verb is get, and the requested object is related to the requesting node:</span>\n<span class=\"token comment\">//     node &lt;- configmap</span>\n<span class=\"token comment\">//     node &lt;- pod</span>\n<span class=\"token comment\">//     node &lt;- pod &lt;- secret</span>\n<span class=\"token comment\">//     node &lt;- pod &lt;- configmap</span>\n<span class=\"token comment\">//     node &lt;- pod &lt;- pvc</span>\n<span class=\"token comment\">//     node &lt;- pod &lt;- pvc &lt;- pv</span>\n<span class=\"token comment\">//     node &lt;- pod &lt;- pvc &lt;- pv &lt;- secret</span>\n<span class=\"token comment\">//     node &lt;- pod &lt;- ResourceClaim</span>\n<span class=\"token comment\">//  4. For other resources, authorize all nodes uniformly using statically defined rules</span></code></pre></div>\n<p>You can see this in effect if you try to get secrets from a cluster with Kubelet credentials:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl <span class=\"token parameter variable\">--kubeconfig</span><span class=\"token operator\">=</span>/etc/kubernetes/kubelet.conf get secrets <span class=\"token parameter variable\">-A</span>\nError from server <span class=\"token punctuation\">(</span>Forbidden<span class=\"token punctuation\">)</span>: secrets is forbidden: User <span class=\"token string\">\"system:node:kubeletauthz-worker\"</span> cannot list resource <span class=\"token string\">\"secrets\"</span> <span class=\"token keyword\">in</span> API group <span class=\"token string\">\"\"</span> at the cluster scope: can only <span class=\"token builtin class-name\">read</span> namespaced object of this <span class=\"token builtin class-name\">type</span></code></pre></div>\n<p>One important point to note on this is where the logic is \"reject\", this just passes the request to other configured authorization modes, so if cluster RBAC has been modified to allow the <code class=\"language-text\">system:nodes</code> group to do something in excess of what the Node authorization mode allows then that will still be allowed.</p>\n<p>You can see this by, for example, editing the <code class=\"language-text\">system:node</code> clusterrolebinding to add the <code class=\"language-text\">system:nodes</code> group as a subject, by adding these lines to it:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">subjects</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroup</span><span class=\"token punctuation\">:</span> rbac.authorization.k8s.io\n    <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Group\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> system<span class=\"token punctuation\">:</span>nodes</code></pre></div>\n<p>After completing the setup and configuration, when you use Kubelet credentials to attempt to access secrets at the cluster level, it should indeed work without issues:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl <span class=\"token parameter variable\">--kubeconfig</span><span class=\"token operator\">=</span>/etc/kubernetes/kubelet.conf get secrets <span class=\"token parameter variable\">-A</span>\nNAMESPACE     NAME                     TYPE                            DATA   AGE\nkube-system   bootstrap-token-abcdef   bootstrap.kubernetes.io/token   <span class=\"token number\">6</span>      34m</code></pre></div>\n<p>There are a couple of places where this mode can't effectively restrict permissions, which are in node and pod properties, for that we need another component.</p>\n<h2 id=\"-noderestriction-admission-controller\" style=\"position:relative;\"><a href=\"#-noderestriction-admission-controller\" aria-label=\" noderestriction admission controller permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõÇ NodeRestriction Admission Controller</h2>\n<p>In addressing the NodeRestriction Admission Controller, we encounter a specialized admission controller designed to enhance security within Kubernetes. Its primary role is to carefully scrutinize requests originating from Kubelets. Specifically, it focuses on requests related to pods and nodes, aiming to restrict access rights to only those that are pertinent to the functioning of the Kubelet. As an illustrative example, this controller limits the ability to modify certain properties of node objects. This restriction serves a crucial purpose by preventing unauthorized changes, such as altering a node's security classification.</p>\n<h2 id=\"Ô∏è-variations-in-kubernetes-distributions\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-variations-in-kubernetes-distributions\" aria-label=\"Ô∏è variations in kubernetes distributions permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ò∏Ô∏è Variations in Kubernetes Distributions</h2>\n<p>A noteworthy aspect of working with Kubernetes is the considerable variability among different distributions. It is essential to bear in mind that the discussion presented thus far pertains primarily to the standard Kubernetes setup, often referred to as \"vanilla Kubernetes,\" particularly when configured using Kubeadm. However, it's important to recognize that Kubernetes distribution providers have the flexibility to customize this configuration. Indeed, many providers exercise this freedom to adapt Kubernetes to their specific requirements. As an example, <a href=\"https://azure.microsoft.com/en-us/services/kubernetes-service/\" target=\"_blank\" rel=\"noopener noreferrer\">Azure AKS</a>, Microsoft's Kubernetes service, may deviate from the default configuration by allowing Kubelets to access secrets at the cluster level. These variations underscore the need for flexibility and adaptability in managing Kubernetes across diverse environments.</p>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ú® Conclusion</h2>\n<p>Concluding our exploration of Kubernetes authorization, it is evident that while Role-Based Access Control (RBAC) remains the prevalent choice in most Kubernetes clusters, it may not always suffice to ensure a comprehensive level of security. There are instances where additional layers of security measures become essential. This is where supplemental authorization modes and admission controllers come into play. In this discussion, we've specifically examined the Node authorization mode and the NodeRestriction admission controller. These components play a crucial role in granting Kubelets the necessary rights and privileges to access the essential resources required for their smooth operation. Thus, Kubernetes administrators should consider these supplemental measures alongside RBAC to fortify their cluster's security posture and ensure it meets the specific demands of their use cases.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":8,"rawMarkdownBody":"\n> **Kubelet Authorization: A Must-Know for Kubernetes Admins üîê**\n\n## ‚≠êÔ∏è Introduction\n\nKubernetes, the cornerstone of modern container orchestration, relies on various components to ensure the efficient management of container workloads. Among these components, the Kubelet plays a vital role in overseeing worker nodes within the Kubernetes cluster. It manages container runtimes and communicates with the Kubernetes API server, ensuring that containers are correctly created and managed on individual nodes.\n\nIf an attacker breaks out from a container to the host node, they often gain access to a set of kubelet credentials. These credentials could then potentially be exploited to elevate their privileges within the cluster. Consequently, the Kubernetes project has implemented measures to limit the actions that the Kubelet can perform to reduce the risk of privilege escalation.\n\n## ü•Ö Objectives of the Blog\n\nIn this blog post, we'll explore a critical aspect of Kubernetes security: **Kubelet Authorization**. For Kubernetes administrators, understanding the importance of Kubelet credentials from a security perspective is essential. Our goal here is to highlight the significance of these credentials, their security implications, and the measures put in place by the Kubernetes project to minimize potential risks.\n\n## üí± Exploring Kubernetes Authorization Modes\n\nBefore discussing the specifics of Kubelet authorization, it's crucial to understand how Kubernetes handles authorization on a broader scale. Kubernetes provides multiple authorization modes, allowing cluster administrators to tailor access control to their specific needs.\n\nThe most commonly used authorization mode is [Role-Based Access Control (RBAC)](https://kubernetes.io/docs/reference/access-authn-authz/rbac/), which allows administrators to define fine-grained permissions for users and service accounts. However, Kubernetes also supports other authorization modes, such as [Node Authorizer](https://kubernetes.io/docs/reference/access-authn-authz/node/), [Webhook](https://kubernetes.io/docs/reference/access-authn-authz/webhook/), and [Attribute-Based Access Control (ABAC)](https://kubernetes.io/docs/reference/access-authn-authz/abac/), each serving distinct use cases.\n\nIt's essential to recognize that in Kubernetes, rights provided by each authorization mode are cumulative. This means that a user's permissions result from the combined effects of all active authorization modes. Therefore, careful consideration is necessary to avoid inadvertently granting excessive privileges to users.\n\nKubernetes provides a built-in tool for enumerating a user's permissions using the `kubectl auth can-i --list` command. However, it's important to note that this tool is optimized for RBAC. Permissions granted through other authorization modes, such as Node Authorizer or Webhook, will not be included in the analysis. To assess individual permissions granted via any authorization mode, you can use the `kubectl auth can-i` command.\n\nThis nuanced approach ensures a comprehensive evaluation of user rights, regardless of the chosen authorization mode within your Kubernetes cluster. Understanding and effectively managing these authorization modes is fundamental to maintaining a secure and well-controlled Kubernetes environment.\n\n## üó∫ Understanding Kubelet Authorization\n\nNow that we have covered the essential concepts, let's delve into the mechanics of Kubelet authorization. We will initiate our exploration with a Kubernetes in Docker ([KinD](https://kind.sigs.k8s.io/)) cluster, examining the observable aspects within this context.\n\nTo facilitate this exploration, we will set up a cluster comprising two worker nodes. We'll configure this cluster using a straightforward KinD configuration, as demonstrated below:\n\n```yaml\n# Configuration for a three-node (two workers) cluster\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n    - role: control-plane\n    - role: worker\n    - role: worker\n```\n\nThis KinD cluster configuration serves as our starting point for understanding how Kubelet authorization functions within the Kubernetes ecosystem.\n\nAfter configuring the KinD cluster as outlined above, we can proceed to start it up using the following command:\n\n```sh\nkind create cluster --config kind-config.yaml --name kubeletauthz\n```\n\nOnce the cluster is successfully launched and operational, we can access one of the worker nodes to examine the Kubelet credentials. To determine the Kubeconfig file used by the Kubelet, inspect the command line parameters. In many cases, including Kubeadm setups, the default path for the Kubeconfig file is specified as `--kubeconfig=/etc/kubernetes/kubelet.conf`.\n\nArmed with this information, you can utilize `kubectl` to access cluster resources. For example, you can retrieve a list of pods within the cluster by running:\n\n```sh\nkubectl --kubeconfig=/etc/kubernetes/kubelet.conf get pods -n <namespace>\n```\n\nThis process allows us to gain insights into the Kubelet's configuration and its interaction with the Kubernetes cluster.\n\n```sh\nroot@kubeletauthz-worker:/# kubectl --kubeconfig=/etc/kubernetes/kubelet.conf get po -A\nNAMESPACE            NAME                                                 READY   STATUS    RESTARTS   AGE\nkube-system          coredns-5d78c9869d-hqnmt                             1/1     Running   0          23m\nkube-system          coredns-5d78c9869d-mcvv7                             1/1     Running   0          23m\nkube-system          etcd-kubeletauthz-control-plane                      1/1     Running   0          23m\nkube-system          kindnet-ccht8                                        1/1     Running   0          22m\nkube-system          kindnet-hj2dh                                        1/1     Running   0          23m\nkube-system          kindnet-ttdr7                                        1/1     Running   0          22m\nkube-system          kube-apiserver-kubeletauthz-control-plane            1/1     Running   0          23m\nkube-system          kube-controller-manager-kubeletauthz-control-plane   1/1     Running   0          23m\nkube-system          kube-proxy-2gn7z                                     1/1     Running   0          22m\nkube-system          kube-proxy-bspz6                                     1/1     Running   0          23m\nkube-system          kube-proxy-trgxh                                     1/1     Running   0          22m\nkube-system          kube-scheduler-kubeletauthz-control-plane            1/1     Running   0          23m\nlocal-path-storage   local-path-provisioner-6bc4bddd6b-jrxmn              1/1     Running   0          23m\n```\n\nUsually, to check the rights of a principal in Kubernetes we'd use the command `kubectl auth can-i --list` and if we try that with the Kubelet credentials we get back something like this:\n\n```sh\nkubectl --kubeconfig=/etc/kubernetes/kubelet.conf auth can-i --list\n\nWarning: the list may be incomplete: node authorizer does not support user rule resolution\nResources                                                       Non-Resource URLs   Resource Names   Verbs\nselfsubjectaccessreviews.authorization.k8s.io                   []                  []               [create]\nselfsubjectrulesreviews.authorization.k8s.io                    []                  []               [create]\ncertificatesigningrequests.certificates.k8s.io/selfnodeclient   []                  []               [create]\n                                                                                                                                [/api/*]            []               [get]\n                                                                                                                                [/api]              []               [get]\n                                                                                                                                [/apis/*]           []               [get]\n                                                                                                                                [/apis]             []               [get]\n                                                                                                                                [/healthz]          []               [get]\n                                                                                                                                [/healthz]          []               [get]\n                                                                                                                                [/livez]            []               [get]\n                                                                                                                                [/livez]            []               [get]\n                                                                                                                                [/openapi/*]        []               [get]\n                                                                                                                                [/openapi]          []               [get]\n                                                                                                                                [/readyz]           []               [get]\n                                                                                                                                [/readyz]           []               [get]\n                                                                                                                                [/version/]         []               [get]\n                                                                                                                                [/version/]         []               [get]\n                                                                                                                                [/version]          []               [get]\n                                                                                                                                [/version]          []               [get]\n```\n\nA noteworthy observation is the absence of permissions associated with the pod objects we've examined. The key to understanding this situation lies in the warning message at the top, which explicitly mentions that the node authorizer lacks support for user rule resolution.\n\nAs a quick aside, it might be perplexing that the Kubelet doesn't utilize Role-Based Access Control (RBAC), especially considering the presence of the clusterrole named `system:node` that seemingly grants rights to nodes. However, it's important to note that the corresponding clusterrolebinding associated with `system:node` lacks any subjects, rendering it ineffectual. This peculiarity adds an intriguing layer to the authorization mechanisms within the cluster.\n\n## üëÆ‚Äç‚ôÄÔ∏è Understanding the Node Authorizer\n\nTo shed light on this scenario, let's take a closer look at how the Kubernetes API server is configured. If you examine the parameters provided to the kube-apiserver component, you'll notice the line `--authorization-mode=Node,RBAC`. This configuration tells us that two authorization modes are in play, and, as mentioned earlier, their permissions stack up.\n\nThe Node authorization mode has a singular purpose: to grant permissions to Kubelets. According to the documentation, this mode specifically allows access to resources that Kubelets require, such as pods, nodes, configmaps, and secrets. However, it's important to note that it also enforces restrictions to ensure that a Kubelet on one node can't access secrets meant for pods running on a different node.\n\nFor the nitty-gritty details of what's allowed and what's restricted, you'd need to dive into the codebase, where the rules governing Kubelet access within the cluster are defined. Understanding these rules is essential for maintaining security and proper access control in your Kubernetes environment.\n\n```go\n// NodeAuthorizer authorizes requests from kubelets, with the following logic:\n//  1. If a request is not from a node (NodeIdentity() returns isNode=false), reject\n//  2. If a specific node cannot be identified (NodeIdentity() returns nodeName=\"\"), reject\n//  3. If a request is for a secret, configmap, persistent volume, resource claim, or persistent volume claim, reject unless the verb is get, and the requested object is related to the requesting node:\n//     node <- configmap\n//     node <- pod\n//     node <- pod <- secret\n//     node <- pod <- configmap\n//     node <- pod <- pvc\n//     node <- pod <- pvc <- pv\n//     node <- pod <- pvc <- pv <- secret\n//     node <- pod <- ResourceClaim\n//  4. For other resources, authorize all nodes uniformly using statically defined rules\n```\n\nYou can see this in effect if you try to get secrets from a cluster with Kubelet credentials:\n\n```sh\nkubectl --kubeconfig=/etc/kubernetes/kubelet.conf get secrets -A\nError from server (Forbidden): secrets is forbidden: User \"system:node:kubeletauthz-worker\" cannot list resource \"secrets\" in API group \"\" at the cluster scope: can only read namespaced object of this type\n```\n\nOne important point to note on this is where the logic is \"reject\", this just passes the request to other configured authorization modes, so if cluster RBAC has been modified to allow the `system:nodes` group to do something in excess of what the Node authorization mode allows then that will still be allowed.\n\nYou can see this by, for example, editing the `system:node` clusterrolebinding to add the `system:nodes` group as a subject, by adding these lines to it:\n\n```yaml\nsubjects:\n- apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: system:nodes\n```\n\nAfter completing the setup and configuration, when you use Kubelet credentials to attempt to access secrets at the cluster level, it should indeed work without issues:\n\n```sh\nkubectl --kubeconfig=/etc/kubernetes/kubelet.conf get secrets -A\nNAMESPACE     NAME                     TYPE                            DATA   AGE\nkube-system   bootstrap-token-abcdef   bootstrap.kubernetes.io/token   6      34m\n```\n\nThere are a couple of places where this mode can't effectively restrict permissions, which are in node and pod properties, for that we need another component.\n\n## üõÇ NodeRestriction Admission Controller\n\nIn addressing the NodeRestriction Admission Controller, we encounter a specialized admission controller designed to enhance security within Kubernetes. Its primary role is to carefully scrutinize requests originating from Kubelets. Specifically, it focuses on requests related to pods and nodes, aiming to restrict access rights to only those that are pertinent to the functioning of the Kubelet. As an illustrative example, this controller limits the ability to modify certain properties of node objects. This restriction serves a crucial purpose by preventing unauthorized changes, such as altering a node's security classification.\n\n## ‚ò∏Ô∏è Variations in Kubernetes Distributions\n\nA noteworthy aspect of working with Kubernetes is the considerable variability among different distributions. It is essential to bear in mind that the discussion presented thus far pertains primarily to the standard Kubernetes setup, often referred to as \"vanilla Kubernetes,\" particularly when configured using Kubeadm. However, it's important to recognize that Kubernetes distribution providers have the flexibility to customize this configuration. Indeed, many providers exercise this freedom to adapt Kubernetes to their specific requirements. As an example, [Azure AKS](https://azure.microsoft.com/en-us/services/kubernetes-service/), Microsoft's Kubernetes service, may deviate from the default configuration by allowing Kubelets to access secrets at the cluster level. These variations underscore the need for flexibility and adaptability in managing Kubernetes across diverse environments.\n\n## ‚ú® Conclusion\n\nConcluding our exploration of Kubernetes authorization, it is evident that while Role-Based Access Control (RBAC) remains the prevalent choice in most Kubernetes clusters, it may not always suffice to ensure a comprehensive level of security. There are instances where additional layers of security measures become essential. This is where supplemental authorization modes and admission controllers come into play. In this discussion, we've specifically examined the Node authorization mode and the NodeRestriction admission controller. These components play a crucial role in granting Kubelets the necessary rights and privileges to access the essential resources required for their smooth operation. Thus, Kubernetes administrators should consider these supplemental measures alongside RBAC to fortify their cluster's security posture and ensure it meets the specific demands of their use cases.\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1451},"frontmatter":{"id":"384464547971f7b27e444dd3","path":"/blog/kubelet-authorization-kubernetes-security/","humanDate":"Oct 30, 2024","fullDate":"2024-10-30","title":"Kubernetes Node Security: The Role of Kubelet Authorization üîê","keywords":["Kubernetes","Kubelet","Authorization","Node Security","DevOps"],"excerpt":"Understand the critical role of Kubelet authorization in securing Kubernetes nodes, a must-know for Kubernetes admins.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAciRlhnf/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAERQf/aAAgBAQABBQLXEWH/xAAWEQADAAAAAAAAAAAAAAAAAAACEDH/2gAIAQMBAT8BGL//xAAWEQEBAQAAAAAAAAAAAAAAAAAAAhH/2gAIAQIBAT8Bpj//xAAVEAEBAAAAAAAAAAAAAAAAAAAAMf/aAAgBAQAGPwJEf//EABgQAQADAQAAAAAAAAAAAAAAAAEAESFB/9oACAEBAAE/ISjcOCDpG7Y//9oADAMBAAIAAwAAABB4L//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAwEBPxBxcv/EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8QXaQf/8QAGRABAAMBAQAAAAAAAAAAAAAAAQARIVGR/9oACAEBAAE/EC9GhyyBUBHCzhBYJvS9z0n/2Q=="},"images":{"fallback":{"src":"/static/fb717753b7ce04069c036595f470c90f/256a4/kubelet-authorization-cover.jpg","srcSet":"/static/fb717753b7ce04069c036595f470c90f/35b79/kubelet-authorization-cover.jpg 750w,\n/static/fb717753b7ce04069c036595f470c90f/828ab/kubelet-authorization-cover.jpg 1080w,\n/static/fb717753b7ce04069c036595f470c90f/256a4/kubelet-authorization-cover.jpg 1200w","sizes":"100vw"},"sources":[{"srcSet":"/static/fb717753b7ce04069c036595f470c90f/4badc/kubelet-authorization-cover.webp 750w,\n/static/fb717753b7ce04069c036595f470c90f/f0d5f/kubelet-authorization-cover.webp 1080w,\n/static/fb717753b7ce04069c036595f470c90f/6d8dd/kubelet-authorization-cover.webp 1200w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.3333333333333333}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/finops-ec2-rds-management/","title":"FinOps in practice: Simplify AWS cost Control through Automated EC2 and RDS  Management üí∞","date":"2024-10-30 20:30:00"},"excerpt":"Multi-account, Multi-region EC2 and RDS instance savings üí∏ ‚úíÔ∏è Getting¬†Started In this blog post, we'll talk about the secrets to mastering‚Ä¶","html":"<blockquote>\n<p><strong>Multi-account, Multi-region EC2 and RDS instance savings üí∏</strong></p>\n</blockquote>\n<h2 id=\"Ô∏è-gettingstarted\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-gettingstarted\" aria-label=\"Ô∏è gettingstarted permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚úíÔ∏è Getting¬†Started</h2>\n<p>In this blog post, we'll talk about the secrets to mastering multi-account, multi-region savings, helping you to take control of your AWS infrastructure like never before as we unravel the true power of FinOps.</p>\n<p>Get ready to experience a whole new level of ease and effectiveness in managing your instances!</p>\n<p><img src=\"https://giphy.com/gifs/money-savings-socialusmarketingas-iH6bG56eoI9xaKRVcp\" alt=\"Savings\" loading=\"lazy\">\n          </p>\n<h2 id=\"-efficient-resource-management-with-instance-scheduler-onaws\" style=\"position:relative;\"><a href=\"#-efficient-resource-management-with-instance-scheduler-onaws\" aria-label=\" efficient resource management with instance scheduler onaws permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üí∏ Efficient Resource Management with Instance Scheduler on¬†AWS</h2>\n<p><a href=\"https://github.com/aws-solutions/instance-scheduler-on-aws\" target=\"_blank\" rel=\"noopener noreferrer\">The Instance Scheduler on AWS solution</a> automates the activation and deactivation of Amazon Elastic Compute Cloud (Amazon EC2) and Amazon Relational Database Service (Amazon RDS) instances.\nBy efficiently starting and stopping resources based on demand, this solution effectively reduces operational costs. For instance, organizations can leverage Instance Scheduler on AWS to automatically halt instances outside of business hours, resulting in substantial cost savings. With weekly utilization reduced from 168 hours to 50 hours, companies can potentially save up to 70% for instances that are only necessary during regular working hours.</p>\n<p>Instance Scheduler on AWS utilizes Amazon Web Services (AWS) resource tags and AWS Lambda to automate the process of stopping and restarting instances across multiple AWS Regions and accounts, adhering to a schedule defined by the customer. Additionally, this solution offers the option to utilize hibernation for stopped Amazon EC2 instances, further optimizing resource management.</p>\n<p>This implementation guide presents a comprehensive overview of the Instance Scheduler on AWS solution, including its reference architecture, key components, considerations for deployment planning, and detailed configuration steps for implementing the solution within the AWS Cloud.</p>\n<p>Designed for IT infrastructure architects, administrators, and DevOps professionals, this guide serves as a valuable resource for those seeking to deploy the Instance Scheduler on AWS in their environment.</p>\n<h3 id=\"-key-features-of-instance-scheduler-onaws\" style=\"position:relative;\"><a href=\"#-key-features-of-instance-scheduler-onaws\" aria-label=\" key features of instance scheduler onaws permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîë Key Features of Instance Scheduler on¬†AWS</h3>\n<p>Instance Scheduler on AWS offers a range of powerful features that simplify instance management and provide enhanced control over resource utilization:</p>\n<ul>\n<li>‚úîÔ∏è <strong>Cross-account instance scheduling:</strong> The solution creates necessary IAM roles to enable starting and stopping of instances in secondary accounts.</li>\n<li>‚úîÔ∏è <strong>Automated tagging:</strong> Instance Scheduler on AWS can automatically add tags to instances it manages, including the ability to incorporate variable information using macros.</li>\n<li>‚úîÔ∏è <strong>Scheduler CLI:</strong> A command line interface (CLI) is provided to configure schedules and periods, allowing customers to estimate cost savings based on specific schedules.</li>\n<li>‚úîÔ∏è <strong>SSM maintenance window integration:</strong> For Amazon EC2 instances, Instance Scheduler on AWS can utilize SSM maintenance windows in the same Region to start and stop instances during maintenance windows.</li>\n<li>‚úîÔ∏è <strong>Integration with AppRegistry and AWS Systems Manager Application Manager:</strong> The solution includes a Service Catalog AppRegistry resource, enabling centralized management of the solution's resources through AppRegistry and AWS Systems Manager Application Manager.</li>\n</ul>\n<h3 id=\"Ô∏è-aws-instance-scheduler-solution-flow-and-configuration\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-aws-instance-scheduler-solution-flow-and-configuration\" aria-label=\"Ô∏è aws instance scheduler solution flow and configuration permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚òÅÔ∏è AWS Instance Scheduler: Solution Flow and Configuration</h3>\n<p>The AWS CloudFormation template establishes an <a href=\"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html\" target=\"_blank\" rel=\"noopener noreferrer\">Amazon CloudWatch event</a> at a user-defined interval, triggering the Instance Scheduler AWS Lambda function. User-configured values for AWS Regions, accounts, and custom tags are stored in Amazon DynamoDB, with the Lambda function retrieving them during runtime. By applying the specified custom tag to relevant Amazon EC2 and Amazon RDS instances, the Lambda function ensures appropriate start or stop actions based on defined schedules.</p>\n<p>AWS CloudFormation resources are generated from AWS Cloud Development Kit (AWS CDK) constructs, while AWS Identity Access Management (AWS IAM) handles permission requirements, and AWS Key Management System (AWS KMS) provides encryption for Amazon SNS topics and DynamoDB tables.</p>\n<p>The Lambda function checks the current state of tagged instances against schedule-defined periods, triggering the necessary actions (e.g., starting or stopping instances) based on the schedule configuration stored in DynamoDB. Custom metrics can be recorded in Amazon CloudWatch for monitoring purposes.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.88235294117646%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJElEQVR42pVTTW/TQBDNL0P8DQ69cOdQuHDohT8AFyohwaWCyqJIcEEFypd6RJSkUBUlJK7SpHGbOInt+GO9X37Mru1UoRxgrZXXOzNv3rwZN3BlFfQAh0cduK5b3hQF/nU1jHMdoFT5fuLMcfteH4UW+N/VWOFWAR80fbz/5OFPm5ASXCpwLqCkgBQcWutVwPF4jJO6tMqoiJmU+dIpyzLaDGkaIwqmiKIQ0SJBGC0InK9I0kgg0bu/g+mtx8jzDJwuw90NBM4auCqdjn58R380AfxjBI+uA+kQD7ZSPHsVVFLp1ZIvPrTQ2XwNxjIY0/n+Nka7D21zYLITc3Of+wOcOhsEOIHz0sObPe/vgHmzidRxlnoIpUgvZSXgpJUg6IwxcEHnogQoCkn+EsLoSf4m1pRuAec7LzBYv0O6SUgyKnr7kwm+tVqIqdT5268IRmNKJCmJImlyCFH6agLRurCAZlvA9OAXZs/3LztKDlEQwo9DxF86aF+7C9atuk62dtdFEEa2USKhzbidgCWgv/UZvZublqGhz3NOIyGshlkU4+ywA07B5tsEJuECqXtu8SMis2i5IIGgKbZkeNxG8O6jDTDblGzAzT+jKXv68xSKknCaO0UsMhqZi97AAgaeD787tP5LhuHTbQxvrJEuohxezpeasCTFrO+BEcNa/JzsjMCNP6vORldVM8ymMwQn/at/NQmuqAmyAq/v6mRa6ctz1eXfAlziqSDo4pQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Architecture\" title=\"\" src=\"/static/8f6b8070d192c79c36c64c35859e7005/c5bb3/archi.png\" srcset=\"/static/8f6b8070d192c79c36c64c35859e7005/04472/archi.png 170w,\n/static/8f6b8070d192c79c36c64c35859e7005/9f933/archi.png 340w,\n/static/8f6b8070d192c79c36c64c35859e7005/c5bb3/archi.png 680w,\n/static/8f6b8070d192c79c36c64c35859e7005/b12f7/archi.png 1020w,\n/static/8f6b8070d192c79c36c64c35859e7005/c61d0/archi.png 1145w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"-using-aws-cloudformation-templates-for-solution-deployment\" style=\"position:relative;\"><a href=\"#-using-aws-cloudformation-templates-for-solution-deployment\" aria-label=\" using aws cloudformation templates for solution deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üçÄ Using AWS CloudFormation Templates for Solution Deployment</h3>\n<p><a href=\"https://s3.amazonaws.com/solutions-reference/aws-instance-scheduler/latest/aws-instance-scheduler.template\" target=\"_blank\" rel=\"noopener noreferrer\">In this template</a>, you can seamlessly launch the solution along with its associated components. By default, it includes the deployment of an AWS Lambda function, an Amazon DynamoDB table, an Amazon CloudWatch event, and CloudWatch custom metrics. However, you also have the freedom to customize the template according to your specific requirements. This level of flexibility enables you to adapt the solution to best fit your unique needs, ensuring a comprehensive and tailored deployment experience.</p>\n<p><a href=\"https://s3.amazonaws.com/solutions-reference/aws-instance-scheduler/latest/aws-instance-scheduler-remote.template\" target=\"_blank\" rel=\"noopener noreferrer\">This template</a> serves as a convenient way to launch the solution in remote accounts along with all its associated components. By default, it deploys an AWS Lambda function, an Amazon DynamoDB table, an Amazon CloudWatch event, and CloudWatch custom metrics. However, the template allows you to easily customize its configuration to align with your specific requirements.</p>\n<h3 id=\"-solution-testing-local-test-execution-withtox\" style=\"position:relative;\"><a href=\"#-solution-testing-local-test-execution-withtox\" aria-label=\" solution testing local test execution withtox permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Solution Testing: Local Test Execution with¬†Tox</h3>\n<p>To effectively test the solution, you will need to install tox by running the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> tox</code></pre></div>\n<p>Once installed, navigate to the root directory of the solution and execute the following commands for specific test scenarios:</p>\n<ul>\n<li>\n<p>To run all unit tests:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">tox</code></pre></div>\n</li>\n<li>\n<p>To exclusively test the lambda code:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">tox <span class=\"token parameter variable\">-e</span> lambda</code></pre></div>\n</li>\n<li>\n<p>To solely test the CDK (Cloud Development Kit) code:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">tox <span class=\"token parameter variable\">-e</span> cdk</code></pre></div>\n</li>\n<li>\n<p>To specifically test the CLI (Command-Line Interface) code:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">tox <span class=\"token parameter variable\">-e</span> cli</code></pre></div>\n</li>\n</ul>\n<p>By utilizing tox and running these commands, you can thoroughly test different components of the solution, ensuring its reliability and functionality.</p>\n<p><img src=\"https://giphy.com/gifs/stonks-stonk-YnkMcHgNIMW4Yfmjxr\" alt=\"Stonks\" loading=\"lazy\">\n          </p>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Conclusion</h2>\n<p>In conclusion, the FinOps revolution is changing how businesses handle their infrastructure, specifically when it comes to EC2 and RDS instances. By automating management and optimizing resources, organizations can simplify elasticity and control, leading to significant cost savings and operational improvements.</p>\n<p>Embracing multi-account, multi-region strategies allows companies to master their EC2 and RDS instances, ensuring efficient resource allocation, scalability, and better financial outcomes. With FinOps gaining momentum, it's time for businesses to adopt these innovative approaches and pave the way for a simpler and more cost-effective future.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"},"nextThought":{"frontmatter":{"path":"/blog/openfaas-kubernetes-serverless/","title":"Discover the Potential of Serverless Computing with OpenFaaS and Kubernetes as Catalysts for Change üêã","date":"2024-10-30 18:30:00"},"excerpt":"OpenFaaS and Kubernetes: Orchestrating Serverless Symphony üé∂ üìá Overview OpenFaaS and Kubernetes are catalysts for change in the world of‚Ä¶","html":"<blockquote>\n<p><strong>OpenFaaS and Kubernetes: Orchestrating Serverless Symphony üé∂</strong></p>\n</blockquote>\n<h2 id=\"-overview\" style=\"position:relative;\"><a href=\"#-overview\" aria-label=\" overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìá Overview</h2>\n<p>OpenFaaS and Kubernetes are catalysts for change in the world of serverless computing. Together, they enable organizations to scale new heights with efficiency and simplicity.</p>\n<p><a href=\"https://github.com/openfaas/faas\" target=\"_blank\" rel=\"noopener noreferrer\">OpenFaaS</a>, an open-source serverless platform, harmonizes perfectly with <a href=\"https://kubernetes.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes</a>, the renowned container orchestration system, to achieve the true potential of serverless computing. With OpenFaaS and Kubernetes, businesses can embrace the power of serverless computing and embark on a transformative journey toward a future of agility, scalability, and boundless possibilities.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdS0SQH/xAAZEAABBQAAAAAAAAAAAAAAAAARAQISIjL/2gAIAQEAAQUCdq0kI//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQEBAQAAAAAAAAAAAAAAAAAxIWH/2gAIAQEABj8Crja//8QAGRABAAMBAQAAAAAAAAAAAAAAAQARITFh/9oACAEBAAE/IbJTBBa5nIaMvif/2gAMAwEAAgADAAAAEPPP/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEh/9oACAEDAQE/EFR//8QAFhEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAECAQE/EEmf/8QAHBABAAEEAwAAAAAAAAAAAAAAAQARIUFRMWHR/9oACAEBAAE/ELMXIX8jOFe67x3uBJ5CKE//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"openfaas-python\" title=\"\" src=\"/static/a24b0406ca9ebf8f36beed43ca55e2b1/7bf67/openfaas-python.jpg\" srcset=\"/static/a24b0406ca9ebf8f36beed43ca55e2b1/651be/openfaas-python.jpg 170w,\n/static/a24b0406ca9ebf8f36beed43ca55e2b1/d30a3/openfaas-python.jpg 340w,\n/static/a24b0406ca9ebf8f36beed43ca55e2b1/7bf67/openfaas-python.jpg 680w,\n/static/a24b0406ca9ebf8f36beed43ca55e2b1/990cb/openfaas-python.jpg 1020w,\n/static/a24b0406ca9ebf8f36beed43ca55e2b1/c44b8/openfaas-python.jpg 1360w,\n/static/a24b0406ca9ebf8f36beed43ca55e2b1/d165a/openfaas-python.jpg 1400w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-goals--objectives\" style=\"position:relative;\"><a href=\"#-goals--objectives\" aria-label=\" goals  objectives permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üî≠ Goals &#x26; Objectives</h2>\n<p>In this blog, we will explore the powerful combination of OpenFaaS and Kubernetes and explore how they are revolutionizing the world of serverless computing.</p>\n<div style=\"width:100%;height:0;padding-bottom:56%;position:relative;\"><iframe src=\"https://giphy.com/embed/cUpOMrVpmmLCF3rjyA\" width=\"100%\" height=\"100%\" style=\"position:absolute\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen></iframe></div>\n<h2 id=\"understanding-serverless-architecture-simplifying-code-execution-without-infrastructure\" style=\"position:relative;\"><a href=\"#understanding-serverless-architecture-simplifying-code-execution-without-infrastructure\" aria-label=\"understanding serverless architecture simplifying code execution without infrastructure permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Understanding Serverless Architecture: Simplifying Code Execution without Infrastructure</h2>\n<p>Serverless architecture refers to an innovative approach in which the core business logic is implemented as functions that can be executed in a stateless manner. Contrary to its name, serverless does not imply running code without servers; rather, it entails eliminating the need for manual hardware and infrastructure provisioning during the development process. In this model, the application still operates on servers, albeit ones that are managed by external service providers.</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Function_as_a_service\" target=\"_blank\" rel=\"noopener noreferrer\">Function-as-a-Service (FaaS)</a> plays a big role in enabling serverless architecture. With FaaS, developers can focus solely on writing the functions that represent the specific business logic, without concerning themselves with the underlying infrastructure or server management. FaaS platforms, such as <a href=\"https://aws.amazon.com/lambda/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS Lambda</a>, <a href=\"https://azure.microsoft.com/en-us/services/functions/\" target=\"_blank\" rel=\"noopener noreferrer\">Azure Functions</a>, or <a href=\"https://cloud.google.com/functions\" target=\"_blank\" rel=\"noopener noreferrer\">Google Cloud Functions</a>, allow developers to deploy their functions and execute them in response to specific events or triggers.</p>\n<p>The beauty of FaaS lies in its event-driven nature. Functions are executed only when a specific event occurs, such as an HTTP request, a file upload, or a database update. This event-driven approach brings several benefits. First, it enables auto-scaling, as the FaaS platform dynamically scales the execution environment based on the incoming workload. This ensures that the application can handle sudden spikes in traffic without any manual intervention.</p>\n<h2 id=\"exploring-openfaas-a-technical-overview-of-open-source-function-as-a-service\" style=\"position:relative;\"><a href=\"#exploring-openfaas-a-technical-overview-of-open-source-function-as-a-service\" aria-label=\"exploring openfaas a technical overview of open source function as a service permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Exploring OpenFaaS: A Technical Overview of Open-Source Function-as-a-Service</h2>\n<p><a href=\"https://docs.openfaas.com/\" target=\"_blank\" rel=\"noopener noreferrer\">OpenFaaS</a> is an open-source Function-as-a-Service (FaaS) platform that offers developers a flexible and scalable solution for building serverless applications. By leveraging containerization technology, OpenFaaS allows developers to package their functions into lightweight, independent containers that can be easily deployed and executed in a serverless environment. With OpenFaaS, developers have the freedom to write functions in any language of their choice, enabling a polyglot development approach.</p>\n<p>Under the hood, OpenFaaS relies on Docker and Kubernetes for container orchestration, providing robust scalability and high availability. The platform supports automatic scaling, allowing functions to handle varying workloads seamlessly. Additionally, OpenFaaS integrates with popular cloud providers, allowing developers to leverage existing cloud services and resources.</p>\n<h3 id=\"getting-hands-on-with-openfaas\" style=\"position:relative;\"><a href=\"#getting-hands-on-with-openfaas\" aria-label=\"getting hands on with openfaas permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Getting Hands-On with OpenFaaS</h3>\n<p>In this hands-on exploration of OpenFaaS, we will follow a straightforward process to deploy a Flask microservice as a serverless function. The steps involve setting up Kubernetes and OpenFaaS, dockerizing the Python application, creating a custom function, deploying the function, and finally, testing its functionality. This practical approach will provide a firsthand experience of leveraging OpenFaaS for serverless development. Let's start!</p>\n<h3 id=\"-setting-up-the-environment\" style=\"position:relative;\"><a href=\"#-setting-up-the-environment\" aria-label=\" setting up the environment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ùï Setting up the environment</h3>\n<p>Setting up Kubernetes and OpenFaas involves deploying OpenFaaS on either a local or remote Kubernetes cluster. In our case, we will utilize the EKS Kubernetes cluster to deploy OpenFaaS. The deployment of OpenFaaS can be accomplished using either Helm or arkade.</p>\n<p><a href=\"https://helm.sh/\" target=\"_blank\" rel=\"noopener noreferrer\">Helm</a> serves as a Kubernetes package and operations manager. Users can utilize Helm to publish their application configurations in the form of Charts.</p>\n<p>On the other hand, <a href=\"https://github.com/alexellis/arkade\" target=\"_blank\" rel=\"noopener noreferrer\">arkade</a> is a Go-based open-source CLI that simplifies app management. Internally, arkade leverages helm charts and kubectl to install applications onto the Kubernetes cluster.</p>\n<p>In this demo, we will use arkade to install OpenFaas as it is very easy and quick to use.</p>\n<h4 id=\"-install-arkade\" style=\"position:relative;\"><a href=\"#-install-arkade\" aria-label=\" install arkade permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚úÖ Install arkade</h4>\n<p>Use the following command to install arkade.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Note: you can also run without `sudo` and move the binary yourself</span>\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-sLS</span> https://get.arkade.dev <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">sh</span>\n\narkade <span class=\"token parameter variable\">--help</span>\nark <span class=\"token parameter variable\">--help</span>  <span class=\"token comment\"># a handy alias</span>\n\n<span class=\"token comment\"># Windows users with Git Bash</span>\n<span class=\"token function\">curl</span> <span class=\"token parameter variable\">-sLS</span> https://get.arkade.dev <span class=\"token operator\">|</span> <span class=\"token function\">sh</span></code></pre></div>\n<h4 id=\"-install-openfaas\" style=\"position:relative;\"><a href=\"#-install-openfaas\" aria-label=\" install openfaas permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚úÖ Install OpenFaas</h4>\n<p>Use arkade install to configure OpenFaaS with a cloud LoadBalancer, in this instance an \"ALB\" will be created.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">arkade <span class=\"token function\">install</span> openfaas --load-balancer\n\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\n<span class=\"token operator\">=</span> OpenFaaS has been installed.                                        <span class=\"token operator\">=</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span></code></pre></div>\n<p>To verify if the installation is successful we can execute the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token parameter variable\">-n</span> openfaas get deployments <span class=\"token parameter variable\">-l</span> <span class=\"token assign-left variable\">release</span><span class=\"token operator\">=</span>openfaas,app<span class=\"token operator\">=</span>openfaas</code></pre></div>\n<p>Or to verify that openfaas has started, run:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 137.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZ0lEQVR42nVV6XriMAzkfcqRg3BfCSQc4Ugod0u33e37P8Hm02pkmw2Q/tBnh+CJRiONS/3J6q8brana31JtsKXqQK/9VKKCdYA1kcC+6NlEyYmSv958S53FiRqzA3XiMw2TK7nhK9VGKdkjXodbqk8OZPs72QPI4T2eH0FLrgCmVOfwFik1dLhRKoCN6MQHX2m4/kWt6ZmcYEfl3kb2TY5y7xkwA4ABw1qf6j8w3UZ4kiz9zSe1Z5cbYJvBWkWA9SkDLvlgrMCaeo9wJltqRpwVZzje/qbO/I3c8Z5eGBD7zvwi4HeAVpBkTojDHGO9cti8twOm7u+lbk2mXh8fyOJsy1w3N9gL+FMNnUmSoVaVrlLUBGpnMRAywOHu4k2EAQCo95dX+cCTyrVRkll+ShKBEgIvUCscQHbYh69/qDU7yzsAtpnuI5iizIC2puhEaoUYyAY0AehNjhSkX9TluiFrgOFduagPLZ9ryIBuqDI0LwSQVbRugCwK07ZGWxEEChc2dnW4yar+hsFYrRG6fyNfRtOamnnhkSl/M1UG0ZS98EAv3bW0TX5qSl60z3qrC/XWZ+quTrK25kcaLD8oSL6ot3iXbEbrT2lugEnW/BHQbvCq6r1/AFxe5KBMAP+xF18Z9Cr75vREg9WHAEJtlKIXv6t3HG6g2Nwo15hybbSRFlGhKHuaMtRGtqgdRAIo2qqQMhobgmDc6jNW2VfFBRVMAkRo8viFu2/JEmOI7EC9WJR+klWH/DBMC/sKTQ5zALiZY2SMfSGgG6rGruT8DwFqyASHkQ2aGoXvs1gwDIiC/zwDwm1iRdmb6Vhgro0x7CRDMzHGEzF6rR/tK1b1E+tiX6xxxnBt1BFgqGNF9yYcHfuubqdiwKUGnGthJopyIzoKCACrA+XSBrwf/wDohMpgTYaedm57rEZO0U2lRaAwwMRgZ3qen/yQZxkH8oIYgdRvyvvE/jlD5dp7EQU1hT/eU2bHxv0BM7UnOYMN1L3CfSqZwmEwDcq1lRPhI21+zrdPyWaDNbW7XQMrFdjLzecrqrZ2a3PzARQzfweIGhp18zXEigzxJxFmmN5aBsKoa+FcAIgMZ7oP5/8Dz3JRhRpokN4EgtuoLjhJ898BMqXMXEhYrbEy2vy1YOmJqD2s4pm5ewW//wMJSMDbxcLB4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"check\" title=\"\" src=\"/static/b1fc131591abb2f351333d71c30bf6f6/c5bb3/check.png\" srcset=\"/static/b1fc131591abb2f351333d71c30bf6f6/04472/check.png 170w,\n/static/b1fc131591abb2f351333d71c30bf6f6/9f933/check.png 340w,\n/static/b1fc131591abb2f351333d71c30bf6f6/c5bb3/check.png 680w,\n/static/b1fc131591abb2f351333d71c30bf6f6/b12f7/check.png 1020w,\n/static/b1fc131591abb2f351333d71c30bf6f6/b5a09/check.png 1360w,\n/static/b1fc131591abb2f351333d71c30bf6f6/29007/check.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>To retrieve the admin password, run:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">echo</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl <span class=\"token parameter variable\">-n</span> openfaas get secret basic-auth <span class=\"token parameter variable\">-o</span> <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token string\">\"{.data.basic-auth-password}\"</span> <span class=\"token operator\">|</span> base64 <span class=\"token parameter variable\">--decode</span> <span class=\"token variable\">)</span></span></code></pre></div>\n<h4 id=\"-install-faas-cli\" style=\"position:relative;\"><a href=\"#-install-faas-cli\" aria-label=\" install faas cli permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚úÖ Install faas-cli</h4>\n<p>Once OpenFaas is installed, we must install faas-cli.</p>\n<p>The faas-cli is required to deploy and test functions with OpenFaas. Execute the following command to install faas-cli.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-SLsf</span> https://cli.openfaas.com <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">sh</span></code></pre></div>\n<p>If basic auth is enabled, you can now log into your gateway:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 14.117647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAp0lEQVR42j2Oyw6CMBBF+R7B4sYUKBYXBgooFGpMCj7+f21mVzOOVVycnHtvu5iAq+a1Ep1b572LiJBy9OHXF5b36P9Xk/XXO+0YEcvBBaK1KLsb8tJiWs8oTw8U7RUTNfnuUTPyytJmMT/eKV8wqw0mlSGfcXswyOSIcTFikNcGeGkgVRNkRKos5M0Mm72BuBiI0cMoMzn4nRWaNk19cQ+h6IGufL4BzIdpjF9Ln58AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"gateway\" title=\"\" src=\"/static/a8ddb1b7a87e7435b4c827c806f938eb/c5bb3/gateway.png\" srcset=\"/static/a8ddb1b7a87e7435b4c827c806f938eb/04472/gateway.png 170w,\n/static/a8ddb1b7a87e7435b4c827c806f938eb/9f933/gateway.png 340w,\n/static/a8ddb1b7a87e7435b4c827c806f938eb/c5bb3/gateway.png 680w,\n/static/a8ddb1b7a87e7435b4c827c806f938eb/b12f7/gateway.png 1020w,\n/static/a8ddb1b7a87e7435b4c827c806f938eb/b5a09/gateway.png 1360w,\n/static/a8ddb1b7a87e7435b4c827c806f938eb/29007/gateway.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Then Open UI and you will find it like below:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.352941176470594%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVR42tWSTQrCMBCFe/8zqAuhGxUX4i1EEdxU3UirK9P/pmnTps+JVkVbENqVgQ8ySea9CTPGaLrD0LQwMPcYTw6wjj6yrEQUS8RJDS/gejEY8+C6Hpgbvu9eFAhCAUNKCSlLKAVUVQWefj7UwqkoYZ8DzJcWZguLTFltmjcFlapICHf0PknyhnvCJZwLw3rrYLWxcbKvdJ61V4ivxbls+U5O1QiqlEgFxYLiXoKPhCa9BH/xv4Kp7mrRgRKhFtSzp2gIn8TUvTDqAOX5AccNDWoD8z0qNRkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ui\" title=\"\" src=\"/static/e8c0926e810362dd6629886dad772b63/c5bb3/ui.png\" srcset=\"/static/e8c0926e810362dd6629886dad772b63/04472/ui.png 170w,\n/static/e8c0926e810362dd6629886dad772b63/9f933/ui.png 340w,\n/static/e8c0926e810362dd6629886dad772b63/c5bb3/ui.png 680w,\n/static/e8c0926e810362dd6629886dad772b63/b12f7/ui.png 1020w,\n/static/e8c0926e810362dd6629886dad772b63/b5a09/ui.png 1360w,\n/static/e8c0926e810362dd6629886dad772b63/29007/ui.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"flask-on-fire-dockerizing-the-python-application\" style=\"position:relative;\"><a href=\"#flask-on-fire-dockerizing-the-python-application\" aria-label=\"flask on fire dockerizing the python application permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Flask on Fire: Dockerizing the Python Application</h3>\n<p>In simpler words, dockerizing means using special containers called docker to package, deploy, and run applications.</p>\n<p>We will use docker to package and run the sample Flask application.</p>\n<h4 id=\"prepare-the-codebase\" style=\"position:relative;\"><a href=\"#prepare-the-codebase\" aria-label=\"prepare the codebase permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Prepare the Codebase</h4>\n<p>To set up the application, you can make a copy of my sample Python application project by running the provided command in any directory you prefer.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> clone https://github.com/seifrajhi/python-openfaas-demo</code></pre></div>\n<p>We will use this Flask application to be packaged into our docker image.</p>\n<h4 id=\"brief-explanation-of-the-dockerfile\" style=\"position:relative;\"><a href=\"#brief-explanation-of-the-dockerfile\" aria-label=\"brief explanation of the dockerfile permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Brief explanation of the Dockerfile</h4>\n<p>A Dockerfile is essentially a textual document that contains specific instructions on constructing a Docker image for our project.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2ElEQVR42qWSy26DMBREWaZpgACJ8QO/CpVaBGmi/v+fYU3sW2XRXZ0ujuSx5COPr4t3O23MeOxLj8PxjXitPfHIf6VsRhRM2E2aGb1acRYzWESaS8xLtjBRnHq3cTWi6z+Iqp1Qdz+UzRNCxn3g0uLEPyGGNW6O2B0sdqXFS+myqxdCmSD0jMHdoOwXVdXuCjd+Y4g53TpLKAcXlFni4SuEXklo/I0Q+kJPkCXsmA9V66nevorUjtaPnF25ZS4054luksb+zGR/CXvpg9QLeKybKv5Hmv7hHeil46LdYGIOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Dockerfile\" title=\"\" src=\"/static/b6869ce620b072c4488ac49be021ab76/c5bb3/Dockerfile.png\" srcset=\"/static/b6869ce620b072c4488ac49be021ab76/04472/Dockerfile.png 170w,\n/static/b6869ce620b072c4488ac49be021ab76/9f933/Dockerfile.png 340w,\n/static/b6869ce620b072c4488ac49be021ab76/c5bb3/Dockerfile.png 680w,\n/static/b6869ce620b072c4488ac49be021ab76/b12f7/Dockerfile.png 1020w,\n/static/b6869ce620b072c4488ac49be021ab76/b5a09/Dockerfile.png 1360w,\n/static/b6869ce620b072c4488ac49be021ab76/29007/Dockerfile.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>First, we need to create the image by using the Dockerfile.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAT0lEQVR42mOQVdH4yaei/odZVOMPizgEs0IxCxmYgUte/w+PouF/bgWD/xwyOv/5FAz/8ysagTGfktF/HmXD/7zKRmAMUgPUhBOzSmj+BwD8QzOO8P7nqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"build\" title=\"\" src=\"/static/3f4186824ab37520cae8dc920cc619f6/c5bb3/build.png\" srcset=\"/static/3f4186824ab37520cae8dc920cc619f6/04472/build.png 170w,\n/static/3f4186824ab37520cae8dc920cc619f6/9f933/build.png 340w,\n/static/3f4186824ab37520cae8dc920cc619f6/c5bb3/build.png 680w,\n/static/3f4186824ab37520cae8dc920cc619f6/b12f7/build.png 1020w,\n/static/3f4186824ab37520cae8dc920cc619f6/b5a09/build.png 1360w,\n/static/3f4186824ab37520cae8dc920cc619f6/29007/build.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>To verify the created image, you can use the following command:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAVUlEQVR42oWOUQqAMAxDt9ZuXVdBegLvf8ZBHNM/BT8egRCSpDPKiGCUnKHbAyUo/0AfTD9Zl9GPiv1Q+FSPCmv8KmhKaHKPmTK6C6zyylohuMo6cwE+1SqdS+J8tQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"verify\" title=\"\" src=\"/static/1bce9ba976387fa4d4510d4a325b4222/c5bb3/verify.png\" srcset=\"/static/1bce9ba976387fa4d4510d4a325b4222/04472/verify.png 170w,\n/static/1bce9ba976387fa4d4510d4a325b4222/9f933/verify.png 340w,\n/static/1bce9ba976387fa4d4510d4a325b4222/c5bb3/verify.png 680w,\n/static/1bce9ba976387fa4d4510d4a325b4222/b12f7/verify.png 1020w,\n/static/1bce9ba976387fa4d4510d4a325b4222/b5a09/verify.png 1360w,\n/static/1bce9ba976387fa4d4510d4a325b4222/29007/verify.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"pushing-docker-image-to-docker-hub\" style=\"position:relative;\"><a href=\"#pushing-docker-image-to-docker-hub\" aria-label=\"pushing docker image to docker hub permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Pushing Docker Image to Docker Hub</h3>\n<p>To upload the Docker image to Docker Hub, we can use the docker tag and docker push commands. This step enables us to create, test, store, and distribute container images through the Docker Hub platform.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 12.941176470588234%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAWklEQVR42pWOQQ6AMAgES1uUAq3/f+1KOJiY2IOHCbDAQhEhCBVI/Un7pqg2qHVYwlDtT62jZXTn7JmHHvmQujUtaTRjeB6Y1wlbB3wxPLU4EMuD6YV02n54A8+xP8z1cn3iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"push\" title=\"\" src=\"/static/75c080b1f01b5c43a8011cb969e4e536/c5bb3/push-dh.png\" srcset=\"/static/75c080b1f01b5c43a8011cb969e4e536/04472/push-dh.png 170w,\n/static/75c080b1f01b5c43a8011cb969e4e536/9f933/push-dh.png 340w,\n/static/75c080b1f01b5c43a8011cb969e4e536/c5bb3/push-dh.png 680w,\n/static/75c080b1f01b5c43a8011cb969e4e536/b12f7/push-dh.png 1020w,\n/static/75c080b1f01b5c43a8011cb969e4e536/b5a09/push-dh.png 1360w,\n/static/75c080b1f01b5c43a8011cb969e4e536/29007/push-dh.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Now, that the docker image is created, we can use this docker image to run the Flask application from anywhere we want.</p>\n<h3 id=\"building-a-serverless-function\" style=\"position:relative;\"><a href=\"#building-a-serverless-function\" aria-label=\"building a serverless function permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Building a Serverless Function</h3>\n<p>In the preceding stages, we used the arkade CLI to install OpenFaaS on a Kubernetes cluster.</p>\n<p>Now, we can generate a function using the OpenFaas template, which we can subsequently deploy within OpenFaas.</p>\n<p>Since we have a dockerized Flask application we will use the <a href=\"https://github.com/openfaas/templates\" target=\"_blank\" rel=\"noopener noreferrer\">dockerfile template of OpenFaas</a> to create our function as follows:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.529411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdElEQVR42oWOQQrDMAwE5TS2Jbuykzol//9nYLuhh0Ih5DCwWqRBklI4ssiRwx/TLyuzPu45b6R5RN8L2lD429BHgb8UdUnwsxuGkifYHGDxC48vEa8Re53RPMM3o9gozHh2CjdFY+cL5zWx486q0AspP8QH47VAcpF7Z94AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"create\" title=\"\" src=\"/static/778ec96f746ea37e8780bfc7be4855be/c5bb3/create.png\" srcset=\"/static/778ec96f746ea37e8780bfc7be4855be/04472/create.png 170w,\n/static/778ec96f746ea37e8780bfc7be4855be/9f933/create.png 340w,\n/static/778ec96f746ea37e8780bfc7be4855be/c5bb3/create.png 680w,\n/static/778ec96f746ea37e8780bfc7be4855be/b12f7/create.png 1020w,\n/static/778ec96f746ea37e8780bfc7be4855be/b5a09/create.png 1360w,\n/static/778ec96f746ea37e8780bfc7be4855be/29007/create.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Container images are used to store OpenFaas functions. In this case, we will use DockerHub as the repository for our image. Consequently, we will establish the environment variable <code class=\"language-text\">OPENFAAS_PREFIX</code> with the username associated with DockerHub.</p>\n<p><code class=\"language-text\">faas-cli new</code> enables us to create a new function via the dockerfile template in the current directory. Here, we have created a function called <code class=\"language-text\">sample-openfaas-demo</code> using the OpenFaas template dockerfile. After executing the above commands we will find that the following files were created:</p>\n<ul>\n<li><code class=\"language-text\">sample-openfaas-demo.yaml</code></li>\n<li><code class=\"language-text\">sample-openfaas-demo/Dockerfile</code></li>\n</ul>\n<p>We will now make the necessary changes to files in order to deploy our serverless logic.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1.0</span>\n<span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">gateway</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//a55330be826824eefb8b679774fa42b2.eu<span class=\"token punctuation\">-</span>west<span class=\"token punctuation\">-</span>1.elb.amazonaws.com\n<span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">sample-flask-service</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">lang</span><span class=\"token punctuation\">:</span> dockerfile\n        <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> ./dockerfile<span class=\"token punctuation\">-</span>sample/python<span class=\"token punctuation\">-</span>openfaas<span class=\"token punctuation\">-</span>demo\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> rajhisaifeddine/python<span class=\"token punctuation\">-</span>openfaas<span class=\"token punctuation\">-</span>demo<span class=\"token punctuation\">:</span>latest\n        <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">RAW_BODY</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">True</span>\n            <span class=\"token key atrule\">write_timeout</span><span class=\"token punctuation\">:</span> 30s\n            <span class=\"token key atrule\">read_timeout</span><span class=\"token punctuation\">:</span> 30s\n            <span class=\"token key atrule\">exec_timeout</span><span class=\"token punctuation\">:</span> 30s\n        <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n         <span class=\"token key atrule\">com.openfaas.scale.min</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n         <span class=\"token key atrule\">com.openfaas.scale.max</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n         <span class=\"token key atrule\">com.openfaas.scale.zero</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"true\"</span></code></pre></div>\n<p>Then, we update the Dockerfile for our function.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">FROM ghcr.io/openfaas/classic<span class=\"token punctuation\">-</span>watchdog<span class=\"token punctuation\">:</span>0.2.1 as watchdog\n\nFROM rajhisaifeddine/python<span class=\"token punctuation\">-</span>openfaas<span class=\"token punctuation\">-</span>demo<span class=\"token punctuation\">:</span>latest\n\nRUN mkdir <span class=\"token punctuation\">-</span>p /home/app\n\nCOPY <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>from=watchdog /fwatchdog /usr/bin/fwatchdog\nRUN chmod +x /usr/bin/fwatchdog\n\n<span class=\"token comment\"># Add non root user</span>\nRUN addgroup <span class=\"token punctuation\">-</span>S app <span class=\"token important\">&amp;&amp;</span> adduser app <span class=\"token punctuation\">-</span>S <span class=\"token punctuation\">-</span>G app\nRUN chown app /home/app\n\nWORKDIR /home/app\n\nUSER app\n\nENV fprocess=\"python app.py\"\n\nENV upstream_url=\"http<span class=\"token punctuation\">:</span>//127.0.0.1<span class=\"token punctuation\">:</span>5000\"\nENV mode=\"http\"\nENV cgi_headers=\"true\"\n\n<span class=\"token comment\"># Set to true to see request in function logs</span>\nENV write_debug=\"false\"\n\nHEALTHCHECK <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>interval=3s CMD <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">-</span>e /tmp/.lock <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span> exit 1\n\nCMD <span class=\"token punctuation\">[</span><span class=\"token string\">\"fwatchdog\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div style=\"width:100%;height:0;padding-bottom:67%;position:relative;\"><iframe src=\"https://giphy.com/embed/drj2TRzBtDG6lx5le3\" width=\"100%\" height=\"100%\" style=\"position:absolute\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen></iframe></div>\n<h3 id=\"deploy-the-function\" style=\"position:relative;\"><a href=\"#deploy-the-function\" aria-label=\"deploy the function permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Deploy the Function</h3>\n<p>The function is now ready to be deployed. We can run the following command to deploy the function.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">faas-cli up <span class=\"token parameter variable\">-f</span> sample-openfaas-demo.yaml</code></pre></div>\n<p>The above command will perform the following actions:</p>\n<ul>\n<li>Creates a local container image of the function.</li>\n<li>Pushes the image to the remote registry, which in our case is the docker hub.</li>\n<li>Using the OpenFaas REST API, creates a deployment inside Kubernetes Cluster and a new Pod to serve the traffic.</li>\n</ul>\n<h3 id=\"testing-the-function\" style=\"position:relative;\"><a href=\"#testing-the-function\" aria-label=\"testing the function permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Testing the Function</h3>\n<p>We have deployed our function as a Serverless function with autoscaling enabled in OpenFaas. Before proceeding to test our function we must set up monitoring of the process to understand how serverless actually works. For monitoring purposes, we can use <a href=\"https://grafana.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Grafana</a>.</p>\n<p>We can easily install Grafana as a pod in Kubernetes Cluster using the below command:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.529411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAe0lEQVR42lWObQ+EIAyDAWUwnLzcGf//DzWpExO4+/CkbdY0M0T2CtYMolN1M//53+wmcXl5vNmFkHPAfkRIJWzbCmGP/GWUxpAWFO202JFMPdfMaKz34KFjA3O2grMWyKGjnwj2TrHg4JAU7tjp6dVEC9LTXe0Y0w9xA/KFQGU/CMstAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"grafana\" title=\"\" src=\"/static/5577d5b9088c601a832a44b5cd7e19cd/c5bb3/grafana.png\" srcset=\"/static/5577d5b9088c601a832a44b5cd7e19cd/04472/grafana.png 170w,\n/static/5577d5b9088c601a832a44b5cd7e19cd/9f933/grafana.png 340w,\n/static/5577d5b9088c601a832a44b5cd7e19cd/c5bb3/grafana.png 680w,\n/static/5577d5b9088c601a832a44b5cd7e19cd/b12f7/grafana.png 1020w,\n/static/5577d5b9088c601a832a44b5cd7e19cd/b5a09/grafana.png 1360w,\n/static/5577d5b9088c601a832a44b5cd7e19cd/29007/grafana.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Next, use port-forward from our local computer to access Grafana the URL:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAVElEQVR42n2NwQqAMAxD9yG2vei6ths7+f8/NohMBiKCh/CSHJJ0VhmHC2hjiAiYeenx7/5fST2GRsWhhmyO7IGZrbZFR+sB84JdC6z1m0T0GZvHF2GROAILbapBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"port-forward\" title=\"\" src=\"/static/6fe97391e1a22974cc4dda68405855be/c5bb3/port-forward.png\" srcset=\"/static/6fe97391e1a22974cc4dda68405855be/04472/port-forward.png 170w,\n/static/6fe97391e1a22974cc4dda68405855be/9f933/port-forward.png 340w,\n/static/6fe97391e1a22974cc4dda68405855be/c5bb3/port-forward.png 680w,\n/static/6fe97391e1a22974cc4dda68405855be/b12f7/port-forward.png 1020w,\n/static/6fe97391e1a22974cc4dda68405855be/b5a09/port-forward.png 1360w,\n/static/6fe97391e1a22974cc4dda68405855be/29007/port-forward.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Open the OpenFaas Grafana Dashboard from <a href=\"http://127.0.0.1:3000/\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:3000/</a>. Enter the default password for Grafana, which is admin: admin. The OpenFaas Grafana Dashboard would look as follows:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.29411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVR42m1QXXrDIAzjHG34M4SQLHtYe/+zqRYpKcv2oA8sZCPLfC+Cn8cT21qxlIKvbWunpITUIfK5K0TrtVbs+466VKzauxXRvgzjnYe93eCmqSE4h+g9vLUnyI81QQ3R+9xkYfU0KcZzCMH7WHdurBunQ0dewqEzOQnKPEPoSgl+QHQnFNFBDAFZYls/63vJGVWjyYwgSnt3qje9qQ+YVUDRdcXDzeE+6OeLmiDGrWjIXLM67Ic/uV0j+C+aNvAT6vRryMjZ+13XCm3Nvs3pivr3ndoXxbfAGEPZZm8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"dashboard\" title=\"\" src=\"/static/5940164c2d724d452a63848e3ae07cbc/c5bb3/dashboard.png\" srcset=\"/static/5940164c2d724d452a63848e3ae07cbc/04472/dashboard.png 170w,\n/static/5940164c2d724d452a63848e3ae07cbc/9f933/dashboard.png 340w,\n/static/5940164c2d724d452a63848e3ae07cbc/c5bb3/dashboard.png 680w,\n/static/5940164c2d724d452a63848e3ae07cbc/b12f7/dashboard.png 1020w,\n/static/5940164c2d724d452a63848e3ae07cbc/e996b/dashboard.png 1050w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>From the Dashboard, we can see that the number of replicas has increased to 1 from 0 to serve the request. This replica count will further increase depending on the load till the <code class=\"language-text\">com.openfaas.scale.max</code> specified previously.</p>\n<p>The way autoscaling works in the background is that the requests are blocked until the desired count of replicas is achieved. We can verify that from the gateway logs as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl logs <span class=\"token parameter variable\">-n</span> openfaas deploy/gateway <span class=\"token parameter variable\">-c</span> gateway <span class=\"token parameter variable\">-f</span></code></pre></div>\n<div style=\"width:100%;height:0;padding-bottom:67%;position:relative;\"><iframe src=\"https://giphy.com/embed/3o84U9arAYRM73AIvu\" width=\"100%\" height=\"100%\" style=\"position:absolute\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen></iframe></div>\n<h2 id=\"-wrap-up\" style=\"position:relative;\"><a href=\"#-wrap-up\" aria-label=\" wrap up permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Wrap-up</h2>\n<p>The combination of OpenFaaS and Kubernetes has unlocked new possibilities in serverless computing. These powerful tools have acted as catalysts for change, enabling businesses to scale new heights in terms of efficiency and flexibility. By harnessing their potential, organizations can embrace the future of technology and revolutionize the way they deploy and manage applications. With OpenFaaS and Kubernetes orchestrating serverless environments, the sky's the limit for innovation and growth.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}