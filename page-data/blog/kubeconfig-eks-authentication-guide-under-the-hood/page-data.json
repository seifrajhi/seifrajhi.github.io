{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/kubeconfig-eks-authentication-guide-under-the-hood/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>AWS EKS-Kubeconfig Connection üêã</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Introduction</h2>\n<p>One of the key challenges of using EKS is authentication. EKS uses IAM to provide authentication to your K8s cluster. However, IAM tokens can be difficult to manage and use.</p>\n<p><a href=\"https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubeconfig</a> is a configuration file that stores information about K8s clusters, including their API server endpoints, certificates, and authentication information. Kubeconfig can be used to authenticate with EKS clusters, making it a more convenient and secure option than IAM tokens. This blog post will discuss how to use kubeconfig to authenticate with EKS clusters. We will also cover the basics of kubeconfig and how it works.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABx0lEQVR42kWRy2sTURSH81e468pVBRdSEAsWXUgVWqjYKoIpBTfWnSK46EIQkfpWRBCLKBUXIvjY+ADdyNCNxlfSJjM1M9NJI20SmsloJjOZOzOfdyZVD5x7uOd378fh/DJhGAEx3w0fZbFDIGLiKCIMBVHUyziONmsoa4Tv+6xUquim9S9bjiP1mEzy+NZLh4MXakxeq3N6boNWO6S5IdBUQe5TRLkc8fWLoJAPSMK0KmzbuY+hA4cZPXKcvv5dPHz8NNUy1UbAxMUaLxZclCWPqRsN3uTcVPQ8QT6vYhgVOXFMpxOm/bKxwo6hEQ5lTzB18gzbB/dzf/5JD1iq+IydX+fVR5e3uTbHrtR4ttCWUkBhcYnlZU0CdSzLxDT1HlA32T08wXh2mulTMwyPZf8Dk+PB+w7js00mr9vMPPqd7qLbDXDkXkzTRFEUVFWV91/ppx8S2Nc/yMCeUfaOHGXL1gHuzM33gKEQ/Kyu8vqDxvN3JYqaLk0RCCFSsOd52LaN67rSkDg1sNlscfnmXS7JvHr7HmfPzfL5W2ETGIbouo5RVrFMjVKxKKfrkvQTaFKTSOrfTJy2bYfV6hpr63Vq9UbaS7Q/m0ve+KKDhQcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Kubeconfig Diagram\" title=\"\" src=\"/static/4f530c98ecd2cb014bb56234dd64c4a3/c5bb3/Kubeconfig.png\" srcset=\"/static/4f530c98ecd2cb014bb56234dd64c4a3/04472/Kubeconfig.png 170w,\n/static/4f530c98ecd2cb014bb56234dd64c4a3/9f933/Kubeconfig.png 340w,\n/static/4f530c98ecd2cb014bb56234dd64c4a3/c5bb3/Kubeconfig.png 680w,\n/static/4f530c98ecd2cb014bb56234dd64c4a3/2c288/Kubeconfig.png 684w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"Ô∏è-kubeconfig-a-manual-creation-guide-and-its-interplay-with-code-classlanguage-textaws-eks-get-tokencode\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-kubeconfig-a-manual-creation-guide-and-its-interplay-with-code-classlanguage-textaws-eks-get-tokencode\" aria-label=\"Ô∏è kubeconfig a manual creation guide and its interplay with code classlanguage textaws eks get tokencode permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ò∏Ô∏è Kubeconfig: A Manual Creation Guide and its Interplay with <code class=\"language-text\">aws eks get-token</code></h2>\n<p><a href=\"https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubeconfig</a> serves as the backbone for <a href=\"https://kubernetes.io/docs/reference/kubectl/\" target=\"_blank\" rel=\"noopener noreferrer\">kubectl</a>, empowering it to locate the necessary details for cluster selection and communication with the API Server.</p>\n<p>By default, <code class=\"language-text\">kubectl</code> searches for a file named <code class=\"language-text\">config</code> within the <code class=\"language-text\">$HOME/.kube</code> directory, allowing seamless access to Kubernetes resources. In this article, we'll take a hands-on approach and walk you through the manual creation of <code class=\"language-text\">kubeconfig</code>. As we progress, we'll unravel the inner workings of this vital configuration file, exploring its synergy with <code class=\"language-text\">aws eks get-token</code>.</p>\n<p>By the end, you'll have a comprehensive understanding of how these components collaboratively enable secure and efficient interactions with AWS EKS clusters.</p>\n<h3 id=\"-prerequisites-for-this-blog\" style=\"position:relative;\"><a href=\"#-prerequisites-for-this-blog\" aria-label=\" prerequisites for this blog permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìú Prerequisites for this Blog</h3>\n<ul>\n<li>Basic familiarity with Kubernetes concepts and operations.</li>\n<li>Understanding of Amazon Web Services (AWS) and Elastic Kubernetes Service (EKS).</li>\n<li>Familiarity with the <code class=\"language-text\">kubectl</code> command-line tool.</li>\n<li>A functional AWS EKS Kubernetes cluster, to experiment with <code class=\"language-text\">kubeconfig</code> and <code class=\"language-text\">aws eks get-token</code>.</li>\n</ul>\n<h2 id=\"Ô∏è-hands-on-lab\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-hands-on-lab\" aria-label=\"Ô∏è hands on lab permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Hands-on Lab</h2>\n<p>In this part, we'll walk through each step, from creating the <code class=\"language-text\">kubeconfig</code> file to leveraging <code class=\"language-text\">aws eks get-token</code>, all while exploring the vital components that facilitate secure authentication and communication with your Kubernetes cluster.</p>\n<h3 id=\"step-1-remove-existing-kubeconfig-folder-Ô∏è\" style=\"position:relative;\"><a href=\"#step-1-remove-existing-kubeconfig-folder-%EF%B8%8F\" aria-label=\"step 1 remove existing kubeconfig folder Ô∏è permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 1: Remove Existing Kubeconfig Folder ‚öôÔ∏è</h3>\n<p>Delete the existing <code class=\"language-text\">~/.kube</code> folder created by <code class=\"language-text\">eksctl</code> to ensure a clean slate for <code class=\"language-text\">kubeconfig</code> setup.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-r</span> ~/.kube</code></pre></div>\n<h3 id=\"step-2-set-environment-variables-\" style=\"position:relative;\"><a href=\"#step-2-set-environment-variables-\" aria-label=\"step 2 set environment variables  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 2: Set Environment Variables üåç</h3>\n<p>Define <code class=\"language-text\">region</code>, <code class=\"language-text\">cluster_name</code>, and <code class=\"language-text\">account_id</code> as environment variables to simplify subsequent commands.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">region_code</span><span class=\"token operator\">=</span><span class=\"token string\">\"eu-west-1\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">cluster_name</span><span class=\"token operator\">=</span><span class=\"token string\">\"poc-cluster\"</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">account_id</span><span class=\"token operator\">=</span><span class=\"token string\">\"account_id\"</span></code></pre></div>\n<h3 id=\"step-3-retrieve-cluster-endpoint-\" style=\"position:relative;\"><a href=\"#step-3-retrieve-cluster-endpoint-\" aria-label=\"step 3 retrieve cluster endpoint  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 3: Retrieve Cluster Endpoint üîó</h3>\n<p>Obtain the cluster endpoint URL required for communication with the Kubernetes API server.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">cluster_endpoint</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>aws eks describe-cluster <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--region</span> $region_code <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--name</span> $cluster_name <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--query</span> <span class=\"token string\">\"cluster.endpoint\"</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--output</span> text<span class=\"token variable\">)</span></span></code></pre></div>\n<h3 id=\"step-4-get-certificate-authority-data-\" style=\"position:relative;\"><a href=\"#step-4-get-certificate-authority-data-\" aria-label=\"step 4 get certificate authority data  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 4: Get Certificate Authority Data üîê</h3>\n<p>Acquire the base64-encoded Certificate Authority (CA) Certificate data, essential for secure communication with the cluster.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">certificate_data</span><span class=\"token operator\">=</span><span class=\"token punctuation\">$(</span>aws eks describe-cluster <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--region</span> <span class=\"token variable\">$region_code</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--name</span> <span class=\"token variable\">$cluster_name</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--query</span> <span class=\"token string\">\"cluster.certificateAuthority.data\"</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--output</span>\naws eks describe-cluster <span class=\"token parameter variable\">--name</span> <span class=\"token variable\">$cluster_name</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--query</span> <span class=\"token string\">\"cluster.certificateAuthority.data\"</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--output</span> text <span class=\"token operator\">|</span> base64 <span class=\"token parameter variable\">--decode</span> <span class=\"token operator\">></span> eks.crt</code></pre></div>\n<p>Additionally, you can inspect the certificate details using OpenSSL to verify its authenticity:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">openssl x509 <span class=\"token parameter variable\">-in</span> eks.crt <span class=\"token parameter variable\">-text</span> <span class=\"token parameter variable\">-noout</span></code></pre></div>\n<p>Here, the <code class=\"language-text\">Issuer: CN=kubernetes</code> and <code class=\"language-text\">Subject: CN=kubernetes</code> indicate a self-signed certificate issued by EKS.</p>\n<h3 id=\"step-5-create-kubeconfig-directory-\" style=\"position:relative;\"><a href=\"#step-5-create-kubeconfig-directory-\" aria-label=\"step 5 create kubeconfig directory  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 5: Create Kubeconfig Directory üìÇ</h3>\n<p>Prepare the necessary <code class=\"language-text\">~/.kube</code> directory to store the <code class=\"language-text\">kubeconfig</code> file and other Kubernetes configuration files.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> ~/.kube</code></pre></div>\n<h3 id=\"step-6-create-kubeconfig-file-\" style=\"position:relative;\"><a href=\"#step-6-create-kubeconfig-file-\" aria-label=\"step 6 create kubeconfig file  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 6. Create Kubeconfig File üìù</h3>\n<p>Generate a configuration file using the following command, which creates the file <code class=\"language-text\">~/.kube/config</code> and automatically fills in all the necessary fields.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">''</span> KUBECONFIG <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\napiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: <span class=\"token variable\">$certificate_data</span>\n    server: <span class=\"token variable\">$cluster_endpoint</span>\n  name: arn:aws:eks:<span class=\"token variable\">$region_code</span>:<span class=\"token variable\">$account_id</span>:cluster/<span class=\"token variable\">$cluster_name</span>\ncontexts:\n- context:\n    cluster: arn:aws:eks:<span class=\"token variable\">$region_code</span>:<span class=\"token variable\">$account_id</span>:cluster/<span class=\"token variable\">$cluster_name</span>\n    user: arn:aws:eks:<span class=\"token variable\">$region_code</span>:<span class=\"token variable\">$account_id</span>:cluster/<span class=\"token variable\">$cluster_name</span>\n  name: arn:aws:eks:<span class=\"token variable\">$region_code</span>:<span class=\"token variable\">$account_id</span>:cluster/<span class=\"token variable\">$cluster_name</span>\ncurrent-context: arn:aws:eks:<span class=\"token variable\">$region_code</span>:<span class=\"token variable\">$account_id</span>:cluster/<span class=\"token variable\">$cluster_name</span>\nkind: Config\npreferences: {}\nusers:\n- name: arn:aws:eks:<span class=\"token variable\">$region_code</span>:<span class=\"token variable\">$account_id</span>:cluster/<span class=\"token variable\">$cluster_name</span>\n  user:\n    exec:\n      apiVersion: client.authentication.k8s.io/v1beta1\n      command: aws\n      args:\n        - --region\n        - <span class=\"token variable\">$region_code</span>\n        - eks\n        - get-token\n        - --cluster-name\n        - <span class=\"token variable\">$cluster_name</span>\n        # - \"-r\"\n        # - \"arn:aws:iam::<span class=\"token variable\">$account_id</span>:role/my-role\"\n      # env:\n        # - name: \"AWS_PROFILE\"\n        #   value: \"aws-profile\"\nEOF</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">${KUBECONFIG}</span>\"</span> <span class=\"token operator\">></span> ~/.kube/config</code></pre></div>\n<p>The client token, essential for authentication, will be obtained using the AWS CLI.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws eks get-token --cluster-name <span class=\"token variable\">$cluster_name</span></code></pre></div>\n<p>This command provides an <code class=\"language-text\">ExecCredential</code> object containing the required token for authentication.</p>\n<p>The token generated by <code class=\"language-text\">aws eks get-token</code> is a JSON Web Token (JWT) that follows a specific format. Each token begins with the prefix <code class=\"language-text\">k8s-aws-v1.</code>, followed by a base64-encoded string containing JSON data. When decoded, the token should resemble the following structure:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"kind\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ExecCredential\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"apiVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"client.authentication.k8s.io/v1beta1\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"expirationTimestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2023-08-06T12:09:00Z\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"token\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"base64_encoded_jwt_token_here\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>With the configuration file created and the client token obtained, our kubeconfig setup is complete.</p>\n<h3 id=\"step-7-verify-cluster-access-\" style=\"position:relative;\"><a href=\"#step-7-verify-cluster-access-\" aria-label=\"step 7 verify cluster access  permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 7. Verify Cluster Access üßë‚Äçüíª</h3>\n<p>Now that our kubeconfig is set up and the client token is obtained, let's validate the cluster access and ensure that everything is functioning correctly. We'll use the <code class=\"language-text\">kubectl</code> command-line tool to interact with the cluster.</p>\n<p>First, check the services available in the cluster:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get svc</code></pre></div>\n<p>Next, verify the list of nodes in the cluster:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get nodes</code></pre></div>\n<p>These commands will provide an overview of the services and nodes within the cluster, confirming successful access and interaction with your AWS EKS cluster. If everything is configured properly, you should see a list of services and nodes, indicating that you have established a successful connection to the Kubernetes cluster on AWS EKS.</p>\n<h3 id=\"step-8-understanding-the-mechanism-‚ìúÔ∏è\" style=\"position:relative;\"><a href=\"#step-8-understanding-the-mechanism-%E2%93%9C%EF%B8%8F\" aria-label=\"step 8 understanding the mechanism ‚ìúÔ∏è permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Step 8. Understanding the Mechanism ‚ìÇÔ∏è</h3>\n<p>Now that we have the IAM user details and the kubeconfig set up, let's explore how the Kubernetes cluster verifies RBAC permissions for these users. Kubernetes checks the IAM user or role credentials obtained earlier against its Role-Based Access Control (RBAC) system.</p>\n<p>To confirm the IAM users or roles added to the cluster's RBAC permissions, we'll examine the <code class=\"language-text\">aws-auth</code> ConfigMap. The ConfigMap stores the mappings between IAM entities and their corresponding Kubernetes roles and groups, defining the access levels for AWS users within the cluster.</p>\n<p>To view the contents of the <code class=\"language-text\">aws-auth</code> ConfigMap, run the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl describe configmap aws-auth <span class=\"token parameter variable\">-n</span> kube-system</code></pre></div>\n<p>This command will display detailed information about the <code class=\"language-text\">aws-auth</code> ConfigMap, shedding light on the IAM users and roles granted permissions in the Kubernetes cluster.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Name</span><span class=\"token punctuation\">:</span>         aws<span class=\"token punctuation\">-</span>auth\n<span class=\"token key atrule\">Namespace</span><span class=\"token punctuation\">:</span>    kube<span class=\"token punctuation\">-</span>system\n<span class=\"token key atrule\">Labels</span><span class=\"token punctuation\">:</span>       &lt;none<span class=\"token punctuation\">></span>\n<span class=\"token key atrule\">Annotations</span><span class=\"token punctuation\">:</span>  &lt;none<span class=\"token punctuation\">></span>\n<span class=\"token key atrule\">API Version</span><span class=\"token punctuation\">:</span>  v1\n<span class=\"token key atrule\">Kind</span><span class=\"token punctuation\">:</span>         ConfigMap\n<span class=\"token key atrule\">Data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">mapRoles</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">rolearn</span><span class=\"token punctuation\">:</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>123456789012<span class=\"token punctuation\">:</span>role/MyEKSWorkerRole\n      <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> system<span class=\"token punctuation\">:</span>node<span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>EC2PrivateDNSName<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">groups</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> system<span class=\"token punctuation\">:</span>bootstrappers\n        <span class=\"token punctuation\">-</span> system<span class=\"token punctuation\">:</span>nodes\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">rolearn</span><span class=\"token punctuation\">:</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>123456789012<span class=\"token punctuation\">:</span>user/xxxx\n      <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"system:node:{{EC2PrivateDNSName}}\"</span>\n      <span class=\"token key atrule\">groups</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> system<span class=\"token punctuation\">:</span>masters</code></pre></div>\n<p>In our exploration, we encountered an intriguing situation where a specific IAM entity had the ability to access the Amazon EKS cluster despite not having a corresponding entry in the <code class=\"language-text\">aws-auth</code> ConfigMap. This enigma led us to uncover an interesting mechanism provided by AWS.</p>\n<p>When you create an Amazon EKS cluster, the AWS Identity and Access Management (IAM) entity user or role, such as a federated user that creates the cluster, is automatically granted <code class=\"language-text\">system:masters</code> permissions in the cluster's role-based access control (RBAC) configuration in the Amazon EKS control plane. This IAM entity doesn't appear in any visible configuration, so make sure to keep track of which IAM entity originally created the cluster.</p>\n<p>However, this automated privilege assignment applies only to the IAM entity that initiated the cluster creation process. For additional users or roles requiring access, corresponding entries must be explicitly defined in the <code class=\"language-text\">aws-auth</code> ConfigMap.</p>\n<p>In our scenario, we observed that the identity of the user who obtained the token via the <code class=\"language-text\">kubectl</code> command (using <code class=\"language-text\">aws eks get-token</code> specified in the kubeconfig) did not have visible RBAC entries in the <code class=\"language-text\">aws-auth</code> ConfigMap. Nonetheless, AWS documentation clarified that this user had already been granted <code class=\"language-text\">system:masters</code> permissions by default, albeit in a concealed manner.</p>\n<h2 id=\"Ô∏è-conclusion\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-conclusion\" aria-label=\"Ô∏è conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üíÅüèª‚Äç‚ôÇÔ∏è Conclusion</h2>\n<p>This phenomenon highlights a control aspect that we must relinquish when using managed Kubernetes platforms like EKS. Understanding this behavior is essential for assessing the security posture of your Kubernetes cluster, even when certain aspects may not be immediately apparent in the configuration.</p>\n<p>By exploring these intricacies, we gain valuable insights into the underlying mechanics of <a href=\"https://aws.amazon.com/eks/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS EKS</a>, which enables us to make informed decisions to enhance the security and management of our Kubernetes clusters.</p>\n<p>We hope that you have found this blog post helpful. If you have any other tips or tricks that you would like to share, please leave a comment below.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":6,"rawMarkdownBody":"\n> **AWS EKS-Kubeconfig Connection üêã**\n\n## üìå Introduction\n\nOne of the key challenges of using EKS is authentication. EKS uses IAM to provide authentication to your K8s cluster. However, IAM tokens can be difficult to manage and use.\n\n[Kubeconfig](https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/) is a configuration file that stores information about K8s clusters, including their API server endpoints, certificates, and authentication information. Kubeconfig can be used to authenticate with EKS clusters, making it a more convenient and secure option than IAM tokens. This blog post will discuss how to use kubeconfig to authenticate with EKS clusters. We will also cover the basics of kubeconfig and how it works.\n\n![Kubeconfig Diagram](./Kubeconfig.png)\n\n## ‚ò∏Ô∏è Kubeconfig: A Manual Creation Guide and its Interplay with `aws eks get-token`\n\n[Kubeconfig](https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/) serves as the backbone for [kubectl](https://kubernetes.io/docs/reference/kubectl/), empowering it to locate the necessary details for cluster selection and communication with the API Server.\n\nBy default, `kubectl` searches for a file named `config` within the `$HOME/.kube` directory, allowing seamless access to Kubernetes resources. In this article, we'll take a hands-on approach and walk you through the manual creation of `kubeconfig`. As we progress, we'll unravel the inner workings of this vital configuration file, exploring its synergy with `aws eks get-token`.\n\nBy the end, you'll have a comprehensive understanding of how these components collaboratively enable secure and efficient interactions with AWS EKS clusters.\n\n### üìú Prerequisites for this Blog\n\n- Basic familiarity with Kubernetes concepts and operations.\n- Understanding of Amazon Web Services (AWS) and Elastic Kubernetes Service (EKS).\n- Familiarity with the `kubectl` command-line tool.\n- A functional AWS EKS Kubernetes cluster, to experiment with `kubeconfig` and `aws eks get-token`.\n\n## üõ†Ô∏è Hands-on Lab\n\nIn this part, we'll walk through each step, from creating the `kubeconfig` file to leveraging `aws eks get-token`, all while exploring the vital components that facilitate secure authentication and communication with your Kubernetes cluster.\n\n### Step 1: Remove Existing Kubeconfig Folder ‚öôÔ∏è\n\nDelete the existing `~/.kube` folder created by `eksctl` to ensure a clean slate for `kubeconfig` setup.\n\n```bash\nrm -r ~/.kube\n```\n\n### Step 2: Set Environment Variables üåç\n\nDefine `region`, `cluster_name`, and `account_id` as environment variables to simplify subsequent commands.\n\n```bash\nexport region_code=\"eu-west-1\"\nexport cluster_name=\"poc-cluster\"\nexport account_id=\"account_id\"\n```\n\n### Step 3: Retrieve Cluster Endpoint üîó\n\nObtain the cluster endpoint URL required for communication with the Kubernetes API server.\n\n```bash\ncluster_endpoint=$(aws eks describe-cluster \\\n--region $region_code \\\n--name $cluster_name \\\n--query \"cluster.endpoint\" \\\n--output text)\n```\n\n### Step 4: Get Certificate Authority Data üîê\n\nAcquire the base64-encoded Certificate Authority (CA) Certificate data, essential for secure communication with the cluster.\n\n```bash\ncertificate_data=$(aws eks describe-cluster \\\n--region $region_code \\\n--name $cluster_name \\\n--query \"cluster.certificateAuthority.data\" \\\n--output\naws eks describe-cluster --name $cluster_name \\\n--query \"cluster.certificateAuthority.data\" \\\n--output text | base64 --decode > eks.crt\n```\n\nAdditionally, you can inspect the certificate details using OpenSSL to verify its authenticity:\n\n```bash\nopenssl x509 -in eks.crt -text -noout\n```\n\nHere, the `Issuer: CN=kubernetes` and `Subject: CN=kubernetes` indicate a self-signed certificate issued by EKS.\n\n### Step 5: Create Kubeconfig Directory üìÇ\n\nPrepare the necessary `~/.kube` directory to store the `kubeconfig` file and other Kubernetes configuration files.\n\n```bash\nmkdir -p ~/.kube\n```\n\n### Step 6. Create Kubeconfig File üìù\n\nGenerate a configuration file using the following command, which creates the file `~/.kube/config` and automatically fills in all the necessary fields.\n\n```bash\n#!/bin/bash\nread -r -d '' KUBECONFIG <<EOF\napiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: $certificate_data\n    server: $cluster_endpoint\n  name: arn:aws:eks:$region_code:$account_id:cluster/$cluster_name\ncontexts:\n- context:\n    cluster: arn:aws:eks:$region_code:$account_id:cluster/$cluster_name\n    user: arn:aws:eks:$region_code:$account_id:cluster/$cluster_name\n  name: arn:aws:eks:$region_code:$account_id:cluster/$cluster_name\ncurrent-context: arn:aws:eks:$region_code:$account_id:cluster/$cluster_name\nkind: Config\npreferences: {}\nusers:\n- name: arn:aws:eks:$region_code:$account_id:cluster/$cluster_name\n  user:\n    exec:\n      apiVersion: client.authentication.k8s.io/v1beta1\n      command: aws\n      args:\n        - --region\n        - $region_code\n        - eks\n        - get-token\n        - --cluster-name\n        - $cluster_name\n        # - \"-r\"\n        # - \"arn:aws:iam::$account_id:role/my-role\"\n      # env:\n        # - name: \"AWS_PROFILE\"\n        #   value: \"aws-profile\"\nEOF\necho \"${KUBECONFIG}\" > ~/.kube/config\n```\n\nThe client token, essential for authentication, will be obtained using the AWS CLI.\n\n```bash\naws eks get-token --cluster-name $cluster_name\n```\n\nThis command provides an `ExecCredential` object containing the required token for authentication.\n\nThe token generated by `aws eks get-token` is a JSON Web Token (JWT) that follows a specific format. Each token begins with the prefix `k8s-aws-v1.`, followed by a base64-encoded string containing JSON data. When decoded, the token should resemble the following structure:\n\n```json\n{\n  \"kind\": \"ExecCredential\",\n  \"apiVersion\": \"client.authentication.k8s.io/v1beta1\",\n  \"status\": {\n    \"expirationTimestamp\": \"2023-08-06T12:09:00Z\",\n    \"token\": \"base64_encoded_jwt_token_here\"\n  }\n}\n```\n\nWith the configuration file created and the client token obtained, our kubeconfig setup is complete.\n\n### Step 7. Verify Cluster Access üßë‚Äçüíª\n\nNow that our kubeconfig is set up and the client token is obtained, let's validate the cluster access and ensure that everything is functioning correctly. We'll use the `kubectl` command-line tool to interact with the cluster.\n\nFirst, check the services available in the cluster:\n\n```bash\nkubectl get svc\n```\n\nNext, verify the list of nodes in the cluster:\n\n```bash\nkubectl get nodes\n```\n\nThese commands will provide an overview of the services and nodes within the cluster, confirming successful access and interaction with your AWS EKS cluster. If everything is configured properly, you should see a list of services and nodes, indicating that you have established a successful connection to the Kubernetes cluster on AWS EKS.\n\n### Step 8. Understanding the Mechanism ‚ìÇÔ∏è\n\nNow that we have the IAM user details and the kubeconfig set up, let's explore how the Kubernetes cluster verifies RBAC permissions for these users. Kubernetes checks the IAM user or role credentials obtained earlier against its Role-Based Access Control (RBAC) system.\n\nTo confirm the IAM users or roles added to the cluster's RBAC permissions, we'll examine the `aws-auth` ConfigMap. The ConfigMap stores the mappings between IAM entities and their corresponding Kubernetes roles and groups, defining the access levels for AWS users within the cluster.\n\nTo view the contents of the `aws-auth` ConfigMap, run the following command:\n\n```bash\nkubectl describe configmap aws-auth -n kube-system\n```\n\nThis command will display detailed information about the `aws-auth` ConfigMap, shedding light on the IAM users and roles granted permissions in the Kubernetes cluster.\n\n```yaml\nName:         aws-auth\nNamespace:    kube-system\nLabels:       <none>\nAnnotations:  <none>\nAPI Version:  v1\nKind:         ConfigMap\nData:\n  mapRoles:\n    - rolearn: arn:aws:iam::123456789012:role/MyEKSWorkerRole\n      username: system:node:{{EC2PrivateDNSName}}\n      groups:\n        - system:bootstrappers\n        - system:nodes\n    - rolearn: arn:aws:iam::123456789012:user/xxxx\n      username: \"system:node:{{EC2PrivateDNSName}}\"\n      groups:\n        - system:masters\n```\n\nIn our exploration, we encountered an intriguing situation where a specific IAM entity had the ability to access the Amazon EKS cluster despite not having a corresponding entry in the `aws-auth` ConfigMap. This enigma led us to uncover an interesting mechanism provided by AWS.\n\nWhen you create an Amazon EKS cluster, the AWS Identity and Access Management (IAM) entity user or role, such as a federated user that creates the cluster, is automatically granted `system:masters` permissions in the cluster's role-based access control (RBAC) configuration in the Amazon EKS control plane. This IAM entity doesn't appear in any visible configuration, so make sure to keep track of which IAM entity originally created the cluster.\n\nHowever, this automated privilege assignment applies only to the IAM entity that initiated the cluster creation process. For additional users or roles requiring access, corresponding entries must be explicitly defined in the `aws-auth` ConfigMap.\n\nIn our scenario, we observed that the identity of the user who obtained the token via the `kubectl` command (using `aws eks get-token` specified in the kubeconfig) did not have visible RBAC entries in the `aws-auth` ConfigMap. Nonetheless, AWS documentation clarified that this user had already been granted `system:masters` permissions by default, albeit in a concealed manner.\n\n## üíÅüèª‚Äç‚ôÇÔ∏è Conclusion\n\nThis phenomenon highlights a control aspect that we must relinquish when using managed Kubernetes platforms like EKS. Understanding this behavior is essential for assessing the security posture of your Kubernetes cluster, even when certain aspects may not be immediately apparent in the configuration.\n\nBy exploring these intricacies, we gain valuable insights into the underlying mechanics of [AWS EKS](https://aws.amazon.com/eks/), which enables us to make informed decisions to enhance the security and management of our Kubernetes clusters.\n\nWe hope that you have found this blog post helpful. If you have any other tips or tricks that you would like to share, please leave a comment below.\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  _**Until next time üéâ**_\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1096},"frontmatter":{"id":"0ff148ada0db87ce5e2eaccf","path":"/blog/kubeconfig-eks-authentication-guide-under-the-hood/","humanDate":"Oct 19, 2024","fullDate":"2024-10-19","title":"Discover Kubeconfig: A guide to EKS authentication with AWS ü§î","keywords":["Kubeconfig","EKS Authentication","AWS","Kubernetes","Cloud Security"],"excerpt":"Get to know the secrets of Kubeconfig and EKS authentication with AWS","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADj0lEQVR42nVU+2/aVhTmP9u/MG3SpkndL5PWLF27dumWtTRN02ZJ2FZl66asUtO8Ex7llachCZAXUEqgNeFVCDKGgHnFjsE22MY4O2CaaJF6dXV97vU5557z3e8c1fmHIZ/LMC+2Zzztzvm28F2CLX5MR3X+/yHJUrqaRTDHdFi7nLLZcdf0kdaS3IidJnhJuKJ8acwITLB4pItbZyN6uDDHFhoCz7J1kqcOcr6FqBGmJ+8nG2eXxkoQXLOuj1u1cUvoNErzVVluHzs93hdaHQitVosT63Hq2JpCZsK6PFtQUlApeqFKdDFuYhosSdKKNqz23f1/ZufauUgSrNUqw7LcRnp7G9/rGisfY2L1NREA+YehJwf+wxrD6tfWfx7V9Nx/MGUwBo4iFZLqHXiYzuROuPxMWF8TmG7O2VpuJqI7rZMgl0ny6zt9twYfZ/J5s802PjkliOLE/MInX3wFTkGBbwq6uCVYDHWNN/EdBHMqT0CUSmMTz3vVDyOJ5N4bP+QsCOJPI2OjE8/XnS7lufyFd/r3y01ZUgE8MxE9RmcUAOdM5thxiuXqA0/Hr99TX7vT1z+qefMOhV8TcwuFcrlNgQatmKh8RMCUXBOaIjiet1hvDg7NmswbTlff8MiX39/qH/vts+u9y5tbJsSm/uMp3G9EbCR1tpfzrqY2Va+JQ1NyXZSaG66dl3rD7cfD82bLmsN599eRT7/97ubgo897bqxuO4wIMvTs76E/n5ntdpKi3XmfNYmoKB5i0AGrFNj/XVgEqKu12qPxv3ruPbh2u+8Xze++TtiIaycUj4NA8zUg0jGFtQGzp10wFcCyROGEKNxQD/hQ1H0YmNQZGI775m7/QfBtmmWAc6ATKIYA8Gar2TaGa8ET1eEdRdOvvB7Hh6vGX7wEATvJ2QMBNIODDDYANQDefSpJbhner/iL7f2PT4a9KBqgKQTHVlFU73YHK6X9Qp6o1dQaDYaf5OsEMBTeqMPtDj3flsIQCcfXyVNacZdlmZVYdDF4GKXIWidaugoZNGy4cyu92wGoXRhyp6TYpZjZkFiJUQlW5BSPOx7v5JJWobogiVgVX8e2p46WcgxxyW1lQCQ+IrgYM81HXu1mPaV6hRdEKElaaJ9Dwc1FDK6su8iVL/rB1WYgtsQElVpJ2aAZIGmHI7s/HdZB2aDlCJTtR5vBlRZT5irOzD60FCibltzq6nTGhfF/yjT4Gbq+UBsAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/ef4819fc74935dd769469ad81e2b06b3/c7240/kubeconfig-cover.png","srcSet":"/static/ef4819fc74935dd769469ad81e2b06b3/c7240/kubeconfig-cover.png 600w","sizes":"100vw"},"sources":[{"srcSet":"/static/ef4819fc74935dd769469ad81e2b06b3/6d09e/kubeconfig-cover.webp 600w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/aws-eks-open-source-monitoring-stack-guide/","title":"AWS EKS Monitoring Stack: Grafana, Prometheus, AlertManager, Promtail, and Loki","date":"2024-10-19 11:00:00"},"excerpt":"Monitoring AWS EKS with performant open source tools üîñ Introduction Amazon Elastic Kubernetes Service (EKS) is a managed Kubernetes service‚Ä¶"},"nextThought":{"frontmatter":{"path":"/blog/eks-aws-cloudwatch-container-insights/","title":"Casting light on EKS: exploring AWS CloudWatch Container Insights for kubernetes cluster metrics and logs aggregation","date":"2024-10-18 20:06:00"},"excerpt":"Proactive EKS cluster monitoring üîñ Introduction Kubernetes on AWS is a great managed container orchestration platform, but it can be‚Ä¶"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}