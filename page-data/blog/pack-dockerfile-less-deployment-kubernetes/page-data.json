{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/pack-dockerfile-less-deployment-kubernetes/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Build your OCI images using Buildpacks</strong></p>\n</blockquote>\n<h2 id=\"‚ÑπÔ∏è-overview\" style=\"position:relative;\"><a href=\"#%E2%84%B9%EF%B8%8F-overview\" aria-label=\"‚ÑπÔ∏è overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ÑπÔ∏è Overview</h2>\n<p>In the ecosystem of containerization, Docker has long been the de facto standard for building and deploying applications. However, the rise of open standards such as the <a href=\"https://opencontainers.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Open Container Initiative (OCI)</a> has paved the way for alternative approaches that offer greater flexibility and simplicity.</p>\n<p>One such approach is <a href=\"https://buildpacks.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Cloud Native Buildpacks (CNB)</a>, a project that aims to unify the buildpack ecosystem and provide a platform-agnostic way to build OCI images. CNB is implemented by a number of tools, including <a href=\"https://buildpacks.io/docs/tools/pack/\" target=\"_blank\" rel=\"noopener noreferrer\">Pack</a>, a CLI that enables users to build, manage, and deploy applications using buildpacks.</p>\n<p>In this blog post, we will explore how Pack can be used to achieve Dockerfile-less deployment to Kubernetes. We will discuss the benefits of using buildpacks over Dockerfiles, and we will demonstrate how to use Pack to build and deploy a simple Node.js application to Kubernetes.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVR42q1Ry07EMAzs//8NR24ckPgBOIIAoaXbbZO0Tdo8nAxOWqruHoCVsORDHHs846nwz1Fd0xxTgvcRqjdQg8E0OWhjMc0ezhES//8MyA37CBThQ8TLW43n1wM6MaJuJITUmG1AjCtgRk4XwzmIS/tqHnCeEBjUuQC7pvc5qSgogEIO+Gy6c3Kc97dPGD/6rbBIDoVpP05oOoVT18OwdOJlG+CxlTgc22VTCCAeUHrC3c0Dusd3RO7x3jMbz8OWe6jcLoMJpWHtsiSLrDKTEKhkjHGTP88OreohtSm3zDXi/9m6Ik8og/ok0bQKo7YMmP5gyqXLMa0qqNyuFUNxvNz1m+FvJu+9WlguTHMGWoDKm+L1DLclOHd///4C/GkTJC5REVwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pack\" title=\"\" src=\"/static/915b0257c814fdbe81ddab643c019f45/c5bb3/pack.png\" srcset=\"/static/915b0257c814fdbe81ddab643c019f45/04472/pack.png 170w,\n/static/915b0257c814fdbe81ddab643c019f45/9f933/pack.png 340w,\n/static/915b0257c814fdbe81ddab643c019f45/c5bb3/pack.png 680w,\n/static/915b0257c814fdbe81ddab643c019f45/b12f7/pack.png 1020w,\n/static/915b0257c814fdbe81ddab643c019f45/b5a09/pack.png 1360w,\n/static/915b0257c814fdbe81ddab643c019f45/29007/pack.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-oci-image-standard-a-foundation-for-portable-and-interoperable-containerization\" style=\"position:relative;\"><a href=\"#-oci-image-standard-a-foundation-for-portable-and-interoperable-containerization\" aria-label=\" oci image standard a foundation for portable and interoperable containerization permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üì¶ OCI Image Standard: A Foundation for Portable and Interoperable Containerization</h2>\n<p>OCI images, or Open Container Initiative images, are a standard format for container images. They are defined by the Open Container Initiative (OCI), a non-profit organization that aims to create open standards for containerization.</p>\n<p>OCI images are composed of a manifest, a set of filesystem layers, and a configuration. The manifest lists the layers that make up the image, as well as other metadata such as the image name and the author. The filesystem layers are stored as tarballs, and they contain the files that make up the image. The configuration file contains information about the image, such as the environment variables that should be set when the image is run.</p>\n<p>OCI images are designed to be portable across different container runtimes. This means that an OCI image can be run on any runtime that supports the OCI image format. Some popular container runtimes that support OCI images include <a href=\"https://www.docker.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker</a>, <a href=\"https://cri-o.io/\" target=\"_blank\" rel=\"noopener noreferrer\">CRI-O</a>, and <a href=\"https://containerd.io/\" target=\"_blank\" rel=\"noopener noreferrer\">containerd</a>.</p>\n<p>OCI images are the de facto standard for container images. They are used by a wide variety of organizations, including Google, Amazon, and Microsoft.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 47.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHZWxIowf/EABoQAAEFAQAAAAAAAAAAAAAAAAABAhASITH/2gAIAQEAAQUCfhUTk//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAEhAAIgMlH/2gAIAQEABj8CDL5NrY//xAAYEAEBAQEBAAAAAAAAAAAAAAARAQAgMf/aAAgBAQABPyG0oeJi3BEU4//aAAwDAQACAAMAAAAQYw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEgYTFx8P/aAAgBAQABPxAxLvQfMu7txGEhVvLh/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"oci\" title=\"\" src=\"/static/552b1728e6ea5d491d61d5166dfe8f0c/7bf67/oci.jpg\" srcset=\"/static/552b1728e6ea5d491d61d5166dfe8f0c/651be/oci.jpg 170w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/d30a3/oci.jpg 340w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/7bf67/oci.jpg 680w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/990cb/oci.jpg 1020w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/c44b8/oci.jpg 1360w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/b17f8/oci.jpg 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<hr>\n<h2 id=\"-pack-a-swift-solution-for-docker-image-creation\" style=\"position:relative;\"><a href=\"#-pack-a-swift-solution-for-docker-image-creation\" aria-label=\" pack a swift solution for docker image creation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Pack: A Swift Solution for Docker Image Creation</h2>\n<p>Pack is a convenient tool for swiftly constructing Docker images for your projects without the need for individual Dockerfiles. This enables you to efficiently Dockerize numerous projects without having to write Dockerfiles for each one.</p>\n<p>Buildpacks automatically identify the programming language of your project as well as any required dependencies, such as <code class=\"language-text\">pom.xml</code>, <code class=\"language-text\">build.gradle</code>, or <code class=\"language-text\">requirements.txt</code> files. All you have to do for each project is run a single command, which makes it simple to incorporate into your CI/CD pipeline for automated Docker image creation.</p>\n<hr>\n<h3 id=\"-benefits-of-using-buildpacks-over-dockerfiles\" style=\"position:relative;\"><a href=\"#-benefits-of-using-buildpacks-over-dockerfiles\" aria-label=\" benefits of using buildpacks over dockerfiles permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Benefits of Using Buildpacks Over Dockerfiles</h3>\n<p>There are a number of benefits to using buildpacks over Dockerfiles. These include:</p>\n<ul>\n<li><strong>Simplicity</strong>: Buildpacks are designed to be simpler to use than Dockerfiles. They are based on the idea of detecting the programming language and project structure of an application, and then applying a series of build steps that are appropriate for that language and project. This means that users do not need to have a deep understanding of how to create Dockerfiles.</li>\n<li><strong>Flexibility</strong>: Buildpacks are more flexible than Dockerfiles. They can be used to build a wider range of images, and they can be more easily adapted to changes in the underlying application. For example, if a buildpack is updated to support a new version of a programming language, all images that are built using that buildpack will automatically benefit from the update.</li>\n<li><strong>Portability</strong>: Buildpacks are portable across different platforms. This means that an image that is built using a buildpack can be deployed to any platform that supports OCI images.</li>\n</ul>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 79.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAdtFQZSf/8QAGhAAAgIDAAAAAAAAAAAAAAAAATEAAhIyQv/aAAgBAQABBQLqyxg2Kqv/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8BZH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAEDFB/9oACAEBAAY/AtVK/wD/xAAaEAACAwEBAAAAAAAAAAAAAAABEQAhMWFB/9oACAEBAAE/IQdLEBpLklrgXNn48lTp8mNLk//aAAwDAQACAAMAAAAQuN//xAAYEQADAQEAAAAAAAAAAAAAAAAAAREhQf/aAAgBAwEBPxDjqLbD/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERIUH/2gAIAQIBAT8Q2iWf/8QAGhABAQADAQEAAAAAAAAAAAAAAREAITFBcf/aAAgBAQABPxBL7gc1iTC1OfcRHaunE34E8o9CY67ksMuOtvepsc//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Benefits\" title=\"\" src=\"/static/7ad030aa1c03089c29a3d491b47156c0/04df2/Benefits.jpg\" srcset=\"/static/7ad030aa1c03089c29a3d491b47156c0/651be/Benefits.jpg 170w,\n/static/7ad030aa1c03089c29a3d491b47156c0/d30a3/Benefits.jpg 340w,\n/static/7ad030aa1c03089c29a3d491b47156c0/04df2/Benefits.jpg 522w\" sizes=\"(max-width: 522px) 100vw, 522px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"hands-on\" style=\"position:relative;\"><a href=\"#hands-on\" aria-label=\"hands on permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-on</h2>\n<p>To illustrate the capabilities of buildpacks, let's consider a basic Node.js application as an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">myapp\n‚îú‚îÄ‚îÄ package.json\n‚îî‚îÄ‚îÄ src\n    ‚îî‚îÄ‚îÄ index.js</code></pre></div>\n<p>To containerize our application in a container, we typically create a Dockerfile. This file contains the essential instructions for constructing an environment that will be used to execute our application.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:latest</span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /app</span>\n<span class=\"token comment\"># add our code to our future image</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> package.json /app/package.json</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> src/ /app/src</span>\n<span class=\"token comment\"># launch npm which will install the Node.js dependencies of the application</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm install</span>\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> <span class=\"token string\">'npm start'</span></span></code></pre></div>\n<p>Once built, we can inspect our image with <code class=\"language-text\">docker inspect</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">(...)\n  <span class=\"token property\">\"Config\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Hostname\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Domainname\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"User\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"AttachStdin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"AttachStdout\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"AttachStderr\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Tty\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"OpenStdin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"StdinOnce\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"NODE_VERSION=16.17.0\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"YARN_VERSION=1.22.19\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Cmd\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"-c\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"npm start\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Image\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sha256:ca5108589bcee5007319db215f0f22048fb7b75d4d6c16e6310ef044c58218c0\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Volumes\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"WorkingDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/app\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Entrypoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"docker-entrypoint.sh\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"OnBuild\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Labels\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  (...)\n      <span class=\"token property\">\"Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"layers\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Layers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"sha256:20833a96725ec17c9ab15711400e43781a7b7fe31d23fc6c78a7cca478935d33\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:07b905e91599cd0251bd575fb77d0918cd4f40b64fa7ea50ff82806c60e2ba61\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:5cbe2d191b8f91d974fbba38b5ddcbd5d4882e715a9e008061ab6d2ec432ef7b\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:47b6660a2b9bb2091a980c361a1c15b2a391c530877961877138fffc50d2f6f7\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:1e69483976e43c657172c073712c3d741245f9141fb560db5af7704aee95114c\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:a51886a0928017dc307b85b85c6fb3f9d727b5204ea944117ce59c4b4acc5e05\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:ba9804f7abedf8ddea3228539ae12b90966272d6eb02fd2c57446e44d32f1b70\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:c77311ff502e318598cc7b6c03a5bd25182f7f6f0352d9b68fad82ed7b4e8c26\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:93a6676fffe0813e4ca03cae4769300b539b66234e95be66d86c3ac7748c1321\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:3cf3c6f03984f8a31c0181feb75ac056fc2bd56ef8282af9a72dafd1b6bb0c41\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:02dacaf7071cc5792c28a4cf54141b7058ee492c93f04176f8f3f090c42735eb\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:85152f012a08f63dfaf306c01ac382c1962871bf1864b357549899ec2fa7385d\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:8ceb0bd5afef8a5fa451f89273974732cd0c89dac2c80ff8b7855531710fbc49\"</span>\n      <span class=\"token punctuation\">]</span>\n  (...)</code></pre></div>\n<p>We can see a configuration block with:</p>\n<ul>\n<li>The environment variables</li>\n<li>The entrypoint command, the default command</li>\n<li>The working directory</li>\n<li>The user of the image</li>\n</ul>\n<p>And a second block Layers with a list of checksums. Each checksum corresponds to a compressed archive file (.tar.gz). All these layers applied on top of each other build a complete filesystem.</p>\n<h3 id=\"Ô∏è-how-docker-builds-images\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-how-docker-builds-images\" aria-label=\"Ô∏è how docker builds images permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèóÔ∏è How Docker builds images</h3>\n<p>To comprehend how Docker constructs an image, it is essential to be familiar with the <code class=\"language-text\">docker commit</code> command. This command operates on a running container and creates an image from the state of that container.</p>\n<p>This mechanism is utilized, for instance, in the <code class=\"language-text\">RUN npm install</code> instruction:</p>\n<ol>\n<li>Docker starts an intermediate container.</li>\n<li>Within this container, the <code class=\"language-text\">npm install</code> command is executed.</li>\n<li>Once the command is complete, Docker commits the container, and the difference between the previous image allows for the creation of an additional layer, resulting in a new intermediate image.</li>\n</ol>\n<p>However, <code class=\"language-text\">docker build</code> has one significant drawback: by default, the build is not reproducible. Two consecutive <code class=\"language-text\">docker builds</code> with the same Dockerfile will not necessarily produce the same layers, and therefore the same checksums. This phenomenon is primarily caused by timestamps. Each file in a standard Linux filesystem has a creation date, a last modification date, and a last access date. Additionally, the image has a timestamp that is embedded in the image and alters the checksum. This makes it very difficult to isolate our different layers, and it is challenging to logically associate an operation in our Dockerfile with a layer in our final image.</p>\n<p>For modifications to the base image (the <code class=\"language-text\">FROM</code> instruction, for security reasons, for example), Docker must perform a complete build. Additionally, uploading this update to our registry necessitates sending all the layers. Depending on the size of our image, this can lead to a significant amount of traffic on each of our machines hosting our image and wishing to update.</p>\n<p>An image is simply a stack of layers on top of each other, along with configuration files. However, Docker (and its Dockerfile) is not the only way to build an image. Buildpacks offer a different principle for building images. Buildpacks is a project incubated at the <a href=\"https://www.cncf.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Cloud Native Computing Foundation</a>.</p>\n<h2 id=\"-how-buildpack-builds-images\" style=\"position:relative;\"><a href=\"#-how-buildpack-builds-images\" aria-label=\" how buildpack builds images permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üáµüá∏ How buildpack builds images</h2>\n<p>A buildpack is a set of executable scripts that will allow you to build and launch your application. A buildpack is made of 3 components:</p>\n<ol>\n<li><code class=\"language-text\">buildpack.toml</code>: the metadata of your buildpack.</li>\n<li><code class=\"language-text\">bin/detect</code>: script that determines if the buildpack applies to your application.</li>\n<li><code class=\"language-text\">bin/build</code>: script launching the build sequence of the application.</li>\n</ol>\n<p>Building your application means running buildpacks one after the other. To do this we use a builder. A builder is an image including a whole set of buildpacks, a lifecycle, and a reference to a very light run image in which we will integrate our application. The build image/run image couple is called a stack.</p>\n<p>Coming back to our Node.js application, Buildpack will only use the information in the <code class=\"language-text\">package.json</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"myapp\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.1\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"express\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^4.18.1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node src/index.js\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"engines\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"16\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This is all we need to build an image containing our application with buildpacks:</p>\n<ul>\n<li>The base image (the <code class=\"language-text\">FROM</code> of the Dockerfile) will be the one specified in the stack.</li>\n<li>The buildpacks lifecycle detects a <code class=\"language-text\">package.json</code> and thus starts the installation process of Node.js and the dependencies.</li>\n<li>The version of Node will be the version specified in the <code class=\"language-text\">package.json</code>.</li>\n<li>The default command will be <code class=\"language-text\">node src/index.js</code> because it is the start command of the <code class=\"language-text\">package.json</code>.</li>\n</ul>\n<p>The only command you need to know to use buildpacks is the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">pack build myapp <span class=\"token parameter variable\">--builder</span> gcr.io/buildpacks/builder:v1</code></pre></div>\n<p>Here we use the builder provided by Google <code class=\"language-text\">gcr.io/buildpacks/builder:v1</code>. Other builders are available (see <code class=\"language-text\">pack stack suggest</code>) or you can build your own! It is then directly possible to launch our application.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">docker</span> run myapp\n<span class=\"token operator\">></span> myapp@0.0.1 start\n<span class=\"token operator\">></span> <span class=\"token function\">node</span> src/index.js\nExample app listening on port <span class=\"token number\">3000</span></code></pre></div>\n<h3 id=\"-advantages-of-using-buildpacks\" style=\"position:relative;\"><a href=\"#-advantages-of-using-buildpacks\" aria-label=\" advantages of using buildpacks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Advantages of using buildpacks</h3>\n<p>The advantages of using buildpacks include:</p>\n<ul>\n<li>The absence of a Dockerfile. The developer can concentrate on his code only.</li>\n<li>The respect of good image building practices, in terms of security, limitation of the number and size of layers. This is the responsibility of the buildpack designer, not the developer.</li>\n<li>Caching is native, whether it's the binaries to be installed or the software libraries.</li>\n<li>Uses your organization's best practices if you create your own buildpack (use of internal mirrors, code analysis‚Ä¶).</li>\n<li>Each layer of the final image is logically linked with the dependencies it brings.</li>\n<li>Each operation of a buildpack touches only a restricted area (a folder with the name of the buildpack in the run image).</li>\n<li>Buildpacks allow obtaining reproducible builds with less effort.</li>\n<li>The files copied into the image all have a timestamp with a value of 0.</li>\n<li>It is however necessary that the intermediate build steps (e.g. compilation of Java code) must be idempotent.</li>\n<li>This allows launching an operation that buildpacks calls 'rebase'.</li>\n</ul>\n<h3 id=\"-image-rebasing-with-buildpacks\" style=\"position:relative;\"><a href=\"#-image-rebasing-with-buildpacks\" aria-label=\" image rebasing with buildpacks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîÑ Image rebasing with Buildpacks</h3>\n<p>Image rebasing is the ability to swap out multiple layers of an image without having to modify the upper layers. This is particularly useful when updating the base image of our run image.</p>\n<p>As an example, let's consider a Node.js application (which I'm simplifying for the sake of brevity):</p>\n<p>At build time, Buildpacks rely on the lightest possible run image, adding layer by layer:</p>\n<ul>\n<li>A layer containing the Node binaries.</li>\n<li>A layer containing the <code class=\"language-text\">node_modules</code> (dependencies) of our application.</li>\n</ul>\n<p>Note that the <code class=\"language-text\">npm</code> binary is not needed in our run image. It will not be included, but it is used in our build image to install the <code class=\"language-text\">node_modules</code> that will be integrated into our run image.</p>\n<p>If our container is deployed in Kubernetes and a flaw is discovered in its base image, it is necessary to update the base image. With Docker, this would require rebuilding our image completely, and uploading our entire new image to our registry, and each Kubernetes worker would have to download this new image.</p>\n<p>This is not necessary with Buildpacks. Only the layers related to the base image need to be uploaded. For example, we can compare two OCI images, one with an Ubuntu 18.04 base image and the other with an Ubuntu 20.04 base image. The first 3 layers (in blue) are the Ubuntu-related layers. The next layers (in red) are the layers added by Buildpacks. These layers are identical. This behavior is possible in Docker (but complex to set up), but it is the default behavior with Buildpacks.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnklEQVR42iXGzw6CIACAcd+hi6WkkMIUcnLIBGv+ydahdSjRWyWu93+GyLZv334WoZymFY7zMMpxLMI5A4iznTjV7SWkTcQqTEtCSxyXBrMrRPYWh8ErykcqNJWaSU3FOPcm2TOr2+I4QD6xYmLSXP9gLj/bwy3gVuIBBZ0egWEDFHJNxgqBbm33adJIebUXHXQfvnP3VuZ/KN85u8svZPglZfFXF+wAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"change\" title=\"\" src=\"/static/e814e2c5621d360f2f8e23d40a9068bd/a6d36/change.png\" srcset=\"/static/e814e2c5621d360f2f8e23d40a9068bd/04472/change.png 170w,\n/static/e814e2c5621d360f2f8e23d40a9068bd/9f933/change.png 340w,\n/static/e814e2c5621d360f2f8e23d40a9068bd/a6d36/change.png 650w\" sizes=\"(max-width: 650px) 100vw, 650px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>If you want to easily implement good image creation practices for your containerized applications, Buildpacks is an excellent choice to consider. It easily integrates with your CI/CD via projects like <a href=\"https://github.com/pivotal/kpack\" target=\"_blank\" rel=\"noopener noreferrer\">kpack</a>. It may even already be integrated into your DevOps infrastructure as Buildpacks is the one behind <a href=\"https://docs.gitlab.com/ee/topics/autodevops/\" target=\"_blank\" rel=\"noopener noreferrer\">Gitlab's Auto DevOps feature</a>.</p>\n<h2 id=\"-closing-thoughts\" style=\"position:relative;\"><a href=\"#-closing-thoughts\" aria-label=\" closing thoughts permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Closing thoughts</h2>\n<p>Buildpacks offer a compelling alternative to Dockerfiles for building container images. They are simpler to use, more flexible, and more portable. Additionally, Buildpacks provide a number of advantages over Dockerfiles, such as reproducible builds and image rebasing.</p>\n<p>As the containerization landscape continues to evolve, Buildpacks are poised to play a major role in the future of container image creation. If you are looking for a way to simplify and streamline your containerization workflow, then Buildpacks are a great option to consider.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":10,"rawMarkdownBody":"\n> **Build your OCI images using Buildpacks**\n\n## ‚ÑπÔ∏è Overview\n\nIn the ecosystem of containerization, Docker has long been the de facto standard for building and deploying applications. However, the rise of open standards such as the [Open Container Initiative (OCI)](https://opencontainers.org/) has paved the way for alternative approaches that offer greater flexibility and simplicity.\n\nOne such approach is [Cloud Native Buildpacks (CNB)](https://buildpacks.io/), a project that aims to unify the buildpack ecosystem and provide a platform-agnostic way to build OCI images. CNB is implemented by a number of tools, including [Pack](https://buildpacks.io/docs/tools/pack/), a CLI that enables users to build, manage, and deploy applications using buildpacks.\n\nIn this blog post, we will explore how Pack can be used to achieve Dockerfile-less deployment to Kubernetes. We will discuss the benefits of using buildpacks over Dockerfiles, and we will demonstrate how to use Pack to build and deploy a simple Node.js application to Kubernetes.\n\n![pack](./pack.png)\n\n## üì¶ OCI Image Standard: A Foundation for Portable and Interoperable Containerization\n\nOCI images, or Open Container Initiative images, are a standard format for container images. They are defined by the Open Container Initiative (OCI), a non-profit organization that aims to create open standards for containerization.\n\nOCI images are composed of a manifest, a set of filesystem layers, and a configuration. The manifest lists the layers that make up the image, as well as other metadata such as the image name and the author. The filesystem layers are stored as tarballs, and they contain the files that make up the image. The configuration file contains information about the image, such as the environment variables that should be set when the image is run.\n\nOCI images are designed to be portable across different container runtimes. This means that an OCI image can be run on any runtime that supports the OCI image format. Some popular container runtimes that support OCI images include [Docker](https://www.docker.com/), [CRI-O](https://cri-o.io/), and [containerd](https://containerd.io/).\n\nOCI images are the de facto standard for container images. They are used by a wide variety of organizations, including Google, Amazon, and Microsoft.\n\n![oci](./oci.jpg)\n\n---\n\n## üöÄ Pack: A Swift Solution for Docker Image Creation\n\nPack is a convenient tool for swiftly constructing Docker images for your projects without the need for individual Dockerfiles. This enables you to efficiently Dockerize numerous projects without having to write Dockerfiles for each one.\n\nBuildpacks automatically identify the programming language of your project as well as any required dependencies, such as `pom.xml`, `build.gradle`, or `requirements.txt` files. All you have to do for each project is run a single command, which makes it simple to incorporate into your CI/CD pipeline for automated Docker image creation.\n\n---\n\n### üåü Benefits of Using Buildpacks Over Dockerfiles\n\nThere are a number of benefits to using buildpacks over Dockerfiles. These include:\n\n- **Simplicity**: Buildpacks are designed to be simpler to use than Dockerfiles. They are based on the idea of detecting the programming language and project structure of an application, and then applying a series of build steps that are appropriate for that language and project. This means that users do not need to have a deep understanding of how to create Dockerfiles.\n- **Flexibility**: Buildpacks are more flexible than Dockerfiles. They can be used to build a wider range of images, and they can be more easily adapted to changes in the underlying application. For example, if a buildpack is updated to support a new version of a programming language, all images that are built using that buildpack will automatically benefit from the update.\n- **Portability**: Buildpacks are portable across different platforms. This means that an image that is built using a buildpack can be deployed to any platform that supports OCI images.\n\n![Benefits](./Benefits.jpg)\n\n##  Hands-on\n\nTo illustrate the capabilities of buildpacks, let's consider a basic Node.js application as an example:\n\n```shell\nmyapp\n‚îú‚îÄ‚îÄ package.json\n‚îî‚îÄ‚îÄ src\n    ‚îî‚îÄ‚îÄ index.js\n```\n\nTo containerize our application in a container, we typically create a Dockerfile. This file contains the essential instructions for constructing an environment that will be used to execute our application.\n\n```dockerfile\nFROM node:latest\nWORKDIR /app\n# add our code to our future image\nCOPY package.json /app/package.json\nCOPY src/ /app/src\n# launch npm which will install the Node.js dependencies of the application\nRUN npm install\nCMD 'npm start'\n```\n\nOnce built, we can inspect our image with `docker inspect`:\n\n```json\n(...)\n  \"Config\": {\n      \"Hostname\": \"\",\n      \"Domainname\": \"\",\n      \"User\": \"\",\n      \"AttachStdin\": false,\n      \"AttachStdout\": false,\n      \"AttachStderr\": false,\n      \"Tty\": false,\n      \"OpenStdin\": false,\n      \"StdinOnce\": false,\n      \"Env\": [\n        \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n        \"NODE_VERSION=16.17.0\",\n        \"YARN_VERSION=1.22.19\"\n      ],\n      \"Cmd\": [\n        \"/bin/sh\",\n        \"-c\",\n        \"npm start\"\n      ],\n      \"Image\": \"sha256:ca5108589bcee5007319db215f0f22048fb7b75d4d6c16e6310ef044c58218c0\",\n      \"Volumes\": null,\n      \"WorkingDir\": \"/app\",\n      \"Entrypoint\": [\n          \"docker-entrypoint.sh\"\n      ],\n      \"OnBuild\": null,\n      \"Labels\": null\n  },\n  (...)\n      \"Type\": \"layers\",\n      \"Layers\": [\n          \"sha256:20833a96725ec17c9ab15711400e43781a7b7fe31d23fc6c78a7cca478935d33\",\n          \"sha256:07b905e91599cd0251bd575fb77d0918cd4f40b64fa7ea50ff82806c60e2ba61\",\n          \"sha256:5cbe2d191b8f91d974fbba38b5ddcbd5d4882e715a9e008061ab6d2ec432ef7b\",\n          \"sha256:47b6660a2b9bb2091a980c361a1c15b2a391c530877961877138fffc50d2f6f7\",\n          \"sha256:1e69483976e43c657172c073712c3d741245f9141fb560db5af7704aee95114c\",\n          \"sha256:a51886a0928017dc307b85b85c6fb3f9d727b5204ea944117ce59c4b4acc5e05\",\n          \"sha256:ba9804f7abedf8ddea3228539ae12b90966272d6eb02fd2c57446e44d32f1b70\",\n          \"sha256:c77311ff502e318598cc7b6c03a5bd25182f7f6f0352d9b68fad82ed7b4e8c26\",\n          \"sha256:93a6676fffe0813e4ca03cae4769300b539b66234e95be66d86c3ac7748c1321\",\n          \"sha256:3cf3c6f03984f8a31c0181feb75ac056fc2bd56ef8282af9a72dafd1b6bb0c41\",\n          \"sha256:02dacaf7071cc5792c28a4cf54141b7058ee492c93f04176f8f3f090c42735eb\",\n          \"sha256:85152f012a08f63dfaf306c01ac382c1962871bf1864b357549899ec2fa7385d\",\n          \"sha256:8ceb0bd5afef8a5fa451f89273974732cd0c89dac2c80ff8b7855531710fbc49\"\n      ]\n  (...)\n```\n\nWe can see a configuration block with:\n\n- The environment variables\n- The entrypoint command, the default command\n- The working directory\n- The user of the image\n\nAnd a second block Layers with a list of checksums. Each checksum corresponds to a compressed archive file (.tar.gz). All these layers applied on top of each other build a complete filesystem.\n\n### üèóÔ∏è How Docker builds images\n\nTo comprehend how Docker constructs an image, it is essential to be familiar with the `docker commit` command. This command operates on a running container and creates an image from the state of that container.\n\nThis mechanism is utilized, for instance, in the `RUN npm install` instruction:\n\n1. Docker starts an intermediate container.\n2. Within this container, the `npm install` command is executed.\n3. Once the command is complete, Docker commits the container, and the difference between the previous image allows for the creation of an additional layer, resulting in a new intermediate image.\n\nHowever, `docker build` has one significant drawback: by default, the build is not reproducible. Two consecutive `docker builds` with the same Dockerfile will not necessarily produce the same layers, and therefore the same checksums. This phenomenon is primarily caused by timestamps. Each file in a standard Linux filesystem has a creation date, a last modification date, and a last access date. Additionally, the image has a timestamp that is embedded in the image and alters the checksum. This makes it very difficult to isolate our different layers, and it is challenging to logically associate an operation in our Dockerfile with a layer in our final image.\n\nFor modifications to the base image (the `FROM` instruction, for security reasons, for example), Docker must perform a complete build. Additionally, uploading this update to our registry necessitates sending all the layers. Depending on the size of our image, this can lead to a significant amount of traffic on each of our machines hosting our image and wishing to update.\n\nAn image is simply a stack of layers on top of each other, along with configuration files. However, Docker (and its Dockerfile) is not the only way to build an image. Buildpacks offer a different principle for building images. Buildpacks is a project incubated at the [Cloud Native Computing Foundation](https://www.cncf.io/).\n\n## üáµüá∏ How buildpack builds images\n\nA buildpack is a set of executable scripts that will allow you to build and launch your application. A buildpack is made of 3 components:\n\n1. `buildpack.toml`: the metadata of your buildpack.\n2. `bin/detect`: script that determines if the buildpack applies to your application.\n3. `bin/build`: script launching the build sequence of the application.\n\nBuilding your application means running buildpacks one after the other. To do this we use a builder. A builder is an image including a whole set of buildpacks, a lifecycle, and a reference to a very light run image in which we will integrate our application. The build image/run image couple is called a stack.\n\nComing back to our Node.js application, Buildpack will only use the information in the `package.json`.\n\n```json\n{\n  \"name\": \"myapp\",\n  \"version\": \"0.1\",\n  \"main\": \"index.js\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n    \"express\": \"^4.18.1\"\n  },\n  \"scripts\": {\n    \"start\": \"node src/index.js\"\n  },\n  \"engines\": {\n    \"node\": \"16\"\n  }\n}\n```\n\nThis is all we need to build an image containing our application with buildpacks:\n\n- The base image (the `FROM` of the Dockerfile) will be the one specified in the stack.\n- The buildpacks lifecycle detects a `package.json` and thus starts the installation process of Node.js and the dependencies.\n- The version of Node will be the version specified in the `package.json`.\n- The default command will be `node src/index.js` because it is the start command of the `package.json`.\n\nThe only command you need to know to use buildpacks is the following:\n\n```shell\npack build myapp --builder gcr.io/buildpacks/builder:v1\n```\n\nHere we use the builder provided by Google `gcr.io/buildpacks/builder:v1`. Other builders are available (see `pack stack suggest`) or you can build your own! It is then directly possible to launch our application.\n\n```shell\n$ docker run myapp\n> myapp@0.0.1 start\n> node src/index.js\nExample app listening on port 3000\n```\n\n### üåü Advantages of using buildpacks\n\nThe advantages of using buildpacks include:\n\n- The absence of a Dockerfile. The developer can concentrate on his code only.\n- The respect of good image building practices, in terms of security, limitation of the number and size of layers. This is the responsibility of the buildpack designer, not the developer.\n- Caching is native, whether it's the binaries to be installed or the software libraries.\n- Uses your organization's best practices if you create your own buildpack (use of internal mirrors, code analysis‚Ä¶).\n- Each layer of the final image is logically linked with the dependencies it brings.\n- Each operation of a buildpack touches only a restricted area (a folder with the name of the buildpack in the run image).\n- Buildpacks allow obtaining reproducible builds with less effort.\n- The files copied into the image all have a timestamp with a value of 0.\n- It is however necessary that the intermediate build steps (e.g. compilation of Java code) must be idempotent.\n- This allows launching an operation that buildpacks calls 'rebase'.\n\n### üîÑ Image rebasing with Buildpacks\n\nImage rebasing is the ability to swap out multiple layers of an image without having to modify the upper layers. This is particularly useful when updating the base image of our run image.\n\nAs an example, let's consider a Node.js application (which I'm simplifying for the sake of brevity):\n\nAt build time, Buildpacks rely on the lightest possible run image, adding layer by layer:\n\n- A layer containing the Node binaries.\n- A layer containing the `node_modules` (dependencies) of our application.\n\nNote that the `npm` binary is not needed in our run image. It will not be included, but it is used in our build image to install the `node_modules` that will be integrated into our run image.\n\nIf our container is deployed in Kubernetes and a flaw is discovered in its base image, it is necessary to update the base image. With Docker, this would require rebuilding our image completely, and uploading our entire new image to our registry, and each Kubernetes worker would have to download this new image.\n\nThis is not necessary with Buildpacks. Only the layers related to the base image need to be uploaded. For example, we can compare two OCI images, one with an Ubuntu 18.04 base image and the other with an Ubuntu 20.04 base image. The first 3 layers (in blue) are the Ubuntu-related layers. The next layers (in red) are the layers added by Buildpacks. These layers are identical. This behavior is possible in Docker (but complex to set up), but it is the default behavior with Buildpacks.\n\n![change](./change.png)\n\nIf you want to easily implement good image creation practices for your containerized applications, Buildpacks is an excellent choice to consider. It easily integrates with your CI/CD via projects like [kpack](https://github.com/pivotal/kpack). It may even already be integrated into your DevOps infrastructure as Buildpacks is the one behind [Gitlab's Auto DevOps feature](https://docs.gitlab.com/ee/topics/autodevops/).\n\n## üìå Closing thoughts\n\nBuildpacks offer a compelling alternative to Dockerfiles for building container images. They are simpler to use, more flexible, and more portable. Additionally, Buildpacks provide a number of advantages over Dockerfiles, such as reproducible builds and image rebasing.\n\nAs the containerization landscape continues to evolve, Buildpacks are poised to play a major role in the future of container image creation. If you are looking for a way to simplify and streamline your containerization workflow, then Buildpacks are a great option to consider.\n\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1867},"frontmatter":{"id":"988f37b67f305381fe92df22","path":"/blog/pack-dockerfile-less-deployment-kubernetes/","humanDate":"Oct 27, 2024","fullDate":"2024-10-27","title":"Pack: Dockerfile-less Deployment to Kubernetes with Cloud Native Buildpacks","keywords":["Pack","Dockerfile-less","Kubernetes","Cloud Native Buildpacks","OCI images"],"excerpt":"Pack: Dockerfile-less deployment to Kubernetes with Cloud Native Buildpacks","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIBAwQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwAB/9oADAMBAAIQAxAAAAHJbzosYQQ//8QAGxAAAgEFAAAAAAAAAAAAAAAAAQIRAAMQEhP/2gAIAQEAAQUCtgMvJKYQ2xicf//EABURAQEAAAAAAAAAAAAAAAAAABAS/9oACAEDAQE/AbP/xAAXEQADAQAAAAAAAAAAAAAAAAABEBJR/9oACAECAQE/AYOr/8QAGRAAAgMBAAAAAAAAAAAAAAAAEBEAAiFx/9oACAEBAAY/Aq50KJn/xAAcEAEBAQABBQAAAAAAAAAAAAABEQAxECFRgZH/2gAIAQEAAT8hFJeRT5l73nqTEwbMHBh4uU8q9P/aAAwDAQACAAMAAAAQ9B//xAAYEQADAQEAAAAAAAAAAAAAAAAAARExkf/aAAgBAwEBPxBJI1eD0//EABcRAQEBAQAAAAAAAAAAAAAAAAEAETH/2gAIAQIBAT8QVdMRy//EABwQAQEAAgIDAAAAAAAAAAAAABEBACEQQWFxof/aAAgBAQABPxCwqUiwj7OHre2hIO94Iporni2oTPp5Xj//2Q=="},"images":{"fallback":{"src":"/static/75b798f6a2bcbbe5cd45a0e153b46b60/f6810/pack-cover.jpg","srcSet":"/static/75b798f6a2bcbbe5cd45a0e153b46b60/37bba/pack-cover.jpg 750w,\n/static/75b798f6a2bcbbe5cd45a0e153b46b60/61c72/pack-cover.jpg 1080w,\n/static/75b798f6a2bcbbe5cd45a0e153b46b60/d61e8/pack-cover.jpg 1366w,\n/static/75b798f6a2bcbbe5cd45a0e153b46b60/f6810/pack-cover.jpg 1600w","sizes":"100vw"},"sources":[{"srcSet":"/static/75b798f6a2bcbbe5cd45a0e153b46b60/a66aa/pack-cover.webp 750w,\n/static/75b798f6a2bcbbe5cd45a0e153b46b60/65dd5/pack-cover.webp 1080w,\n/static/75b798f6a2bcbbe5cd45a0e153b46b60/4fad6/pack-cover.webp 1366w,\n/static/75b798f6a2bcbbe5cd45a0e153b46b60/e9d78/pack-cover.webp 1600w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5625}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/kubernetes-autoscaling-pods-hpa-vpa/","title":"Kubernetes Autoscaling: Achieving Scalability and Efficiency","date":"2024-10-27 20:00:00"},"excerpt":"How to Scale Pods Vertically and Horizontally in Kubernetes üåê üê≥ Introduction Kubernetes embodies resilience and scalability by deploying‚Ä¶","html":"<blockquote>\n<p><strong>How to Scale Pods Vertically and Horizontally in Kubernetes üåê</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üê≥ Introduction</h2>\n<p><a href=\"https://kubernetes.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes</a> embodies resilience and scalability by deploying diverse pods with varying resource allocations, ensuring application redundancy. While manual adjustments suffice, Kubernetes elevates scaling with Horizontal Pod Autoscaling (HPA). This self-regulating loop dynamically expands or contracts resources (app Pods) based on real-time demands. Simply deploy a <a href=\"https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/\" target=\"_blank\" rel=\"noopener noreferrer\">HorizontalPodAutoscaler (HPA)</a> resource for auto-scaling, leaving the automation to it.</p>\n<p>Moreover, in addition to HPA, the <a href=\"https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler\" target=\"_blank\" rel=\"noopener noreferrer\">Vertical Pod Autoscaler (VPA)</a> offers a distinct approach. Unlike HPA's horizontal scaling, VPA modifies a Pod's resources.requests, prompting the Kubernetes Scheduler to shift Pods across WorkerNodes as needed. VPA incessantly monitors container resource usage, automatically tweaking requests to prevent waste and ensure sufficient CPU and memory allocation. This synergy of HPA and VPA empowers Kubernetes users to effortlessly achieve efficient, tailored scaling.</p>\n<p>This blog explores the universe of Kubernetes autoscaling, casting a spotlight on these two powerful tools: HPA and VPA. We'll uncover how they work, their distinctions, and how they can collaborate to enhance resource utilization and application performance.</p>\n<p>Join us on a quest to become proficient in the art of scaling within Kubernetes.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB5VUzGVGA/wD/xAAaEAACAgMAAAAAAAAAAAAAAAAAAQISESEx/9oACAEBAAEFAl1syKUS+rI//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAABEBECIx/9oACAEBAAY/AjMKEdpOv//EABwQAAMAAgMBAAAAAAAAAAAAAAABETFRYZGh8P/aAAgBAQABPyGsBTTbOZ6Xt2UZg1hki0j5rP/aAAwDAQACAAMAAAAQ6C//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QhX//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAGxABAAMBAQEBAAAAAAAAAAAAAQARITFBUXH/2gAIAQEAAT8Qvp3tbD9c4pXxxBbtN+oy1UcoWV5sATn7kR9uH//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"hpa-vpa\" title=\"\" src=\"/static/063a135be697a2c366aa6efcd27d818a/7bf67/hpa-vpa.jpg\" srcset=\"/static/063a135be697a2c366aa6efcd27d818a/651be/hpa-vpa.jpg 170w,\n/static/063a135be697a2c366aa6efcd27d818a/d30a3/hpa-vpa.jpg 340w,\n/static/063a135be697a2c366aa6efcd27d818a/7bf67/hpa-vpa.jpg 680w,\n/static/063a135be697a2c366aa6efcd27d818a/990cb/hpa-vpa.jpg 1020w,\n/static/063a135be697a2c366aa6efcd27d818a/e5166/hpa-vpa.jpg 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-horizontalpodautoscaler-hpa-scaling-horizontally\" style=\"position:relative;\"><a href=\"#-horizontalpodautoscaler-hpa-scaling-horizontally\" aria-label=\" horizontalpodautoscaler hpa scaling horizontally permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìà HorizontalPodAutoscaler (HPA): Scaling Horizontally</h2>\n<p>Under the hood, HPA is powered by a dedicated Kubernetes controller. You create an HPA YAML targeting your app's Deployment and use <code class=\"language-text\">kubectl</code> to apply it.</p>\n<h2 id=\"-vertical-pod-autoscaler-vpa-scaling-vertically\" style=\"position:relative;\"><a href=\"#-vertical-pod-autoscaler-vpa-scaling-vertically\" aria-label=\" vertical pod autoscaler vpa scaling vertically permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìâ Vertical Pod Autoscaler (VPA): Scaling Vertically</h2>\n<p>VPA involves three pods:</p>\n<ul>\n<li><strong>Recommender</strong>: <a href=\"https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/recommender/README.md\" target=\"_blank\" rel=\"noopener noreferrer\">Analyzes</a> Pod resource usage and recommends CPU/memory requests.</li>\n<li><strong>Updater</strong>: <a href=\"https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/updater/README.md\" target=\"_blank\" rel=\"noopener noreferrer\">Monitors</a> and aligns Pod requests with recommendations, recreating if needed.</li>\n<li><strong>Admission-plugin</strong>: <a href=\"https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/admission-controller/README.md\" target=\"_blank\" rel=\"noopener noreferrer\">Sets</a> request values for new/updated Pods.</li>\n</ul>\n<h3 id=\"Ô∏è-vpa-limitations\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-vpa-limitations\" aria-label=\"Ô∏è vpa limitations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ö†Ô∏è VPA Limitations</h3>\n<ul>\n<li>VPA doesn't oversee Pod recreation post-eviction, needing tools like Cluster Autoscaler.</li>\n<li>It can't be used with HPA for CPU/memory scaling, but custom metrics are compatible.</li>\n<li>VPA's Pod recreation might cause service downtime without fault-tolerant solutions.</li>\n</ul>\n<p>HPA and VPA require a <a href=\"https://github.com/kubernetes-sigs/metrics-server\" target=\"_blank\" rel=\"noopener noreferrer\">metrics server</a>, like Kubernetes Metrics Server, to gather CPU/memory metrics for scaling decisions.</p>\n<h3 id=\"-metrics-api-types\" style=\"position:relative;\"><a href=\"#-metrics-api-types\" aria-label=\" metrics api types permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìä Metrics API Types</h3>\n<ul>\n<li><strong>metrics.k8s.io</strong>: Default metrics, provided by the <a href=\"https://github.com/kubernetes-sigs/metrics-server\" target=\"_blank\" rel=\"noopener noreferrer\">metrics-server</a>.</li>\n<li><strong>custom.metrics.k8s.io</strong>: Metrics provided by adapters from inside a cluster, e.g., <a href=\"https://github.com/Azure/azure-k8s-metrics-adapter\" target=\"_blank\" rel=\"noopener noreferrer\">Microsoft Azure Adapter</a>, <a href=\"https://github.com/GoogleCloudPlatform/k8s-stackdriver\" target=\"_blank\" rel=\"noopener noreferrer\">Google Stackdriver</a>, <a href=\"https://github.com/kubernetes-sigs/prometheus-adapter\" target=\"_blank\" rel=\"noopener noreferrer\">Prometheus Adapter</a>.</li>\n<li><strong>external.metrics.k8s.io</strong>: Similar to the Custom Metrics API, but metrics are provided by an external system, such as <a href=\"https://aws.amazon.com/cloudwatch/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS CloudWatch</a>.</li>\n</ul>\n<p>In a nutshell, <code class=\"language-text\">metrics.k8s.io</code> encompasses default metrics from the metrics-server, while <code class=\"language-text\">custom.metrics.k8s.io</code> involves internal cluster adapters like Microsoft Azure or Google Stackdriver, and <code class=\"language-text\">external.metrics.k8s.io</code> pertains to external systems like AWS CloudWatch, providing adaptable metrics.</p>\n<h2 id=\"Ô∏è-deploy-metrics-server-using-helm\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-deploy-metrics-server-using-helm\" aria-label=\"Ô∏è deploy metrics server using helm permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚òÅÔ∏è Deploy Metrics Server Using Helm</h2>\n<p>To initiate the process, integrate the metrics-server repository into your helm package collection. Employ the <code class=\"language-text\">helm repo add</code> command as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm repo <span class=\"token function\">add</span> metrics-server https://kubernetes-sigs.github.io/metrics-server</code></pre></div>\n<p>Then, employ <code class=\"language-text\">helm repo update</code> to refresh the pool of accessible packages:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ helm repo update metrics-server\n\nHang tight <span class=\"token keyword\">while</span> we grab the latest from your chart repositories<span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">..</span>.Successfully got an update from the <span class=\"token string\">\"metrics-server\"</span> chart repository\nUpdate Complete. ‚éàHappy Helming<span class=\"token operator\">!</span>‚éà\n\n$ helm search repo metrics-server</code></pre></div>\n<h3 id=\"Ô∏è-repository-integration-complete-metrics-server-deployment\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-repository-integration-complete-metrics-server-deployment\" aria-label=\"Ô∏è repository integration complete metrics server deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ò∏Ô∏è Repository Integration Complete: Metrics Server Deployment</h3>\n<p>With the repository successfully added to Helm, you're poised to include metrics-server in your Kubernetes deployments. Here's how you can create your deployment configuration:</p>\n<p>Clone the Kubernetes Starter Kit Git repository:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> clone https://github.com/seifrajhi/K8s-Workload-Scaling-Strategies.git</code></pre></div>\n<p>Locate the metrics-server configuration in the following path:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> K8s-Workload-Scaling-Strategies\n<span class=\"token function\">vim</span> assets/manifests/metrics-server-values-v3.11.0.yaml</code></pre></div>\n<p>By following these steps, you'll seamlessly integrate metrics-server into your Kubernetes environment and have the flexibility to tailor your deployment configuration to your needs.</p>\n<p>It contains a few stock parameters. Note that replicas is a fixed value, 2.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">## Ref: https://github.com/kubernetes-sigs/metrics-server/blob/metrics-server-helm-chart-3.8.2/charts/metrics-server</span>\n<span class=\"token comment\"># Number of metrics-server replicas to run</span>\nreplicas: <span class=\"token number\">2</span>\n\napiService:\n    <span class=\"token comment\"># Specifies if the v1beta1.metrics.k8s.io API service should be created.</span>\n    create: <span class=\"token boolean\">true</span>\n\nhostNetwork:\n    <span class=\"token comment\"># Specifies if metrics-server should be started in hostNetwork mode.</span>\n    enabled: <span class=\"token boolean\">false</span></code></pre></div>\n<p>You can check the Metrics Server chart page for explanations of the available values for metrics-server.</p>\n<p>Then, you can install the Kubernetes Metrics Server using Helm (a dedicated metrics-server namespace will be created as well):</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm <span class=\"token function\">install</span> metrics-server metrics-server/metrics-server <span class=\"token parameter variable\">--version</span> <span class=\"token number\">3.11</span>.0<span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">--namespace</span> metrics-server <span class=\"token punctuation\">\\</span>\n    --create-namespace <span class=\"token punctuation\">\\</span>\n    <span class=\"token parameter variable\">-f</span> <span class=\"token string\">\"assets/manifests/metrics-server-v3.11.0.yaml\"</span></code></pre></div>\n<p>This will deploy metrics-server to your configured Kubernetes cluster.</p>\n<p>After deploying, you can use <code class=\"language-text\">helm ls</code> to verify that metrics-server has been added to your deployment:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm <span class=\"token function\">ls</span> <span class=\"token parameter variable\">-n</span> metrics-server</code></pre></div>\n<p>Next, you can check the status of all of the Kubernetes resources deployed to the metrics-server namespace:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get all <span class=\"token parameter variable\">-n</span> metrics-server</code></pre></div>\n<p>Finally, check if the <code class=\"language-text\">kubectl top</code> command works (similar to Linux top command - prints current resource usage, such as CPU and memory). Below command displays current resource usage for all Pods in the kube-system namespace:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token function\">top</span> pods <span class=\"token parameter variable\">-n</span> kube-system</code></pre></div>\n<p>You have now deployed metrics-server into your Kubernetes cluster. In the next step, you'll review some of the parameters of a HorizontalPodAutoscaler Custom Resource Definition.</p>\n<h2 id=\"introducing-hpas-the-key-to-dynamic-scaling\" style=\"position:relative;\"><a href=\"#introducing-hpas-the-key-to-dynamic-scaling\" aria-label=\"introducing hpas the key to dynamic scaling permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Introducing HPAs: The Key to Dynamic Scaling</h2>\n<p>So far, you've been manually configuring the number of pods in your Kubernetes deployments. This is fine for simple cases, but it can be a pain to keep up with as your application grows and traffic fluctuates.</p>\n<p>That's where <strong>HorizontalPodAutoscalers (HPAs)</strong> come in. HPAs are a Kubernetes feature that automatically scales your deployments up or down based on metrics like CPU usage and memory utilization. This means that you can focus on building great applications, and let HPAs take care of the scaling for you.</p>\n<h3 id=\"how-an-hpa-works\" style=\"position:relative;\"><a href=\"#how-an-hpa-works\" aria-label=\"how an hpa works permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>How an HPA Works</h3>\n<ol>\n<li><strong>Metric Monitoring</strong>: The HPA watches a metric, such as CPU usage.</li>\n<li><strong>Threshold Exceeded</strong>: When the metric exceeds a threshold, the HPA triggers a scale operation.</li>\n<li><strong>Scaling</strong>: The scale operation either increases or decreases the number of pods in the deployment.</li>\n</ol>\n<h3 id=\"hpa-crd-custom-resource-definition\" style=\"position:relative;\"><a href=\"#hpa-crd-custom-resource-definition\" aria-label=\"hpa crd custom resource definition permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>HPA CRD (Custom Resource Definition)</h3>\n<p>The HPA CRD is a YAML file that specifies the configuration of the HPA. The CRD includes the following fields:</p>\n<ul>\n<li><strong>Target</strong>: The name of the Kubernetes object that the HPA is monitoring.</li>\n<li><strong>Metrics</strong>: The metrics that the HPA is watching.</li>\n<li><strong>Scaling Policies</strong>: The rules for how the HPA scales the deployment.</li>\n</ul>\n<p>Here's an example of an HPA CRD:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> autoscaling/v2beta2\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> HorizontalPodAutoscaler\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> demo<span class=\"token punctuation\">-</span>hpa\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">scaleTargetRef</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>deployment\n    <span class=\"token key atrule\">minReplicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token key atrule\">maxReplicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n    <span class=\"token key atrule\">metrics</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Resource\n            <span class=\"token key atrule\">resource</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cpu\n                <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Utilization\n                    <span class=\"token key atrule\">averageUtilization</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n<h3 id=\"explanation-of-the-configuration\" style=\"position:relative;\"><a href=\"#explanation-of-the-configuration\" aria-label=\"explanation of the configuration permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Explanation of the Configuration</h3>\n<ul>\n<li><strong>spec.scaleTargetRef</strong>: Specifies the Kubernetes object that the HPA is monitoring. In this case, it is the <code class=\"language-text\">my-deployment</code> deployment.</li>\n<li><strong>spec.minReplicas</strong>: Specifies the lower limit for the number of replicas in the deployment. The HPA will never scale the deployment down below 1 pod.</li>\n<li><strong>spec.maxReplicas</strong>: Specifies the upper limit for the number of replicas in the deployment. The HPA will never scale the deployment up above 3 pods.</li>\n<li><strong>spec.metrics.type</strong>: Specifies the type of metric that the HPA is using to calculate the desired replica count. Here, it is using the <code class=\"language-text\">Resource</code> type, which means it is scaling the deployment based on the average CPU utilization.</li>\n<li><strong>spec.metrics.resource.name</strong>: Specifies the name of the resource that the HPA is monitoring. In this case, it is the <code class=\"language-text\">cpu</code> resource.</li>\n<li><strong>spec.metrics.resource.averageUtilization</strong>: Specifies the threshold value for the metric. The HPA will scale the deployment up if the average CPU utilization exceeds 80%.</li>\n</ul>\n<h3 id=\"creating-an-hpa\" style=\"position:relative;\"><a href=\"#creating-an-hpa\" aria-label=\"creating an hpa permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Creating an HPA</h3>\n<p>There are two ways to create an HPA for your application deployment. You can use the <code class=\"language-text\">kubectl autoscale</code> command on an existing deployment, or you can create an HPA YAML manifest.</p>\n<h4 id=\"using-code-classlanguage-textkubectl-autoscalecode-command\" style=\"position:relative;\"><a href=\"#using-code-classlanguage-textkubectl-autoscalecode-command\" aria-label=\"using code classlanguage textkubectl autoscalecode command permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Using <code class=\"language-text\">kubectl autoscale</code> Command</h4>\n<p>To create an HPA using the <code class=\"language-text\">kubectl autoscale</code> command, you need to specify the name of the deployment and the target CPU utilization. For example, the following command would create an HPA for the <code class=\"language-text\">myapp-test</code> deployment with a target CPU utilization of 80%:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> myapp<span class=\"token punctuation\">-</span>test\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> myapp<span class=\"token punctuation\">-</span>test\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> myapp<span class=\"token punctuation\">-</span>test\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> busybox\n                    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> busybox\n                    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">limits</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 50m\n                        <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 20m\n                    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"sh\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-c\"</span><span class=\"token punctuation\">]</span>\n                    <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token punctuation\">-</span> while <span class=\"token punctuation\">[</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">]</span>; do\n                            echo \"Test\";\n                            sleep 0.01;\n                            done</code></pre></div>\n<p>Note the last few lines of this file. They contain some shell syntax to repeatedly print \"Test\" a hundred times a second, to simulate load. Once you are done reviewing the file, you can deploy it into your cluster using <code class=\"language-text\">kubectl</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> assets/manifests/hpa/metrics-server/myapp-test.yaml</code></pre></div>\n<p>Finally, create a HorizontalPodAutoscaler targeting the <code class=\"language-text\">myapp-test</code> deployment:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl autoscale deployment hpa-test --cpu-percent<span class=\"token operator\">=</span><span class=\"token number\">80</span> <span class=\"token parameter variable\">--min</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token parameter variable\">--max</span><span class=\"token operator\">=</span><span class=\"token number\">3</span></code></pre></div>\n<p>You can check if the HPA resource was created by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get hpa</code></pre></div>\n<p>The <code class=\"language-text\">TARGETS</code> column of the output will eventually show a figure of current usage%/target usage%.</p>\n<p>You can also observe the logged events that an HPA generates by using:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl describe hpa hpa-test</code></pre></div>\n<p>In a real-world scenario, you will want to use a dedicated YAML manifest to define each HPA. This way, you can track the changes by having the manifest committed in a Git repository, as well as come back to it later and perform changes.</p>\n<h3 id=\"scaling-applications-automatically-with-metrics-server\" style=\"position:relative;\"><a href=\"#scaling-applications-automatically-with-metrics-server\" aria-label=\"scaling applications automatically with metrics server permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Scaling Applications Automatically with Metrics Server</h3>\n<p>In this last step, you will experiment with two different ways of generating server load and scaling your applications automatically via a YAML manifest.</p>\n<h4 id=\"application-deployment\" style=\"position:relative;\"><a href=\"#application-deployment\" aria-label=\"application deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Application Deployment</h4>\n<p>One way to generate server load is to create an application deployment that performs some CPU-intensive computations. This will cause the pods in the deployment to use more CPU resources, which will trigger the HorizontalPodAutoscaler (HPA) to scale the deployment up.</p>\n<h4 id=\"shell-script\" style=\"position:relative;\"><a href=\"#shell-script\" aria-label=\"shell script permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Shell Script</h4>\n<p>Another way to generate server load is to use a shell script. This script can be configured to perform fast successive HTTP calls to a web application. This will cause the web application to use more CPU resources, which will also trigger the HPA to scale the deployment up.</p>\n<h4 id=\"constant-load-test\" style=\"position:relative;\"><a href=\"#constant-load-test\" aria-label=\"constant load test permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Constant Load Test</h4>\n<p>In this scenario, you will create a sample application that performs some CPU-intensive computations. This application is implemented in Python and is included in one of the example manifests from the starter kit. You can open the manifest, called <code class=\"language-text\">constant-load.yaml</code>, using nano or your favorite text editor.</p>\n<p>The manifest defines a deployment that creates a pod that runs the Python application. The application will continuously perform CPU-intensive computations, which will cause the pod to use more CPU resources. This will trigger the HorizontalPodAutoscaler (HPA) to scale the deployment up.</p>\n<p>Once you have opened the manifest, you can edit it to change the number of replicas in the deployment. The default number of replicas is 1, but you can increase this number to create more pods. The more pods you create, the more CPU resources will be used, and the more the HPA will scale the deployment up.</p>\n<p>Once you have edited the manifest, you can save it and apply it to your cluster using the <code class=\"language-text\">kubectl apply</code> command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> assets/manifests/hpa/metrics-server/constant-load.yaml</code></pre></div>\n<p>Once the manifest has been applied, the HPA will start monitoring the CPU usage of the deployment. If the CPU usage exceeds the target utilization, the HPA will scale the deployment up to add more pods.</p>\n<p>Verify that the deployment was created successfully, and that it's up and running:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get deployments</code></pre></div>\n<p>Next, you will need to deploy another HorizontalPodAutoscaler (HPA) to this cluster. There is an example HPA that is matched to this scenario in the file <code class=\"language-text\">constant-load-hpa.yaml</code>.</p>\n<p>The <code class=\"language-text\">constant-load-hpa.yaml</code> file defines an HPA that monitors the CPU usage of the constant-load deployment. The HPA will scale the deployment up if the CPU usage exceeds the target utilization, which is set to 80% by default.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">cat</span> assets/manifests/hpa/metrics-server/constant-load-hpa.yaml</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> autoscaling/v2beta2\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> HorizontalPodAutoscaler\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> constant<span class=\"token punctuation\">-</span>load\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">scaleTargetRef</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> constant<span class=\"token punctuation\">-</span>load<span class=\"token punctuation\">-</span>deployment\n    <span class=\"token key atrule\">minReplicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token key atrule\">maxReplicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n    <span class=\"token key atrule\">metrics</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Resource\n            <span class=\"token key atrule\">resource</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cpu\n                <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Utilization\n                    <span class=\"token key atrule\">averageUtilization</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> constant-load-hpa.yaml</code></pre></div>\n<p>Once the HPA has been applied, it will start monitoring the CPU usage of the constant-load deployment. If the CPU usage exceeds the target utilization, the HPA will scale the deployment up to add more pods.</p>\n<h2 id=\"running-vertical-pod-autoscaler\" style=\"position:relative;\"><a href=\"#running-vertical-pod-autoscaler\" aria-label=\"running vertical pod autoscaler permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Running Vertical Pod Autoscaler</h2>\n<p>For the VPA to work, it relies on the Kubernetes Metrics Server to get a Pod's CPU/Memory values. However, it can also use Prometheus. See <a href=\"https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler#using-prometheus\" target=\"_blank\" rel=\"noopener noreferrer\">How can I use Prometheus for the VPA recommender</a>.</p>\n<h3 id=\"Ô∏è-installing-vertical-pod-autoscaler\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-installing-vertical-pod-autoscaler\" aria-label=\"Ô∏è installing vertical pod autoscaler permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Installing Vertical Pod Autoscaler</h3>\n<p>Let's use the Helm chart <code class=\"language-text\">cowboysysop/vertical-pod-autoscaler</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm repo <span class=\"token function\">add</span> cowboysysop https://cowboysysop.github.io/charts/\nhelm <span class=\"token parameter variable\">-n</span> kube-system upgrade <span class=\"token parameter variable\">--install</span> vertical-pod-autoscaler cowboysysop/vertical-pod-autoscaler</code></pre></div>\n<p>Then, you can check VPA's Pods:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token parameter variable\">-n</span> kube-system get pod <span class=\"token parameter variable\">-l</span> app.kubernetes.io/name<span class=\"token operator\">=</span>vertical-pod-autoscaler</code></pre></div>\n<p>And its CustomResourceDefinitions:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get crds\nNAME                                                   CREATED AT\nverticalpodautoscalercheckpoints.autoscaling.k8s.io  <span class=\"token number\">2023</span>-08-26T10:45:46Z\nverticalpodautoscalers.autoscaling.k8s.io            <span class=\"token number\">2023</span>-08-26T10:45:46Z</code></pre></div>\n<p>Now everything is ready to start using it.</p>\n<h3 id=\"-examples-of-work-with-vertical-pod-autoscaler\" style=\"position:relative;\"><a href=\"#-examples-of-work-with-vertical-pod-autoscaler\" aria-label=\" examples of work with vertical pod autoscaler permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìÑ Examples of Work with Vertical Pod Autoscaler</h3>\n<p>In the <a href=\"https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler\" target=\"_blank\" rel=\"noopener noreferrer\">VPA repository</a>, there is a directory named <code class=\"language-text\">vpa</code>, which contains examples of manifests. In the <code class=\"language-text\">hamster.yaml</code> file, there is an example of a configured VPA and a test Deployment. But let's create our manifests and deploy resources separately.</p>\n<h4 id=\"-first-describe-a-deployment\" style=\"position:relative;\"><a href=\"#-first-describe-a-deployment\" aria-label=\" first describe a deployment permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üêπ First, Describe a Deployment</h4>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> hamster\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> hamster\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n    <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> hamster\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">securityContext</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">runAsNonRoot</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n                <span class=\"token key atrule\">runAsUser</span><span class=\"token punctuation\">:</span> <span class=\"token number\">65534</span> <span class=\"token comment\"># nobody</span>\n            <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> hamster\n                    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> registry.k8s.io/ubuntu<span class=\"token punctuation\">-</span>slim<span class=\"token punctuation\">:</span><span class=\"token number\">0.1</span>\n                    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 100m\n                            <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 50Mi\n                    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">]</span>\n                    <span class=\"token key atrule\">args</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token punctuation\">-</span> <span class=\"token string\">\"-c\"</span>\n                        <span class=\"token punctuation\">-</span> <span class=\"token string\">\"while true; do timeout 0.5s yes >/dev/null; sleep 0.5s; done\"</span></code></pre></div>\n<p>Here we have to create two Pods with requests at 100 Milli CPU and 50 Megabyte memory. Deploy it:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> assets/manifests/vpa/hamster.yaml\ndeployment.apps/hamster created</code></pre></div>\n<p>A few minutes later, check the resources that are actually consumed by the Pods:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token function\">top</span> pod\nNAME                       CPU<span class=\"token punctuation\">(</span>cores<span class=\"token punctuation\">)</span>   MEMORY<span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span>\nhamster-65cd4dd797-fq9lq   498m         0Mi\nhamster-65cd4dd797-lnpks   499m         0Mi</code></pre></div>\n<h4 id=\"now-add-a-vpa\" style=\"position:relative;\"><a href=\"#now-add-a-vpa\" aria-label=\"now add a vpa permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Now, Add a VPA</h4>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"autoscaling.k8s.io/v1\"</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> VerticalPodAutoscaler\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> hamster<span class=\"token punctuation\">-</span>vpa\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">targetRef</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"apps/v1\"</span>\n        <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> hamster\n    <span class=\"token key atrule\">resourcePolicy</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">containerPolicies</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerName</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'*'</span>\n                <span class=\"token key atrule\">minAllowed</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 100m\n                    <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 50Mi\n                <span class=\"token key atrule\">maxAllowed</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n                    <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 500Mi\n                <span class=\"token key atrule\">controlledResources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"memory\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Deploy it:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> assets/manifests/vpa/vpa.yaml\nverticalpodautoscaler.autoscaling.k8s.io/hamster-vpa created</code></pre></div>\n<p>Check the VPA object:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get vpa\nNAME         MODE CPU MEM PROVIDED AGE\nhamster-vpa   Auto                 14s</code></pre></div>\n<p>And in a minute or two, the Recommender starts working:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get vpa\nNAME          MODE  CPU   MEM     PROVIDED AGE\nhamster-vpa   Auto  587m  262144k  True    43s</code></pre></div>\n<p>And in another minute, check the Updater work‚Ää‚Äî‚Ääit kills old Pods to apply new recommended values for the requests:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get pod\nNAME                       READY   STATUS        RESTARTS   AGE\nhamster-65cd4dd797-fq9lq   <span class=\"token number\">1</span>/1     Terminating   <span class=\"token number\">0</span>          3m43s\nhamster-65cd4dd797-hc9cn   <span class=\"token number\">1</span>/1     Running       <span class=\"token number\">0</span>          13s\nhamster-65cd4dd797-lnpks   <span class=\"token number\">1</span>/1     Running       <span class=\"token number\">0</span>          3m43s</code></pre></div>\n<p>Check the value requests of the new Pod:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get pod hamster-65cd4dd797-hc9cn <span class=\"token parameter variable\">-o</span> yaml <span class=\"token operator\">|</span> yq <span class=\"token string\">'.spec.containers[].resources'</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"requests\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"cpu\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"587m\"</span>,\n        <span class=\"token string\">\"memory\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"262144k\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That's all for now. üéâ</p>\n<h2 id=\"-closing-notes\" style=\"position:relative;\"><a href=\"#-closing-notes\" aria-label=\" closing notes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìï Closing Notes</h2>\n<p>Kubernetes autoscaling is a pivotal strategy for achieving seamless scalability and operational efficiency in your containerized applications. By mastering the art of vertical and horizontal pod autoscaling, you unlock the ability to adapt to varying workloads while optimizing resource utilization. Whether it's boosting performance through vertical scaling or accommodating increased traffic with horizontal scaling, Kubernetes provides the tools to strike a balance between performance and cost-effectiveness. Harness the power of autoscaling to elevate your applications, ensuring they effortlessly meet user demands and resource constraints in today's dynamic computing landscape.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p><strong>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</strong></p>"},"nextThought":{"frontmatter":{"path":"/blog/eks-node-viewer-visualizing-node-usage/","title":"eks-node-viewer: A Tool for Visualizing Dynamic Node Usage in EKS Clusters¬†üöÄ","date":"2024-10-27 18:40:00"},"excerpt":"Optimizing AWS Kubernetes Cluster üîä Introduction EKS Node Viewer is a tool for visualizing dynamic node usage within a Kubernetes cluster‚Ä¶","html":"<blockquote>\n<p><strong>Optimizing AWS Kubernetes Cluster</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîä Introduction</h2>\n<p><a href=\"https://github.com/awslabs/eks-node-viewer\" target=\"_blank\" rel=\"noopener noreferrer\">EKS Node Viewer</a> is a tool for visualizing dynamic node usage within a Kubernetes cluster. It was originally developed as an internal tool at AWS for demonstrating consolidation with <a href=\"https://karpenter.sh/\" target=\"_blank\" rel=\"noopener noreferrer\">Karpenter</a>, but it is now available to the public as an open-source project.</p>\n<p>EKS Node Viewer displays the scheduled pod resource requests vs the allocatable capacity on the node. This information can be used to identify nodes that are underutilized or overutilized and to make decisions about node scaling and consolidation.</p>\n<h2 id=\"-goals-and-objectives\" style=\"position:relative;\"><a href=\"#-goals-and-objectives\" aria-label=\" goals and objectives permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üéØ Goals and Objectives</h2>\n<p>In this blog post, we will introduce EKS Node Viewer and explain how to use it to improve your Kubernetes clusters. We will also discuss some of the benefits of using EKS Node Viewer and provide some tips for getting the most out of it.</p>\n<h3 id=\"definition-and-usage\" style=\"position:relative;\"><a href=\"#definition-and-usage\" aria-label=\"definition and usage permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Definition and Usage</h3>\n<p>EKS Node Viewer is a simple but powerful tool that can be used to improve the efficiency and performance of Kubernetes clusters. It is easy to use and install, and it provides a clear and concise view of node usage. It does not look at the actual pod resource usage.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.352941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA20lEQVR42mOwdXB3cvG2d/Q0s3GysXeztHW1MLLK09cvszCoczHJDbUPjHR1cXKwdXPWN7HSN7QEIkNjax09c0VlHQZ3D38fv1BnVx8XV18vryBbFx8PE9t3enJP4ywPVfvNm5EQMSXNws7D3T3A1c3PPzDC2zfE1z8MqF5Nw4BBQ8tYU9tYQ8tIVd1AXdNIBUiq6jkpqTtqa9vo65maGGqZGauo6QGVqqrrq2saAkkgW0VNX15Ri0FGTh2CpGVBCMSQUxeT0xCTVZeQUZeUVpOWVkNSgGDLymsAALViNA1PJcyOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Node Viewer Output 1\" title=\"\" src=\"/static/d7d645bcd355f7583af717da427e5838/c5bb3/output1.png\" srcset=\"/static/d7d645bcd355f7583af717da427e5838/04472/output1.png 170w,\n/static/d7d645bcd355f7583af717da427e5838/9f933/output1.png 340w,\n/static/d7d645bcd355f7583af717da427e5838/c5bb3/output1.png 680w,\n/static/d7d645bcd355f7583af717da427e5838/b12f7/output1.png 1020w,\n/static/d7d645bcd355f7583af717da427e5838/46115/output1.png 1290w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>It also supports spot instances. Here is a small EKS cluster instance:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcWbBDD/xAAXEAADAQAAAAAAAAAAAAAAAAAAERIg/9oACAEBAAEFArLG8f/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAABIDFB/9oACAEBAAY/AqRkf//EABwQAAEDBQAAAAAAAAAAAAAAAAABESAhMVGR0f/aAAgBAQABPyGjgOxoJch//9oADAMBAAIAAwAAABBzz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAICAQUAAAAAAAAAAAAAAAERACFREDFBkdH/2gAIAQEAAT8QJ0cq2zP1fIYWAF8BRDEQxp//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Node Viewer Output 2\" title=\"\" src=\"/static/bb946f14ab570171af00c5f19278a676/7bf67/output2.jpg\" srcset=\"/static/bb946f14ab570171af00c5f19278a676/651be/output2.jpg 170w,\n/static/bb946f14ab570171af00c5f19278a676/d30a3/output2.jpg 340w,\n/static/bb946f14ab570171af00c5f19278a676/7bf67/output2.jpg 680w,\n/static/bb946f14ab570171af00c5f19278a676/990cb/output2.jpg 1020w,\n/static/bb946f14ab570171af00c5f19278a676/e5166/output2.jpg 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"Ô∏è-installation\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-installation\" aria-label=\"Ô∏è installation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Installation</h3>\n<p><strong>Homebrew:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">brew tap aws/tap\nbrew <span class=\"token function\">install</span> eks-node-viewer</code></pre></div>\n<p><strong>Manual:</strong></p>\n<p>Please either fetch the latest release or install manually using:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">go <span class=\"token function\">install</span> github.com/awslabs/eks-node-viewer/cmd/eks-node-viewer@latest</code></pre></div>\n<p><em>Note: This will install it to your GOBIN directory, typically <code class=\"language-text\">~/go/bin</code> if it is unconfigured.</em></p>\n<h3 id=\"-usage\" style=\"position:relative;\"><a href=\"#-usage\" aria-label=\" usage permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Usage</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Usage of ./eks-node-viewer:\n    <span class=\"token parameter variable\">-attribution</span>\n            Show the Open Source Attribution\n    <span class=\"token parameter variable\">-context</span> string\n            Name of the kubernetes context to use\n    -disable-pricing\n            Disable pricing lookups\n    -extra-labels string\n            A comma separated <span class=\"token builtin class-name\">set</span> of extra <span class=\"token function\">node</span> labels to display\n    <span class=\"token parameter variable\">-kubeconfig</span> string\n            Absolute path to the kubeconfig <span class=\"token function\">file</span> <span class=\"token punctuation\">(</span>default <span class=\"token string\">\"~/.kube/config\"</span><span class=\"token punctuation\">)</span>\n    -node-selector string\n            Node label selector used to filter nodes, <span class=\"token keyword\">if</span> empty all nodes are selected\n    <span class=\"token parameter variable\">-resources</span> string\n            List of comma separated resources to monitor <span class=\"token punctuation\">(</span>default <span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token parameter variable\">-v</span>\tDisplay eks-node-viewer version\n    <span class=\"token parameter variable\">-version</span>\n            Display eks-node-viewer version</code></pre></div>\n<h3 id=\"-examples\" style=\"position:relative;\"><a href=\"#-examples\" aria-label=\" examples permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìã Examples</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Standard usage</span>\neks-node-viewer\n\n<span class=\"token comment\"># Karpenter nodes only</span>\neks-node-viewer --node-selector <span class=\"token string\">\"karpenter.sh/provisioner-name\"</span>\n\n<span class=\"token comment\"># Display both CPU and Memory Usage</span>\neks-node-viewer <span class=\"token parameter variable\">--resources</span> cpu,memory\n\n<span class=\"token comment\"># Display extra labels, i.e. AZ</span>\neks-node-viewer --extra-labels topology.kubernetes.io/zone\n\n<span class=\"token comment\"># Specify a particular AWS profile and region</span>\n<span class=\"token assign-left variable\">AWS_PROFILE</span><span class=\"token operator\">=</span>myprofile <span class=\"token assign-left variable\">AWS_REGION</span><span class=\"token operator\">=</span>us-west-2 eks-node-viewer</code></pre></div>\n<h3 id=\"Ô∏è-computed-labels\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-computed-labels\" aria-label=\"Ô∏è computed labels permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üè∑Ô∏è Computed Labels</h3>\n<p>EKS Node Viewer supports some custom label names that can be passed to the <code class=\"language-text\">--extra-labels</code> to display additional node information.</p>\n<ul>\n<li><code class=\"language-text\">eks-node-viewer/node-age</code> - Age of the node</li>\n<li><code class=\"language-text\">eks-node-viewer/node-cpu-usage</code> - CPU usage (requests)</li>\n<li><code class=\"language-text\">eks-node-viewer/node-memory-usage</code> - Memory usage (requests)</li>\n<li><code class=\"language-text\">eks-node-viewer/node-pods-usage</code> - Pod usage (requests)</li>\n<li><code class=\"language-text\">eks-node-viewer/node-ephemeral-storage-usage</code> - Ephemeral Storage usage (requests)</li>\n</ul>\n<h3 id=\"Ô∏è-default-options\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-default-options\" aria-label=\"Ô∏è default options permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚öôÔ∏è Default Options</h3>\n<p>You can supply default options to EKS Node Viewer by creating a file named <code class=\"language-text\">.eks-node-viewer</code> in your home directory and specifying options there. The format is <code class=\"language-text\">option-name=value</code> where the option names are the command line flags:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># select only Karpenter managed nodes</span>\nnode-selector<span class=\"token operator\">=</span>karpenter.sh/provisioner-name\n\n<span class=\"token comment\"># display both CPU and memory</span>\n<span class=\"token assign-left variable\">resources</span><span class=\"token operator\">=</span>cpu,memory</code></pre></div>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèÅ Conclusion</h2>\n<p>EKS Node Viewer is a valuable tool for optimizing Kubernetes clusters and improving efficiency. By visualizing dynamic node usage, EKS Node Viewer can help you identify nodes that are underutilized or overutilized, and make decisions about node scaling and consolidation. This can lead to significant cost savings and improved performance.</p>\n<p>If you are running Kubernetes clusters on AWS, I highly recommend using EKS Node Viewer. It is easy to use and install, and it can provide valuable insights into your cluster usage.</p>\n<br>\n<br>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}