{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/aws-signer-oci-artifacts/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Ensuring the integrity and authenticity of containerized applications and Metadata</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîñ Introduction</h2>\n<p>The adoption of containers grows, so does the need to ensure the integrity and authenticity of the software artifacts that make up these applications.</p>\n<p>Beyond just the container images themselves, organizations are required to secure additional metadata files, such as Common Vulnerabilities and Exposure (CVE) scan results, Software Bill of Materials (SBOM), and Helm charts, that provide critical information about the components and dependencies of their containerized applications.</p>\n<p><em>Ensuring the provenance and trustworthiness of these artifacts is essential for maintaining the overall security and compliance of the software supply chain.</em></p>\n<p>In this blog post, we will explore how AWS Signer, a fully managed code-signing service, can be used to cryptographically sign and validate not only container images, but also the associated OCI (Open Container Initiative) artifacts that accompany them.</p>\n<h2 id=\"open-container-initiative-oci\" style=\"position:relative;\"><a href=\"#open-container-initiative-oci\" aria-label=\"open container initiative oci permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Open Container Initiative OCI</h2>\n<p>The Open Container Initiative (OCI) is a lightweight, open governance structure (project), formed under the auspices of the Linux Foundation, for the express purpose of creating open industry standards around container formats and runtimes. The OCI was launched on June 22nd 2015 by Docker, CoreOS and other leaders in the container industry.</p>\n<p>The OCI currently contains three specifications: the Runtime Specification (runtime-spec), the Image Specification (image-spec) and the Distribution Specification (distribution-spec). The Runtime Specification outlines how to run a ‚Äúfilesystem bundle‚Äù that is unpacked on disk.</p>\n<h2 id=\"aws-signer\" style=\"position:relative;\"><a href=\"#aws-signer\" aria-label=\"aws signer permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>AWS Signer</h2>\n<p>AWS Signer is a fully managed signing service that simplifies the process of signing container images. It integrates seamlessly with ECR, allowing you to sign and verify images easily in your ECR repositories.</p>\n<p>AWS Signer uses the Notary project, an open-source container image signing tool, to perform the signing and verification operations. Image signing involves creating a cryptographic signature using a private key and the image‚Äôs digest.</p>\n<p>The signature is then attached to the image, and when the image is deployed, the signature is verified using the corresponding public key.</p>\n<p>If the verification fails, it indicates that the image has been tampered with and should not be deployed.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.8235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAQADBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAeauSMSf/8QAGBAAAgMAAAAAAAAAAAAAAAAAEBEAAQL/2gAIAQEAAQUCcdjR/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bh//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAMAAwEAAAAAAAAAAAAAAAABIRARYYH/2gAIAQEAAT8hTaVOg66Q/M//2gAMAwEAAgADAAAAEIj/AP/EABYRAAMAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxClf//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EIP/xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhYRAxQXH/2gAIAQEAAT8QIQjOot17rNRqqthEoDT7z//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Image description\" title=\"\" src=\"/static/c13fa318951a791335eb2364ccbcb103/7bf67/signer.jpg\" srcset=\"/static/c13fa318951a791335eb2364ccbcb103/651be/signer.jpg 170w,\n/static/c13fa318951a791335eb2364ccbcb103/d30a3/signer.jpg 340w,\n/static/c13fa318951a791335eb2364ccbcb103/7bf67/signer.jpg 680w,\n/static/c13fa318951a791335eb2364ccbcb103/4b190/signer.jpg 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"hands-on-example\" style=\"position:relative;\"><a href=\"#hands-on-example\" aria-label=\"hands on example permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-On example</h2>\n<p>If you want to implement image signing within our development workflows. It‚Äôs important to think about which other OCI artifacts we intend to incorporate alongside our images. Equally critical is ensuring that security is integrated at every stage of the image‚Äôs lifecycle, from its initial creation to deployment. For this latter aspect, leveraging signatures within an OCI repository can be advantageous, addressing key container security practices:</p>\n<ul>\n<li>Establishing ongoing trust as vulnerabilities and configuration requirements evolve</li>\n<li>Validating the integrity of images to ensure they remain untampered</li>\n<li>Approving images and artifacts that align with organizational compliance standards.</li>\n</ul>\n<p>Consequently, our approach should involve selecting, signing, and managing all relevant OCI artifacts for an image to enhance trust and enhance visibility across the software development lifecycle (SDLC).</p>\n<p>Let‚Äôs check a typical development process and explore how our organization can embrace these practices. Additionally, you can refer to this security blog for further insights on integrating AWS Signer into a pipeline.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 14.117647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjUlEQVR42jWO2QrFIBBD+///J6VCN7tYF6oIfc7lCPdBBifJmQwpJXnvxQwhaN93OecUY1QpRbVWWWtljOn74zj0PE/38viv66pt23Rdl4ZlWXoAwH3fGsexQwF936ecs973Fb5pmtRa0zzPHQqAMud59oNkBugAEbmGQJAAMFoQoh1ewn8vBdDZoeP/AbJF3GOJ0sJRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Image description\" title=\"\" src=\"/static/64c3bc91eeee6e82c1495482e8ea2693/c5bb3/example.png\" srcset=\"/static/64c3bc91eeee6e82c1495482e8ea2693/04472/example.png 170w,\n/static/64c3bc91eeee6e82c1495482e8ea2693/9f933/example.png 340w,\n/static/64c3bc91eeee6e82c1495482e8ea2693/c5bb3/example.png 680w,\n/static/64c3bc91eeee6e82c1495482e8ea2693/5a190/example.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>Initially, developers fetch public images for initial testing and customization on their local machines.</p>\n<p>Once prepared for building, they upload their build specification files to a shared code repository, such as <strong>AWS CodeCommit</strong>.</p>\n<p>A modification in the shared repository triggers a pipeline via AWS CodeBuild. This pipeline utilizes the build specification files to construct and sign an image using** AWS Signer**.</p>\n<p>Subsequently, the image is uploaded to an <strong>OCI-compliant</strong> image repository, such as Amazon Elastic Container Registry (Amazon ECR). Notably, AWS Signer, in conjunction with the underlying Notation CLI client, can be employed with any OCI 1.0 compatible registry.</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>By integrating AWS Signer into your software development lifecycle, you can establish a robust and centralized solution for managing the signing and verification of your containerized applications and their supporting metadata, ensuring the trust and integrity of your software supply chain.</p>\n<p><strong>References:</strong></p>\n<ul>\n<li><a href=\"https://aws.amazon.com/blogs/containers/signing-and-validating-oci-artifacts-with-aws-signer/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws.amazon.com/blogs/containers/signing-and-validating-oci-artifacts-with-aws-signer/</a></li>\n<li><a href=\"https://aws.amazon.com/blogs/security/best-practices-to-help-secure-your-container-image-build-pipeline-by-using-aws-signer/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws.amazon.com/blogs/security/best-practices-to-help-secure-your-container-image-build-pipeline-by-using-aws-signer/</a></li>\n<li><a href=\"https://aws.amazon.com/blogs/containers/cryptographic-signing-for-containers/\" target=\"_blank\" rel=\"noopener noreferrer\">https://aws.amazon.com/blogs/containers/cryptographic-signing-for-containers/</a></li>\n<li><a href=\"https://opencontainers.org/about/overview/\" target=\"_blank\" rel=\"noopener noreferrer\">https://opencontainers.org/about/overview/</a></li>\n</ul>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":3,"rawMarkdownBody":"\n> **Ensuring the integrity and authenticity of containerized applications and Metadata**\n\n## üîñ Introduction\n\nThe adoption of containers grows, so does the need to ensure the integrity and authenticity of the software artifacts that make up these applications.\n\nBeyond just the container images themselves, organizations are required to secure additional metadata files, such as Common Vulnerabilities and Exposure (CVE) scan results, Software Bill of Materials (SBOM), and Helm charts, that provide critical information about the components and dependencies of their containerized applications.\n\n_Ensuring the provenance and trustworthiness of these artifacts is essential for maintaining the overall security and compliance of the software supply chain._\n\nIn this blog post, we will explore how AWS Signer, a fully managed code-signing service, can be used to cryptographically sign and validate not only container images, but also the associated OCI (Open Container Initiative) artifacts that accompany them.\n\n## Open Container Initiative OCI\nThe Open Container Initiative (OCI) is a lightweight, open governance structure (project), formed under the auspices of the Linux Foundation, for the express purpose of creating open industry standards around container formats and runtimes. The OCI was launched on June 22nd 2015 by Docker, CoreOS and other leaders in the container industry.\n\nThe OCI currently contains three specifications: the Runtime Specification (runtime-spec), the Image Specification (image-spec) and the Distribution Specification (distribution-spec). The Runtime Specification outlines how to run a ‚Äúfilesystem bundle‚Äù that is unpacked on disk.\n\n## AWS Signer\n\nAWS Signer is a fully managed signing service that simplifies the process of signing container images. It integrates seamlessly with ECR, allowing you to sign and verify images easily in your ECR repositories.\n\nAWS Signer uses the Notary project, an open-source container image signing tool, to perform the signing and verification operations. Image signing involves creating a cryptographic signature using a private key and the image‚Äôs digest.\n\nThe signature is then attached to the image, and when the image is deployed, the signature is verified using the corresponding public key.\n\nIf the verification fails, it indicates that the image has been tampered with and should not be deployed.\n\n\n![Image description](./signer.jpg)\n\n## Hands-On example\n\nIf you want to implement image signing within our development workflows. It‚Äôs important to think about which other OCI artifacts we intend to incorporate alongside our images. Equally critical is ensuring that security is integrated at every stage of the image‚Äôs lifecycle, from its initial creation to deployment. For this latter aspect, leveraging signatures within an OCI repository can be advantageous, addressing key container security practices:\n\n- Establishing ongoing trust as vulnerabilities and configuration requirements evolve\n- Validating the integrity of images to ensure they remain untampered\n- Approving images and artifacts that align with organizational compliance standards.\n\nConsequently, our approach should involve selecting, signing, and managing all relevant OCI artifacts for an image to enhance trust and enhance visibility across the software development lifecycle (SDLC).\n\nLet‚Äôs check a typical development process and explore how our organization can embrace these practices. Additionally, you can refer to this security blog for further insights on integrating AWS Signer into a pipeline.\n\n\n![Image description](example.png)\n\n\nInitially, developers fetch public images for initial testing and customization on their local machines.\n\nOnce prepared for building, they upload their build specification files to a shared code repository, such as **AWS CodeCommit**.\n\nA modification in the shared repository triggers a pipeline via AWS CodeBuild. This pipeline utilizes the build specification files to construct and sign an image using** AWS Signer**.\n\nSubsequently, the image is uploaded to an **OCI-compliant** image repository, such as Amazon Elastic Container Registry (Amazon ECR). Notably, AWS Signer, in conjunction with the underlying Notation CLI client, can be employed with any OCI 1.0 compatible registry.\n\n## Conclusion\n\nBy integrating AWS Signer into your software development lifecycle, you can establish a robust and centralized solution for managing the signing and verification of your containerized applications and their supporting metadata, ensuring the trust and integrity of your software supply chain.\n\n**References:**\n\n- https://aws.amazon.com/blogs/containers/signing-and-validating-oci-artifacts-with-aws-signer/\n- https://aws.amazon.com/blogs/security/best-practices-to-help-secure-your-container-image-build-pipeline-by-using-aws-signer/\n- https://aws.amazon.com/blogs/containers/cryptographic-signing-for-containers/\n- https://opencontainers.org/about/overview/\n  \n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  _**Until next time üéâ**_\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":732},"frontmatter":{"id":"6ade66b8927d1379076f2e29","path":"/blog/aws-signer-oci-artifacts/","humanDate":"Oct 19, 2024","fullDate":"2024-10-19","title":"Secure the software supply chain with AWS Signer for signing and validating OCI artifacts","keywords":["AWS","AWS Signer","OCI Artifacts","Software Supply Chain","Container Security"],"excerpt":"Secure your software supply chain by using AWS Signer to sign and validate OCI artifacts and ensure the integrity and authenticity of your containerized applications and metadata.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACa0lEQVR42mVRWU+TURTsdwthESiYGDEmPhET4wKVIthSaGmhUhbBjQQT9QFcaAsS0LbRLtAipQiySHjxxQegbGFv+7VFxD82zlceJPFhcm7uOWfuzFyVMZpG7UQSulAcd4NHaJhMojZ0BN3YEWwzGegnEjAQt337uMcZpd80JUPrP0B9OAFzRMbNT3socW4jv90PlXYsDlM0hcZJGdXBQ5g4UMcH9Fys59nwJQkL+9rAAclktPKR1q8Z1I3HUcN5y1QKN7z7yH0yD8nsheraxx08WjqFWRmikmfLf2Agkf3bMbq//0bNONVy0UhiPRV2z5/AyAc7ZjMkk9E2e4zLb1ehMo1AbeiHqmRwA0Wju7jk3oN+OgPrwgla5n6hZSadRWNWZQL3SWbluYu9BpJbqax8aBMFvYuQ2sYh7EGIZiosdsRQ5NqAhk0dB6sjaVYZlbSoZFfNLO/4DlBFKLlVETpmrQ0couDVT6g6pyF1RiG1+iFaPFRIwjOsIbd/BaWOdVz37EIzEIOG9xfexVDwehWFxFldQd6bVYieJUgdExAPA4QPUpMDkmX4H6HGqSyvZT+midb04Tgq3DvsraOM/VJCqWWuTeT1xSA6IgRtdvmgfrGInKFtSHbvOUKikIQVnh3YmZ0SuJLbleEtlPA+S+gkWQ8z65yFaA9Dah6l0ghy3DJyRg6h7p07b5lZ0mb5+y3YplN4vnyKOhJeZL6KylLnOvK7pyDVOyEsHyDawqzDtOmC6PsB9UtGYA/8T3h1ZBu3Pu/TciKbZ/GAYncD+c1crnwMYRyE0PdBehDMEgqbl0Qh/vQYxNMF/AWRHrhRA9cPAgAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/11c9ff60b90c1878fbe8f8bc7076ed34/bbc75/oci-cover.png","srcSet":"/static/11c9ff60b90c1878fbe8f8bc7076ed34/ea251/oci-cover.png 750w,\n/static/11c9ff60b90c1878fbe8f8bc7076ed34/bbc75/oci-cover.png 800w","sizes":"100vw"},"sources":[{"srcSet":"/static/11c9ff60b90c1878fbe8f8bc7076ed34/678bf/oci-cover.webp 750w,\n/static/11c9ff60b90c1878fbe8f8bc7076ed34/c79d7/oci-cover.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.50375}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/kubernetes-gateway-api-part1/","title":"Redefining Kubernetes networking with Gateway API: Part 1","date":"2024-10-19 13:06:00"},"excerpt":"Improving connectivity and security in k8s clusters üï∏ üìï Introduction The core ideas for this Gateway API were initially proposed by Bowei‚Ä¶","html":"<blockquote>\n<p><strong>Improving connectivity and security in k8s clusters üï∏</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìï Introduction</h2>\n<p>The core ideas for this Gateway API were initially <a href=\"https://youtu.be/Ne9UJL6irXY?si=jVRaFZpbjI1osfHq\" target=\"_blank\" rel=\"noopener noreferrer\">proposed by Bowei Du (Software Engineer, Google)</a> at KubeCon San Diego as \"Ingress v2\", the next generation of the Ingress API for Kubernetes.</p>\n<p>This proposal came as the shortcomings of the original Ingress API were becoming apparent.</p>\n<p>The <a href=\"https://gateway-api.sigs.k8s.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Gateway API</a> is changing how traffic is managed in Kubernetes, giving more control and flexibility.</p>\n<p>The <a href=\"https://gateway-api.sigs.k8s.io/mesh/gamma/\" target=\"_blank\" rel=\"noopener noreferrer\">GAMMA</a> initiative highlights the collaboration to use Gateway API for Service Mesh, showing the industry's dedication to improving networking in Kubernetes.</p>\n<p>The <a href=\"https://www.gateway-api-controller.eks.aws.dev/dev/concepts/concepts/\" target=\"_blank\" rel=\"noopener noreferrer\">AWS Gateway API Controller</a> is key in connecting Kubernetes clusters with VPC Lattice, making it easier to manage networking resources.</p>\n<p>Keep following as we explore the impact of Gateway API and AWS VPC Lattice on Kubernetes networking, leading to a more efficient and secure infrastructure.</p>\n<p>This series of posts will look at how these technologies work together and show how combining the AWS Gateway API Controller with VPC Lattice enhances the efficiency and security of networking in AWS EKS clusters, thereby smoothing networking and improving connectivity in Kubernetes setups.</p>\n<h2 id=\"-ingress-limitations--the-gateway-api\" style=\"position:relative;\"><a href=\"#-ingress-limitations--the-gateway-api\" aria-label=\" ingress limitations  the gateway api permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöß Ingress Limitations &#x26; the Gateway API</h2>\n<p>As per documentation: Ingress is frozen. New features are being added to the Gateway API.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.11764705882354%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/ElEQVR42mVTiW7bMAzN/3/UCmzDsGVYO6DYurZp1yS+D12+EsvSG0XXXdIYeCD5RD+JpLQaRg/VeTSDh+k9Kj2hP0yQjYNuLXTnaN1BGIeaIJoJqnUolYPp5rz+6LF8KyEV9lGKKE4hpIZ1wOQ87ASCx8R2xjh55kLOaOf10XrOfxOM4xhXVx+w/vYV2+0Lk9ZaODeRmCVMJyCerHOOrSf7/lt1XQelFIKVUjLqukZZlqiqin0hBIqiYG7hg9Vas/iZYPjhZbujsiPsdjukaYY4ScimSNLQihgJxRGt7/cR+TO3f42HYTgXbJsGUlQwtJuSAlpJOrGkE7fsS1FDE98YzXzIlbJm/ng4XJZsBodNLPG4K/C4L/AUV3hOBP6mEttcY1cYtkucqgMjU0fk2sIM07lg2QKfbxN8vH7Ap5snfLndYn0X4fufBNebAj+fK9yQXVP84yHDphzxVFnCiPv8iMxYFlrmvOr7nkpT1GCDpm15KMEPDdfGwJgGivyGWhMQBiiE5MGEQV6U3DSGJzgjR5alyPOcMU+V+HKe8JJXkZ9lGW9+IdgOIzo6Jd8tgvf+zV9iBsfh7s33cHq9j2HtTPBXpPD77p5LWcoyVOpiufSw1vZo6Xm2fdjwv8iFYHOw3KeW+ncqdtqz0JauG+itOxJ1LLic/H3J/wBi3OYwXx/yXAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Freeze Ingress\" title=\"\" src=\"/static/2d17ef3d49128f0db4eab8031b607c70/c5bb3/freeze-ingress.png\" srcset=\"/static/2d17ef3d49128f0db4eab8031b607c70/04472/freeze-ingress.png 170w,\n/static/2d17ef3d49128f0db4eab8031b607c70/9f933/freeze-ingress.png 340w,\n/static/2d17ef3d49128f0db4eab8031b607c70/c5bb3/freeze-ingress.png 680w,\n/static/2d17ef3d49128f0db4eab8031b607c70/b12f7/freeze-ingress.png 1020w,\n/static/2d17ef3d49128f0db4eab8031b607c70/b5a09/freeze-ingress.png 1360w,\n/static/2d17ef3d49128f0db4eab8031b607c70/169e3/freeze-ingress.png 1682w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<div class=\"image-title\"><a href=\"https://kubernetes.io/docs/concepts/services-networking/ingress/\">Source Documentation</a></div>\n<p>Traditional Kubernetes Ingress, while functional, often falls short in complex environments due to limitations such as restricted traffic routing, limited extensibility, minimal role-based access control, constrained protocol support, and inconsistent implementations.</p>\n<p>On the other hand, Custom Resource Definitions (CRDs) offer extensive flexibility but lack a standardized approach, leading to a landscape emphasizing flexibility over uniformity.</p>\n<p>Although IngressClass decouples the ingress gateway from the back-end implementation, it still has significant limitations.</p>\n<p>Ingress is too simple for most real-world use and it only supports HTTP protocol routing. It only supports host and path matching, and there is no standard configuration for advanced routing features, which can only be achieved through annotation, such as URL redirection using Nginx Ingress Controller, which requires configuration of <code class=\"language-text\">nginx.ingress.kubernetes.io/rewrite-target</code> annotation, which is no longer adaptable to the needs of a programmable proxy.</p>\n<p>The situation where services in different namespaces must be bound to the same gateway often arises in practical situations where the ingress gateway cannot be shared across multiple namespaces.</p>\n<p>No delineation of responsibilities for creating and managing ingress gateways, resulting in developers having to not only configure gateway routes but also create and manage gateways themselves.</p>\n<p>To tackle these challenges, the Kubernetes SIG-NETWORK group initiated the development of the Gateway API in 2019. The Kubernetes Gateway API serves as a unified and adaptable solution that seamlessly integrates with native Kubernetes resources, addresses advanced use cases, adopts a role-centric approach, and emphasizes portability.</p>\n<p>The core concept is to move away from a one-size-fits-all model and capitalize on the benefits of more comprehensive frameworks. The Gateway API represents a significant advancement beyond traditional Ingress; it presents a more capable, extensible, and secure solution for managing traffic in Kubernetes environments.</p>\n<h3 id=\"-gateway-api-vs-ingress\" style=\"position:relative;\"><a href=\"#-gateway-api-vs-ingress\" aria-label=\" gateway api vs ingress permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Gateway API vs. Ingress</h3>\n<p>The Kubernetes Gateway API is a specification overseen by the <a href=\"https://github.com/kubernetes-sigs/gateway-api\" target=\"_blank\" rel=\"noopener noreferrer\">SIG-NETWORK community</a>, aimed at modeling service networking within Kubernetes. This API is crafted to enhance Kubernetes service networking through adaptable and role-oriented interfaces. As a standardized specification, projects, and organizations supporting the Gateway API must comply with its guidelines.</p>\n<table>\n<thead>\n<tr>\n<th><strong>Feature</strong></th>\n<th><strong>Ingress</strong></th>\n<th><strong>Gateway API</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Traffic Routing</strong></td>\n<td>Basic HTTP routing and advanced routing features are not natively supported.</td>\n<td>Header-based matching, traffic weighting, typed routes, and different backend types.</td>\n</tr>\n<tr>\n<td><strong>Extensibility</strong></td>\n<td>Achieved with custom annotations through a vendor-specific approach.</td>\n<td>Allows users to define their own custom resources.</td>\n</tr>\n<tr>\n<td><strong>Standardization</strong></td>\n<td>Individual implementations with inconsistencies across different Ingress controllers.</td>\n<td>Universal specification that is supported across various implementations.</td>\n</tr>\n<tr>\n<td><strong>Role-Based Access Control</strong></td>\n<td>Does not natively let different teams manage different configuration sections.</td>\n<td>Allows individual teams to manage their traffic while cluster operators set the policies.</td>\n</tr>\n<tr>\n<td><strong>Protocol Support</strong></td>\n<td>To expose non-HTTP services to the internet, different Kubernetes resources are needed.</td>\n<td>Extensive protocol support.</td>\n</tr>\n<tr>\n<td><strong>Security</strong></td>\n<td>Basic support for TLS termination.</td>\n<td>Generally facilitates enhanced security controls which the cluster operators define.</td>\n</tr>\n</tbody>\n</table>\n<p>For more details, you can refer to the <a href=\"https://gateway-api.sigs.k8s.io/\" target=\"_blank\" rel=\"noopener noreferrer\">official Gateway API documentation</a>.</p>\n<h2 id=\"-gateway-api-concepts-and-features\" style=\"position:relative;\"><a href=\"#-gateway-api-concepts-and-features\" aria-label=\" gateway api concepts and features permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåê Gateway API Concepts and Features</h2>\n<p>The Gateway API embodies four fundamental concepts: <strong>role-oriented approach</strong>, <strong>portability</strong>, <strong>expressiveness</strong>, and <strong>extensibility</strong>. These principles establish a versatile framework for Kubernetes service networking, empowering teams with enhanced control, advanced routing capabilities, flexible configurations, and standardized traffic management within Kubernetes clusters. When managing network traffic in Kubernetes, the Gateway API promises a comprehensive set of features that add value in the context of modern infrastructures.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 87.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACk0lEQVR42n1U2U4bQRD0//9K8hIleUGJIqEkioRQDkBgxxhjew+vvYf3nLvoHnvDAiYltT0zO1M9XVu9IzgHhigDiOIvrMywh0MP3tIIB6EOoR1amhuLFxi5A+H45xdMzt6jiG9gaaksS1RVhaapEa03mIYS48BgEmhcrxSWW4Oqc89SEyH/KCUxv7/H7e0Mq+US1hiYQ1hr0HYSi42iMLhPFOaJQZAaf+ujhIy6rlDsduiExDHYXhopwVXx1LkjJe812j+5uzjH8uYHqjx8FO+AsrVIK4usUshrQ2GPJn5C+OfXGN9OvyMKI0i6SVEUXsc0TbGIcgSZw++7vX7bnfFaHyXssVwFuB5PUdWtn+81tHAUu8ZgQySrpEGUCuSN9dq5/xEqpYhEQWvlyZ5D0nNOoLWmkEfoBoR92bIMcXb6EZ9OPvt50zS+fLYRW6goW6wLi0VCzlgrJDuLbWkp0cCHfTCSOMTV5SXGVDrfsm1bT7YjB0jRIYgzRJnGJDQ4nxJpopEUBsq4lyUz6WKxxGx2izgK9/o5C0MSPNoH3tAdLdWtojElHThtlCUxcnqLrEuPTvIBbjOLsu7IwNbPh5VwMtG16LrG6951nV8bfT35gHdv32C72fiu2KZckkCcWypL+0hJI/bdsHeruiZNW99hURR7WYQQGN1MZ7i4ukaW5VSaRl6UCFNJhI76VmC8ktgQIZOagfFqIuQIggBJkniNPWEcRUjWa3/lHkLz10XTBuVbsSKtpH5qEV8yEfQ24jHL8eSl8BvlB1J2lL30duEDDfU5B/uU9/D/a/hnGz6Y5znpEWE8mfgxt12eF96L8/ncR5Zlfv1VwqFlWAc+EIahJ2QivhFrxTqtSRpe57XXCB8AqwV0AaICF9kAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Gateway Schema\" title=\"\" src=\"/static/1d5defe45ad2ab92f234f1e9df7409df/c5bb3/gw-schema.png\" srcset=\"/static/1d5defe45ad2ab92f234f1e9df7409df/04472/gw-schema.png 170w,\n/static/1d5defe45ad2ab92f234f1e9df7409df/9f933/gw-schema.png 340w,\n/static/1d5defe45ad2ab92f234f1e9df7409df/c5bb3/gw-schema.png 680w,\n/static/1d5defe45ad2ab92f234f1e9df7409df/5a190/gw-schema.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"Ô∏è-classes\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-classes\" aria-label=\"Ô∏è classes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üè∑Ô∏è Classes</h3>\n<p><strong>GatewayClasses</strong> serve to formalize distinct load balancing implementations, simplifying users' comprehension of the diverse capabilities available through the Kubernetes resource model. By categorizing load balancing options, GatewayClasses offer users clarity and specificity regarding the features each option provides.</p>\n<h3 id=\"-gateways\" style=\"position:relative;\"><a href=\"#-gateways\" aria-label=\" gateways permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåâ Gateways</h3>\n<p>The Gateway API supports <strong>Shared Gateways</strong> and <strong>cross-Namespace functionality</strong>, enabling the sharing of load balancers and Virtual IPs (VIPs) by allowing independent Route resources to connect to the same Gateway. This feature facilitates secure infrastructure sharing among teams operating across different namespaces without necessitating direct coordination. It promotes efficiency and collaboration within Kubernetes environments.</p>\n<h3 id=\"Ô∏è-routes\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-routes\" aria-label=\"Ô∏è routes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ§Ô∏è Routes</h3>\n<p>Unlike Ingress, which is confined to HTTP routing, the Gateway API broadens its scope by introducing <strong>Typed Routes</strong> and diverse backend support. This expanded flexibility enables the API to accommodate various protocols like HTTP and gRPC, along with a variety of backend targets, enhancing its versatility in managing network traffic effectively.</p>\n<h3 id=\"-gamma-initiative-extending-the-gateway-api-for-service-mesh-management\" style=\"position:relative;\"><a href=\"#-gamma-initiative-extending-the-gateway-api-for-service-mesh-management\" aria-label=\" gamma initiative extending the gateway api for service mesh management permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üß© GAMMA Initiative: Extending the Gateway API for Service Mesh Management</h3>\n<p>The <strong>GAMMA Initiative</strong> is a special project within the Gateway API group. It started in 2022 to make the Gateway API better for how services communicate within a cluster.</p>\n<p>Originally, the Gateway API was mainly for managing traffic from outside to inside a cluster (like a front door). But as more people wanted to use it for communication between services inside the cluster (like talking between rooms), the GAMMA Initiative was created.</p>\n<p>GAMMA's main goal is to make it easier to set up and manage how services talk to each other in a cluster. They want to do this without changing the Gateway API too much and keeping its main way of working.</p>\n<p>They also want all projects using the Gateway API for service communication to do it in a similar way, no matter what technology they use. It's interesting that around the same time, another project called <a href=\"https://www.envoyproxy.io/docs/envoy/latest/start/sandboxes/envoy-gateway\" target=\"_blank\" rel=\"noopener noreferrer\">Envoy Gateway</a> started too.</p>\n<p>This shows that many are interested in making the Gateway API work better for both inside-cluster communication (east-west) and outside-cluster traffic (north-south).</p>\n<p>This means that in the future, the Gateway API could be used not just for letting traffic in from outside but also for helping services talk to each other within Kubernetes clusters.</p>\n<p>The work of the GAMMA initiative will be captured in Gateway Enhancement Proposals that extend or refine the Gateway API specification to cover mesh and mesh-adjacent use cases. To date, these have been relatively small changes (albeit sometimes with relatively large impacts!) and we expect that to continue. Governance of the Gateway API specification remains solely with the maintainers of the Gateway API subproject.</p>\n<p>The ideal final outcome of the GAMMA initiative is that service mesh use cases become a first-party concern of Gateway API, at which point there will be no further need for a separate initiative.</p>\n<h3 id=\"-summary\" style=\"position:relative;\"><a href=\"#-summary\" aria-label=\" summary permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìú Summary</h3>\n<p>The Gateway API is like a newer version of the Kubernetes Ingress API. It provides a clearer set of rules for Kubernetes gateway providers compared to the older Ingress API.</p>\n<p>This upgrade enhances the features of the ingress gateway, making it easier to use and manage gateways by different groups. Additionally, the GAMMA initiative is working on combining the Ingress Gateway with the Gateway API for service mesh applications.</p>\n<p>There are plans to expand the Gateway API's capabilities to include east-west gateways through policy attachments.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"},"nextThought":{"frontmatter":{"path":"/blog/aws-eks-open-source-monitoring-stack-guide/","title":"AWS EKS Monitoring Stack: Grafana, Prometheus, AlertManager, Promtail, and Loki","date":"2024-10-19 11:00:00"},"excerpt":"Monitoring AWS EKS with performant open source tools üîñ Introduction Amazon Elastic Kubernetes Service (EKS) is a managed Kubernetes service‚Ä¶","html":"<blockquote>\n<p><strong>Monitoring AWS EKS with performant open source tools</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîñ Introduction</h2>\n<p>Amazon Elastic Kubernetes Service (EKS) is a managed Kubernetes service that makes it easy to run Kubernetes on AWS. However, EKS doesn't come with a built-in monitoring solution. This means that you need to set up your own monitoring stack if you want to track the health and performance of your EKS cluster.</p>\n<p>In this article, we will show you how to create a monitoring stack for AWS EKS using <strong>Grafana</strong>, <strong>Prometheus</strong>, <strong>AlertManager</strong>, <strong>Promtail</strong>, and <strong>Loki</strong>. These open source tools provide a comprehensive monitoring solution that can help you track all aspects of your EKS cluster, from metrics to logs.</p>\n<p>We will walk you through the steps of installing and configuring these tools, and we will show you how to create dashboards in Grafana to visualize your data. By the end of this article, you will have a solid understanding of how to monitor your AWS EKS cluster using open source tools.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACOElEQVR42nWTW2sTQRTH84nER0Eo+AF8Efvmi29aEEtavFQfCoIPIgpGsA1eUEstBksiGKhW7Q2lTdVoU7BKIrWNMZvsJtndmc1eZv7OzmyakOCBs5czM785/3NmYojMK27Dyb0Hdwj6jXPlA3FighELnNrhn4zFwoeVmkb13HEYt8ahjQ2DWc0IxBEwLmGMhc7VOhHgzANJJ2BOX4SdvgvuUgXkYoc/w4dBFudloHzyEKz5+woY+AMZ8pAsrL3+DNaLCaFqFuT1Tfj7BQVkZgOV00OgSy/hV3ahxU/ATE2p1QK4sdPG+Xt1jCXr+FZyRVAB3R8zcPK3wUSJ3J054U+6kk0huXHnCuzsLPRrZ+DpdTmY+WBjaLyMiUc6RqfqOHahjHd5Jc03f8MtTcKvJuDuXkdgbHaBsim/vsMt5ET9WujUP55Uma0VKJa/Uowkaph8asgxWU5/D4xugHulTpsiYG8L5bf6P3WjissPdQF0sLbtCOk1nBXQg1oeFDaks26GXHaNiSawqLNq3qoAHRndl6CRhIaj8TLyxbYqL4vWcSa9YzH8xzqbv/lMcemBjquPDZllv6B+k8BixYNhBjAshj3Nh0UZdJNBawZwPLVaF+PVRoBy3UfTZmgIbxKGv0aAWouBtKODHb6yOYq5JQuZjwQLmwRp0d1X6wSffraRyLSwsuVIqcmsKebZeL5iY/ELRWrVlj7z1sLyltNTw57DG94MeSOiTroiQxrt7gd8QC7vXh4J/AfM23XnepObZwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Grafana and Prometheus\" title=\"\" src=\"/static/aa73b94cec6b832e7e484005aa23ff4a/c5bb3/gr-prom.png\" srcset=\"/static/aa73b94cec6b832e7e484005aa23ff4a/04472/gr-prom.png 170w,\n/static/aa73b94cec6b832e7e484005aa23ff4a/9f933/gr-prom.png 340w,\n/static/aa73b94cec6b832e7e484005aa23ff4a/c5bb3/gr-prom.png 680w,\n/static/aa73b94cec6b832e7e484005aa23ff4a/5a190/gr-prom.png 800w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"-goals--objectives\" style=\"position:relative;\"><a href=\"#-goals--objectives\" aria-label=\" goals  objectives permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üéØ Goals &#x26; Objectives</h3>\n<p>If you are looking for a comprehensive and cost-effective monitoring solution for your AWS EKS cluster, then this monitoring stack is a great option. So, roll your sleeves and let's get cracking! üî•</p>\n<h3 id=\"-prerequisites\" style=\"position:relative;\"><a href=\"#-prerequisites\" aria-label=\" prerequisites permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìã Prerequisites</h3>\n<ul>\n<li>Knowledge of Kubernetes.</li>\n<li>AWS EKS cluster.</li>\n<li><a href=\"https://helm.sh/docs/intro/install/\" target=\"_blank\" rel=\"noopener noreferrer\">Helm</a>.</li>\n</ul>\n<h2 id=\"Ô∏è-kube-prometheus-stack-an-effective-way-to-monitor-aws-eks-cluster\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-kube-prometheus-stack-an-effective-way-to-monitor-aws-eks-cluster\" aria-label=\"Ô∏è kube prometheus stack an effective way to monitor aws eks cluster permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Kube-Prometheus-Stack: An Effective Way to Monitor AWS EKS Cluster</h2>\n<p><a href=\"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack\" target=\"_blank\" rel=\"noopener noreferrer\"><strong>Kube-Prometheus-stack</strong></a>, also known as <strong>Prometheus Operator</strong>, is a popular open-source project providing complete monitoring and alerting solutions for Kubernetes clusters. It combines tools and components to create a monitoring stack for Kubernetes environments.</p>\n<p>We will use the official Helm Chart <a href=\"https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack\" target=\"_blank\" rel=\"noopener noreferrer\"><strong>Kube-Prometheus-stack</strong></a>, with a customized value file.</p>\n<h4 id=\"steps-to-deploy-the-monitoring-stack\" style=\"position:relative;\"><a href=\"#steps-to-deploy-the-monitoring-stack\" aria-label=\"steps to deploy the monitoring stack permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Steps to Deploy the Monitoring Stack</h4>\n<ol>\n<li>\n<p><strong>Creating Namespace called monitoring</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl create namespace monitoring</code></pre></div>\n</li>\n<li>\n<p><strong>Add a new Helm Repository</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm repo <span class=\"token function\">add</span> prometheus-community https://prometheus-community.github.io/helm-charts\nhelm repo update</code></pre></div>\n</li>\n<li>\n<p><strong>Edit the Values</strong></p>\n<p>These settings indicate that the selectors mentioned (rule, service monitor, pod monitor, and scrape config) will have independent configurations and will not be based on Helm graphic values.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">prometheus</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">agentMode</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n  <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">networkPolicy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">flavor</span><span class=\"token punctuation\">:</span> kubernetes\n  <span class=\"token key atrule\">serviceAccount</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">create</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">serviceMonitor</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">selfMonitor</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">sampleLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token key atrule\">targetLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token key atrule\">labelLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token key atrule\">labelNameLengthLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token key atrule\">labelValueLengthLimit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token key atrule\">scheme</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">tlsConfig</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">bearerTokenFile</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metricRelabelings</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">relabelings</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key atrule\">prometheusSpec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">disableCompaction</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enableRemoteWriteReceiver</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">replicaExternalLabelName</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">replicaExternalLabelNameClear</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">prometheusExternalLabelName</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">prometheusExternalLabelNameClear</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">externalUrl</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">nodeSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">secrets</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">configMaps</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">query</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">ruleNamespaceSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">ruleSelectorNilUsesHelmValues</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">ruleSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">serviceMonitorSelectorNilUsesHelmValues</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">serviceMonitorSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">serviceMonitorNamespaceSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">podMonitorSelectorNilUsesHelmValues</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">podMonitorSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">podMonitorNamespaceSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">probeSelectorNilUsesHelmValues</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">probeSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">probeNamespaceSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">scrapeConfigSelectorNilUsesHelmValues</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">scrapeConfigSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">scrapeConfigNamespaceSelector</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">retention</span><span class=\"token punctuation\">:</span> 10d\n    <span class=\"token key atrule\">retentionSize</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">tsdb</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">outOfOrderTimeWindow</span><span class=\"token punctuation\">:</span> 0s\n    <span class=\"token key atrule\">walCompression</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">paused</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token key atrule\">shards</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token key atrule\">logLevel</span><span class=\"token punctuation\">:</span> info\n    <span class=\"token key atrule\">logFormat</span><span class=\"token punctuation\">:</span> logfmt\n    <span class=\"token key atrule\">routePrefix</span><span class=\"token punctuation\">:</span> /\n    <span class=\"token key atrule\">podMetadata</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">podAntiAffinity</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">podAntiAffinityTopologyKey</span><span class=\"token punctuation\">:</span> kubernetes.io/hostname\n    <span class=\"token key atrule\">affinity</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">remoteRead</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">additionalRemoteRead</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">remoteWrite</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">additionalRemoteWrite</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">remoteWriteDashboards</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">storageSpec</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">additionalScrapeConfigs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">additionalScrapeConfigsSecret</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">additionalPrometheusSecretsAnnotations</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">additionalAlertManagerConfigs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">additionalAlertManagerConfigsSecret</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">additionalAlertRelabelConfigs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">additionalAlertRelabelConfigsSecret</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">arbitraryFSAccessThroughSMs</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">overrideHonorLabels</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">overrideHonorTimestamps</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">ignoreNamespaceSelectors</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enforcedNamespaceLabel</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token key atrule\">prometheusRulesExcludedFromEnforce</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">excludedFromEnforcement</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">queryLogFile</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enforcedSampleLimit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enforcedTargetLimit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enforcedLabelLimit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enforcedLabelNameLengthLimit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">enforcedLabelValueLengthLimit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">allowOverlappingBlocks</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">minReadySeconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token key atrule\">hostNetwork</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">hostAliases</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">tracingConfig</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><strong>Run the Helm Deployment Command</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm upgrade <span class=\"token parameter variable\">--install</span> <span class=\"token parameter variable\">-f</span> values.yaml kube-prometheus-stack prometheus-community/kube-prometheus-stack <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n</li>\n</ol>\n<p>After we deploy the Kube-Prometheus stack, we get:</p>\n<ul>\n<li><strong>Grafana</strong></li>\n<li><strong>Prometheus</strong></li>\n<li><strong>AlertManager</strong></li>\n</ul>\n<h2 id=\"-testing\" style=\"position:relative;\"><a href=\"#-testing\" aria-label=\" testing permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üß™ Testing</h2>\n<p>To check if everything is working, you can use the following commands:</p>\n<h3 id=\"prometheus-dashboard\" style=\"position:relative;\"><a href=\"#prometheus-dashboard\" aria-label=\"prometheus dashboard permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Prometheus Dashboard</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl port-forward svc/prometheus-operated <span class=\"token number\">9090</span>:9090 <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n<p>You can access the Prometheus dashboard at <a href=\"http://localhost:9090\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:9090</a>.</p>\n<h3 id=\"grafana-dashboard\" style=\"position:relative;\"><a href=\"#grafana-dashboard\" aria-label=\"grafana dashboard permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Grafana Dashboard</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl port-forward svc/kube-prometheus-stack-grafana <span class=\"token number\">3000</span>:3000 <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n<p>You can access the Grafana dashboard at <a href=\"http://localhost:3000\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:3000</a>.</p>\n<h3 id=\"check-running-pods\" style=\"position:relative;\"><a href=\"#check-running-pods\" aria-label=\"check running pods permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Check Running Pods</h3>\n<p>To ensure all pods are running, use the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl get pods <span class=\"token parameter variable\">--namespace</span> monitoring</code></pre></div>\n<h2 id=\"Ô∏è-create-a-servicemonitor\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-create-a-servicemonitor\" aria-label=\"Ô∏è create a servicemonitor permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ°Ô∏è Create a ServiceMonitor</h2>\n<p>Prometheus Operator uses ServiceMonitors to auto-detect target pods based on label selectors and associate them with Prometheus instances. The ServiceMonitor defines an application that scrapes metrics from Kubernetes.</p>\n<p>Below is an example manifest for a ServiceMonitor:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> monitoring.coreos.com/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ServiceMonitor\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> prometheus<span class=\"token punctuation\">-</span>self\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>prometheus<span class=\"token punctuation\">-</span>stack<span class=\"token punctuation\">-</span>prometheus\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">endpoints</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> 30s\n            <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> web\n    <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> kube<span class=\"token punctuation\">-</span>prometheus<span class=\"token punctuation\">-</span>stack<span class=\"token punctuation\">-</span>prometheus</code></pre></div>\n<p>The ServiceMonitor defined above will select pods labeled <code class=\"language-text\">app: kube-prometheus-stack-prometheus</code> using the <code class=\"language-text\">spec.selector.matchLabels</code> field.</p>\n<p>To apply the ServiceMonitor manifest, run the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl apply <span class=\"token parameter variable\">-f</span> servicemonitor.yaml <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n<h2 id=\"-integration-of-promtail-and-loki-to-grafana\" style=\"position:relative;\"><a href=\"#-integration-of-promtail-and-loki-to-grafana\" aria-label=\" integration of promtail and loki to grafana permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîó Integration of Promtail and Loki to Grafana</h2>\n<p>Promtail is a log agent that ships logs to Loki, a horizontally scalable, highly available, and efficient log store. Loki can be integrated with Grafana to create dashboards that visualize your logs and metrics. This integration provides a powerful way to monitor your applications and infrastructure.</p>\n<h3 id=\"-intro-to-loki\" style=\"position:relative;\"><a href=\"#-intro-to-loki\" aria-label=\" intro to loki permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìú Intro to Loki</h3>\n<p>Loki uses Promtail as its primary log collector, but it can also accept log flows from other sources, such as Syslog or other log senders. It offers high uptime and supports data replication across multiple replicas for durability and fault tolerance. Loki is tightly integrated with Grafana, allowing you to visualize log metrics. Think of Loki as Prometheus, but for logs.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 76.47058823529412%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADbklEQVR42mWT6W/jVBTF89fCJ5AQQmI+wUgUaYSEkAbaqVBBs7QdmIXpAt0ybTrTNZ22Q5s0drokbWIndhLb8f7sJD9eUjFC4knX1/LzO/fcc8/LhCJFNMu3kfYRsaBpmJSKyignaUIQBCRJStM0OCmdYpodhBBEYUjXC7HdEKsb4Lo+GcNsU1UP0c7m0bQavucTRx5h3SWS70ICxnFMIhL8yMIKdQZxQC+N6bgx+XKL3TOdXcVA1Twyuq6jlstUKhWq1Wt8x8QvT2EUf8Yt3SfS88R9SOwy3fNHmIUpCoUttHZEy4lYL3ZYP9FZ+7vBuyuXTC8V9PoDUhnDLCQb83gCLfs15uYXhLVNUoaAN1Tf3kHNfUpxbYyOWaPlpsxs1ZhcVnmwpLJV6pA5PG9h1xXCRoGwdU4o243dKkK75Ea3qDkJST8gku0GlopvnVCv13F8WVgyfLbf5OHGBb9sVNhWHTJPXxe5/P0O9dmPKKx+TCNQ6R5JdjufUcx+TvksRyQZWu192u++pJ3/hFeLsxQqHQma8GJfZ+btNU/eVNlRLTJaw6RZyGGeZumc7+GKLvWbVcyTRdzjBdJuBSkh/USgV5cxLueolg5wuq5kKMgWOmwqDmsFi/yFZChEjJAnxFCnAaTSHmLQp0uMF/TohYxWOAgJ5bfhGowePZp2zG+7GlNrCpMrCtuKZDj0WBhKjWTEcTTyVyotkiYJYd/DdRx838PHlSAD+r1UejIZ5aYd8VP2mm/mytx9WSZ72paA0pyhjCiKRn4T8udh9Hp9nEAOxb6i0lZpuDe0XeO2YJrK/RTbEzzOVfhursT3Cwp75Q8M/wMoDwxlGAp3WN3mj+OHLL1/zvz7aTZKf+I43RFgIgvGlrSOuoeh7mPK7Gml/wP+G/Tg+HqHmfwEs7uTPD2YJFf6C8d2pBxCAkJUO8LKT6Pnn8vpzxIoK2T8wGcYH0CjmEhqKTWXDHd4cfgrcwfTvDp6xGZpSTJ05DWUXcj94Gobe/VbjJV7dFbG8I6fkRnqZHYbxKYgTm7ZhVE4YvhGWeL+67s8WLvH+PoY84fT2JYtb1M0coZXWMBZ/ormxvgIuLs1TqYZ1GkZBu0ri+pNZaTRkGkSJ9TMKuuFRVZOXsoJznOhl247kAUjSdHTFIyNH9HWJ2hkf8BWcvwDyiNCgeasG1wAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Promtail\" title=\"\" src=\"/static/e34799ae75e169ae345722b568a24cc9/c5bb3/promtail.png\" srcset=\"/static/e34799ae75e169ae345722b568a24cc9/04472/promtail.png 170w,\n/static/e34799ae75e169ae345722b568a24cc9/9f933/promtail.png 340w,\n/static/e34799ae75e169ae345722b568a24cc9/c5bb3/promtail.png 680w,\n/static/e34799ae75e169ae345722b568a24cc9/f8067/promtail.png 726w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"-add-a-new-helm-repository\" style=\"position:relative;\"><a href=\"#-add-a-new-helm-repository\" aria-label=\" add a new helm repository permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üì• Add a New Helm Repository</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm repo <span class=\"token function\">add</span> grafana https://grafana.github.io/helm-charts\nhelm repo update</code></pre></div>\n<h3 id=\"-run-the-helm-deployment-command\" style=\"position:relative;\"><a href=\"#-run-the-helm-deployment-command\" aria-label=\" run the helm deployment command permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Run the Helm Deployment Command</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm upgrade <span class=\"token parameter variable\">--install</span> loki grafana/loki-distributed <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n<p>After deploying Loki, update the Kube-Prometheus-stack values file to add additional data sources. This configuration defines a default additional data source that connects to a Loki log aggregation system. It specifies the URL for accessing Loki and sets the access method to the proxy.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">grafana</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">additionalDataSources</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Loki\n            <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> loki\n            <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//loki<span class=\"token punctuation\">-</span>loki<span class=\"token punctuation\">-</span>distributed<span class=\"token punctuation\">-</span>gateway.monitoring.svc.cluster.local\n            <span class=\"token key atrule\">access</span><span class=\"token punctuation\">:</span> proxy</code></pre></div>\n<p>Please refer to the <a href=\"https://github.com/grafana/helm-charts\" target=\"_blank\" rel=\"noopener noreferrer\">Helm values</a> for more details.</p>\n<h3 id=\"-intro-to-promtail\" style=\"position:relative;\"><a href=\"#-intro-to-promtail\" aria-label=\" intro to promtail permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìú Intro to Promtail</h3>\n<p>Promtail can log files from different sources, including local files, container output streams (stdout and stderr), and systemd journals. It supports the development, filtering, and relabeling of logs before sending them to Loki.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">clients</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//loki<span class=\"token punctuation\">-</span>loki<span class=\"token punctuation\">-</span>distributed<span class=\"token punctuation\">-</span>gateway.monitoring.svc.cluster.local/loki/api/v1/push</code></pre></div>\n<p>Please refer to the <a href=\"https://github.com/grafana/helm-charts\" target=\"_blank\" rel=\"noopener noreferrer\">Helm values</a> for more details.</p>\n<h3 id=\"-run-the-helm-upgrade-command\" style=\"position:relative;\"><a href=\"#-run-the-helm-upgrade-command\" aria-label=\" run the helm upgrade command permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Run the Helm Upgrade Command</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">helm upgrade <span class=\"token parameter variable\">--install</span> <span class=\"token parameter variable\">-f</span> promtail.yaml promtail grafana/promtail <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n<p>After deploying Promtail and Loki, two new data sources will be presented to Grafana.</p>\n<h3 id=\"-access-grafana\" style=\"position:relative;\"><a href=\"#-access-grafana\" aria-label=\" access grafana permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîç Access Grafana</h3>\n<p>Run the following command to port-forward Grafana:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">kubectl port-forward svc/kube-prometheus-stack-grafana <span class=\"token number\">3000</span>:3000 <span class=\"token parameter variable\">-n</span> monitoring</code></pre></div>\n<p>Connect to Grafana by navigating to <a href=\"http://localhost:3000\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:3000</a>, then go to <strong>Menu -> Data Sources</strong> to add the new data sources.</p>\n<h3 id=\"-summary\" style=\"position:relative;\"><a href=\"#-summary\" aria-label=\" summary permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìù Summary</h3>\n<p>Setting up a monitoring stack for Kubernetes is a complex task, but it is essential for ensuring the health and performance of your applications. The steps outlined in this article provide a good starting point, but they are just the beginning. In most cases, workloads will not be limited to Kubernetes pods and containers. There will also be a need to monitor virtual machines and other infrastructure components. A unified logging mechanism based on the same tools is essential for getting a complete view of your system.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}