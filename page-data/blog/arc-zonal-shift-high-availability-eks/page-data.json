{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/arc-zonal-shift-high-availability-eks/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Maintaining apps' availability during zones and regions outages</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîä Introduction</h2>\n<p>Amazon Elastic Kubernetes Service (EKS) is a widely used managed Kubernetes service for running applications in the cloud. However, cloud parts, known as Availability Zones (AZs) or Regions, can experience outages, disrupting your applications.</p>\n<p>To address this, Amazon provides the Application Recovery Controller (ARC) with a key feature called zonal shift, which redirects traffic away from affected zones, ensuring operational reliability.</p>\n<p>In this blog post, we will explore how ARC zonal shift works within Amazon EKS, its benefits, and why it is essential for maintaining application availability during outages.</p>\n<p>Let‚Äôs dive in!</p>\n<h3 id=\"-what-is-the-application-recovery-controller-arc\" style=\"position:relative;\"><a href=\"#-what-is-the-application-recovery-controller-arc\" aria-label=\" what is the application recovery controller arc permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ö° What is the Application Recovery Controller (ARC)?</h3>\n<p><a href=\"https://aws.amazon.com/application-recovery-controller/\" target=\"_blank\" rel=\"noopener noreferrer\">The Application Recovery Controller (ARC)</a> helps manage and coordinate the recovery of applications across different AWS Regions and AZs. It provides insights into recovery readiness, making it easier to handle issues when they arise.</p>\n<p>ARC supports the following resources for zonal shift and zonal autoshift:</p>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.eks.html\" target=\"_blank\" rel=\"noopener noreferrer\">Amazon Elastic Kubernetes Service</a></li>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.app-load-balancers.html\" target=\"_blank\" rel=\"noopener noreferrer\">Application Load Balancers</a> with cross-zone load balancing disabled</li>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.network-load-balancers.html\" target=\"_blank\" rel=\"noopener noreferrer\">Network Load Balancers</a> with cross-zone load balancing enabled or disabled</li>\n</ul>\n<p><strong>Benefits of ARC:</strong></p>\n<ul>\n<li><strong>Manage Recovery for Multi-AZ and Multi-Region Applications</strong>: Quickly address problems for applications spanning multiple AZs or Regions, supporting both active-active and active-standby setups.</li>\n<li><strong>Validate Recovery Readiness</strong>: Continuously monitor resources, checking limits, capacity, and configurations, and suggest fixes.</li>\n<li><strong>Maintain High Availability</strong>: Manage failures for critical applications by quickly shifting traffic between environments.</li>\n<li><strong>Automate Recovery</strong>: Automatically redirect traffic away from an AZ when AWS detects a potential failure.</li>\n</ul>\n<h3 id=\"what-is-arc-zonal-shift\" style=\"position:relative;\"><a href=\"#what-is-arc-zonal-shift\" aria-label=\"what is arc zonal shift permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>What is ARC Zonal Shift?</h3>\n<p><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-autoshift.html\" target=\"_blank\" rel=\"noopener noreferrer\">ARC zonal shift</a> automatically moves network traffic away from an AZ experiencing problems, keeping applications running smoothly.</p>\n<p><strong>How It Helps During AZ Problems</strong><br>\nWhen an AZ faces issues, zonal shift quickly redirects traffic to healthy AZs, reducing downtime and maintaining a better user experience.</p>\n<h3 id=\"how-does-zonal-shift-work\" style=\"position:relative;\"><a href=\"#how-does-zonal-shift-work\" aria-label=\"how does zonal shift work permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>How Does Zonal Shift Work?</h3>\n<p><strong>Shifting Traffic Away from an Impaired AZ</strong><br>\nWhen an AZ is identified as having problems, zonal shift activates, redirecting traffic to healthy AZs to minimize user impact.</p>\n<p><strong>Role of AWS in Managing This Process</strong><br>\nAWS continuously monitors AZ health and automatically triggers zonal shifts, ensuring traffic is redirected without manual intervention.</p>\n<h3 id=\"benefits-of-using-arc-zonal-shift\" style=\"position:relative;\"><a href=\"#benefits-of-using-arc-zonal-shift\" aria-label=\"benefits of using arc zonal shift permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Benefits of Using ARC Zonal Shift</h3>\n<ol>\n<li><strong>Faster Recovery</strong>: Allows for quicker recovery during outages by redirecting traffic to healthy AZs.</li>\n<li><strong>Reduced Downtime</strong>: Significantly reduces downtime by automatically managing traffic during AZ problems.</li>\n<li><strong>Simplified Application Management</strong>: Automates traffic redirection, reducing the workload on your team.</li>\n<li><strong>Enhanced Reliability</strong>: Quickly shifts traffic away from impaired zones, maintaining high availability.</li>\n<li><strong>Improved User Experience</strong>: Minimizes downtime, ensuring applications remain accessible.</li>\n</ol>\n<h3 id=\"amazon-application-recovery-controllers-arc-zonal-shift-in-amazon-eks\" style=\"position:relative;\"><a href=\"#amazon-application-recovery-controllers-arc-zonal-shift-in-amazon-eks\" aria-label=\"amazon application recovery controllers arc zonal shift in amazon eks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Amazon Application Recovery Controller‚Äôs (ARC) Zonal Shift in Amazon EKS</h3>\n<h4 id=\"eks-zonal-shift-requirements\" style=\"position:relative;\"><a href=\"#eks-zonal-shift-requirements\" aria-label=\"eks zonal shift requirements permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>EKS Zonal Shift Requirements</h4>\n<p>To ensure effective ARC zonal shift in Amazon EKS:</p>\n<ol>\n<li><strong>Distribute Worker Nodes Across Multiple AZs</strong>: Protect applications from issues in any single AZ.</li>\n<li><strong>Ensure Sufficient Compute Capacity</strong>: Handle the loss of one AZ.</li>\n<li><strong>Pre-scale Your Pods</strong>: Ensure enough Pods are ready to manage traffic.</li>\n<li><strong>Spread Pod Replicas Across AZs</strong>: Maintain capacity in healthy AZs.</li>\n<li><strong>Co-locate Related Pods</strong>: Maintain performance and connectivity.</li>\n<li><strong>Test Your Setup</strong>: Verify cluster functionality with one less AZ.</li>\n</ol>\n<p>Kubernetes has built-in features for resilience during AZ impairments. Using ARC with zonal shift and zonal autoshift enhances fault tolerance and recovery capabilities in Amazon EKS.</p>\n<p>During an EKS zonal shift:</p>\n<ul>\n<li>Nodes in the impacted AZ are cordoned to prevent new Pods from being scheduled there.</li>\n<li>Availability Zone rebalancing is suspended for Managed Node Groups.</li>\n<li>Nodes in the unhealthy AZ are not terminated, and Pods are not evicted. This is to make sure that when a zonal shift expires or gets cancelled, the traffic can be safely returned to the AZ which still has full capacity</li>\n<li>The EndpointSlice controller removes Pod endpoints in the impaired AZ from relevant EndpointSlices.</li>\n</ul>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 124.11764705882354%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAACzklEQVR42q1ViW7bMAzN/39Qf2DAMDRotqBp0hxtbceXfB+xHZ9vpBIVSZq0GzYChCRafqL4SGqEC2nbFo7jIAgCeJ73PoZhCN/35cjfm6bBNRldGrquI5AInvCPwCHiOEUUxRIwjmMJygffBBwGoOkqVE2Cus3R9iWafkdjQfYcdZdJ2y0ZCKDv+wPggEFOksqAmf6At5tDZHPY2QPpBG4+hZWOERRL+eMlEIvrulgsFgdAdn29XsM0LbiOwOuLJq9pWy40zaBru/SDgE7zzWaDoijewRTgdDrF3d3d0UMy8qayrLDfH5TXT08zhFFI9gJ1vUdVldJ+SoYCTNMU2+32Oimn5Fxe8bO96qAPgH8GcS5MyBmgikc39GiHTo49aUMbec7EncbsSw8V016dYZJpmGYGloWL58LBQ6pBK4NPPdztdpSnkTxwpAxCCMRJAstzEaUxREiJLVw4vqB1AkGpkef5Ve9s25akMI4E3O/3srwW8zl+TiaY/prSfIHnxTNmj49YLVeyBMvyenJz5TAog5+RUlWV/IlP4hRRa1ZVCdeEc5mdOmNZBv2EZY7/6br/G1L+Vc4A1Zl+3WMct7iPGjzQ+C1o8J3nSYsxjfOsuwnIocmy7ADI8cppkVPpmRGxnOSwoxROsiPN4NJapDn0KENEraug/bdY5riPEkoVTdcRUK+ztgZ8T8DQ3jAZ38M09KPNg2tbMAwDlmV96DjcJxm0ruvrMWRGOU1udeVLYaDd0fORKiml/VEVs/3F91sOqA7+/1k+S9B+gBV10LwODo263+JFtCjrz3sQe8fXfgdkQ9s2qBt68cIamihhBRW2foW1XSEtGvm9ufIw8XX5CTBNU1bLSL0Jj1Szy+USb68b0jVeNitoNNdoviL7nOp8NpvJ610C8uvIacMlKknh1qPrhjyF6fc8SiHLpnQIpJ03q2/qaqfCnqlO9BtpApUp1Z6YhAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Image description\" title=\"\" src=\"/static/50921d28a0aebf43239851ea9d349501/c5bb3/napkin-selection.png\" srcset=\"/static/50921d28a0aebf43239851ea9d349501/04472/napkin-selection.png 170w,\n/static/50921d28a0aebf43239851ea9d349501/9f933/napkin-selection.png 340w,\n/static/50921d28a0aebf43239851ea9d349501/c5bb3/napkin-selection.png 680w,\n/static/50921d28a0aebf43239851ea9d349501/b12f7/napkin-selection.png 1020w,\n/static/50921d28a0aebf43239851ea9d349501/b5a09/napkin-selection.png 1360w,\n/static/50921d28a0aebf43239851ea9d349501/6b26f/napkin-selection.png 1658w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"real-world-example\" style=\"position:relative;\"><a href=\"#real-world-example\" aria-label=\"real world example permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Real-World Example</h2>\n<p>Consider an EKS cluster spread across three AZs. If one AZ experiences an outage, ARC zonal shift redirects traffic to the remaining healthy AZs, ensuring minimal interruption.</p>\n<h3 id=\"bookinfo-application-on-amazon-eks\" style=\"position:relative;\"><a href=\"#bookinfo-application-on-amazon-eks\" aria-label=\"bookinfo application on amazon eks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Bookinfo Application on Amazon EKS</h3>\n<p>The Bookinfo application, deployed in Amazon EKS, consists of four microservices operating across multiple AZs in the eu-west-1 region:</p>\n<ol>\n<li><strong>Productpage</strong>: Aggregates data from details and reviews microservices.</li>\n<li><strong>Details</strong>: Provides detailed information about books.</li>\n<li><strong>Reviews</strong>: Manages user-generated reviews.</li>\n<li><strong>Ratings</strong>: Handles ranking information for books.</li>\n</ol>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACaUlEQVR42lWTW09TQRRG+6t8IhFDSAWE6gPPhDd/DcZITEgEpC29HHqHQrG1EDHCA9SKihJ7L7TY09P29HJO78tpMSY+rOxvZpKVPZk9hnxLJ9vu8u2uRCx3Q/y2MM7x/A2JRotMrYx8uob8cZWSIH/0kp+hFZLhF9ydvKLyaZXK6WuUkxVK2QsMOb1DfgD5/oihyMNxzXX75BF7tSIDmxHMk+gbkxRXJyi9nkBbf0j/7SRDyyOwTsH6A5S4hCHdbJHudsj0uqTbHRItjaSuk+50SAlxtlqkt7OIbn1Cz2FCsy3Qd5oYSiZ6ojat8/SlZ7A9TfnSg+GsfIW/EsZze4jlu5vta5/IIfYqUQLqMdFUhPLmUwb2OQaOecrrMzTNcyDNj9fyaC2kbE/dC0/kODtqAPutF3vBi1QK4K4G8VSCSGqQSDZE37EIO6MOF6hvzdK1CYFzQXQ9R0PIW0I4FNdWvo6E5Tj2khfHjR+feog148J5F8BbPUCq7hNOh9AtJtSNKSpvpulYjGhbRtpmI0PbjOh0ltrmY9S1CaqX7vsOR0JnwY+z6MeclLBmXUgiO5VdwtkIdc9zGu4lmt5lNN/yuLZG2Sv2PEsU7UvI1kWUH6GR8Aue5gG7jQh72ntcchBvJYSvdoiruseREiOtNriulPlVq5JQVZKCxF+S9Tq5tj6mIB7T8EH5jLMpHqK5j6e1L64ZYO1qE4fsQ2r4iKoxMUKISeiT6Q7I9ob/yA8ZkxNjlxUUOz0M8WqGqHLOcTnGkRwj+vucd/mzcT1WLjgX5xmtQ1prk9L0/0iORkyQEp8jKc4LWps/4AychdSW9+kAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt\" title=\"\" src=\"/static/dff4404a95861fcc0679e20ea1a08b7f/c5bb3/image-1.png\" srcset=\"/static/dff4404a95861fcc0679e20ea1a08b7f/04472/image-1.png 170w,\n/static/dff4404a95861fcc0679e20ea1a08b7f/9f933/image-1.png 340w,\n/static/dff4404a95861fcc0679e20ea1a08b7f/c5bb3/image-1.png 680w,\n/static/dff4404a95861fcc0679e20ea1a08b7f/b12f7/image-1.png 1020w,\n/static/dff4404a95861fcc0679e20ea1a08b7f/b5a09/image-1.png 1360w,\n/static/dff4404a95861fcc0679e20ea1a08b7f/1439b/image-1.png 2562w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p><strong>Deployment in Amazon EKS</strong><br>\nDeployed in Amazon EKS, the application benefits from high availability and scalability, distributed across multiple AZs.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHElEQVR42q2QS3ODIBSF/f8/rFm0k0l3zcY0FbV5iOIDEdSvqE3qwmXPzDcwwD33HoJxHFkYgPHJ3/kaVmy/CfhVbQauauDmSaTDuqXJMCxMJoPL6K3wa+od+6fxWkHfD/TOkmSGQ6hn9qGhqAylKojjhOv1QtMYOn1Ely+eV5zTbCnI85zz+UwsIpI0Jfm++MeOruuQUhKGIUIIlFLzbxS5IoliEt+oLEuqqpoTPA0fxdZaTCVp7184leKMRsQxu92Oj+ORSpUUfiqhJXF9R7carRfWsYPJfTLsvGGbCerTG+3XAdsobveM0ykkiiJ03RC1Gfv8k3d5prVmO7IxZo42Rc+LwqN85H6+XHd+7Fs/UZ7JOe6m4aqC/9APcTttvsLHk7sAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt\" title=\"\" src=\"/static/193a9d5b71171c4322f3e5ac1d73ff4c/c5bb3/image.png\" srcset=\"/static/193a9d5b71171c4322f3e5ac1d73ff4c/04472/image.png 170w,\n/static/193a9d5b71171c4322f3e5ac1d73ff4c/9f933/image.png 340w,\n/static/193a9d5b71171c4322f3e5ac1d73ff4c/c5bb3/image.png 680w,\n/static/193a9d5b71171c4322f3e5ac1d73ff4c/b12f7/image.png 1020w,\n/static/193a9d5b71171c4322f3e5ac1d73ff4c/b5a09/image.png 1360w,\n/static/193a9d5b71171c4322f3e5ac1d73ff4c/c0566/image.png 1544w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p><strong>How to Use Zonal Shift</strong><br>\nInitiate a zonal shift manually or enable <strong>zonal autoshift</strong> for automatic traffic updates.</p>\n<p><strong>Hands-On: Simulating an AZ Outage</strong>\nTo test ARC zonal shift, you can simulate an AZ outage by manually cordoning and draining nodes in one of the AZs. This will mimic an AZ impairment and allow you to observe how ARC handles traffic redirection. Use <code class=\"language-text\">kubectl cordon &lt;node-name></code> and <code class=\"language-text\">kubectl drain &lt;node-name> --ignore-daemonsets --delete-local-data</code> to simulate the outage.</p>\n<p>Monitor your application to ensure traffic is redirected to healthy AZs and verify application availability. After testing, uncordon the nodes using <code class=\"language-text\">kubectl uncordon &lt;node-name></code> to revert the simulation.</p>\n<p><strong>Routing Traffic with Load Balancers</strong><br>\nApplication Load Balancers (ALBs) and Network Load Balancers (NLBs) automatically route traffic to healthy AZs during a zonal shift.</p>\n<h3 id=\"understanding-the-importance-of-arc-zonal-shift\" style=\"position:relative;\"><a href=\"#understanding-the-importance-of-arc-zonal-shift\" aria-label=\"understanding the importance of arc zonal shift permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Understanding the Importance of ARC Zonal Shift</h3>\n<p>ARC zonal shift automates recovery by redirecting traffic away from impaired AZs, avoiding lengthy recovery steps and extended downtime.</p>\n<h3 id=\"integration-with-aws-services\" style=\"position:relative;\"><a href=\"#integration-with-aws-services\" aria-label=\"integration with aws services permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Integration with AWS Services</h3>\n<p>ARC zonal shift modifies network traffic routing, working seamlessly with AWS Load Balancers and interacting with Amazon EC2 Auto Scaling Groups.</p>\n<h3 id=\"enhancing-resilience-beyond-kubernetes-protections\" style=\"position:relative;\"><a href=\"#enhancing-resilience-beyond-kubernetes-protections\" aria-label=\"enhancing resilience beyond kubernetes protections permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Enhancing Resilience Beyond Kubernetes Protections</h3>\n<p>ARC zonal shift complements Kubernetes' built-in protections, providing an additional layer of safety by isolating degraded AZs.</p>\n<h3 id=\"automation-with-zonal-autoshift\" style=\"position:relative;\"><a href=\"#automation-with-zonal-autoshift\" aria-label=\"automation with zonal autoshift permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Automation with Zonal Autoshift</h3>\n<p>Enable ARC zonal autoshift for AWS to monitor AZ health and automatically trigger shifts, ensuring minimal disruption.</p>\n<h3 id=\"preparing-for-zonal-shifts\" style=\"position:relative;\"><a href=\"#preparing-for-zonal-shifts\" aria-label=\"preparing for zonal shifts permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Preparing for Zonal Shifts</h3>\n<p>Pre-scale resources to ensure application availability during AZ issues.</p>\n<h3 id=\"considerations-for-stateful-applications\" style=\"position:relative;\"><a href=\"#considerations-for-stateful-applications\" aria-label=\"considerations for stateful applications permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Considerations for Stateful Applications</h3>\n<p>Assess fault tolerance for stateful applications, ensuring connectivity to persistent volumes in healthy AZs.</p>\n<h3 id=\"compatibility-with-karpenter-and-eks-fargate\" style=\"position:relative;\"><a href=\"#compatibility-with-karpenter-and-eks-fargate\" aria-label=\"compatibility with karpenter and eks fargate permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Compatibility with Karpenter and EKS Fargate</h3>\n<p>Karpenter does not support ARC zonal shift. Adjust NodePool configuration for new worker nodes in healthy AZs. ARC zonal shift does not apply to EKS Fargate.</p>\n<h3 id=\"impact-on-the-eks-control-plane\" style=\"position:relative;\"><a href=\"#impact-on-the-eks-control-plane\" aria-label=\"impact on the eks control plane permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Impact on the EKS Control Plane</h3>\n<p>ARC zonal shift affects the Kubernetes data plane, not the control plane.</p>\n<h3 id=\"cost-considerations\" style=\"position:relative;\"><a href=\"#cost-considerations\" aria-label=\"cost considerations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Cost Considerations</h3>\n<p>ARC zonal shift and zonal autoshift are available at no extra charge, but you will incur costs for provisioned instances. Pre-scale your Kubernetes data plane to balance cost and availability effectively.</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>In this blog post, we explored the Amazon Application Recovery Controller (ARC) and its zonal shift feature, which is very important for maintaining application availability during AZ outages. We discussed how ARC zonal shift works, its benefits, and the steps to prepare your EKS cluster for effective zonal shifts. Additionally, we provided a hands-on guide to simulate an AZ outage and test the functionality of ARC zonal shift.</p>\n<p>By making use of ARC zonal shift, you can enhance the resilience and reliability of your applications running on Amazon EKS. This feature ensures that your applications remain operational even during unexpected AZ impairments, providing a seamless user experience and reducing downtime.</p>\n<p><strong>References and links for further reading:</strong></p>\n<ol>\n<li>\n<p><strong>Amazon Application Recovery Controller (ARC)</strong>:</p>\n<ul>\n<li><a href=\"https://aws.amazon.com/application-recovery-controller/\" target=\"_blank\" rel=\"noopener noreferrer\">The Application Recovery Controller (ARC)</a></li>\n</ul>\n</li>\n<li>\n<p><strong>ARC Zonal Shift Documentation</strong>:</p>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-autoshift.html\" target=\"_blank\" rel=\"noopener noreferrer\">ARC Zonal Shift</a></li>\n</ul>\n</li>\n<li>\n<p><strong>ARC Supported Resources</strong>:</p>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.eks.html\" target=\"_blank\" rel=\"noopener noreferrer\">Amazon Elastic Kubernetes Service</a></li>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.app-load-balancers.html\" target=\"_blank\" rel=\"noopener noreferrer\">Application Load Balancers</a></li>\n<li><a href=\"https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.network-load-balancers.html\" target=\"_blank\" rel=\"noopener noreferrer\">Network Load Balancers</a></li>\n</ul>\n</li>\n<li>\n<p><strong>Kubernetes Commands</strong>:</p>\n<ul>\n<li><a href=\"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#cordon\" target=\"_blank\" rel=\"noopener noreferrer\">kubectl cordon</a></li>\n<li><a href=\"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#drain\" target=\"_blank\" rel=\"noopener noreferrer\">kubectl drain</a></li>\n<li><a href=\"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#uncordon\" target=\"_blank\" rel=\"noopener noreferrer\">kubectl uncordon</a></li>\n</ul>\n</li>\n</ol>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<p><br><br></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":5,"rawMarkdownBody":"\n> **Maintaining apps' availability during zones and regions outages**\n\n## üîä Introduction\n\nAmazon Elastic Kubernetes Service (EKS) is a widely used managed Kubernetes service for running applications in the cloud. However, cloud parts, known as Availability Zones (AZs) or Regions, can experience outages, disrupting your applications.\n\nTo address this, Amazon provides the Application Recovery Controller (ARC) with a key feature called zonal shift, which redirects traffic away from affected zones, ensuring operational reliability.\n\nIn this blog post, we will explore how ARC zonal shift works within Amazon EKS, its benefits, and why it is essential for maintaining application availability during outages.\n\nLet‚Äôs dive in!\n\n### ‚ö° What is the Application Recovery Controller (ARC)?\n\n[The Application Recovery Controller (ARC)](https://aws.amazon.com/application-recovery-controller/) helps manage and coordinate the recovery of applications across different AWS Regions and AZs. It provides insights into recovery readiness, making it easier to handle issues when they arise.\n\nARC supports the following resources for zonal shift and zonal autoshift:\n\n- [Amazon Elastic Kubernetes Service](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.eks.html)\n- [Application Load Balancers](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.app-load-balancers.html) with cross-zone load balancing disabled\n- [Network Load Balancers](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.network-load-balancers.html) with cross-zone load balancing enabled or disabled\n\n**Benefits of ARC:**\n\n- **Manage Recovery for Multi-AZ and Multi-Region Applications**: Quickly address problems for applications spanning multiple AZs or Regions, supporting both active-active and active-standby setups.\n- **Validate Recovery Readiness**: Continuously monitor resources, checking limits, capacity, and configurations, and suggest fixes.\n- **Maintain High Availability**: Manage failures for critical applications by quickly shifting traffic between environments.\n- **Automate Recovery**: Automatically redirect traffic away from an AZ when AWS detects a potential failure.\n\n### What is ARC Zonal Shift?\n\n[ARC zonal shift](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-autoshift.html) automatically moves network traffic away from an AZ experiencing problems, keeping applications running smoothly.\n\n**How It Helps During AZ Problems**  \nWhen an AZ faces issues, zonal shift quickly redirects traffic to healthy AZs, reducing downtime and maintaining a better user experience.\n\n### How Does Zonal Shift Work?\n\n**Shifting Traffic Away from an Impaired AZ**  \nWhen an AZ is identified as having problems, zonal shift activates, redirecting traffic to healthy AZs to minimize user impact.\n\n**Role of AWS in Managing This Process**  \nAWS continuously monitors AZ health and automatically triggers zonal shifts, ensuring traffic is redirected without manual intervention.\n\n### Benefits of Using ARC Zonal Shift\n\n1. **Faster Recovery**: Allows for quicker recovery during outages by redirecting traffic to healthy AZs.\n2. **Reduced Downtime**: Significantly reduces downtime by automatically managing traffic during AZ problems.\n3. **Simplified Application Management**: Automates traffic redirection, reducing the workload on your team.\n4. **Enhanced Reliability**: Quickly shifts traffic away from impaired zones, maintaining high availability.\n5. **Improved User Experience**: Minimizes downtime, ensuring applications remain accessible.\n\n### Amazon Application Recovery Controller‚Äôs (ARC) Zonal Shift in Amazon EKS\n\n#### EKS Zonal Shift Requirements\n\nTo ensure effective ARC zonal shift in Amazon EKS:\n\n1. **Distribute Worker Nodes Across Multiple AZs**: Protect applications from issues in any single AZ.\n2. **Ensure Sufficient Compute Capacity**: Handle the loss of one AZ.\n3. **Pre-scale Your Pods**: Ensure enough Pods are ready to manage traffic.\n4. **Spread Pod Replicas Across AZs**: Maintain capacity in healthy AZs.\n5. **Co-locate Related Pods**: Maintain performance and connectivity.\n6. **Test Your Setup**: Verify cluster functionality with one less AZ.\n\nKubernetes has built-in features for resilience during AZ impairments. Using ARC with zonal shift and zonal autoshift enhances fault tolerance and recovery capabilities in Amazon EKS.\n\nDuring an EKS zonal shift:\n\n- Nodes in the impacted AZ are cordoned to prevent new Pods from being scheduled there.\n- Availability Zone rebalancing is suspended for Managed Node Groups.\n- Nodes in the unhealthy AZ are not terminated, and Pods are not evicted. This is to make sure that when a zonal shift expires or gets cancelled, the traffic can be safely returned to the AZ which still has full capacity\n- The EndpointSlice controller removes Pod endpoints in the impaired AZ from relevant EndpointSlices.\n\n![Image description](./napkin-selection.png)\n\n## Real-World Example\n\nConsider an EKS cluster spread across three AZs. If one AZ experiences an outage, ARC zonal shift redirects traffic to the remaining healthy AZs, ensuring minimal interruption.\n\n### Bookinfo Application on Amazon EKS\n\nThe Bookinfo application, deployed in Amazon EKS, consists of four microservices operating across multiple AZs in the eu-west-1 region:\n\n1. **Productpage**: Aggregates data from details and reviews microservices.\n2. **Details**: Provides detailed information about books.\n3. **Reviews**: Manages user-generated reviews.\n4. **Ratings**: Handles ranking information for books.\n\n![alt](./image-1.png)\n\n**Deployment in Amazon EKS**  \nDeployed in Amazon EKS, the application benefits from high availability and scalability, distributed across multiple AZs.\n\n![alt](./image.png)\n\n**How to Use Zonal Shift**  \nInitiate a zonal shift manually or enable **zonal autoshift** for automatic traffic updates.\n\n**Hands-On: Simulating an AZ Outage**\nTo test ARC zonal shift, you can simulate an AZ outage by manually cordoning and draining nodes in one of the AZs. This will mimic an AZ impairment and allow you to observe how ARC handles traffic redirection. Use `kubectl cordon <node-name>` and `kubectl drain <node-name> --ignore-daemonsets --delete-local-data` to simulate the outage.\n\nMonitor your application to ensure traffic is redirected to healthy AZs and verify application availability. After testing, uncordon the nodes using `kubectl uncordon <node-name>` to revert the simulation.\n\n**Routing Traffic with Load Balancers**  \nApplication Load Balancers (ALBs) and Network Load Balancers (NLBs) automatically route traffic to healthy AZs during a zonal shift.\n\n### Understanding the Importance of ARC Zonal Shift\n\nARC zonal shift automates recovery by redirecting traffic away from impaired AZs, avoiding lengthy recovery steps and extended downtime.\n\n### Integration with AWS Services\n\nARC zonal shift modifies network traffic routing, working seamlessly with AWS Load Balancers and interacting with Amazon EC2 Auto Scaling Groups.\n\n### Enhancing Resilience Beyond Kubernetes Protections\n\nARC zonal shift complements Kubernetes' built-in protections, providing an additional layer of safety by isolating degraded AZs.\n\n### Automation with Zonal Autoshift\n\nEnable ARC zonal autoshift for AWS to monitor AZ health and automatically trigger shifts, ensuring minimal disruption.\n\n### Preparing for Zonal Shifts\n\nPre-scale resources to ensure application availability during AZ issues.\n\n### Considerations for Stateful Applications\n\nAssess fault tolerance for stateful applications, ensuring connectivity to persistent volumes in healthy AZs.\n\n### Compatibility with Karpenter and EKS Fargate\n\nKarpenter does not support ARC zonal shift. Adjust NodePool configuration for new worker nodes in healthy AZs. ARC zonal shift does not apply to EKS Fargate.\n\n### Impact on the EKS Control Plane\n\nARC zonal shift affects the Kubernetes data plane, not the control plane.\n\n### Cost Considerations\n\nARC zonal shift and zonal autoshift are available at no extra charge, but you will incur costs for provisioned instances. Pre-scale your Kubernetes data plane to balance cost and availability effectively.\n\n## Conclusion\n\nIn this blog post, we explored the Amazon Application Recovery Controller (ARC) and its zonal shift feature, which is very important for maintaining application availability during AZ outages. We discussed how ARC zonal shift works, its benefits, and the steps to prepare your EKS cluster for effective zonal shifts. Additionally, we provided a hands-on guide to simulate an AZ outage and test the functionality of ARC zonal shift.\n\nBy making use of ARC zonal shift, you can enhance the resilience and reliability of your applications running on Amazon EKS. This feature ensures that your applications remain operational even during unexpected AZ impairments, providing a seamless user experience and reducing downtime.\n\n**References and links for further reading:**\n\n1. **Amazon Application Recovery Controller (ARC)**:\n   - [The Application Recovery Controller (ARC)](https://aws.amazon.com/application-recovery-controller/)\n\n2. **ARC Zonal Shift Documentation**:\n   - [ARC Zonal Shift](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-autoshift.html)\n\n3. **ARC Supported Resources**:\n   - [Amazon Elastic Kubernetes Service](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.eks.html)\n   - [Application Load Balancers](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.app-load-balancers.html)\n   - [Network Load Balancers](https://docs.aws.amazon.com/r53recovery/latest/dg/arc-zonal-shift.resource-types.network-load-balancers.html)\n\n4. **Kubernetes Commands**:\n   - [kubectl cordon](https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#cordon)\n   - [kubectl drain](https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#drain)\n   - [kubectl uncordon](https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#uncordon)\n\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n<br><br>\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1257},"frontmatter":{"id":"239689aea009f4fae30599f4","path":"/blog/arc-zonal-shift-high-availability-eks/","humanDate":"Oct 27, 2024","fullDate":"2024-10-27","title":"How ARC Zonal Shift Enhances Application Availability in Amazon EKS","keywords":["ARC Zonal Shift","Amazon EKS","High availability","AWS"],"excerpt":"Learn how ARC Zonal Shift improves application availability in Amazon EKS during outages.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR42s1Uf0+DMBTc9/9efgGNbnELOnCswlxb+htKzxYXMjVxg+wPX3JpypHLvXcPFiEE3AqpFrhx/RI0LkCaHirCuIg2QNt4PyFxOj6/WrBRHgfegYkO5UeLVW4HrHcWVESORU766wXPq21bKK1hnYVzbl7LabRpvgm+70HeCuSb9SCOM26WQ+c96PIJ+uE+ztSNSV52eHrRWgvOG2gpkYsWBdNQnIFThobWMHUG0TRgjA3nRcGu60ApRUX2eKwVXpnFPrb8vMmgWA1LVqiqdxBC4llNa1lGB1pFp9stXrJscC6EnBbKVyDhZDpgyQuU/AAjGay4gzNs5CaFkhJNbRVHAiobWKPBjxvUNYH3/bS1Gb4WY1DuSrA4z3EESkfBw8Wk/1ybgHAmEOYt9igWwjc3P++zHN7kb/PvBD8BbN2MMVDHVaQAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/aeb912a8c839b1c746be8bd4994eef08/88640/arc-eks-cover.png","srcSet":"/static/aeb912a8c839b1c746be8bd4994eef08/44f96/arc-eks-cover.png 750w,\n/static/aeb912a8c839b1c746be8bd4994eef08/260b4/arc-eks-cover.png 1080w,\n/static/aeb912a8c839b1c746be8bd4994eef08/d2425/arc-eks-cover.png 1366w,\n/static/aeb912a8c839b1c746be8bd4994eef08/88640/arc-eks-cover.png 1480w","sizes":"100vw"},"sources":[{"srcSet":"/static/aeb912a8c839b1c746be8bd4994eef08/fa444/arc-eks-cover.webp 750w,\n/static/aeb912a8c839b1c746be8bd4994eef08/2d610/arc-eks-cover.webp 1080w,\n/static/aeb912a8c839b1c746be8bd4994eef08/e775f/arc-eks-cover.webp 1366w,\n/static/aeb912a8c839b1c746be8bd4994eef08/462fb/arc-eks-cover.webp 1480w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9121621621621622}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/victoriametrics-time-series-db-prometheus-k8s/","title":"VictoriaMetrics: A Guide, Comparing It to Prometheus, and Implementing Kubernetes Monitoring","date":"2024-10-27 18:06:00"},"excerpt":"A great Time-Series database for monitoring and analytics üîÜ üí¨ Introduction VictoriaMetrics is a time-series database designed for high‚Ä¶"},"nextThought":{"frontmatter":{"path":"/blog/vault-oidc-okta-authentication/","title":"Vault: OIDC Authentication with Okta","date":"2024-10-27 17:06:00"},"excerpt":"Enhancing Security and Access Control üîÜ üí¨ Introduction Hashicorp Vault is a popular open-source secret management tool that helps‚Ä¶"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}