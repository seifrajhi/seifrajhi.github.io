{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/werf-ci-cd-cncf/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>An Insight into the Rising Star of the CNCF Project üöÄ</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üóÉ Introduction</h2>\n<p>Welcome to this blog post, where we explore the fascinating world of <a href=\"https://werf.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Werf</a>, a remarkable <a href=\"https://en.wikipedia.org/wiki/CI/CD\" target=\"_blank\" rel=\"noopener noreferrer\">CI/CD</a> tool that is transforming the way we approach software development and deployment.</p>\n<p>As a <a href=\"https://github.com/werf/werf/discussions/5155\" target=\"_blank\" rel=\"noopener noreferrer\">standout member</a> of the <a href=\"https://www.cncf.io/projects/werf/\" target=\"_blank\" rel=\"noopener noreferrer\">CNCF</a> (Cloud Native Computing Foundation) project family, Werf brings a fresh perspective and cutting-edge capabilities to the ever-evolving field of <a href=\"https://en.wikipedia.org/wiki/DevOps\" target=\"_blank\" rel=\"noopener noreferrer\">DevOps</a> and cloud native.</p>\n<h2 id=\"-goals\" style=\"position:relative;\"><a href=\"#-goals\" aria-label=\" goals permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìò Goals</h2>\n<p>In this article, we explore the features, advantages, and impact of Werf, shedding light on why it has rapidly gained recognition as an impressive solution within the tech community.</p>\n<h2 id=\"Ô∏è-the-art-of-assembling-explore-the-software-delivery-lifecycle-with-werf\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-the-art-of-assembling-explore-the-software-delivery-lifecycle-with-werf\" aria-label=\"Ô∏è the art of assembling explore the software delivery lifecycle with werf permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è The Art of Assembling: Explore the Software Delivery Lifecycle with Werf</h2>\n<p>Werf aims to enhance the efficiency of software delivery in Kubernetes by combining existing technologies with industry best practices. As it has now become an official CNCF project, we are thrilled to share its story and provide an overview of its benefits for users.</p>\n<p>Having a vast ecosystem can be both advantageous and challenging. The true complexity lies not in finding the best implementation of essential functions but rather in integrating various components to achieve a desired solution. Essentially, you are constructing your own CI/CD pipeline using these fundamental building blocks.</p>\n<p>The software delivery lifecycle involves multiple stages that must be completed for successful code building, testing, releasing, and deploying. Consequently, you need to select tools for each of these steps and find a way to seamlessly connect them, all while integrating them with your preferred CI system.</p>\n<h3 id=\"enhancing-cicd-with-best-practices-and-kubernetes-integration\" style=\"position:relative;\"><a href=\"#enhancing-cicd-with-best-practices-and-kubernetes-integration\" aria-label=\"enhancing cicd with best practices and kubernetes integration permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Enhancing CI/CD with Best Practices and Kubernetes Integration</h3>\n<p>Werf, an Open Source Command-Line Interface (CLI) tool, aims to elevate the CI/CD experience by automating and standardizing workflows. Originally developed by a professional services company offering DevOps as a Service, Werf addresses the challenges faced while implementing CI/CD pipelines for diverse projects. The project's primary goal is to minimize the risks associated with potential mishaps that can occur when using established CI/CD workflows, inadvertently causing disruptions in production.</p>\n<p>To achieve these objectives, Werf incorporates a range of best practices, including:</p>\n<ul>\n<li><strong>Sophisticated caching system</strong>: By leveraging layer-by-layer caching, incremental rebuilds based on Git history, and shared caches for layers and images, Werf ensures optimal building times.</li>\n<li><strong>Content-based tagging</strong>: This feature prevents unnecessary builds and subsequent redeployments to Kubernetes (K8s), resulting in improved efficiency.</li>\n<li><strong>Kubernetes-native container image building</strong>: Werf facilitates in-cluster container image building, seamlessly integrating with K8s.</li>\n<li><strong>Giterminism</strong>: Inspired by the fusion of \"Git\" and \"determinism,\" Werf utilizes Git as a single source of truth, guaranteeing reproducibility in builds.</li>\n<li><strong>Advanced Kubernetes deployment process</strong>: Werf enhances observability through K8s resource tracking and a fail-fast mechanism, taking the deployment process to new heights.</li>\n<li><strong>Original container registry cleanup mechanism</strong>: Detecting and removing unused container images specific to your development flow, this mechanism optimizes storage space.</li>\n</ul>\n<p>By leveraging these features and adhering to the implied requirements, Werf enforces compliance in your CI/CD practices. This ensures a consistent approach that guarantees expected outcomes in production, provides a robust rollback mechanism, and optimizes time and resource allocation.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.529411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVR42h2Oy07DMBRE8/8/wYIVH8GGCvEQm26o1IITQkUkkE3qV/xIONhejK5Gmrlzui1HUspYa/He45wrPhFiKEqsa8YYzfh55jz2GD23/Np6sWQiWtvWqz+624cDl1kipWIYhnaVKn52qAVuXmB38CgduNot3L06ft0f14+wHxPyZ2L/pulFjxCCbpKOrVDUBWNMo6zLxhX5xNN74vhVaTPPInOaAnZJ3B8TH9+RLQeM9Y2uEv4DD7zi0ua9O/oAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ci cd\" title=\"\" src=\"/static/4792ec7c80e8594ef7af38d8e65331f7/c5bb3/ci-cd.png\" srcset=\"/static/4792ec7c80e8594ef7af38d8e65331f7/04472/ci-cd.png 170w,\n/static/4792ec7c80e8594ef7af38d8e65331f7/9f933/ci-cd.png 340w,\n/static/4792ec7c80e8594ef7af38d8e65331f7/c5bb3/ci-cd.png 680w,\n/static/4792ec7c80e8594ef7af38d8e65331f7/b12f7/ci-cd.png 1020w,\n/static/4792ec7c80e8594ef7af38d8e65331f7/2bef9/ci-cd.png 1024w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"Ô∏è-a-hands-on-experience-with-werf\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-a-hands-on-experience-with-werf\" aria-label=\"Ô∏è a hands on experience with werf permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèóÔ∏è A Hands-On Experience with Werf</h2>\n<p>To achieve its groundbreaking capabilities, Werf leverages well-established cloud-native projects, acting as the foundation for its functionalities. Among these building blocks, Buildah takes the lead in building container images, while an enhanced version of Helm facilitates their deployment. However, the scope of Werf's integration extends far beyond these components, encompassing an impressive lineup of tools and systems:</p>\n<ul>\n<li><strong>Git</strong>: Leveraging Git history for rebuilds and relying on Git for Giterminism.</li>\n<li><strong>Various container registries</strong>: Efficiently storing and managing container images.</li>\n<li><strong>Argo CD</strong>: Implementing the GitOps pattern, catering to diverse deployment needs.</li>\n<li><strong>Kubernetes</strong>: Seamless integration with the renowned container orchestration platform.</li>\n<li><strong>Various CI systems</strong>: Seamless execution of your pipeline, with built-in support for <a href=\"https://werf.io/guides/nodejs/400_ci_cd_workflow/030_gitlab_ci_cd.html\" target=\"_blank\" rel=\"noopener noreferrer\">GitLab CI/CD</a> and <a href=\"https://werf.io/guides/nodejs/400_ci_cd_workflow/040_github_actions.html\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub Actions</a>, alongside guidelines for other platforms.</li>\n</ul>\n<h3 id=\"installation\" style=\"position:relative;\"><a href=\"#installation\" aria-label=\"installation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Installation</h3>\n<p>Before proceeding, it is essential to install <a href=\"https://werf.io/documentation/v1.2/\" target=\"_blank\" rel=\"noopener noreferrer\">Werf</a> and its dependencies. You can follow the guide provided below to ensure a smooth installation process.</p>\n<p><strong>Requirements:</strong></p>\n<ul>\n<li>Bash</li>\n<li>Git version 2.18.0 or above</li>\n<li>GPG</li>\n<li><a href=\"https://docs.docker.com/engine/install/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker Engine</a></li>\n</ul>\n<p>Then, run the command below to install Werf:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-sSL</span> https://werf.io/install.sh <span class=\"token operator\">|</span> <span class=\"token function\">bash</span> <span class=\"token parameter variable\">-s</span> -- <span class=\"token parameter variable\">--version</span> <span class=\"token number\">1.2</span> <span class=\"token parameter variable\">--channel</span> stable</code></pre></div>\n<p>and then start a new shell session.</p>\n<h3 id=\"create-application-repository\" style=\"position:relative;\"><a href=\"#create-application-repository\" aria-label=\"create application repository permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Create Application Repository</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Clone the example repository to ~/werf-guide/guides (if you have not cloned it yet).</span>\n<span class=\"token builtin class-name\">test</span> <span class=\"token parameter variable\">-e</span> ~/werf-guide/guides <span class=\"token operator\">||</span> <span class=\"token function\">git</span> clone https://github.com/werf/website ~/werf-guide/guides\n\n<span class=\"token comment\"># Copy the (unchanged) application files to ~/werf-guide/app.</span>\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> ~/werf-guide/app\n<span class=\"token function\">cp</span> <span class=\"token parameter variable\">-rf</span> ~/werf-guide/guides/examples/basic/000_app ~/werf-guide/app\n\n<span class=\"token comment\"># Make the ~/werf-guide/app directory a git repository.</span>\n<span class=\"token builtin class-name\">cd</span> ~/werf-guide/app\n<span class=\"token function\">git</span> init\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> initial\n\n<span class=\"token comment\"># To see what changes we will make later in this chapter, let's replace all the application files</span>\n<span class=\"token comment\"># in the repository with new, modified files containing the changes described below.</span>\n<span class=\"token function\">git</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">-r</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">cp</span> <span class=\"token parameter variable\">-rf</span> ~/werf-guide/guides/examples/basic/001_build/. <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> WIP\n\n<span class=\"token comment\"># Enter the command below to show files we are going to change.</span>\n<span class=\"token function\">git</span> show <span class=\"token parameter variable\">--stat</span>\n<span class=\"token comment\"># Enter the command below to show the changes that will be made.</span>\n<span class=\"token function\">git</span> show</code></pre></div>\n<h3 id=\"dockerfile\" style=\"position:relative;\"><a href=\"#dockerfile\" aria-label=\"dockerfile permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Dockerfile</h3>\n<p><a href=\"https://docs.docker.com/engine/reference/builder/\" target=\"_blank\" rel=\"noopener noreferrer\">Dockerfile</a> contains all the steps required to build our application:</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> alpine:3.14</span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /app</span>\n\n<span class=\"token comment\"># [&lt;en>] Install app dependencies.</span>\n<span class=\"token comment\"># [&lt;ru>] –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apk add --no-cache --update nmap-ncat</span>\n\n<span class=\"token comment\"># [&lt;en>] Add to the image a script to run the echo server and set the permission to execution.</span>\n<span class=\"token comment\"># [&lt;ru>] –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ–±—Ä–∞–∑ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç—Ö–æ-—Å–µ—Ä–≤–µ—Ä–∞ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> start.sh .</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> chmod +x start.sh</span></code></pre></div>\n<p>The primary Werf configuration file, <code class=\"language-text\">werf.yaml</code> (in the repository's root) specifies Dockerfile to use when building an application with Werf:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">project</span><span class=\"token punctuation\">:</span> werf<span class=\"token punctuation\">-</span>guide<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">configVersion</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> app\n<span class=\"token key atrule\">dockerfile</span><span class=\"token punctuation\">:</span> Dockerfile</code></pre></div>\n<p>The <code class=\"language-text\">werf.yaml</code> file can describe the assembly of multiple images at once. There are also some additional settings for building an image.</p>\n<p>Note that before starting the Werf-based build/deploy process, you have to add all the files to the commit. We already did this in the Create Application repository section above. Normally, however, you have to run the <code class=\"language-text\">git add</code> and <code class=\"language-text\">git commit</code> commands.</p>\n<p>Start the build using the <a href=\"https://werf.io/documentation/v1.2/reference/cli/werf_build.html\" target=\"_blank\" rel=\"noopener noreferrer\">werf build</a> command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">werf build</code></pre></div>\n<h3 id=\"starting-the-application\" style=\"position:relative;\"><a href=\"#starting-the-application\" aria-label=\"starting the application permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Starting the Application</h3>\n<p>You can run the container locally using the built image via the <a href=\"https://werf.io/documentation/v1.2/reference/cli/werf_run.html\" target=\"_blank\" rel=\"noopener noreferrer\">werf run</a> command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">werf run app --docker-options<span class=\"token operator\">=</span><span class=\"token string\">\"-ti --rm -p 8000:8000\"</span> -- /app/start.sh</code></pre></div>\n<p>Here, the <code class=\"language-text\">--docker-options</code> flag sets the <a href=\"https://docs.docker.com/engine/reference/run/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker parameters</a>, while the command to run in the container is given at the end (after two hyphens).</p>\n<p>Go to <a href=\"http://127.0.0.1:8000/ping\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:8000/ping</a> in the browser to check if the application is running. Alternatively, you can use the curl utility:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> http://127.0.0.1:8000/ping</code></pre></div>\n<p>You will get the <code class=\"language-text\">pong</code> message in response and the following text will appear in the container log:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">GET /ping HTTP/1.1\nHost: <span class=\"token number\">127.0</span>.0.1:8000\nUser-Agent: curl/7.67.0\nAccept: */*</code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACf0lEQVR42nXPW2/SYBjA8X4EL7zy0g/gYfEQp9F5ZbwwmWbTRd2pHEqBrZRSWKEFSo9AC4WWY1tOAgGdY9NFnYm6qFmYxi2Zmzcm3vo17HRXRpNfnvyfJ+/NCyR9rIiwgo/lEIb/jUWsZkUfyy/QAsJY8T+AFBRDi/JDex71SAFPGoYkH5zyOoUEmqoIhWxYkgKCHBT/kHBRtmC8hPHWCuQiUsCnumCFCmTDeJHGlRyZETGO8TPbn3dWWgMllMxTmTwpWwqxjEbJ+YhkUUkZKCVyKKrxEdVa0j6uISpZWjmLi6ccAT9GBiEkhccNTrOeVTlVDiY1Kltl8xXmEGAKxXikHCerRiJL22Qj1shx6slF+tgEeHp07PLISMSNNCSjmSpU6Yz3dkD2Sy2pUhNL9WQJsIqO6kzMfKyWW+lHZWK5kzU5PHrlwqWx0avXzp9zOPHrsc2b1LpA6RLYbybrXbXSzuptuQp01RpJ1YrpWk+pP9U7+8Mva411nmAnb92dHL/34M64CxNOIO+Po0OCbhRRoxx80lNavXyzr9WA5XIrwXcFrmM4Ph5s/Pzx7fvW9s7w0/67jd2trb3drwdvt/eC5TdzyqZafG59Snb1tdkPrfCrQa0JLBfqRqpkyrqGNM1Yu69pfc1cM7urZmegt1f09jOj/brZG5SqjaTQlNQqXRacSo3R1/Q2wOPsDdfLKWSVhomlGYiEXBTsj7qxKIwdTjdGwRjlDhBOZAkEaa+fQQh0aiHmCmWIBGCD42dsLy46V8D7GDgxA9shFF74B/ci6vKGUTxGkJ45GIWQEOIH3PN2FJz2gdPwnB2atcPzDo8N+osbdB4GeBRe+9HxF18tb7QgeItxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"werf\" title=\"\" src=\"/static/a2e63b553fbf76a868df4b29db6918bb/c5bb3/werf.png\" srcset=\"/static/a2e63b553fbf76a868df4b29db6918bb/04472/werf.png 170w,\n/static/a2e63b553fbf76a868df4b29db6918bb/9f933/werf.png 340w,\n/static/a2e63b553fbf76a868df4b29db6918bb/c5bb3/werf.png 680w,\n/static/a2e63b553fbf76a868df4b29db6918bb/b12f7/werf.png 1020w,\n/static/a2e63b553fbf76a868df4b29db6918bb/b5a09/werf.png 1360w,\n/static/a2e63b553fbf76a868df4b29db6918bb/2cefc/werf.png 1400w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Conclusion</h2>\n<p>In conclusion, Werf emerges as a promising addition to the DevOps landscape and a rising star within the CNCF project.</p>\n<p>Werf offers numerous advantages such as ease of use, flexibility, and enhanced efficiency. Its innovative approach to containerization and GitOps empowers developers to streamline their workflows, ensuring seamless and reliable application deployment.</p>\n<p>By integrating seamlessly with popular container orchestration platforms like Kubernetes, Werf enables teams to achieve faster delivery cycles, better collaboration, and improved scalability. With its growing community and continuous development, Werf is set to shape the future of CI/CD, empowering organizations to accelerate their software delivery processes and embrace the full potential of modern DevOps practices.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":5,"rawMarkdownBody":"\n> **An Insight into the Rising Star of the CNCF Project üöÄ**\n\n## üóÉ Introduction\n\nWelcome to this blog post, where we explore the fascinating world of [Werf](https://werf.io/), a remarkable [CI/CD](https://en.wikipedia.org/wiki/CI/CD) tool that is transforming the way we approach software development and deployment.\n\nAs a [standout member](https://github.com/werf/werf/discussions/5155) of the [CNCF](https://www.cncf.io/projects/werf/) (Cloud Native Computing Foundation) project family, Werf brings a fresh perspective and cutting-edge capabilities to the ever-evolving field of [DevOps](https://en.wikipedia.org/wiki/DevOps) and cloud native.\n\n## üìò Goals\n\nIn this article, we explore the features, advantages, and impact of Werf, shedding light on why it has rapidly gained recognition as an impressive solution within the tech community.\n\n## üõ†Ô∏è The Art of Assembling: Explore the Software Delivery Lifecycle with Werf\n\nWerf aims to enhance the efficiency of software delivery in Kubernetes by combining existing technologies with industry best practices. As it has now become an official CNCF project, we are thrilled to share its story and provide an overview of its benefits for users.\n\nHaving a vast ecosystem can be both advantageous and challenging. The true complexity lies not in finding the best implementation of essential functions but rather in integrating various components to achieve a desired solution. Essentially, you are constructing your own CI/CD pipeline using these fundamental building blocks.\n\nThe software delivery lifecycle involves multiple stages that must be completed for successful code building, testing, releasing, and deploying. Consequently, you need to select tools for each of these steps and find a way to seamlessly connect them, all while integrating them with your preferred CI system.\n\n### Enhancing CI/CD with Best Practices and Kubernetes Integration\n\nWerf, an Open Source Command-Line Interface (CLI) tool, aims to elevate the CI/CD experience by automating and standardizing workflows. Originally developed by a professional services company offering DevOps as a Service, Werf addresses the challenges faced while implementing CI/CD pipelines for diverse projects. The project's primary goal is to minimize the risks associated with potential mishaps that can occur when using established CI/CD workflows, inadvertently causing disruptions in production.\n\nTo achieve these objectives, Werf incorporates a range of best practices, including:\n\n- **Sophisticated caching system**: By leveraging layer-by-layer caching, incremental rebuilds based on Git history, and shared caches for layers and images, Werf ensures optimal building times.\n- **Content-based tagging**: This feature prevents unnecessary builds and subsequent redeployments to Kubernetes (K8s), resulting in improved efficiency.\n- **Kubernetes-native container image building**: Werf facilitates in-cluster container image building, seamlessly integrating with K8s.\n- **Giterminism**: Inspired by the fusion of \"Git\" and \"determinism,\" Werf utilizes Git as a single source of truth, guaranteeing reproducibility in builds.\n- **Advanced Kubernetes deployment process**: Werf enhances observability through K8s resource tracking and a fail-fast mechanism, taking the deployment process to new heights.\n- **Original container registry cleanup mechanism**: Detecting and removing unused container images specific to your development flow, this mechanism optimizes storage space.\n\nBy leveraging these features and adhering to the implied requirements, Werf enforces compliance in your CI/CD practices. This ensures a consistent approach that guarantees expected outcomes in production, provides a robust rollback mechanism, and optimizes time and resource allocation.\n\n![ci cd](./ci-cd.png)\n\n## üèóÔ∏è A Hands-On Experience with Werf\n\nTo achieve its groundbreaking capabilities, Werf leverages well-established cloud-native projects, acting as the foundation for its functionalities. Among these building blocks, Buildah takes the lead in building container images, while an enhanced version of Helm facilitates their deployment. However, the scope of Werf's integration extends far beyond these components, encompassing an impressive lineup of tools and systems:\n\n- **Git**: Leveraging Git history for rebuilds and relying on Git for Giterminism.\n- **Various container registries**: Efficiently storing and managing container images.\n- **Argo CD**: Implementing the GitOps pattern, catering to diverse deployment needs.\n- **Kubernetes**: Seamless integration with the renowned container orchestration platform.\n- **Various CI systems**: Seamless execution of your pipeline, with built-in support for [GitLab CI/CD](https://werf.io/guides/nodejs/400_ci_cd_workflow/030_gitlab_ci_cd.html) and [GitHub Actions](https://werf.io/guides/nodejs/400_ci_cd_workflow/040_github_actions.html), alongside guidelines for other platforms.\n\n### Installation\n\nBefore proceeding, it is essential to install [Werf](https://werf.io/documentation/v1.2/) and its dependencies. You can follow the guide provided below to ensure a smooth installation process.\n\n**Requirements:**\n\n- Bash\n- Git version 2.18.0 or above\n- GPG\n- [Docker Engine](https://docs.docker.com/engine/install/)\n\nThen, run the command below to install Werf:\n\n```bash\ncurl -sSL https://werf.io/install.sh | bash -s -- --version 1.2 --channel stable\n```\n\nand then start a new shell session.\n\n### Create Application Repository\n\n```bash\n# Clone the example repository to ~/werf-guide/guides (if you have not cloned it yet).\ntest -e ~/werf-guide/guides || git clone https://github.com/werf/website ~/werf-guide/guides\n\n# Copy the (unchanged) application files to ~/werf-guide/app.\nrm -rf ~/werf-guide/app\ncp -rf ~/werf-guide/guides/examples/basic/000_app ~/werf-guide/app\n\n# Make the ~/werf-guide/app directory a git repository.\ncd ~/werf-guide/app\ngit init\ngit add .\ngit commit -m initial\n\n# To see what changes we will make later in this chapter, let's replace all the application files\n# in the repository with new, modified files containing the changes described below.\ngit rm -r .\ncp -rf ~/werf-guide/guides/examples/basic/001_build/. .\ngit add .\ngit commit -m WIP\n\n# Enter the command below to show files we are going to change.\ngit show --stat\n# Enter the command below to show the changes that will be made.\ngit show\n```\n\n### Dockerfile\n\n[Dockerfile](https://docs.docker.com/engine/reference/builder/) contains all the steps required to build our application:\n\n```dockerfile\nFROM alpine:3.14\nWORKDIR /app\n\n# [<en>] Install app dependencies.\n# [<ru>] –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.\nRUN apk add --no-cache --update nmap-ncat\n\n# [<en>] Add to the image a script to run the echo server and set the permission to execution.\n# [<ru>] –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ–±—Ä–∞–∑ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç—Ö–æ-—Å–µ—Ä–≤–µ—Ä–∞ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.\nCOPY start.sh .\nRUN chmod +x start.sh\n```\n\nThe primary Werf configuration file, `werf.yaml` (in the repository's root) specifies Dockerfile to use when building an application with Werf:\n\n```yaml\nproject: werf-guide-app\nconfigVersion: 1\n\n---\nimage: app\ndockerfile: Dockerfile\n```\n\nThe `werf.yaml` file can describe the assembly of multiple images at once. There are also some additional settings for building an image.\n\nNote that before starting the Werf-based build/deploy process, you have to add all the files to the commit. We already did this in the Create Application repository section above. Normally, however, you have to run the `git add` and `git commit` commands.\n\nStart the build using the [werf build](https://werf.io/documentation/v1.2/reference/cli/werf_build.html) command:\n\n```bash\nwerf build\n```\n\n### Starting the Application\n\nYou can run the container locally using the built image via the [werf run](https://werf.io/documentation/v1.2/reference/cli/werf_run.html) command:\n\n```bash\nwerf run app --docker-options=\"-ti --rm -p 8000:8000\" -- /app/start.sh\n```\n\nHere, the `--docker-options` flag sets the [Docker parameters](https://docs.docker.com/engine/reference/run/), while the command to run in the container is given at the end (after two hyphens).\n\nGo to [http://127.0.0.1:8000/ping](http://127.0.0.1:8000/ping) in the browser to check if the application is running. Alternatively, you can use the curl utility:\n\n```bash\ncurl http://127.0.0.1:8000/ping\n```\n\nYou will get the `pong` message in response and the following text will appear in the container log:\n\n```shell\nGET /ping HTTP/1.1\nHost: 127.0.0.1:8000\nUser-Agent: curl/7.67.0\nAccept: */*\n```\n\n![werf](./werf.png)\n\n## üåü Conclusion\n\nIn conclusion, Werf emerges as a promising addition to the DevOps landscape and a rising star within the CNCF project.\n\nWerf offers numerous advantages such as ease of use, flexibility, and enhanced efficiency. Its innovative approach to containerization and GitOps empowers developers to streamline their workflows, ensuring seamless and reliable application deployment.\n\nBy integrating seamlessly with popular container orchestration platforms like Kubernetes, Werf enables teams to achieve faster delivery cycles, better collaboration, and improved scalability. With its growing community and continuous development, Werf is set to shape the future of CI/CD, empowering organizations to accelerate their software delivery processes and embrace the full potential of modern DevOps practices.\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1036},"frontmatter":{"id":"384464547971f7b27e444dd3","path":"/blog/werf-ci-cd-cncf/","humanDate":"Oct 31, 2024","fullDate":"2024-10-31","title":"Werf: Pioneering the Future of CI/CD - A Close Look at the CNCF's Noteworthy Addition to the DevOps Landscape üöÄ","keywords":["Werf","CI/CD","CNCF","DevOps","k8s","kubernetes"],"excerpt":"An insight into the rising star of the CNCF project, Werf, and its impact on the future of CI/CD in the DevOps landscape.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVR42m2S208aURCH+afrc1+aNDFp+tTS+mDipaZYE7Xloo1UAbcYoSCgolAQuchlC7uwrMC6+/XsYZva1El+O7Pn7Pl2Zs74EOY4rpw/wTx+wtzVUsvkINNHHdnyfXgPutDI1QR87odV1SHXhGwDrjqI2CHvqd7/C8+VWoQSDY6TLZY3D2ncdXgQ6/czG2P6CJhO/yAU3qNQuCCeUMhksxzFjxmb5qP0HIqlW/aUK/zvl9n6uE7qWmMrOea0YjGceEC3vEKhQCIRJxQMEovFUJRjIYVo9ABVVSWvL/xsYtBWddqdnshOJXDYZCms8/JdhKPvWSy8DHVdR9MGdDodut2uVL1ep1arYZr3EjjQND4d3fA6YrB/NiISz/P1pMxa4AsbH9bpDQxZtm8qsJY9v4+nzPY2zi4qvN0usp2ectmGouh15LTNeakp98czR16Qz31ITRzRXGcO8PQgXLGqkcz10EzRmssym5EUoZMmu3sKC88WSGUvMERSummJ8wI48prpygUbwk+s+ZDE8i3O9hX6uwH8K59p390xGuoomZ+srm2QzuQJp1s8X1WI5VR0Y/YvUEI98Fj0o3z7i51v5/j9S4R2thgOh2gDDdu2ZZnn1w0C0SIv3qywuPiK2m39f+BjTcW5vgia6kgO8cyayaF3ZduiJQ8W1zc9gsF9qpWS/MlvQhjgQU9QNCUAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/e35ddac2eb26162edaa2f4421e4b6b1f/0ccb9/werf-ci-cd-cover.png","srcSet":"/static/e35ddac2eb26162edaa2f4421e4b6b1f/9e217/werf-ci-cd-cover.png 750w,\n/static/e35ddac2eb26162edaa2f4421e4b6b1f/e4953/werf-ci-cd-cover.png 1080w,\n/static/e35ddac2eb26162edaa2f4421e4b6b1f/0ccb9/werf-ci-cd-cover.png 1200w","sizes":"100vw"},"sources":[{"srcSet":"/static/e35ddac2eb26162edaa2f4421e4b6b1f/7513b/werf-ci-cd-cover.webp 750w,\n/static/e35ddac2eb26162edaa2f4421e4b6b1f/317ed/werf-ci-cd-cover.webp 1080w,\n/static/e35ddac2eb26162edaa2f4421e4b6b1f/31cc3/werf-ci-cd-cover.webp 1200w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5233333333333333}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/kubernetes-validation-cel/","title":"Introducing Kubernetes Validation with Common Expression Language (CEL) ‚òØ","date":"2024-10-31 19:30:00"},"excerpt":"Simplify Complex Validations with CEL and Kyverno Policies ‚òØ üîÜ Introduction Kubernetes is extensible and allows users to create Custom‚Ä¶","html":"<blockquote>\n<p><strong>Simplify Complex Validations with CEL and Kyverno Policies ‚òØ</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîÜ Introduction</h2>\n<p>Kubernetes is extensible and allows users to create <a href=\"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#custom-resources\" target=\"_blank\" rel=\"noopener noreferrer\">Custom Resources (CR)</a> and <a href=\"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#customresourcedefinitions\" target=\"_blank\" rel=\"noopener noreferrer\">Custom Resource Definitions (CRD)</a> that define the structure and meta-attributes of future resources. However, creating complex validation webhooks for each CRD can be an operational and development overhead.</p>\n<p>Kubernetes now provides a solution in the form of the <a href=\"https://kubernetes.io/docs/reference/using-api/cel/\" target=\"_blank\" rel=\"noopener noreferrer\">Common Expression Language (CEL)</a>. CEL is a simple yet powerful language that allows you to define complex validation rules directly in the Kubernetes API server. With CEL, you can introduce complex validations without creating your own validating webhooks in code.</p>\n<p><a href=\"https://kyverno.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Kyverno</a> is a Kubernetes-native policy engine that allows you to define policies as code. With Kyverno, you can enforce best practices, security standards, and compliance requirements.</p>\n<p>By using CEL expressions in Kyverno policies, you can simplify your validation rules and make them more expressive.</p>\n<p>In this blog post, we'll explore how to use CEL expressions in Kyverno policies to simplify your Kubernetes validation rules. We'll walk through examples of using CEL expressions in Kyverno policies to enforce policies for your Kubernetes resources.</p>\n<p>So, if you're looking to simplify your Kubernetes validation rules and make them more expressive, read on to learn how to use CEL expressions in Kyverno policies.</p>\n<h2 id=\"cel-and-validation-in-kubernetes\" style=\"position:relative;\"><a href=\"#cel-and-validation-in-kubernetes\" aria-label=\"cel and validation in kubernetes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>CEL and Validation in Kubernetes</h2>\n<p>Kubernetes Custom Resource Definitions (CRDs) support validation through <a href=\"https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#specifying-a-structural-schema\" target=\"_blank\" rel=\"noopener noreferrer\">structural schemas</a>, <a href=\"https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#validation\" target=\"_blank\" rel=\"noopener noreferrer\">OpenAPI v3 validation rules</a>, <a href=\"https://thenewstack.io/developer-guardrails-with-custom-kubernetes-resource-validators/\" target=\"_blank\" rel=\"noopener noreferrer\">custom validators</a>, and <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/\" target=\"_blank\" rel=\"noopener noreferrer\">admission webhooks</a>.</p>\n<p>CRD structural schemas provide type checking, while OpenAPI v3 validation rules offer regex, range, and size limits. Custom validators can be written in various languages, and admission webhooks are used for more complex validation scenarios.</p>\n<p>To address the need for self-contained validation, Kubernetes introduced Common Expression Language (CEL) into CRDs. CEL is a lightweight, safe, and easy-to-use expression language that supports pre-parsing and type checking at CRD registration time. This allows syntax and type errors to be caught before the CRD is deployed, improving cluster operability and reducing the need for webhooks. CEL is chosen for its simplicity, flexibility, and ability to express validation rules in a declarative manner. This choice aligns with Kubernetes' goal of providing a simple and consistent validation framework for CRDs.</p>\n<hr>\n<h3 id=\"a-deep-dive-into-cel\" style=\"position:relative;\"><a href=\"#a-deep-dive-into-cel\" aria-label=\"a deep dive into cel permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>A Deep Dive into CEL</h3>\n<p>Kubernetes CRDs support validation through CEL to ensure the correctness and consistency of custom resources. This feature, introduced in Kubernetes 1.25, allows developers to define validation rules using CEL expressions, which are declarative and lightweight. CEL validation rules are scoped to the location of the <code class=\"language-text\">x-kubernetes-validations</code> extension in the CRD schema, and the <code class=\"language-text\">self</code> variable in the CEL expression is bound to the scoped value. All validation rules are scoped to the current object, and cross-object or stateful validation rules are not supported.</p>\n<p>For example, a validation rule using <code class=\"language-text\">x-kubernetes-validations</code> could be:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">openAPIV3Schema</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> object\n  <span class=\"token key atrule\">properties</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> object\n      <span class=\"token key atrule\">properties</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> string\n          <span class=\"token key atrule\">x-kubernetes-validations</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">rule</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"self.cpu in ['1', '2', '4']\"</span>\n            <span class=\"token key atrule\">message</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CPU should be one of 1, 2, or 4.\"</span>\n        <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> cpu</code></pre></div>\n<p><a href=\"https://github.com/kubernetes/kubernetes/issues/121164\" target=\"_blank\" rel=\"noopener noreferrer\">CEL validation rules support a wide range of use cases, and they were promoted to GA in Kubernetes 1.29</a>. This feature has been adopted by many Kubernetes ecosystem projects and is widely used in the Kubernetes community. CEL validation rules provide a lightweight and self-contained validation mechanism that reduces the need for admission webhooks and simplifies the development and operability of CRDs. They also allow users to define complex validation rules in a declarative manner, improving the readability and maintainability of the CRD schema.</p>\n<hr>\n<h3 id=\"kyverno-a-policy-engine-for-k8s-resource-validation\" style=\"position:relative;\"><a href=\"#kyverno-a-policy-engine-for-k8s-resource-validation\" aria-label=\"kyverno a policy engine for k8s resource validation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Kyverno: A Policy Engine for k8s Resource Validation</h3>\n<p>Kyverno is a policy engine for Kubernetes that enables resource validation, change, and creation based on defined policies. It uses CEL expressions for validation, reducing the need for admission webhooks. <a href=\"https://kyverno.io/policies/\" target=\"_blank\" rel=\"noopener noreferrer\">Kyverno policies</a> consist of Match, Exclude, Validate, Mutate, Generate, and Verify Images clauses, allowing users to define complex validation rules in a declarative manner.</p>\n<p>Kyverno policies provide a lightweight and self-contained validation mechanism that reduces the need for admission webhooks and simplifies the development and operability of CRDs. They also allow users to define complex validation rules in a declarative manner, improving the readability and maintainability of the CRD schema.</p>\n<h4 id=\"using-cel-expressions-in-kyverno-policies\" style=\"position:relative;\"><a href=\"#using-cel-expressions-in-kyverno-policies\" aria-label=\"using cel expressions in kyverno policies permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Using CEL Expressions in Kyverno Policies</h4>\n<p>CEL expressions in Kyverno policies are used in the validate section. The <code class=\"language-text\">message</code> field is used to display an error message when the expression evaluates to false. The <code class=\"language-text\">validationFailureAction</code> field is used to enforce the validation failure action when the expression evaluates to false.</p>\n<p>CEL expressions in Kyverno policies can be used to validate various aspects of Kubernetes resources, such as resource limits, labels, and annotations. Kyverno also supports the automatic generation of policy rules for higher-level controllers, such as Deployments, DaemonSets, StatefulSets, and CronJobs.</p>\n<p>To create a Kyverno policy that disallows CPU requests without a value, use the following example:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> kyverno.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ClusterPolicy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> disallow<span class=\"token punctuation\">-</span>cpu<span class=\"token punctuation\">-</span>requests<span class=\"token punctuation\">-</span>without<span class=\"token punctuation\">-</span>value\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">validationFailureAction</span><span class=\"token punctuation\">:</span> Enforce\n  <span class=\"token key atrule\">background</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> disallow<span class=\"token punctuation\">-</span>cpu<span class=\"token punctuation\">-</span>requests<span class=\"token punctuation\">-</span>without<span class=\"token punctuation\">-</span>value\n    <span class=\"token key atrule\">match</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">any</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">kinds</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> Pod \n    <span class=\"token key atrule\">validate</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">cel</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">expressions</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">message</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CPU requests must have a value\"</span>\n            <span class=\"token key atrule\">expression</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"object.spec.containers.all(container, has(container.resources.requests.cpu))\"</span></code></pre></div>\n<p>Now, let's try deploying a pod without CPU requests:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cpu<span class=\"token punctuation\">-</span>pod\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cpu<span class=\"token punctuation\">-</span>container\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx\n    <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"256Mi\"</span></code></pre></div>\n<p>We can see that our policy is enforced. Great!</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ kubectl apply <span class=\"token parameter variable\">-f</span> pod.yaml\nError from server: error when creating <span class=\"token string\">\"pod.yaml\"</span><span class=\"token builtin class-name\">:</span> admission webhook <span class=\"token string\">\"validate.kyverno.svc-fail\"</span> denied the request: \n\nresource Pod/default/cpu-pod was blocked due to the following policies \n\ndisallow-cpu-requests-without-value:\n  disallow-cpu-requests-without-value: CPU requests must have a value</code></pre></div>\n<p>Some other useful variables that we can use in CEL expressions are:</p>\n<ul>\n<li><code class=\"language-text\">oldObject</code>: The existing object. The value is null for CREATE requests.</li>\n<li><code class=\"language-text\">authorizer</code>: It can be used to perform authorization checks.</li>\n<li><code class=\"language-text\">authorizer.requestResource</code>: A shortcut for an authorization check configured with the request resource (group, resource, (subresource), namespace, name).</li>\n</ul>\n<h4 id=\"cel-preconditions-in-kyverno-policies\" style=\"position:relative;\"><a href=\"#cel-preconditions-in-kyverno-policies\" aria-label=\"cel preconditions in kyverno policies permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>CEL Preconditions in Kyverno Policies</h4>\n<p>The below policy ensures the <code class=\"language-text\">hostPort</code> field is set to a value between 5000 and 6000 for pods whose <code class=\"language-text\">metadata.name</code> is set to nginx:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> - <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\napiVersion: kyverno.io/v1\nkind: ClusterPolicy\nmetadata:\n  name: disallow-host-port-range\nspec:\n  validationFailureAction: Enforce\n  background: false\n  rules:\n    - name: host-port-range\n      match:\n        any:\n        - resources:\n            kinds:\n              - Pod\n      celPreconditions:\n          - name: \"first match condition in CEL\"\n            expression: \"object.metadata.name.matches('nginx')\"\n      validate:\n        cel:\n          expressions:\n          - expression: \"object.spec.containers.all(container, !has(container.ports) || container.ports.all(port, !has(port.hostPort) || (port.hostPort >= 5000 &amp;&amp; port.hostPort &lt;= 6000)))\"\n            message: \"The only permitted hostPorts are in the range 5000-6000.\"\nEOF</span></code></pre></div>\n<p><code class=\"language-text\">spec.rules.celPreconditions</code> are CEL expressions. All celPreconditions must be evaluated to true for the resource to be evaluated. Therefore, any Pod with nginx in its <code class=\"language-text\">metadata.name</code> will be evaluated.</p>\n<p>Let's try deploying an Apache server with <code class=\"language-text\">hostPort</code> set to 80:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> - <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: apache\nspec:\n  containers:\n  - name: apache-server\n    image: httpd\n    ports:\n    - containerPort: 8080\n      hostPort: 80\nEOF</span></code></pre></div>\n<p>You'll see that it's successfully created because the validation rule wasn't applied to the new Pod as it doesn't satisfy the celPreconditions. That's exactly what we need.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Pod/apache created</code></pre></div>\n<p>Let's try deploying an Nginx server with <code class=\"language-text\">hostPort</code> set to 80:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> - <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n  - name: nginx-server\n    image: nginx\n    ports:\n    - containerPort: 8080\n      hostPort: 80\nEOF</span></code></pre></div>\n<p>Since the new Pod satisfies the celPreconditions, the validation rule will be applied. As a result, the creation of the Pod will be blocked as it violates the rule.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Error from server: error when creating <span class=\"token string\">\"STDIN\"</span><span class=\"token builtin class-name\">:</span> admission webhook <span class=\"token string\">\"validate.kyverno.svc-fail\"</span> denied the request:\nresource Pod/default/nginx was blocked due to the following policies\n\ndisallow-host-port-range:\n  host-port-range: The only permitted hostPorts are <span class=\"token keyword\">in</span> the range <span class=\"token number\">5000</span>-6000.</code></pre></div>\n<h2 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Summary</h2>\n<p>The blog provides a good understanding of the Common Expression Language (CEL) and its application in Kubernetes <code class=\"language-text\">ValidatingAdmissionPolicies</code>. It shows the significance of CEL in validating Custom Resource Definitions (CRDs) and its integration into Kyverno policies for resource validation. The post covers the features introduced in Kubernetes ValidatingAdmissionPolicies and demonstrates the use of CEL expressions in Kyverno policies to validate resources. It also emphasizes the benefits of using CEL for in-process validation, reducing the reliance on admission webhooks, and simplifying the development and operability of CRDs.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <em><strong>Until next time üéâ</strong></em></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">Saifeddine Rajhi</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">@rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"},"nextThought":{"frontmatter":{"path":"/blog/kubernetes-owasp-top-10/","title":"OWASP Kubernetes Top 10: A Comprehensive Guide üõ°Ô∏è","date":"2024-10-31 17:00:00"},"excerpt":"Protect Your Kubernetes Clusters from Attacks üìó Introduction Kubernetes is a popular container orchestration platform that has‚Ä¶","html":"<blockquote>\n<p><strong>Protect Your Kubernetes Clusters from Attacks</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìó Introduction</h2>\n<p>Kubernetes is a popular container orchestration platform that has revolutionized the way we develop and deploy applications. However, with great power comes great responsibility, and Kubernetes security is a top concern for many organizations.</p>\n<p><a href=\"https://owasp.org/www-project-kubernetes-top-ten/\" target=\"_blank\" rel=\"noopener noreferrer\">The OWASP Kubernetes Top 10</a> is a prioritized list of the most common security risks associated with Kubernetes. It is an essential resource for security practitioners, system administrators, and software developers alike.</p>\n<p>In this blog post, we will take a comprehensive look at the OWASP Kubernetes Top 10. We will discuss each risk in detail, and provide recommendations for mitigating it. We will also group some of the risks together into categories, such as misconfigurations, monitoring, and vulnerabilities. Finally, we will recommend some tools and techniques for auditing your configuration and making sure that your security posture is the most appropriate.</p>\n<p>We hope that this blog post will help you to understand and mitigate the security risks associated with Kubernetes.</p>\n<h2 id=\"-overview\" style=\"position:relative;\"><a href=\"#-overview\" aria-label=\" overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Overview</h2>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACRklEQVR42m1Ui27bMAzs///Whg1YgbZI1jZoFiRO2rwcvy3bsiXfeHTtNEAFEHJE8XhHUrmDrL7vb8x7rzvX+M19tNH33bqjsyxL5HmuZoxBXdew1qJt28k3nDeTj3GmqpEXRo3fCsiMVVUhTVNEUaSXoUy9AhLgdDoLcEW+6JXhwPx9f8Lu44Ttx1G/ve8HQAaNa5TNRfCmaTShbR2sCeG6Bv3nvdU6wPz5VWyB5Wpzy9DaFo1ISnKPeHmPdDtHJ5GNJCM7Y0ocDpkkb4fEErcVVuvZMzbzFwTyzSQTwzTLEV1ipInFw8sTnp7eNJC+LMvEStz/2ctvq+dtYyVJhbIoUOSFkKqvgPxRiCNOc5HYiYnUz6ZQMptBBVnRivQOLFC++IdjsEVeGq0/GzcBGpHsWou3o8EvYSF6tMCsIY3+inUW2bUtsXMNsAsQvu8kSYk4TuCcu9aQsnjQiZUiybth3rQpwo7giYxG/PMHfLTWpnTHBQ7BCucwEtnldQ5HhrXUIxPg38sd4HoNIiCT8U5hZOZmM7jsIMMjvjxAFO5RiGSWZgLUAsvB+ArI8uvr6LoObvTJvTF4lW+w3geIpZGs/xVQh7SfrP/c2RgdJdmd85Ofy2QWj9EFq/0HkoiA5e3TYwBZfLUkzeTlxLhIwdlxL/fInsW4hAWW2wLHc6LsmJg90C4roPc3LEcmHCcm06fGpDxMQpxf/+JxdsbybY0wPMvAH5Ek6QD43b/NUL9es471HEzuug6tNKqqZZeZ5J1xZCj5P69zjK8j8PRrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pillars\" title=\"\" src=\"/static/61f6bfba860a5124fbec4aa4aa307a72/c5bb3/pillars.png\" srcset=\"/static/61f6bfba860a5124fbec4aa4aa307a72/04472/pillars.png 170w,\n/static/61f6bfba860a5124fbec4aa4aa307a72/9f933/pillars.png 340w,\n/static/61f6bfba860a5124fbec4aa4aa307a72/c5bb3/pillars.png 680w,\n/static/61f6bfba860a5124fbec4aa4aa307a72/b12f7/pillars.png 1020w,\n/static/61f6bfba860a5124fbec4aa4aa307a72/c1b63/pillars.png 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>In the visual above, we spotlight which component or part is impacted by each of the risks that appear in OWASP Kubernetes mapped to a generalized Kubernetes threat model to aid in understanding. This analysis also dives into each OWASP risk, providing technical details on why the threat is prominent, as well as common mitigations. It's also helpful to group the risks into three categories and in order of likelihood.</p>\n<p>The OWASP (Open Web Application Security Project) is a non-profit organization dedicated to enhancing software security. While initially concentrating on web application security, OWASP has expanded its focus due to evolving system designs.</p>\n<p>As software development transitions from traditional monolithic architectures hosted on virtual machines shielded behind firewalls to contemporary microservice setups running on cloud infrastructure, it becomes imperative to adapt security measures to suit each unique application environment.</p>\n<p>For this reason, the OWASP Foundation has introduced the OWASP Kubernetes Top 10, comprising the ten most prevalent attack vectors tailored specifically for the Kubernetes environment.</p>\n<h2 id=\"k00-welcome-to-the-kubernetes-security-top-ten\" style=\"position:relative;\"><a href=\"#k00-welcome-to-the-kubernetes-security-top-ten\" aria-label=\"k00 welcome to the kubernetes security top ten permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K00: Welcome to the Kubernetes Security Top Ten</h2>\n<p>The OWASP Kubernetes Top 10 is a comprehensive guide designed to help organizations understand and mitigate the most critical security risks associated with Kubernetes. As Kubernetes adoption grows, so do the potential risks to applications and infrastructure. This guide serves as a starting point for security practitioners, system administrators, and software developers to prioritize and address these risks effectively.</p>\n<h3 id=\"k01-insecure-workload-configurations\" style=\"position:relative;\"><a href=\"#k01-insecure-workload-configurations\" aria-label=\"k01 insecure workload configurations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K01: Insecure Workload Configurations</h3>\n<p><img src=\"/2c76f2ade5d1a7879461c31cf0e505ba/insecure.gif\" alt=\"insecure\" loading=\"lazy\">\n          </p>\n<p>Insecure workload configurations are one of the most common risks in Kubernetes environments. These misconfigurations can lead to vulnerabilities that attackers can exploit. Ensuring that workloads are configured securely involves setting appropriate resource limits, using security contexts, and avoiding the use of privileged containers. Regular audits and automated tools can help identify and remediate insecure configurations.</p>\n<p>The security context of a workload in Kubernetes is highly configurable, which can lead to serious security misconfigurations across an organization's workloads and clusters. <a href=\"https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview\" target=\"_blank\" rel=\"noopener noreferrer\">According to Redhat's 2022 report</a>, nearly 53% of respondents experienced a misconfiguration incident in their Kubernetes environments in the last 12 months. Cloud providers like AWS, GCP, and Azure offer various security features, but the shared security model means users must also implement security measures. Administrators should prioritize safe image usage, maintain updated operating systems, and conduct continuous audits to prevent misconfigurations, which are common entry points for attackers.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABy0lEQVR42n2U6XLCMAyEef/Ho+2UHz0h5QzksONcdlStjEI4WmbEhMj6vFrLzIg/IQQahkECz/p7mtP309yjzwwLjDFUFAXleU7WWnLOUdM01HXdmNP3VVVJDlDnaipNJVHxM9EQgViUZTml6ZHatpWdUABgXde03x+4wF0p7ntPyWZPy2Qr8bPZkfchAt15sYK0NQChxlZQ3ArEey9rUPz+uaSnlwXNn1/p7eNbakZgy8UAoMALcBiBxlhuuxSgKsSa1XrLoKXAVsn6GigtH08M6bmwl2IFIleW5qKQO/G8zvFGNWxpOxE0HgqAZWlFCVqxthJfAQbQ1Y1sBNWikAubwtBhvqA6PZE7HMnzuitgxT5FVb1AUYwDQlhWZ0tumQ+os47C2We3S6lcrgUYuPYKiFbC2Tt9lpYZ2GM8ThnZ7Z5y9gwKhxBklGSMeA0C3o5jg3ahruu8QHVs0HLDFhSHlMx6R8VXQuEMhLc4LHQHUQLUQr0pGjpzqlZOXyMEyZ9YNWZUh15axhc8uw3dFYHDmV69uEn0UXMqYqZTfwvM+BqiJajAUEdvYy7O4+P7/CcQzlv2VtVMczrgD4HRq+HOw8tp3+f++7f5BWT1ldC5h/HSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"k01\" title=\"\" src=\"/static/4804a6f8e9128013d9e92c7858c09951/c5bb3/k01.png\" srcset=\"/static/4804a6f8e9128013d9e92c7858c09951/04472/k01.png 170w,\n/static/4804a6f8e9128013d9e92c7858c09951/9f933/k01.png 340w,\n/static/4804a6f8e9128013d9e92c7858c09951/c5bb3/k01.png 680w,\n/static/4804a6f8e9128013d9e92c7858c09951/b12f7/k01.png 1020w,\n/static/4804a6f8e9128013d9e92c7858c09951/105d8/k01.png 1170w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"insecure-workload-configurations\" style=\"position:relative;\"><a href=\"#insecure-workload-configurations\" aria-label=\"insecure workload configurations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Insecure Workload Configurations</h3>\n<ul>\n<li>Misconfigurations in Kubernetes workloads can lead to serious security issues.</li>\n<li>Cloud providers offer security features, but users must also implement security measures.</li>\n<li>Administrators should prioritize safe image usage, maintain updated OS, and conduct continuous audits.</li>\n<li>Misconfigurations are common entry points for attackers.</li>\n</ul>\n<p><strong>Operating System:</strong></p>\n<ul>\n<li>Use minimal, streamlined images like Alpine Linux to reduce potential security risks.</li>\n<li>Start with a base image and add necessary packages gradually.</li>\n</ul>\n<p><strong>Audit Workloads:</strong></p>\n<ul>\n<li>Use <a href=\"https://www.cisecurity.org/benchmark/kubernetes\" target=\"_blank\" rel=\"noopener noreferrer\">CIS Benchmark for Kubernetes</a> and tools like <a href=\"https://github.com/aquasecurity/kube-bench\" target=\"_blank\" rel=\"noopener noreferrer\">kube-bench</a> or <a href=\"https://aquasecurity.github.io/trivy/v0.56/tutorials/kubernetes/cluster-scanning/\" target=\"_blank\" rel=\"noopener noreferrer\">trivy</a> to discover misconfigurations.</li>\n</ul>\n<p><strong>Preventing Workload Misconfigurations with OPA:</strong></p>\n<ul>\n<li><a href=\"https://github.com/open-policy-agent/gatekeeper\" target=\"_blank\" rel=\"noopener noreferrer\">Open Policy Agent (OPA)</a> helps identify and rectify misconfigurations.</li>\n<li>OPA can enforce policies to prevent insecure configurations.</li>\n</ul>\n<h3 id=\"misconfigured-cluster-components\" style=\"position:relative;\"><a href=\"#misconfigured-cluster-components\" aria-label=\"misconfigured cluster components permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Misconfigured Cluster Components</h3>\n<p><img src=\"/61bbab19759e3586913d8844a30e476d/clutser.gif\" alt=\"cluster misconfigured\" loading=\"lazy\">\n          </p>\n<ul>\n<li>Continuous and automatic auditing of IaC and Kubernetes YAML manifests is crucial.</li>\n<li>Misconfigurations in core components like Kubelet can lead to severe security risks.</li>\n<li>Disable anonymous access in Kubelet by setting <code class=\"language-text\">--anonymous-auth=false</code>.</li>\n</ul>\n<p><strong>Securing etcd:</strong></p>\n<ul>\n<li>Regular backups of <a href=\"https://kubernetes.io/docs/concepts/overview/components/#etcd\" target=\"_blank\" rel=\"noopener noreferrer\">etcd</a> data are essential.</li>\n<li>Use <code class=\"language-text\">etcdctl snapshot save</code> command for backups.</li>\n</ul>\n<p><strong>kube-apiserver:</strong></p>\n<ul>\n<li>Ensure all connections to the API server use TLS.</li>\n<li>Enable TLS with <code class=\"language-text\">--tls-cert-file</code> and <code class=\"language-text\">--tls-private-key-file</code> flags.</li>\n<li>Use TLS bootstrapping for automatic certificate management.</li>\n<li>Regularly rotate certificates.</li>\n</ul>\n<p><strong>Enhancing DNS Security with CoreDNS:</strong></p>\n<ul>\n<li><a href=\"https://coredns.io/\" target=\"_blank\" rel=\"noopener noreferrer\">CoreDNS</a> is the preferred DNS solution for Kubernetes, replacing kube-dns.</li>\n<li>CoreDNS addresses security vulnerabilities and performance issues.</li>\n<li>Regular compliance checks with tools like kube-bench are necessary.</li>\n</ul>\n<h3 id=\"k02-supply-chain-vulnerabilities\" style=\"position:relative;\"><a href=\"#k02-supply-chain-vulnerabilities\" aria-label=\"k02 supply chain vulnerabilities permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K02: Supply Chain Vulnerabilities</h3>\n<p><a href=\"https://sysdig.com/blog/software-supply-chain-security/\" target=\"_blank\" rel=\"noopener noreferrer\">The software supply chain</a> is a critical component of any Kubernetes environment. Dependencies and third-party components can introduce vulnerabilities that compromise the security of the entire system. Managing supply chain risks involves verifying the integrity of software components, using trusted sources, and implementing security measures such as image signing and vulnerability scanning. By securing the supply chain, organizations can reduce the risk of introducing malicious code into their environments.</p>\n<p>Containers in the development lifecycle supply chain present unique security challenges due to their reliance on numerous third-party components and dependencies. These challenges include image integrity, image composition, and known software vulnerabilities.</p>\n<p><img src=\"/7ef7abb6dada9fcbac90807ccf7d2698/k02.gif\" alt=\"k02\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Containers rely on many third-party components, making trust difficult.</li>\n<li>Challenges include image integrity, composition, and known vulnerabilities.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Image Integrity:</strong> Risks from unverified container contents, as seen in incidents like the <a href=\"https://www.sans.org/blog/what-you-need-to-know-about-the-solarwinds-supply-chain-attack/\" target=\"_blank\" rel=\"noopener noreferrer\">Solarwinds breach</a>.</li>\n<li><strong>Image Composition:</strong> Layers in container images can present security risks; properly constructed images reduce attack surfaces.</li>\n<li><strong>Known Software Vulnerabilities:</strong> Third-party packages in images can introduce vulnerabilities.</li>\n</ul>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC50lEQVR42l1TS2sUQRCeg+jFi0fBHyCIB0EE8SAGD14UBT2IXhVET0JA0INnRUQNogg+AkEU8RmfMW4wrzVZNzuzs7vZee7OzM6zp58zO4l5rL0bDWJRdFfT/VV91VUlEIy7ihDFWFWUwmxBEsvztWpVrkjyvCTXlboilUpiSZTlCrf/vO+p0NsQpQll7SCEjaZjNcymE9pu3KwV9PKU60WGFWmqajUt27a7oHUwJRiA2Kj+VMUJs5I3qgWULmXO9MrHI6tD2zpDW1fe7m9r79oLywmlC4wyGGeEJF0PvchckKcxaTCRHsHQXVQ/rz7Y3LkprN7buPJgEzc6d4RYfEiS5brnfy9X85rZgt00e7QJJiylwGGgFbNFdfjAyi1hafgws37QlrT87eyjwYO7czklJgZENwz/qRVEhDJCBIyQZVqmatZrOvBQLZAOje26OrIHhQ2UrBKWQZLunrGEr9qg0co8V7edOPAd0wyDkOdMNEeZkfNT5fEIhEUv35fbeXrmWEIxgjGIQdpOj4gNYUS+b3imbgxNzD6ZmP1SlEAUdWnbwHxvvhi3v8YoskHzxMS+vtE9r5XJTnu5kyVILm5/NiK8/TnqBJ124oSg1HBSxnjULjghDMAQQkgJW0qya+KAcP/UlodXzow9P1dqiMf3i3u39r/6EGJWUPVpuVrSTbReZ4RgSlnkekptHgUhgPTYp0Hh7vkNty8IL+ZO9l/uHN3xy6yjNKuG4I0dVIII4r+/zQkEIByXxZxY/F4uIRQvJuk7rXQp//ninPFMc3iFW4joutFyHDuMMkrpPx2GY4TGm8r1udxkU0UY+Z4HW34SQeK72HODIHA1RZyaFKenfF2ljHG2ZL1JKCZtXjpMMn5DaeD7iqpWyuWqKKmK6nkeaWhs+Cl7+ZgYKuHyb+SeC7S2cq9tRpUwflwxBiS96IYpozhJqOtQu0lY8t9g/K8cz7tXiWDBA2tHPnaYZ8r7qkd4DfwbYmn3EvNqivMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"bad images\" title=\"\" src=\"/static/75bc745c5248b442b1270f9a4147d667/c5bb3/bad-images.png\" srcset=\"/static/75bc745c5248b442b1270f9a4147d667/04472/bad-images.png 170w,\n/static/75bc745c5248b442b1270f9a4147d667/9f933/bad-images.png 340w,\n/static/75bc745c5248b442b1270f9a4147d667/c5bb3/bad-images.png 680w,\n/static/75bc745c5248b442b1270f9a4147d667/160a3/bad-images.png 682w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p><strong>How to Prevent:</strong></p>\n<p><img src=\"/fee12408b3e35a34f4b845793601cbc7/mitigate-k02.gif\" alt=\"mitiagte\" loading=\"lazy\">\n          </p>\n<ul>\n<li><strong>Image Integrity:</strong> Validate software through each phase using in-toto attestations to increase SLSA level.</li>\n<li><strong>Software Bill of Materials (SBOM):</strong> Use SBOMs to list software packages and licenses; standards include <a href=\"https://cyclonedx.org/\" target=\"_blank\" rel=\"noopener noreferrer\">CycloneDX</a> and <a href=\"https://spdx.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">SPDX</a>.</li>\n<li><strong>Image Signing:</strong> Use cryptographic key-pairs to sign and verify artifacts; tools like Cosign can help.</li>\n<li><strong>Image Composition:</strong> Use minimal OS packages and dependencies; consider base images like Distroless or Scratch.</li>\n<li><strong>Known Software Vulnerabilities:</strong> Use image vulnerability scanning tools like Clair and Trivy to identify and fix vulnerabilities.</li>\n<li><strong>Enforcing Policy:</strong> Use Kubernetes admission controls and policy engines like OPA and Kyverno to enforce security policies.</li>\n</ul>\n<p><strong>Example Attack Scenarios:</strong></p>\n<ul>\n<li><strong>Compromised CI/CD Pipeline:</strong> If a build tool is compromised, malicious packages can be injected, leading to malware execution or backdoor installation in Kubernetes clusters.</li>\n</ul>\n<h3 id=\"k03-overly-permissive-rbac-configurations\" style=\"position:relative;\"><a href=\"#k03-overly-permissive-rbac-configurations\" aria-label=\"k03 overly permissive rbac configurations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K03: Overly Permissive RBAC Configurations</h3>\n<p>Role-Based Access Control (RBAC) is a powerful feature in Kubernetes that allows administrators to define and enforce access policies. However, overly permissive RBAC configurations can lead to unauthorized access and potential security breaches. It is essential to follow the principle of least privilege, granting users and services only the permissions they need to perform their tasks. Regular reviews and audits of RBAC policies can help ensure that access controls remain tight and effective.</p>\n<p>Role-based access control (RBAC) regulates access to resources based on user roles. Misconfigurations can allow attackers to elevate privileges and control the cluster. Creating RBAC rules is straightforward, but managing them long-term can be complex. Admins should use ClusterRoles for cluster-scoped rules and RoleBindings to bind roles to users. Ensuring correct access without excessive permissions is crucial. Tools like RBAC Audit, Kubiscan, and Krane help manage and audit RBAC configurations to strengthen security.</p>\n<p><img src=\"/ec030f79908692aa45deb0d713b52b29/k03.gif\" alt=\"k03\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>RBAC regulates access based on user roles.</li>\n<li>Misconfigurations can lead to privilege escalation.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Creating RBAC Rules:</strong> Example policy for read-only CRUD actions on pods.</li>\n<li><strong>Managing RBAC Rules:</strong> Use ClusterRoles and RoleBindings for efficient management.</li>\n<li><strong>Ensuring Correct Access:</strong> Avoid granting excessive permissions.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Audit RBAC:</strong> Use tools like <a href=\"https://github.com/cyberark/kubernetes-rbac-audit\" target=\"_blank\" rel=\"noopener noreferrer\">RBAC Audit</a>, <a href=\"https://github.com/cyberark/KubiScan\" target=\"_blank\" rel=\"noopener noreferrer\">Kubiscan</a>, and <a href=\"https://github.com/appvia/krane\" target=\"_blank\" rel=\"noopener noreferrer\">Krane</a> to scan for risky roles and permissions.</li>\n</ul>\n<p><strong>Example Tools:</strong></p>\n<ul>\n<li><strong>RBAC Audit:</strong> Scans for risky roles within RBAC.</li>\n<li><strong>Kubiscan:</strong> Scans for risky permissions in RBAC authorization model.</li>\n<li><strong>Krane:</strong> Provides a dashboard for RBAC security posture and suggestions for mitigation.</li>\n</ul>\n<h3 id=\"k04-lack-of-centralized-policy-enforcement\" style=\"position:relative;\"><a href=\"#k04-lack-of-centralized-policy-enforcement\" aria-label=\"k04 lack of centralized policy enforcement permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K04: Lack of Centralized Policy Enforcement</h3>\n<p>Without centralized policy enforcement, maintaining consistent security policies across a Kubernetes cluster can be challenging. Centralized policy management tools, such as Open Policy Agent (OPA) and Kubernetes Policy Controller, enable organizations to define, enforce, and audit policies consistently. These tools help ensure that security policies are applied uniformly, reducing the risk of misconfigurations and policy violations.</p>\n<p>Distributing and enforcing security policies across multiple clusters and clouds is challenging for security teams. Without centralized policy enforcement, clusters can be left vulnerable to misconfigurations and compromises.</p>\n<p><img src=\"/dee1a6db3aefd2c3fef5ad41ada659bb/k04.gif\" alt=\"k04\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Managing security policies across multiple clusters and clouds is difficult.</li>\n<li>Lack of centralized policy enforcement can lead to vulnerabilities.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Policy Enforcement:</strong> Should occur throughout the software delivery lifecycle.</li>\n<li><strong>Example Policies:</strong> Disallowing images from untrusted registries using OPA Gatekeeper Rego policy.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Admission Controllers:</strong> Use Kubernetes API's Pod Security Standards to enforce policies.</li>\n<li><strong>OSS Projects:</strong> Tools like Open Policy Agent Gatekeeper, Kyverno, and Kubewarden offer policy enforcement capabilities.</li>\n</ul>\n<p><strong>Example Attack Scenarios:</strong></p>\n<ul>\n<li><strong>Container Breakout:</strong> A command that creates a highly privileged container, breaking container isolation and allowing access to the host.</li>\n</ul>\n<p><strong>Example Enforcement Policies:</strong></p>\n<ul>\n<li><strong>Disallowing Images from Untrusted Registries:</strong> Example OPA Gatekeeper Rego policy to block workloads using images from untrusted registries.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># Allowed repos</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> constraints.gatekeeper.sh/v1beta1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> K8sAllowedRepos\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> allowed<span class=\"token punctuation\">-</span>repos\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">match</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">kinds</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">apiGroups</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">kinds</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Pod\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">namespaces</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"sbx\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"prd\"</span>\n  <span class=\"token key atrule\">parameters</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">repos</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"open-policy-agent\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"ubuntu\"</span></code></pre></div>\n<p><strong>Mitigations:</strong></p>\n<ul>\n<li>Use <a href=\"https://sysdig.com/blog/kubernetes-admission-controllers/\" target=\"_blank\" rel=\"noopener noreferrer\">Admission Controllers</a> and OSS projects to enforce policies and prevent misconfigured pods from being scheduled.</li>\n</ul>\n<p><img src=\"/1033691edc7b21be182b84aa9acbddee/gatekeeper.gif\" alt=\"gatekeeper\" loading=\"lazy\">\n          </p>\n<h3 id=\"k05-inadequate-logging-and-monitoring\" style=\"position:relative;\"><a href=\"#k05-inadequate-logging-and-monitoring\" aria-label=\"k05 inadequate logging and monitoring permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K05: Inadequate Logging and Monitoring</h3>\n<p>Effective logging and monitoring are crucial for detecting and responding to security incidents in a Kubernetes environment. Inadequate logging and monitoring can leave organizations blind to potential threats and unable to respond promptly. Implementing comprehensive logging and monitoring solutions, such as Prometheus, Grafana, and ELK stack, allows organizations to gain visibility into their environments, detect anomalies, and respond to incidents swiftly.</p>\n<p>A Kubernetes environment can generate logs from various components. Without proper logging and monitoring, attackers can exploit vulnerabilities undetected, and incident investigation becomes challenging.</p>\n<p><img src=\"/51ec8a21dd534fd0f41f3c8cd739fd85/k05.gif\" alt=\"k05\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Logs must be captured, stored, and monitored to detect and respond to security incidents.</li>\n<li>Lack of logging and monitoring can leave organizations blind to potential threats.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Inadequate Logging:</strong> Occurs when relevant events are not logged, logs are not monitored, alerting thresholds are not set, logs are not centrally stored, or logging infrastructure is disabled.</li>\n<li><strong>Relevant Events:</strong> Include failed authentication attempts, access to sensitive resources, and manual deletion or modification of resources.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Kubernetes Audit Logs:</strong> Record actions taken by the API for later analysis. Monitor for anomalous API calls and authorization failures.</li>\n<li><strong>Kubernetes Events:</strong> Indicate resource state changes and errors.</li>\n<li><strong>Application &#x26; Container Logs:</strong> Capture logs from applications running inside Kubernetes.</li>\n<li><strong>Operating System Logs:</strong> Additional logs from the OS running Kubernetes nodes.</li>\n<li><strong>Cloud Provider Logs:</strong> Additional logging streams available in managed environments like AWS EKS, Azure AKS, and GCP GKE.</li>\n<li><strong>Network Logs:</strong> Capture logs from proxy or ingress components and projects like eBPF.</li>\n</ul>\n<p><strong>Mitigations:</strong></p>\n<ul>\n<li>Implement a robust security logging architecture that captures relevant security events, centralizes logs, and maintains integrity.</li>\n</ul>\n<h3 id=\"k06-broken-authentication-mechanisms\" style=\"position:relative;\"><a href=\"#k06-broken-authentication-mechanisms\" aria-label=\"k06 broken authentication mechanisms permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K06: Broken Authentication Mechanisms</h3>\n<p>Authentication mechanisms are the first line of defense in securing a Kubernetes cluster. Broken or weak authentication mechanisms can be exploited by attackers to gain unauthorized access. Implementing strong authentication methods, such as multi-factor authentication (MFA) and integrating with identity providers, can enhance the security of the cluster. Regularly reviewing and updating authentication mechanisms helps ensure they remain robust and effective.</p>\n<p>Authentication in Kubernetes is highly configurable, making it adaptable to various environments but also presenting security challenges. Broken or weak authentication mechanisms can be exploited by attackers to gain unauthorized access.</p>\n<p><img src=\"/6098aac70c1185f2aff236b7d79b4835/k06.gif\" alt=\"k06\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Authentication in Kubernetes is flexible but can present security challenges.</li>\n<li>Ensuring robust authentication mechanisms is crucial for cluster security.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Human Authentication:</strong> Methods include OpenID Connect (OIDC), Certificates, cloud IAM, and ServiceAccount tokens.</li>\n<li><strong>Service Account Authentication:</strong> SA tokens are used for container-to-API authentication within the cluster.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Avoid Using Certificates for End User Authentication:</strong> Certificates are convenient but risky due to the lack of revocation mechanisms.</li>\n<li><strong>Never Roll Your Own Authentication:</strong> Use supported and widely adopted methods.</li>\n<li><strong>Enforce MFA When Possible:</strong> Require a second method of authentication for humans.</li>\n<li><strong>Don‚Äôt Use Service Account Tokens from Outside the Cluster:</strong> Use short-lived tokens for external authentication.</li>\n<li><strong>Authenticate Users and External Services Using Short-Lived Tokens:</strong> Minimize the lifespan of authentication tokens to reduce the risk of compromise.</li>\n</ul>\n<p><strong>Mitigations:</strong></p>\n<p><img src=\"/7f219a1af9d9fe285671756d55cd1a0e/k06-mitigate.gif\" alt=\"k06-mitigate\" loading=\"lazy\">\n          </p>\n<ul>\n<li>Implement strong authentication methods and regularly review and update them to ensure they remain robust and effective.</li>\n</ul>\n<h3 id=\"k07-missing-network-segmentation-controls\" style=\"position:relative;\"><a href=\"#k07-missing-network-segmentation-controls\" aria-label=\"k07 missing network segmentation controls permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K07: Missing Network Segmentation Controls</h3>\n<p>Network segmentation controls are essential for limiting the spread of attacks within a Kubernetes cluster. Without proper segmentation, an attacker who gains access to one part of the network can move laterally and compromise other components. Implementing network policies, using tools like Calico or Cilium, and segmenting workloads based on their security requirements can help contain potential breaches and protect sensitive data.</p>\n<p>In Kubernetes, controlling network traffic is crucial, especially with multiple microservices and tenants. Network segmentation helps isolate traffic and prevent attackers from exploiting vulnerabilities to move laterally within the cluster.</p>\n<p><img src=\"/951097e7168f47f854175e07c086ca69/k07.gif\" alt=\"k07\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Network segmentation controls traffic within a Kubernetes cluster.</li>\n<li>It helps prevent attackers from moving laterally if they compromise a workload.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Flat Networking:</strong> By default, Kubernetes allows unrestricted communication between workloads.</li>\n<li><strong>Risk:</strong> Attackers can exploit this to probe the network and access other containers or private APIs.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Native Controls (Multi-Cluster):</strong> Use separate clusters for different tenants based on risk.</li>\n<li><strong>Native Controls (NetworkPolicies):</strong> Define network policies to control pod communication, similar to firewall rules. Example policy to prevent backend egress:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> networking.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> NetworkPolicy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deny<span class=\"token punctuation\">-</span>backend<span class=\"token punctuation\">-</span>egress\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">podSelector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">tier</span><span class=\"token punctuation\">:</span> backend\n  <span class=\"token key atrule\">policyTypes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> Egress\n  <span class=\"token key atrule\">egress</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">to</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">podSelector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">tier</span><span class=\"token punctuation\">:</span> backend</code></pre></div>\n<ul>\n<li><strong>Service Mesh:</strong> Use service mesh technologies like Istio, Linkerd, and Hashicorp Consul to segment network traffic. Example Istio AuthorizationPolicy:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"security.istio.io/v1beta1\"</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AuthorizationPolicy\"</span>\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"shoes-writer\"</span>\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> shoes\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">from</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">principals</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"cluster.local/ns/default/sa/inventory-sa\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">to</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">operation</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">methods</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li><strong>CNI Plugins:</strong> Use Container Network Interface (CNI) plugins like Project Calico and Cilium to implement network policies and isolate traffic.</li>\n</ul>\n<p><strong>Mitigations:</strong></p>\n<ul>\n<li>Implement robust network segmentation controls to minimize the blast radius of a compromised container and prevent lateral movement within the cluster.</li>\n</ul>\n<h3 id=\"k08-secrets-management-failures\" style=\"position:relative;\"><a href=\"#k08-secrets-management-failures\" aria-label=\"k08 secrets management failures permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K08: Secrets Management Failures</h3>\n<p>Secrets management is a critical aspect of securing sensitive information in a Kubernetes environment. Failures in managing secrets, such as storing them in plaintext or using weak encryption, can lead to exposure of sensitive data. Using Kubernetes secrets, integrating with external secrets management solutions like HashiCorp Vault, and following best practices for secrets management can help protect sensitive information from unauthorized access.</p>\n<p>In Kubernetes, a Secret is a small object that contains sensitive data like passwords or tokens. Proper management of secrets is crucial to prevent unauthorized access and data exposure.</p>\n<p><img src=\"/5723a8df50660226c645bcd9daa85a75/k08.gif\" alt=\"k08\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Secrets store sensitive data in Kubernetes.</li>\n<li>They must be handled with caution to prevent leaks and unauthorized access.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>Kubernetes Secrets:</strong> Standalone API objects used to store small sensitive data objects. Example manifest for a secret:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Secret\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> top<span class=\"token punctuation\">-</span>secret\n<span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> XXXXXXXXXXXXXXXX\n  <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> XXXXXXXXXXXXXXXX\n<span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> Opaque</code></pre></div>\n<ul>\n<li><strong>Base64 Encoding:</strong> Secrets are base64 encoded by default, not encrypted, making them vulnerable if checked into version control.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Encrypt Secrets at Rest:</strong> Use Kubernetes' encryption at rest feature to encrypt Secret resources in etcd.</li>\n<li><strong>Address Security Misconfigurations:</strong> Ensure rock-solid configuration across clusters, lock down RBAC configurations, and audit third-party plugins.</li>\n<li><strong>Ensure Logging and Auditing:</strong> Enable and configure Kubernetes Audit records to detect malicious or anomalous behavior.</li>\n</ul>\n<p><strong>Mitigations:</strong></p>\n<ul>\n<li>Implement robust secrets management practices, including encryption, secure configurations, and comprehensive logging and auditing, to protect sensitive data from unauthorized access and exposure.</li>\n</ul>\n<h3 id=\"k09-misconfigured-cluster-components\" style=\"position:relative;\"><a href=\"#k09-misconfigured-cluster-components\" aria-label=\"k09 misconfigured cluster components permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K09: Misconfigured Cluster Components</h3>\n<p>Misconfigured cluster components can create vulnerabilities that attackers can exploit. Ensuring that all components of the Kubernetes cluster, including the API server, etcd, and kubelet, are configured securely is essential for maintaining the overall security of the environment. Regular audits, automated configuration management tools, and adherence to security best practices can help identify and remediate misconfigurations.</p>\n<p>A Kubernetes cluster is comprised of many different components ranging from key-value storage within etcd, the kube-apiserver, the kubelet, and more. Each of these components is highly configurable and has important security responsibilities.</p>\n<p><img src=\"/61bbab19759e3586913d8844a30e476d/k09.gif\" alt=\"k09\" loading=\"lazy\">\n          </p>\n<p><strong>Description:</strong>\nMisconfigurations in core Kubernetes components can lead to complete cluster compromise or worse. In this section, we will explore some of the components that exist on the Kubernetes control plane and nodes which can easily be misconfigured:</p>\n<ul>\n<li>\n<p><strong>kubelet:</strong> Agent that runs on each node in the cluster and ensures that containers run as expected and are healthy. Some dangerous configurations to watch out for on the kubelet itself are as follows:</p>\n<ul>\n<li>\n<p><strong>Anonymous authentication:</strong> Allows non-authenticated requests to the Kubelet. Check your Kubelet configuration and ensure the flag below is set to false:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\">#bad</span>\n<span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>anonymous<span class=\"token punctuation\">-</span>auth=true\n<span class=\"token comment\">#good</span>\n<span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>anonymous<span class=\"token punctuation\">-</span>auth=false</code></pre></div>\n</li>\n<li>\n<p><strong>Authorization checks:</strong> Should always be performed when communicating with the Kubelets. It is possible to set the Authorization mode to explicitly allow unauthorized requests. Inspect the following to ensure this is not the case in your Kubelet config. The mode should be set to anything other than AlwaysAllow:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\">#bad</span>\n<span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>authorization<span class=\"token punctuation\">-</span>mode=AlwaysAllow\n<span class=\"token comment\">#good</span>\n<span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>authorization<span class=\"token punctuation\">-</span>mode=Webhook</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>etcd:</strong> A highly available key-value store that Kubernetes uses to centrally house all cluster data. It is important to keep etcd safe as it stores config data as well as secrets.</p>\n</li>\n<li>\n<p><strong>kube-apiserver:</strong> The API server is a component of the Kubernetes control plane that exposes the Kubernetes API. The API server is the front end for the Kubernetes control plane. A simple security check you can perform is to inspect the internet accessibility of the API server itself. It is recommended to keep the Kubernetes API off of the public network as seen in recent news.</p>\n</li>\n</ul>\n<p><strong>How to Prevent:</strong>\nA good start is to perform regular CIS Benchmark scans and audits focused on component misconfigurations. A strong culture of Infrastructure-as-Code can also help centralize Kubernetes configuration and remediation, giving security teams visibility into how clusters are created and maintained. Using managed Kubernetes such as EKS or GKE can also help limit some of the options for component configuration as well as guide operators into more secure defaults.</p>\n<h3 id=\"k10-outdated-and-vulnerable-kubernetes-components\" style=\"position:relative;\"><a href=\"#k10-outdated-and-vulnerable-kubernetes-components\" aria-label=\"k10 outdated and vulnerable kubernetes components permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>K10: Outdated and Vulnerable Kubernetes Components</h3>\n<p>Running outdated or vulnerable Kubernetes components can expose the cluster to known exploits and attacks. Keeping Kubernetes components up to date with the latest security patches and updates is crucial for maintaining a secure environment. Implementing a regular update and patch management process helps ensure that vulnerabilities are addressed promptly, reducing the risk of exploitation.</p>\n<p>Vulnerabilities exist in Kubernetes, and administrators must follow CVE databases, disclosures, and updates closely. Implementing a regular update and patch management process helps ensure that vulnerabilities are addressed promptly, reducing the risk of exploitation.</p>\n<p><img src=\"/4c4d387fa4371ffbacf5719620d37e7a/k10.gif\" alt=\"k10\" loading=\"lazy\">\n          </p>\n<p><strong>Overview:</strong></p>\n<ul>\n<li>Vulnerabilities in Kubernetes components can expose the cluster to known exploits and attacks.</li>\n<li>Regular updates and patch management are crucial for maintaining a secure environment.</li>\n</ul>\n<p><strong>Description:</strong></p>\n<ul>\n<li><strong>ArgoCD CVEs:</strong> Example CVE-2022-24348 allows malicious actors to load a malicious Kubernetes Helm Chart to access restricted information.</li>\n<li><strong>Kubernetes CVEs:</strong> Example CVE in ingress-nginx allowed users to obtain all secrets in a cluster.</li>\n<li><strong>Istio CVEs:</strong> Example CVE-2020-8595 allowed unauthorized access to resources without a valid JWT token.</li>\n<li><strong>Minimum Kubernetes Version:</strong> Maintain an accurate inventory of clusters and ensure conformance with minimum Kubernetes versions.</li>\n</ul>\n<p><strong>How to Prevent:</strong></p>\n<ul>\n<li><strong>Track CVE Databases:</strong> Include Kubernetes and associated components in your CVE vulnerability scanning process.</li>\n<li><strong>Continuous Scanning:</strong> Use tools like OPA Gatekeeper to write custom rules and discover vulnerable components.</li>\n<li><strong>Minimize Third-Party Dependencies:</strong> Audit all third-party software independently before deployment.</li>\n</ul>\n<p><strong>Mitigations:</strong></p>\n<ul>\n<li>Implement a multi-pronged approach to eliminate vulnerable components, including tracking CVE databases, continuous scanning, and minimizing third-party dependencies.</li>\n</ul>\n<h2 id=\"grouping-risks-into-categories\" style=\"position:relative;\"><a href=\"#grouping-risks-into-categories\" aria-label=\"grouping risks into categories permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Grouping Risks into Categories</h2>\n<h3 id=\"misconfigurations\" style=\"position:relative;\"><a href=\"#misconfigurations\" aria-label=\"misconfigurations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Misconfigurations</h3>\n<p>Misconfigurations are a common source of security risks in Kubernetes environments. This category includes insecure workload configurations (K01), overly permissive RBAC configurations (K03), and misconfigured cluster components (K09). Addressing these risks involves regular audits, automated configuration management, and adherence to security best practices.</p>\n<h3 id=\"monitoring-and-logging\" style=\"position:relative;\"><a href=\"#monitoring-and-logging\" aria-label=\"monitoring and logging permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Monitoring and Logging</h3>\n<p>Inadequate logging and monitoring (K05) can leave organizations blind to potential threats. Implementing comprehensive logging and monitoring solutions helps detect anomalies and respond to incidents swiftly. Tools like Prometheus, Grafana, and the ELK stack are essential for gaining visibility into Kubernetes environments.</p>\n<h3 id=\"vulnerabilities\" style=\"position:relative;\"><a href=\"#vulnerabilities\" aria-label=\"vulnerabilities permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Vulnerabilities</h3>\n<p>Supply chain vulnerabilities (K02) and outdated Kubernetes components (K10) are significant risks. Managing supply chain risks involves verifying the integrity of software components and using trusted sources. Keeping Kubernetes components up to date with the latest security patches is crucial for reducing the risk of exploitation.</p>\n<h2 id=\"tools-and-techniques-for-auditing-your-configuration\" style=\"position:relative;\"><a href=\"#tools-and-techniques-for-auditing-your-configuration\" aria-label=\"tools and techniques for auditing your configuration permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Tools and Techniques for Auditing Your Configuration</h2>\n<h3 id=\"kubernetes-security-tools\" style=\"position:relative;\"><a href=\"#kubernetes-security-tools\" aria-label=\"kubernetes security tools permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Kubernetes Security Tools</h3>\n<p>Several tools can help audit and secure your Kubernetes environment. These include:</p>\n<ul>\n<li><strong>Kube-bench</strong>: Checks the security configuration of Kubernetes clusters against the CIS Kubernetes Benchmark.</li>\n<li><strong>Kube-hunter</strong>: Hunts for security issues in Kubernetes clusters.</li>\n<li><strong>Polaris</strong>: Audits Kubernetes resources for best practices and provides recommendations for improving security.</li>\n</ul>\n<h3 id=\"best-practices-for-kubernetes-security\" style=\"position:relative;\"><a href=\"#best-practices-for-kubernetes-security\" aria-label=\"best practices for kubernetes security permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Best Practices for Kubernetes Security</h3>\n<p>Following best practices is essential for maintaining a secure Kubernetes environment. These include:</p>\n<ul>\n<li><strong>Implementing RBAC</strong>: Use RBAC to enforce the principle of least privilege.</li>\n<li><strong>Using Network Policies</strong>: Implement network policies to segment the network and limit the spread of attacks.</li>\n<li><strong>Managing Secrets Securely</strong>: Use Kubernetes secrets and external secrets management solutions to protect sensitive information.</li>\n<li><strong>Regular Audits</strong>: Conduct regular audits of your Kubernetes environment to identify and remediate security risks.</li>\n</ul>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Conclusion</h2>\n<p>Understanding and mitigating these top risks is essential for maintaining a secure Kubernetes environment. By prioritizing these risks, security practitioners, system administrators, and software developers can better protect their applications and infrastructure. The OWASP Kubernetes Top 10 serves as a valuable resource for guiding security efforts and ensuring that Kubernetes environments remain secure and resilient.</p>\n<p><strong>References:</strong></p>\n<ul>\n<li><a href=\"https://owasp.org/www-project-kubernetes-top-ten/\" target=\"_blank\" rel=\"noopener noreferrer\">OWASP Kubernetes Top Ten</a></li>\n<li><a href=\"https://sysdig.com/blog/top-owasp-kubernetes/\" target=\"_blank\" rel=\"noopener noreferrer\">Sysdig OWASP Kubernetes Top 10</a></li>\n<li><a href=\"https://www.cisecurity.org/benchmark/kubernetes\" target=\"_blank\" rel=\"noopener noreferrer\">CIS Benchmarks for Kubernetes</a></li>\n<li><a href=\"https://github.com/open-policy-agent/opa\" target=\"_blank\" rel=\"noopener noreferrer\">Open Policy Agent</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/security/pod-security-standards/\" target=\"_blank\" rel=\"noopener noreferrer\">Pod Security Standards</a></li>\n<li><a href=\"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/\" target=\"_blank\" rel=\"noopener noreferrer\">Admission Controllers</a></li>\n<li><a href=\"https://aquasecurity.github.io/trivy/v0.56/tutorials/kubernetes/cluster-scanning\" target=\"_blank\" rel=\"noopener noreferrer\">Trivy Kubernetes Cluster Scanning</a></li>\n<li><a href=\"https://github.com/sigstore/cosign\" target=\"_blank\" rel=\"noopener noreferrer\">Cosign</a></li>\n<li><a href=\"https://owasp.org/www-project-cyclonedx/\" target=\"_blank\" rel=\"noopener noreferrer\">CycloneDX</a></li>\n<li><a href=\"https://github.com/docker-slim/docker-slim\" target=\"_blank\" rel=\"noopener noreferrer\">Docker Slim</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/configuration/secret/#security-recommendations-for-developers\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Security Recommendations for Developers</a></li>\n<li><a href=\"https://github.com/open-policy-agent/gatekeeper\" target=\"_blank\" rel=\"noopener noreferrer\">OPA Gatekeeper</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/security/pod-security-admission/\" target=\"_blank\" rel=\"noopener noreferrer\">Pod Security Admission Controller</a></li>\n<li><a href=\"https://kyverno.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Kyverno</a></li>\n<li><a href=\"https://developer.squareup.com/blog/threat-hunting-with-kubernetes-audit-logs/\" target=\"_blank\" rel=\"noopener noreferrer\">Threat Hunting with Kubernetes Audit Logs</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/cluster-administration/logging/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Logging</a></li>\n<li><a href=\"https://www.cncf.io/blog/2021/12/21/extracting-value-from-the-kubernetes-events-feed/\" target=\"_blank\" rel=\"noopener noreferrer\">Extracting Value from the Kubernetes Events Feed</a></li>\n<li><a href=\"https://istiobyexample.dev/authorization/\" target=\"_blank\" rel=\"noopener noreferrer\">Istio Authorization</a></li>\n<li><a href=\"https://www.tigera.io/learn/guides/kubernetes-networking/kubernetes-cni/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes CNI Explained</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/services-networking/network-policies/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Network Policies</a></li>\n<li><a href=\"https://www.4armed.com/blog/hacking-kubelet-on-gke/\" target=\"_blank\" rel=\"noopener noreferrer\">Hacking Kubelet on GKE</a></li>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Kubernetes_Security_Cheat_Sheet.html#securing-data\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Security Cheat Sheet</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/overview/components/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Cluster Components</a></li>\n<li><a href=\"https://www.cvedetails.com/vulnerability-list/vendor_id-11448/product_id-81059/version_id-634305/Linuxfoundation-Argo-cd%E2%80%93.html\" target=\"_blank\" rel=\"noopener noreferrer\">ArgoCD CVE Database</a></li>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=kubernetes\" target=\"_blank\" rel=\"noopener noreferrer\">CVE Database Keyword ‚ÄúKubernetes‚Äù</a></li>\n<li><a href=\"https://istio.io/latest/news/security/\" target=\"_blank\" rel=\"noopener noreferrer\">Istio Security Bulletins</a></li>\n<li><a href=\"https://kubernetes.io/docs/reference/issues-security/security/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Security and Disclosure Information</a></li>\n<li><a href=\"https://www.tremolosecurity.com/post/what-the-nsa-and-cisa-left-out-of-their-kubernetes-hardening-guide\" target=\"_blank\" rel=\"noopener noreferrer\">Tremlo Blog Post</a></li>\n<li><a href=\"https://kubernetes.io/docs/concepts/security/controlling-access/\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes Authentication</a></li>\n</ul>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}