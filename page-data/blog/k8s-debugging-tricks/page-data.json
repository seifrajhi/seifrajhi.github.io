{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/k8s-debugging-tricks/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Tricks and tools to solve all your debugging needs like a¬†PRO</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Introduction</h2>\n<p>Let's talk about making your experience with Kubernetes (K8s) easy! I have got some simple tips and tricks to share that will help you solve some of your problems easily.</p>\n<h2 id=\"examining-running-pods\" style=\"position:relative;\"><a href=\"#examining-running-pods\" aria-label=\"examining running pods permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Examining Running Pods</h2>\n<p>First, look at the logs of the affected container:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl logs <span class=\"token variable\">${POD_NAME}</span> <span class=\"token variable\">${CONTAINER_NAME}</span></code></pre></div>\n<p>If your container has previously crashed, you can access the previous container's crash log with:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl logs <span class=\"token parameter variable\">--previous</span> <span class=\"token variable\">${POD_NAME}</span> <span class=\"token variable\">${CONTAINER_NAME}</span></code></pre></div>\n<p>If the container image includes debugging utilities, as is the case with images built from Linux and Windows OS base images, you can run commands inside a specific container with kubectl exec:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token builtin class-name\">exec</span> <span class=\"token variable\">${POD_NAME}</span> <span class=\"token parameter variable\">-c</span> <span class=\"token variable\">${CONTAINER_NAME}</span> -- <span class=\"token variable\">${CMD}</span> <span class=\"token variable\">${ARG1}</span> <span class=\"token variable\">${ARG2}</span> <span class=\"token punctuation\">..</span>. <span class=\"token variable\">${ARGN}</span></code></pre></div>\n<p>As an example, to look at the logs from a running Cassandra pod, you might run</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token builtin class-name\">exec</span> cassandra -- <span class=\"token function\">cat</span> /var/log/cassandra/system.log</code></pre></div>\n<p>You can run a shell that's connected to your terminal using the <code class=\"language-text\">-i</code> and <code class=\"language-text\">-t</code> arguments to kubectl exec, for example:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> cassandra -- <span class=\"token function\">sh</span></code></pre></div>\n<h2 id=\"debug-with-an-ephemeral-debug\" style=\"position:relative;\"><a href=\"#debug-with-an-ephemeral-debug\" aria-label=\"debug with an ephemeral debug permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Debug with an Ephemeral Debug</h2>\n<p><a href=\"https://kubernetes.io/docs/concepts/workloads/pods/ephemeral-containers/\" target=\"_blank\" rel=\"noopener noreferrer\">Ephemeral containers</a> are useful for interactive troubleshooting when <code class=\"language-text\">kubectl exec</code> is insufficient because a container has crashed or a container image doesn't include debugging utilities, such as with <a href=\"https://github.com/GoogleContainerTools/distroless\" target=\"_blank\" rel=\"noopener noreferrer\">distroless images</a>.</p>\n<h3 id=\"debugging-using-ephemeral-containers\" style=\"position:relative;\"><a href=\"#debugging-using-ephemeral-containers\" aria-label=\"debugging using ephemeral containers permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Debugging Using Ephemeral Containers</h3>\n<p>You can use the <code class=\"language-text\">kubectl debug</code> command to add ephemeral containers to a running Pod. First, create a pod for the example:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl run ephemeral-demo <span class=\"token parameter variable\">--image</span><span class=\"token operator\">=</span>registry.k8s.io/pause:3.1 <span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>Never</code></pre></div>\n<p>The examples in this section use the pause container image because it does not contain debugging utilities, but this method works with all container images. If you attempt to use <code class=\"language-text\">kubectl exec</code> to create a shell, you will see an error because there is no shell in this container image.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> ephemeral-demo -- <span class=\"token function\">sh</span>\nOCI runtime <span class=\"token builtin class-name\">exec</span> failed: <span class=\"token builtin class-name\">exec</span> failed: container_linux.go:346: starting container process caused <span class=\"token string\">\"exec: <span class=\"token entity\" title=\"\\&quot;\">\\\"</span>sh<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>: executable file not found in <span class=\"token environment constant\">$PATH</span>\"</span><span class=\"token builtin class-name\">:</span> unknown</code></pre></div>\n<p>You can instead add a debugging container using <code class=\"language-text\">kubectl debug</code>. If you specify the <code class=\"language-text\">-i/--interactive</code> argument, <code class=\"language-text\">kubectl</code> will automatically attach to the console of the Ephemeral Container.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl debug <span class=\"token parameter variable\">-it</span> ephemeral-demo <span class=\"token parameter variable\">--image</span><span class=\"token operator\">=</span>busybox:1.28 <span class=\"token parameter variable\">--target</span><span class=\"token operator\">=</span>ephemeral-demo\nDefaulting debug container name to debugger-8xzrl.\nIf you don't see a <span class=\"token builtin class-name\">command</span> prompt, try pressing enter.\n/ <span class=\"token comment\">#</span></code></pre></div>\n<p>This command adds a new busybox container and attaches to it. The <code class=\"language-text\">--target</code> parameter targets the process namespace of another container. It's necessary here because <code class=\"language-text\">kubectl run</code> does not enable <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/share-process-namespace/\" target=\"_blank\" rel=\"noopener noreferrer\">process namespace sharing</a> in the pod it creates. The <code class=\"language-text\">--target</code> parameter must be supported by the <a href=\"https://kubernetes.io/docs/setup/production-environment/container-runtimes\" target=\"_blank\" rel=\"noopener noreferrer\">Container Runtime</a>. When not supported, the Ephemeral Container may not be started, or it may be started with an isolated process namespace so that <code class=\"language-text\">ps</code> does not reveal processes in other containers.</p>\n<h3 id=\"using-code-classlanguage-textkubectl-describe-podcode\" style=\"position:relative;\"><a href=\"#using-code-classlanguage-textkubectl-describe-podcode\" aria-label=\"using code classlanguage textkubectl describe podcode permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Using <code class=\"language-text\">kubectl describe pod</code></h3>\n<p>For this example, we'll use a Deployment to create two pods, similar to the earlier example.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">-</span>deployment\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n    <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n        <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx\n                <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx\n                <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">limits</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"128Mi\"</span>\n                        <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"500m\"</span>\n                <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n<p>Create the deployment by running the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl apply <span class=\"token parameter variable\">-f</span> nginx.yaml\ndeployment.apps/nginx-deployment created</code></pre></div>\n<p>Check the pod status with the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get pods</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">NAME                                READY   STATUS    RESTARTS   AGE\nnginx-deployment-67d4bdd6f5-cx2nz   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          13s\nnginx-deployment-67d4bdd6f5-w6kd7   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          13s</code></pre></div>\n<p>We can retrieve a lot more information about each of these pods using <code class=\"language-text\">kubectl describe pod</code>. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl describe pod nginx-deployment-67d4bdd6f5-w6kd7</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Name:         nginx-deployment-67d4bdd6f5-w6kd7\nNamespace:    default\nPriority:     <span class=\"token number\">0</span>\nNode:         kube-worker-1/192.168.0.113\nStart Time:   Thu, <span class=\"token number\">17</span> Feb <span class=\"token number\">2022</span> <span class=\"token number\">16</span>:51:01 <span class=\"token parameter variable\">-0500</span>\nLabels:       <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>nginx\n                            pod-template-hash<span class=\"token operator\">=</span>67d4bdd6f5\nAnnotations:  <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>\nStatus:       Running\nIP:           <span class=\"token number\">10.88</span>.0.3\nIPs:\n    IP:           <span class=\"token number\">10.88</span>.0.3\n    IP:           <span class=\"token number\">2001</span>:db8::1\nControlled By:  ReplicaSet/nginx-deployment-67d4bdd6f5\nContainers:\n    nginx:\n        Container ID:   containerd://5403af59a2b46ee5a23fb0ae4b1e077f7ca5c5fb7af16e1ab21c00e0e616462a\n        Image:          nginx\n        Image ID:       docker.io/library/nginx@sha256:2834dc507516af02784808c5f48b7cbe38b8ed5d0f4837f16e78d00deb7e7767\n        Port:           <span class=\"token number\">80</span>/TCP\n        Host Port:      <span class=\"token number\">0</span>/TCP\n        State:          Running\n            Started:      Thu, <span class=\"token number\">17</span> Feb <span class=\"token number\">2022</span> <span class=\"token number\">16</span>:51:05 <span class=\"token parameter variable\">-0500</span>\n        Ready:          True\n        Restart Count:  <span class=\"token number\">0</span>\n        Limits:\n            cpu:     500m\n            memory:  128Mi\n        Requests:\n            cpu:        500m\n            memory:     128Mi\n        Environment:  <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">></span>\n        Mounts:\n            /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-bgsgp <span class=\"token punctuation\">(</span>ro<span class=\"token punctuation\">)</span>\nConditions:\n    Type              Status\n    Initialized       True \n    Ready             True \n    ContainersReady   True\n<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span></code></pre></div>\n<h2 id=\"Ô∏è-get-images-with-almost-any-tool-you-want\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-get-images-with-almost-any-tool-you-want\" aria-label=\"Ô∏è get images with almost any tool you want permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Get Images with Almost Any Tool You Want</h2>\n<p>Whenever I troubleshoot anything container-related, I look for a good container image that contains all the right tools to troubleshoot and/or solve the problem. To save both you and me the hassle of finding or building such image(s), here are some container images that will satisfy all the troubleshooting needs.</p>\n<h3 id=\"-nixery\" style=\"position:relative;\"><a href=\"#-nixery\" aria-label=\" nixery permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üêß Nixery</h3>\n<p>\"Hey, I need an image with terraform, kubectl, helm, curl, and ffmpeg!\"</p>\n<p>\"Sure, let's write a Dockerfile, and‚Ä¶\"</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-ti</span> nixery.dev/shell/terraform/kubectl/kubernetes-helm/curl/ffmpeg</code></pre></div>\n<p>DONE üéâ The image gets generated on the fly. This is probably the most magical thing you'll see today.</p>\n<h3 id=\"-infuser\" style=\"position:relative;\"><a href=\"#-infuser\" aria-label=\" infuser permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üß∞ Infuser</h3>\n<p>Another option is to use an image such as <a href=\"https://github.com/teaxyz/infuser\" target=\"_blank\" rel=\"noopener noreferrer\">Infuser</a>. Infuser is built around tea CLI which automatically installs any tool that you invoke. Let's say you run curl in a container, but it's not installed. No problem, tea will first install it and then invoke your command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">-it</span> ghcr.io/teaxyz/infuser</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># curl is not installed...</span>\ntea $ <span class=\"token function\">curl</span> https://google.com\n<span class=\"token comment\"># installed: ~/.tea/curl.se/ca-certs/v2023.5.30</span>\n<span class=\"token comment\"># installed: ~/.tea/curl.se/v8.2.1</span>\n<span class=\"token comment\"># installed: ~/.tea/openssl.org/v1.1.1u</span>\n<span class=\"token operator\">&lt;</span>HTML<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>HEAD<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>meta http-equiv<span class=\"token operator\">=</span><span class=\"token string\">\"content-type\"</span> <span class=\"token assign-left variable\">content</span><span class=\"token operator\">=</span><span class=\"token string\">\"text/html;charset=utf-8\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>TITLE<span class=\"token operator\">></span><span class=\"token number\">301</span> Moved<span class=\"token operator\">&lt;</span>/TITLE<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>/HEAD<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>BODY<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>H<span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span><span class=\"token number\">301</span> Moved<span class=\"token operator\">&lt;</span>/H<span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span>\nThe document has moved\n<span class=\"token operator\">&lt;</span>A <span class=\"token assign-left variable\">HREF</span><span class=\"token operator\">=</span><span class=\"token string\">\"https://www.google.com/\"</span><span class=\"token operator\">></span>here<span class=\"token operator\">&lt;</span>/A<span class=\"token operator\">></span>.\n<span class=\"token operator\">&lt;</span>/BODY<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>/HTML<span class=\"token operator\">></span>\n<span class=\"token comment\"># ... but worked anyway!</span>\ntea $</code></pre></div>\n<h2 id=\"Ô∏è-netshoot\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-netshoot\" aria-label=\"Ô∏è netshoot permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Netshoot</h2>\n<p>As for more specialized tools, if I need to troubleshoot anything network-related, I always reach for <strong>netshoot</strong>. It contains all the networking tools you might need, all you need to do is run:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">-it</span> nicolaka/netshoot\n<span class=\"token comment\"># OR</span>\nkubectl run tmp-shell <span class=\"token parameter variable\">--rm</span> <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">--tty</span> <span class=\"token parameter variable\">--image</span> nicolaka/netshoot</code></pre></div>\n<p>The above images should satisfy your troubleshooting needs, but there are a couple of honorable mentions:</p>\n<ul>\n<li><strong><a href=\"https://github.com/raesene/alpine-containertools\" target=\"_blank\" rel=\"noopener noreferrer\">alpine-containertools</a></strong> - Image with common container tooling. Targeted at security assessment tools.</li>\n<li><strong><a href=\"https://github.com/lightrun-platform/koolkit\" target=\"_blank\" rel=\"noopener noreferrer\">Koolkits</a></strong> - Language-specific container images that contain a (highly-opinionated) set of tools for debugging applications running in Kubernetes pods. Intended for use with <code class=\"language-text\">kubectl debug</code>.</li>\n<li><strong><a href=\"https://github.com/digitalocean/doks-debug\" target=\"_blank\" rel=\"noopener noreferrer\">doks-debug</a></strong> - Digital Ocean Kubernetes Service debug image, intended for debugging Kubernetes clusters. Contains lots of useful tools for debugging clusters not only in Digital Ocean.</li>\n<li><strong><a href=\"https://github.com/arunvelsriram/utils\" target=\"_blank\" rel=\"noopener noreferrer\">Utils</a></strong> - Image with a different set of tools, this one includes various database clients and MQ tools.</li>\n</ul>\n<h2 id=\"-use-ai-to-debug-kubernetes\" style=\"position:relative;\"><a href=\"#-use-ai-to-debug-kubernetes\" aria-label=\" use ai to debug kubernetes permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>ü§ñ Use AI to Debug Kubernetes</h2>\n<p>AI-powered tools can help you with Kubernetes work by automating tasks, improving reliability, and providing insights.</p>\n<h3 id=\"-k8sgpt\" style=\"position:relative;\"><a href=\"#-k8sgpt\" aria-label=\" k8sgpt permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ú® K8sGPT</h3>\n<p><a href=\"https://github.com/k8sgpt-ai/k8sgpt\" target=\"_blank\" rel=\"noopener noreferrer\">K8sGPT</a> is an open-source project that uses AI models to explain Kubernetes error messages and provide cluster insights. It is already used by two organizations in production.</p>\n<p><strong>K8sGPT Features:</strong></p>\n<ul>\n<li>Provides detailed and contextualized explanations of Kubernetes error messages</li>\n<li>Provides cluster insights</li>\n<li>Supports multiple installation options</li>\n<li>Supports different AI backends</li>\n</ul>\n<p>K8sGPT is the most well-known and widely used project of its kind. Launched by Alex Jones, it is marketed as a way to \"give Kubernetes superpowers to everyone.\"</p>\n<p><img src=\"/1e235c7f3630387594e2e75858e3f862/K8sgpt.gif\" alt=\"K8sgpt\" loading=\"lazy\">\n          </p>\n<h3 id=\"-kubectl-ai\" style=\"position:relative;\"><a href=\"#-kubectl-ai\" aria-label=\" kubectl ai permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ú® kubectl-ai</h3>\n<p><a href=\"https://github.com/sozercan/kubectl-ai\" target=\"_blank\" rel=\"noopener noreferrer\">This project</a> is a <code class=\"language-text\">kubectl</code> plugin to generate and apply Kubernetes manifests using OpenAI GPT.</p>\n<p>To make it more interesting and understand in a visualized way, we will leverage Kubectl + OpenAI plugin.</p>\n<p><strong>Usage:</strong></p>\n<p><strong>Prerequisites:</strong></p>\n<p><code class=\"language-text\">kubectl-ai</code> requires a valid Kubernetes configuration and one of the following:</p>\n<ul>\n<li><a href=\"https://platform.openai.com/overview\" target=\"_blank\" rel=\"noopener noreferrer\">OpenAI API</a> key</li>\n<li><a href=\"https://aka.ms/azure-openai\" target=\"_blank\" rel=\"noopener noreferrer\">Azure OpenAI Service API key</a> and endpoint</li>\n<li><a href=\"https://github.com/go-skynet/LocalAI\" target=\"_blank\" rel=\"noopener noreferrer\">Local AI</a> (see <a href=\"https://localai.io/basics/getting_started/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">getting started</a>)</li>\n</ul>\n<p><img src=\"/d927bc2f1439b128c7f6198d27d72fc0/kubectl-ai.gif\" alt=\"kubectl-ai\" loading=\"lazy\">\n          </p>\n<h2 id=\"Ô∏è-cluster-level-debugging\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-cluster-level-debugging\" aria-label=\"Ô∏è cluster level debugging permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Cluster-Level Debugging</h2>\n<p>Here is an overview of how to troubleshoot and debug a Kubernetes cluster.</p>\n<h3 id=\"get-cluster-information\" style=\"position:relative;\"><a href=\"#get-cluster-information\" aria-label=\"get cluster information permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Get Cluster Information</h3>\n<p>The first step when debugging a Kubernetes cluster is to obtain cluster information. You can do this by running the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl cluster-info</code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 7.0588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANElEQVR42l3EQQoAIAgEQAu0DFcypf8/tXtzGJp3ai0LoNxT49jeiKOZYtaBBtAYJPLPTA9VdgI6b87QYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cluster-info\" title=\"\" src=\"/static/a1d29c61602e8cfb72c38e7f7834221e/c5bb3/cluster-info.png\" srcset=\"/static/a1d29c61602e8cfb72c38e7f7834221e/04472/cluster-info.png 170w,\n/static/a1d29c61602e8cfb72c38e7f7834221e/9f933/cluster-info.png 340w,\n/static/a1d29c61602e8cfb72c38e7f7834221e/c5bb3/cluster-info.png 680w,\n/static/a1d29c61602e8cfb72c38e7f7834221e/b12f7/cluster-info.png 1020w,\n/static/a1d29c61602e8cfb72c38e7f7834221e/42de8/cluster-info.png 1033w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"get-cluster-components-health-status\" style=\"position:relative;\"><a href=\"#get-cluster-components-health-status\" aria-label=\"get cluster components health status permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Get Cluster Components' Health Status</h3>\n<p>The next step is to check the health status of the Kubernetes cluster components, such as the control plane and worker nodes. You can use this command to view the health status of the control plane components:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get componentstatus</code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 604px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.529411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeklEQVR42mWOWQrEMAxDE0ibzY6zL83c/5zjzFdhhMCIZ5BEH0e5FPba+3dL7T3lVFvFEIjIeZ9yZseUODNSSgnWmGOtSZEQA2Otb2fd3p+xpjEGA133xW9SSvGv1hp4/2bWuufZrXetNXeWWrgKADDgWeHOCorRA3wBniUI9sB92wUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"componentstatus\" title=\"\" src=\"/static/b0d176f340bd79542f39fc5eb4915c9e/87254/componentstatus.png\" srcset=\"/static/b0d176f340bd79542f39fc5eb4915c9e/04472/componentstatus.png 170w,\n/static/b0d176f340bd79542f39fc5eb4915c9e/9f933/componentstatus.png 340w,\n/static/b0d176f340bd79542f39fc5eb4915c9e/87254/componentstatus.png 604w\" sizes=\"(max-width: 604px) 100vw, 604px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>This command will display the health status of the control plane components, including the etcd, kube-apiserver, kube-controller-manager, and kube-scheduler (depending on the components installed for your cluster).</p>\n<p>To check the health status of the worker nodes, you can use the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get nodes</code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 485px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiUlEQVR42h2OWRaDIAxFEUHmAiICMrT7X2Vfm6+bk7yBpJRKbfE8jXUXJl9nSiGEUgtYSumcs9YC8n0D/qeKVQhB+hhPH4wxSmmfY67JOVdKt6flnH+stdKKEAKN9y9+iD56BQdP4NfHjDHSfV/vz1pz2zYY47WUarQ2iHMWYhSBmPED/dBXSvUFFHoLC1AhN6MAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"nodes\" title=\"\" src=\"/static/43a666ba251b68aeac9831d525fb7c4e/44c61/nodes.png\" srcset=\"/static/43a666ba251b68aeac9831d525fb7c4e/04472/nodes.png 170w,\n/static/43a666ba251b68aeac9831d525fb7c4e/9f933/nodes.png 340w,\n/static/43a666ba251b68aeac9831d525fb7c4e/44c61/nodes.png 485w\" sizes=\"(max-width: 485px) 100vw, 485px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"view-the-events-in-the-cluster\" style=\"position:relative;\"><a href=\"#view-the-events-in-the-cluster\" aria-label=\"view the events in the cluster permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>View the Events in the Cluster</h3>\n<p>The final step is to view the events in the cluster. Events can be used to track changes and actions that occur in the cluster, including the creation, modification, and deletion of resources. To view the events in the cluster, you can use the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get events</code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfklEQVR42k2N3Q7DIAhGjWgnlgraH+1setO9/zOOLlnSEy4gfDmfScwjkWTJpeSSY4zOOQCYl3kYBvOAFRFE9N6/fhgi0ntZb/rR372nNOnjOM/EyVrr/qzb1vZdkzq1tetzGc2paZxUQiysu5aAAyn5dj8IiAGDomVgba31C+NWB8dFllp8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"events\" title=\"\" src=\"/static/08d1d07ba544e535d6352b843c358b55/c5bb3/events.png\" srcset=\"/static/08d1d07ba544e535d6352b843c358b55/04472/events.png 170w,\n/static/08d1d07ba544e535d6352b843c358b55/9f933/events.png 340w,\n/static/08d1d07ba544e535d6352b843c358b55/c5bb3/events.png 680w,\n/static/08d1d07ba544e535d6352b843c358b55/b12f7/events.png 1020w,\n/static/08d1d07ba544e535d6352b843c358b55/307e7/events.png 1354w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>This command will display a list of events that have occurred in the cluster, including their type, reason, message, and timestamp. You can use this information to troubleshoot issues in the cluster, such as resource allocation problems or unexpected resource deletions.</p>\n<p>You can also filter events based on specific criteria by using this command:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl get events --field-selector <span class=\"token assign-left variable\">involvedObject.kind</span><span class=\"token operator\">=</span>Pod</code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 13.529411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAi0lEQVR42l2MSw6DIAAFEYqg/JRgq3JljLDhIx62NE03ncUkbxYPnP50x+GcSynX+04plVKacynXdcUY26y1thJTzDmHELz3X4Ou67gUdKCUDpwz8GNko5ACIjQyxgXH+IExRgiBP4wxSikp5bIs7QtC2OI0T9ZaqdSs9bqt274/Xx+01oQQ3PeEkDepgSd6pZcRHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"events2\" title=\"\" src=\"/static/44198720993d9811ee1a20aeffc45c34/c5bb3/events2.png\" srcset=\"/static/44198720993d9811ee1a20aeffc45c34/04472/events2.png 170w,\n/static/44198720993d9811ee1a20aeffc45c34/9f933/events2.png 340w,\n/static/44198720993d9811ee1a20aeffc45c34/c5bb3/events2.png 680w,\n/static/44198720993d9811ee1a20aeffc45c34/b12f7/events2.png 1020w,\n/static/44198720993d9811ee1a20aeffc45c34/25260/events2.png 1113w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>This command will display events that are related to pods. You can replace <code class=\"language-text\">Pod</code> with other resource types, such as <code class=\"language-text\">Service</code> or <code class=\"language-text\">Deployment</code>, to filter events based on specific resource types.</p>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîö Conclusion</h2>\n<p>Now that you've got these helpful tricks and tools, fixing issues in Kubernetes (K8s) is much easier. No more frustration‚Ää‚Äî‚Ääyou'll feel like an expert! Keep things simple, smooth out any problems, and enjoy your stress-free journey with K8s.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":7,"rawMarkdownBody":"\n> **Tricks and tools to solve all your debugging needs like a¬†PRO**\n\n## üìå Introduction\n\nLet's talk about making your experience with Kubernetes (K8s) easy! I have got some simple tips and tricks to share that will help you solve some of your problems easily.\n\n## Examining Running Pods\n\nFirst, look at the logs of the affected container:\n\n```shell\nkubectl logs ${POD_NAME} ${CONTAINER_NAME}\n```\n\nIf your container has previously crashed, you can access the previous container's crash log with:\n\n```shell\nkubectl logs --previous ${POD_NAME} ${CONTAINER_NAME}\n```\n\nIf the container image includes debugging utilities, as is the case with images built from Linux and Windows OS base images, you can run commands inside a specific container with kubectl exec:\n\n```shell\nkubectl exec ${POD_NAME} -c ${CONTAINER_NAME} -- ${CMD} ${ARG1} ${ARG2} ... ${ARGN}\n```\n\nAs an example, to look at the logs from a running Cassandra pod, you might run\n\n```shell\nkubectl exec cassandra -- cat /var/log/cassandra/system.log\n```\n\nYou can run a shell that's connected to your terminal using the `-i` and `-t` arguments to kubectl exec, for example:\n\n```shell\nkubectl exec -it cassandra -- sh\n```\n\n## Debug with an Ephemeral Debug\n\n[Ephemeral containers](https://kubernetes.io/docs/concepts/workloads/pods/ephemeral-containers/) are useful for interactive troubleshooting when `kubectl exec` is insufficient because a container has crashed or a container image doesn't include debugging utilities, such as with [distroless images](https://github.com/GoogleContainerTools/distroless).\n\n### Debugging Using Ephemeral Containers\n\nYou can use the `kubectl debug` command to add ephemeral containers to a running Pod. First, create a pod for the example:\n\n```shell\nkubectl run ephemeral-demo --image=registry.k8s.io/pause:3.1 --restart=Never\n```\n\nThe examples in this section use the pause container image because it does not contain debugging utilities, but this method works with all container images. If you attempt to use `kubectl exec` to create a shell, you will see an error because there is no shell in this container image.\n\n```shell\nkubectl exec -it ephemeral-demo -- sh\nOCI runtime exec failed: exec failed: container_linux.go:346: starting container process caused \"exec: \\\"sh\\\": executable file not found in $PATH\": unknown\n```\n\nYou can instead add a debugging container using `kubectl debug`. If you specify the `-i/--interactive` argument, `kubectl` will automatically attach to the console of the Ephemeral Container.\n\n```shell\nkubectl debug -it ephemeral-demo --image=busybox:1.28 --target=ephemeral-demo\nDefaulting debug container name to debugger-8xzrl.\nIf you don't see a command prompt, try pressing enter.\n/ #\n```\n\nThis command adds a new busybox container and attaches to it. The `--target` parameter targets the process namespace of another container. It's necessary here because `kubectl run` does not enable [process namespace sharing](https://kubernetes.io/docs/tasks/configure-pod-container/share-process-namespace/) in the pod it creates. The `--target` parameter must be supported by the [Container Runtime](https://kubernetes.io/docs/setup/production-environment/container-runtimes). When not supported, the Ephemeral Container may not be started, or it may be started with an isolated process namespace so that `ps` does not reveal processes in other containers.\n\n### Using `kubectl describe pod`\n\nFor this example, we'll use a Deployment to create two pods, similar to the earlier example.\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: nginx-deployment\nspec:\n    selector:\n        matchLabels:\n            app: nginx\n    replicas: 2\n    template:\n        metadata:\n            labels:\n                app: nginx\n        spec:\n            containers:\n            - name: nginx\n                image: nginx\n                resources:\n                    limits:\n                        memory: \"128Mi\"\n                        cpu: \"500m\"\n                ports:\n                - containerPort: 80\n```\n\nCreate the deployment by running the following command:\n\n```shell\nkubectl apply -f nginx.yaml\ndeployment.apps/nginx-deployment created\n```\n\nCheck the pod status with the following command:\n\n```shell\nkubectl get pods\n```\n\n```shell\nNAME                                READY   STATUS    RESTARTS   AGE\nnginx-deployment-67d4bdd6f5-cx2nz   1/1     Running   0          13s\nnginx-deployment-67d4bdd6f5-w6kd7   1/1     Running   0          13s\n```\n\nWe can retrieve a lot more information about each of these pods using `kubectl describe pod`. For example:\n\n```shell\nkubectl describe pod nginx-deployment-67d4bdd6f5-w6kd7\n```\n\n```shell\nName:         nginx-deployment-67d4bdd6f5-w6kd7\nNamespace:    default\nPriority:     0\nNode:         kube-worker-1/192.168.0.113\nStart Time:   Thu, 17 Feb 2022 16:51:01 -0500\nLabels:       app=nginx\n                            pod-template-hash=67d4bdd6f5\nAnnotations:  <none>\nStatus:       Running\nIP:           10.88.0.3\nIPs:\n    IP:           10.88.0.3\n    IP:           2001:db8::1\nControlled By:  ReplicaSet/nginx-deployment-67d4bdd6f5\nContainers:\n    nginx:\n        Container ID:   containerd://5403af59a2b46ee5a23fb0ae4b1e077f7ca5c5fb7af16e1ab21c00e0e616462a\n        Image:          nginx\n        Image ID:       docker.io/library/nginx@sha256:2834dc507516af02784808c5f48b7cbe38b8ed5d0f4837f16e78d00deb7e7767\n        Port:           80/TCP\n        Host Port:      0/TCP\n        State:          Running\n            Started:      Thu, 17 Feb 2022 16:51:05 -0500\n        Ready:          True\n        Restart Count:  0\n        Limits:\n            cpu:     500m\n            memory:  128Mi\n        Requests:\n            cpu:        500m\n            memory:     128Mi\n        Environment:  <none>\n        Mounts:\n            /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-bgsgp (ro)\nConditions:\n    Type              Status\n    Initialized       True \n    Ready             True \n    ContainersReady   True\n....\n```\n\n## üõ†Ô∏è Get Images with Almost Any Tool You Want\n\nWhenever I troubleshoot anything container-related, I look for a good container image that contains all the right tools to troubleshoot and/or solve the problem. To save both you and me the hassle of finding or building such image(s), here are some container images that will satisfy all the troubleshooting needs.\n\n### üêß Nixery\n\n\"Hey, I need an image with terraform, kubectl, helm, curl, and ffmpeg!\"\n\n\"Sure, let's write a Dockerfile, and‚Ä¶\"\n\n```shell\ndocker run -ti nixery.dev/shell/terraform/kubectl/kubernetes-helm/curl/ffmpeg\n```\n\nDONE üéâ The image gets generated on the fly. This is probably the most magical thing you'll see today.\n\n### üß∞ Infuser\n\nAnother option is to use an image such as [Infuser](https://github.com/teaxyz/infuser). Infuser is built around tea CLI which automatically installs any tool that you invoke. Let's say you run curl in a container, but it's not installed. No problem, tea will first install it and then invoke your command:\n\n```shell\ndocker run --rm -it ghcr.io/teaxyz/infuser\n```\n\n```shell\n# curl is not installed...\ntea $ curl https://google.com\n# installed: ~/.tea/curl.se/ca-certs/v2023.5.30\n# installed: ~/.tea/curl.se/v8.2.1\n# installed: ~/.tea/openssl.org/v1.1.1u\n<HTML><HEAD><meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">\n<TITLE>301 Moved</TITLE></HEAD><BODY>\n<H1>301 Moved</H1>\nThe document has moved\n<A HREF=\"https://www.google.com/\">here</A>.\n</BODY></HTML>\n# ... but worked anyway!\ntea $\n```\n\n## üõ†Ô∏è Netshoot\n\nAs for more specialized tools, if I need to troubleshoot anything network-related, I always reach for **netshoot**. It contains all the networking tools you might need, all you need to do is run:\n\n```shell\ndocker run --rm -it nicolaka/netshoot\n# OR\nkubectl run tmp-shell --rm -i --tty --image nicolaka/netshoot\n```\n\nThe above images should satisfy your troubleshooting needs, but there are a couple of honorable mentions:\n\n- **[alpine-containertools](https://github.com/raesene/alpine-containertools)** - Image with common container tooling. Targeted at security assessment tools.\n- **[Koolkits](https://github.com/lightrun-platform/koolkit)** - Language-specific container images that contain a (highly-opinionated) set of tools for debugging applications running in Kubernetes pods. Intended for use with `kubectl debug`.\n- **[doks-debug](https://github.com/digitalocean/doks-debug)** - Digital Ocean Kubernetes Service debug image, intended for debugging Kubernetes clusters. Contains lots of useful tools for debugging clusters not only in Digital Ocean.\n- **[Utils](https://github.com/arunvelsriram/utils)** - Image with a different set of tools, this one includes various database clients and MQ tools.\n\n## ü§ñ Use AI to Debug Kubernetes\n\nAI-powered tools can help you with Kubernetes work by automating tasks, improving reliability, and providing insights.\n\n### ‚ú® K8sGPT\n\n[K8sGPT](https://github.com/k8sgpt-ai/k8sgpt) is an open-source project that uses AI models to explain Kubernetes error messages and provide cluster insights. It is already used by two organizations in production.\n\n**K8sGPT Features:**\n\n- Provides detailed and contextualized explanations of Kubernetes error messages\n- Provides cluster insights\n- Supports multiple installation options\n- Supports different AI backends\n\nK8sGPT is the most well-known and widely used project of its kind. Launched by Alex Jones, it is marketed as a way to \"give Kubernetes superpowers to everyone.\"\n\n![K8sgpt](./K8sgpt.gif)\n\n### ‚ú® kubectl-ai\n\n[This project](https://github.com/sozercan/kubectl-ai) is a `kubectl` plugin to generate and apply Kubernetes manifests using OpenAI GPT.\n\nTo make it more interesting and understand in a visualized way, we will leverage Kubectl + OpenAI plugin.\n\n**Usage:**\n\n**Prerequisites:**\n\n`kubectl-ai` requires a valid Kubernetes configuration and one of the following:\n\n- [OpenAI API](https://platform.openai.com/overview) key\n- [Azure OpenAI Service API key](https://aka.ms/azure-openai) and endpoint\n- [Local AI](https://github.com/go-skynet/LocalAI) (see [getting started](https://localai.io/basics/getting_started/index.html))\n\n![kubectl-ai](./kubectl-ai.gif)\n\n## üõ†Ô∏è Cluster-Level Debugging\n\nHere is an overview of how to troubleshoot and debug a Kubernetes cluster.\n\n### Get Cluster Information\n\nThe first step when debugging a Kubernetes cluster is to obtain cluster information. You can do this by running the following command:\n\n```shell\nkubectl cluster-info\n```\n\n![cluster-info](./cluster-info.png)\n\n### Get Cluster Components' Health Status\n\nThe next step is to check the health status of the Kubernetes cluster components, such as the control plane and worker nodes. You can use this command to view the health status of the control plane components:\n\n```shell\nkubectl get componentstatus\n```\n\n![componentstatus](./componentstatus.png)\n\nThis command will display the health status of the control plane components, including the etcd, kube-apiserver, kube-controller-manager, and kube-scheduler (depending on the components installed for your cluster).\n\nTo check the health status of the worker nodes, you can use the following command:\n\n```shell\nkubectl get nodes\n```\n\n![nodes](./nodes.png)\n\n### View the Events in the Cluster\n\nThe final step is to view the events in the cluster. Events can be used to track changes and actions that occur in the cluster, including the creation, modification, and deletion of resources. To view the events in the cluster, you can use the following command:\n\n```shell\nkubectl get events\n```\n\n![events](./events.png)\n\nThis command will display a list of events that have occurred in the cluster, including their type, reason, message, and timestamp. You can use this information to troubleshoot issues in the cluster, such as resource allocation problems or unexpected resource deletions.\n\nYou can also filter events based on specific criteria by using this command:\n\n```shell\nkubectl get events --field-selector involvedObject.kind=Pod\n```\n\n![events2](./events2.png)\n\nThis command will display events that are related to pods. You can replace `Pod` with other resource types, such as `Service` or `Deployment`, to filter events based on specific resource types.\n\n## üîö Conclusion\n\nNow that you've got these helpful tricks and tools, fixing issues in Kubernetes (K8s) is much easier. No more frustration‚Ää‚Äî‚Ääyou'll feel like an expert! Keep things simple, smooth out any problems, and enjoy your stress-free journey with K8s.\n\n<br>\n\n**_Until next time, „Å§„Å•„Åè üéâ_**\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò **_Until next time üéâ_**\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":1192},"frontmatter":{"id":"39d6fca45194cb4adaeb8c5a","path":"/blog/k8s-debugging-tricks/","humanDate":"Oct 22, 2024","fullDate":"2024-10-22","title":"Remove Friction and Reduce Frustration with These Tricks","keywords":["Kubernetes","Debugging","Troubleshooting","Platform engineering","Kubernetes tips"],"excerpt":"Discover essential tricks and tools to solve all your Kubernetes debugging needs like a pro. Reduce friction and frustration with these expert tips.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVR42gGfAmD9AE7StE/Ssk7RsU/RsU/UtE/TtE/TtU/UtU/TtE7Ss2PvzW3/3FfgwFzmxWf202Ty0GLwzVbdvGTvzWf20wBcy7VPzL5C1tpN0clWwKtXxbFWwq9Wwa1ayrVh1cBv6dJ69Nx27dZy69J59Nt9+eFs4cp38dh+++J8+d8AbMC2VsXQb+H1XtPlV6OeUZSPVpqVV5uWT4+KY5KMcaymZ7avb8G6aLiyccS8iOngiuvjiOriievjieriAHi1vnazwGe31W+1xnexuXOrtXSstm+nsEpXWmxnZ4KDg32Njm1/f5S1uZHP25HU4o7P2YzL1ZXX4prc5wCHpsGIrtGLu+eGsNqCob2BobuOsM50i6BhYV9sb29oaWqXlpaVk5K0tLTH09m81OWry+uiw+WZutijxOQAmJrJnqznpbv8nbDykJLBfn+pg4SwhIOyk5OdzM3LnJ6fxMbGkJKSqqysx8bF3tzb1tnkvb/tlZTJm53NAKWL0KKJz5eI26CJ1KqP1bib6Z+FzG9lh1dWWpWVlbGxsmxsbY+Pj7Ozs66wsLa4uLe3tc3M0LCe0aOI0gCyftfBjO68jfO2hurCiuitftCOhJlWV1U6OjktLS1SUlJWVlZ8fHyCgoKEhISTk5N/f4GkpKPSz9TEkuYAuG7UunXuzo7/2JD/z3nwqou20djOaWdqb25vUFBQPz8/V1dXj4+Pjo6Oi4uLT09PV1dXbGptnKKbyqfYAL1i2b9j3MRr59hx96dstbu/u5mXmtfX1/Ly8rq6unJycoKCgoKCgoiIiEVFRSkpKTo6Ok5OTldYWGtlbQC/WdrAWdm/WNjBWNt/aoOrsKuPjpCzs7Onp6fKysqxsbFycnJpaWlKSkpMTExDQ0M8PDxJSUlTU1N+fn7BJpPWO1wTOgAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/04f038def1752bf137e9e41cc8c8aba6/bb8ee/debug-cover.png","srcSet":"/static/04f038def1752bf137e9e41cc8c8aba6/0dee1/debug-cover.png 750w,\n/static/04f038def1752bf137e9e41cc8c8aba6/8beaa/debug-cover.png 1080w,\n/static/04f038def1752bf137e9e41cc8c8aba6/bb8ee/debug-cover.png 1200w","sizes":"100vw"},"sources":[{"srcSet":"/static/04f038def1752bf137e9e41cc8c8aba6/a66aa/debug-cover.webp 750w,\n/static/04f038def1752bf137e9e41cc8c8aba6/65dd5/debug-cover.webp 1080w,\n/static/04f038def1752bf137e9e41cc8c8aba6/edb28/debug-cover.webp 1200w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5625}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/kube-state-metrics-monitoring/","title":"Monitoring Kubernetes Clusters with kube-state-metrics","date":"2024-10-22 21:36:00"},"excerpt":"A Comprehensive Guide to KSM ‚ò∏Ô∏è üìå Introduction kube-state-metrics (KSM) is a Kubernetes add-on that generates metrics about the state of‚Ä¶"},"nextThought":{"frontmatter":{"path":"/blog/arkade-kubernetes-developer-tools/","title":"Arkade: An Open Source Marketplace For Developer Tools üîù","date":"2024-10-22 20:55:00"},"excerpt":"One-Stop-Shop for CLI Tools¬†üõí üìë „ÄΩÔ∏è Introduction As a Platform or SRE engineer, you know how important it is to have the right tools at‚Ä¶"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}