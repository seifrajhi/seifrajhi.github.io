{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/eks-node-viewer-visualizing-node-usage/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p><strong>Optimizing AWS Kubernetes Cluster</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîä Introduction</h2>\n<p><a href=\"https://github.com/awslabs/eks-node-viewer\" target=\"_blank\" rel=\"noopener noreferrer\">EKS Node Viewer</a> is a tool for visualizing dynamic node usage within a Kubernetes cluster. It was originally developed as an internal tool at AWS for demonstrating consolidation with <a href=\"https://karpenter.sh/\" target=\"_blank\" rel=\"noopener noreferrer\">Karpenter</a>, but it is now available to the public as an open-source project.</p>\n<p>EKS Node Viewer displays the scheduled pod resource requests vs the allocatable capacity on the node. This information can be used to identify nodes that are underutilized or overutilized and to make decisions about node scaling and consolidation.</p>\n<h2 id=\"-goals-and-objectives\" style=\"position:relative;\"><a href=\"#-goals-and-objectives\" aria-label=\" goals and objectives permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üéØ Goals and Objectives</h2>\n<p>In this blog post, we will introduce EKS Node Viewer and explain how to use it to improve your Kubernetes clusters. We will also discuss some of the benefits of using EKS Node Viewer and provide some tips for getting the most out of it.</p>\n<h3 id=\"definition-and-usage\" style=\"position:relative;\"><a href=\"#definition-and-usage\" aria-label=\"definition and usage permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Definition and Usage</h3>\n<p>EKS Node Viewer is a simple but powerful tool that can be used to improve the efficiency and performance of Kubernetes clusters. It is easy to use and install, and it provides a clear and concise view of node usage. It does not look at the actual pod resource usage.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.352941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2UlEQVR42mOws3d3cvF2cPI0t3W2dXC3snO1MLbK19cvtzRocDHJC7MPinJ1cXa0dXfRN7HSNwQiS0Njax09c0VlHQZ3zwBfvzAXV18g8vYOsnX18TCxfa8n9yzO8nC1//yZiZFT06zsPTzcA1zd/PwDI7x9Q3z9w5xdfdQ0DBg0tIw0tY2BpKq6gbqmkYq6vrqqnqOSuoOWto2+nqmJoZapsYqanqqGgSpQStMQSAK1qajpyytqMcjIqWMicTkNcVl1CRl1SWk1aWk1sKCatKw6EMHVyMprAADXLTQ+RwTqWAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Node Viewer Output 1\" title=\"\" src=\"/static/d7d645bcd355f7583af717da427e5838/c5bb3/output1.png\" srcset=\"/static/d7d645bcd355f7583af717da427e5838/04472/output1.png 170w,\n/static/d7d645bcd355f7583af717da427e5838/9f933/output1.png 340w,\n/static/d7d645bcd355f7583af717da427e5838/c5bb3/output1.png 680w,\n/static/d7d645bcd355f7583af717da427e5838/b12f7/output1.png 1020w,\n/static/d7d645bcd355f7583af717da427e5838/46115/output1.png 1290w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>It also supports spot instances. Here is a small EKS cluster instance:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcWbBDD/xAAXEAADAQAAAAAAAAAAAAAAAAAAERIg/9oACAEBAAEFArLG8f/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABMSD/2gAIAQEABj8CiIs//8QAGxAAAQQDAAAAAAAAAAAAAAAAAAERICEx0eH/2gAIAQEAAT8hpoHcBMkP/9oADAMBAAIAAwAAABBzz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESFREDFBkdH/2gAIAQEAAT8QXhdWOk3+j8jFQGfBUo1KNHH/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Node Viewer Output 2\" title=\"\" src=\"/static/bb946f14ab570171af00c5f19278a676/7bf67/output2.jpg\" srcset=\"/static/bb946f14ab570171af00c5f19278a676/651be/output2.jpg 170w,\n/static/bb946f14ab570171af00c5f19278a676/d30a3/output2.jpg 340w,\n/static/bb946f14ab570171af00c5f19278a676/7bf67/output2.jpg 680w,\n/static/bb946f14ab570171af00c5f19278a676/990cb/output2.jpg 1020w,\n/static/bb946f14ab570171af00c5f19278a676/e5166/output2.jpg 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"Ô∏è-installation\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-installation\" aria-label=\"Ô∏è installation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üõ†Ô∏è Installation</h3>\n<p><strong>Homebrew:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">brew tap aws/tap\nbrew <span class=\"token function\">install</span> eks-node-viewer</code></pre></div>\n<p><strong>Manual:</strong></p>\n<p>Please either fetch the latest release or install manually using:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">go <span class=\"token function\">install</span> github.com/awslabs/eks-node-viewer/cmd/eks-node-viewer@latest</code></pre></div>\n<p><em>Note: This will install it to your GOBIN directory, typically <code class=\"language-text\">~/go/bin</code> if it is unconfigured.</em></p>\n<h3 id=\"-usage\" style=\"position:relative;\"><a href=\"#-usage\" aria-label=\" usage permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Usage</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Usage of ./eks-node-viewer:\n    <span class=\"token parameter variable\">-attribution</span>\n            Show the Open Source Attribution\n    <span class=\"token parameter variable\">-context</span> string\n            Name of the kubernetes context to use\n    -disable-pricing\n            Disable pricing lookups\n    -extra-labels string\n            A comma separated <span class=\"token builtin class-name\">set</span> of extra <span class=\"token function\">node</span> labels to display\n    <span class=\"token parameter variable\">-kubeconfig</span> string\n            Absolute path to the kubeconfig <span class=\"token function\">file</span> <span class=\"token punctuation\">(</span>default <span class=\"token string\">\"~/.kube/config\"</span><span class=\"token punctuation\">)</span>\n    -node-selector string\n            Node label selector used to filter nodes, <span class=\"token keyword\">if</span> empty all nodes are selected\n    <span class=\"token parameter variable\">-resources</span> string\n            List of comma separated resources to monitor <span class=\"token punctuation\">(</span>default <span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token parameter variable\">-v</span>\tDisplay eks-node-viewer version\n    <span class=\"token parameter variable\">-version</span>\n            Display eks-node-viewer version</code></pre></div>\n<h3 id=\"-examples\" style=\"position:relative;\"><a href=\"#-examples\" aria-label=\" examples permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìã Examples</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Standard usage</span>\neks-node-viewer\n\n<span class=\"token comment\"># Karpenter nodes only</span>\neks-node-viewer --node-selector <span class=\"token string\">\"karpenter.sh/provisioner-name\"</span>\n\n<span class=\"token comment\"># Display both CPU and Memory Usage</span>\neks-node-viewer <span class=\"token parameter variable\">--resources</span> cpu,memory\n\n<span class=\"token comment\"># Display extra labels, i.e. AZ</span>\neks-node-viewer --extra-labels topology.kubernetes.io/zone\n\n<span class=\"token comment\"># Specify a particular AWS profile and region</span>\n<span class=\"token assign-left variable\">AWS_PROFILE</span><span class=\"token operator\">=</span>myprofile <span class=\"token assign-left variable\">AWS_REGION</span><span class=\"token operator\">=</span>us-west-2 eks-node-viewer</code></pre></div>\n<h3 id=\"Ô∏è-computed-labels\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-computed-labels\" aria-label=\"Ô∏è computed labels permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üè∑Ô∏è Computed Labels</h3>\n<p>EKS Node Viewer supports some custom label names that can be passed to the <code class=\"language-text\">--extra-labels</code> to display additional node information.</p>\n<ul>\n<li><code class=\"language-text\">eks-node-viewer/node-age</code> - Age of the node</li>\n<li><code class=\"language-text\">eks-node-viewer/node-cpu-usage</code> - CPU usage (requests)</li>\n<li><code class=\"language-text\">eks-node-viewer/node-memory-usage</code> - Memory usage (requests)</li>\n<li><code class=\"language-text\">eks-node-viewer/node-pods-usage</code> - Pod usage (requests)</li>\n<li><code class=\"language-text\">eks-node-viewer/node-ephemeral-storage-usage</code> - Ephemeral Storage usage (requests)</li>\n</ul>\n<h3 id=\"Ô∏è-default-options\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-default-options\" aria-label=\"Ô∏è default options permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚öôÔ∏è Default Options</h3>\n<p>You can supply default options to EKS Node Viewer by creating a file named <code class=\"language-text\">.eks-node-viewer</code> in your home directory and specifying options there. The format is <code class=\"language-text\">option-name=value</code> where the option names are the command line flags:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># select only Karpenter managed nodes</span>\nnode-selector<span class=\"token operator\">=</span>karpenter.sh/provisioner-name\n\n<span class=\"token comment\"># display both CPU and memory</span>\n<span class=\"token assign-left variable\">resources</span><span class=\"token operator\">=</span>cpu,memory</code></pre></div>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèÅ Conclusion</h2>\n<p>EKS Node Viewer is a valuable tool for optimizing Kubernetes clusters and improving efficiency. By visualizing dynamic node usage, EKS Node Viewer can help you identify nodes that are underutilized or overutilized, and make decisions about node scaling and consolidation. This can lead to significant cost savings and improved performance.</p>\n<p>If you are running Kubernetes clusters on AWS, I highly recommend using EKS Node Viewer. It is easy to use and install, and it can provide valuable insights into your cluster usage.</p>\n<br>\n<br>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>","timeToRead":3,"rawMarkdownBody":"\n> **Optimizing AWS Kubernetes Cluster**\n\n## üîä Introduction\n\n[EKS Node Viewer](https://github.com/awslabs/eks-node-viewer) is a tool for visualizing dynamic node usage within a Kubernetes cluster. It was originally developed as an internal tool at AWS for demonstrating consolidation with [Karpenter](https://karpenter.sh/), but it is now available to the public as an open-source project.\n\nEKS Node Viewer displays the scheduled pod resource requests vs the allocatable capacity on the node. This information can be used to identify nodes that are underutilized or overutilized and to make decisions about node scaling and consolidation.\n\n## üéØ Goals and Objectives\n\nIn this blog post, we will introduce EKS Node Viewer and explain how to use it to improve your Kubernetes clusters. We will also discuss some of the benefits of using EKS Node Viewer and provide some tips for getting the most out of it.\n\n### Definition and Usage\n\nEKS Node Viewer is a simple but powerful tool that can be used to improve the efficiency and performance of Kubernetes clusters. It is easy to use and install, and it provides a clear and concise view of node usage. It does not look at the actual pod resource usage.\n\n![Node Viewer Output 1](./output1.png)\n\nIt also supports spot instances. Here is a small EKS cluster instance:\n\n![Node Viewer Output 2](./output2.jpg)\n\n### üõ†Ô∏è Installation\n\n**Homebrew:**\n\n```shell\nbrew tap aws/tap\nbrew install eks-node-viewer\n```\n\n**Manual:**\n\nPlease either fetch the latest release or install manually using:\n\n```shell\ngo install github.com/awslabs/eks-node-viewer/cmd/eks-node-viewer@latest\n```\n\n*Note: This will install it to your GOBIN directory, typically `~/go/bin` if it is unconfigured.*\n\n### üöÄ Usage\n\n```shell\nUsage of ./eks-node-viewer:\n    -attribution\n            Show the Open Source Attribution\n    -context string\n            Name of the kubernetes context to use\n    -disable-pricing\n            Disable pricing lookups\n    -extra-labels string\n            A comma separated set of extra node labels to display\n    -kubeconfig string\n            Absolute path to the kubeconfig file (default \"~/.kube/config\")\n    -node-selector string\n            Node label selector used to filter nodes, if empty all nodes are selected\n    -resources string\n            List of comma separated resources to monitor (default \"cpu\")\n    -v\tDisplay eks-node-viewer version\n    -version\n            Display eks-node-viewer version\n```\n\n### üìã Examples\n\n```shell\n# Standard usage\neks-node-viewer\n\n# Karpenter nodes only\neks-node-viewer --node-selector \"karpenter.sh/provisioner-name\"\n\n# Display both CPU and Memory Usage\neks-node-viewer --resources cpu,memory\n\n# Display extra labels, i.e. AZ\neks-node-viewer --extra-labels topology.kubernetes.io/zone\n\n# Specify a particular AWS profile and region\nAWS_PROFILE=myprofile AWS_REGION=us-west-2 eks-node-viewer\n```\n\n### üè∑Ô∏è Computed Labels\n\nEKS Node Viewer supports some custom label names that can be passed to the `--extra-labels` to display additional node information.\n\n- `eks-node-viewer/node-age` - Age of the node\n- `eks-node-viewer/node-cpu-usage` - CPU usage (requests)\n- `eks-node-viewer/node-memory-usage` - Memory usage (requests)\n- `eks-node-viewer/node-pods-usage` - Pod usage (requests)\n- `eks-node-viewer/node-ephemeral-storage-usage` - Ephemeral Storage usage (requests)\n\n### ‚öôÔ∏è Default Options\n\nYou can supply default options to EKS Node Viewer by creating a file named `.eks-node-viewer` in your home directory and specifying options there. The format is `option-name=value` where the option names are the command line flags:\n\n```shell\n# select only Karpenter managed nodes\nnode-selector=karpenter.sh/provisioner-name\n\n# display both CPU and memory\nresources=cpu,memory\n```\n\n## üèÅ Conclusion\n\nEKS Node Viewer is a valuable tool for optimizing Kubernetes clusters and improving efficiency. By visualizing dynamic node usage, EKS Node Viewer can help you identify nodes that are underutilized or overutilized, and make decisions about node scaling and consolidation. This can lead to significant cost savings and improved performance.\n\nIf you are running Kubernetes clusters on AWS, I highly recommend using EKS Node Viewer. It is easy to use and install, and it can provide valuable insights into your cluster usage.\n\n<br>\n<br>\n\n> üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  **_Until next time üéâ_**\n\n\nüöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:\n\n**‚ôªÔ∏è LinkedIn:** https://www.linkedin.com/in/rajhi-saif/\n\n**‚ôªÔ∏è X/Twitter:** https://x.com/rajhisaifeddine\n\n**The end ‚úåüèª**\n\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n\n**üìÖ Stay updated**\n\nSubscribe to our newsletter for more insights on AWS cloud computing and containers.\n","wordCount":{"words":460},"frontmatter":{"id":"918c571d36b01de0ae2a64a4","path":"/blog/eks-node-viewer-visualizing-node-usage/","humanDate":"Oct 27, 2024","fullDate":"2024-10-27","title":"eks-node-viewer: A Tool for Visualizing Dynamic Node Usage in EKS Clusters¬†üöÄ","keywords":["eks-node-viewer","EKS clusters","DevOps","SRE"],"excerpt":"Explore how eks-node-viewer helps visualize dynamic node usage in EKS clusters for better optimization.","cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAv/aAAwDAQACEAMQAAABg0oWsDzONX//xAAZEAACAwEAAAAAAAAAAAAAAAACAwABERL/2gAIAQEAAQUCWFWIKEIbuL3GsZg9bP/EABkRAAEFAAAAAAAAAAAAAAAAAAABAhESE//aAAgBAwEBPwFyWgzP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/ARbb/8QAGxAAAwACAwAAAAAAAAAAAAAAAAEREiExQeH/2gAIAQEABj8Cj5psiShj0emz/8QAHRAAAQQCAwAAAAAAAAAAAAAAAQARITFBgVHR4f/aAAgBAQABPyFnwfbKkBpB2oCm+9cpkABinRkwL66X/9oADAMBAAIAAwAAABAnD//EABgRAQADAQAAAAAAAAAAAAAAAAEAETFR/9oACAEDAQE/EKqHSV7P/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQBREf/aAAgBAgEBPxAijtxl/8QAGhABAQADAQEAAAAAAAAAAAAAAREAIVExYf/aAAgBAQABPxAICD4cOYZSArfV5lRwKN1xZgUVgAX0RrL43XYOcyMhCacP/9k="},"images":{"fallback":{"src":"/static/da8a627e2f937ba793a0ea6dd77063b0/3f4ea/node-viewer-cover.jpg","srcSet":"/static/da8a627e2f937ba793a0ea6dd77063b0/3f4ea/node-viewer-cover.jpg 600w","sizes":"100vw"},"sources":[{"srcSet":"/static/da8a627e2f937ba793a0ea6dd77063b0/9ff6b/node-viewer-cover.webp 600w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6666666666666666}}},"coverCredits":"Photo by Saifeddine Rajhi"}}},"pageContext":{"prevThought":{"frontmatter":{"path":"/blog/pack-dockerfile-less-deployment-kubernetes/","title":"Pack: Dockerfile-less Deployment to Kubernetes with Cloud Native Buildpacks","date":"2024-10-27 19:34:00"},"excerpt":"Build your OCI images using Buildpacks ‚ÑπÔ∏è Overview In the ecosystem of containerization, Docker has long been the de facto standard for‚Ä¶","html":"<blockquote>\n<p><strong>Build your OCI images using Buildpacks</strong></p>\n</blockquote>\n<h2 id=\"‚ÑπÔ∏è-overview\" style=\"position:relative;\"><a href=\"#%E2%84%B9%EF%B8%8F-overview\" aria-label=\"‚ÑπÔ∏è overview permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>‚ÑπÔ∏è Overview</h2>\n<p>In the ecosystem of containerization, Docker has long been the de facto standard for building and deploying applications. However, the rise of open standards such as the <a href=\"https://opencontainers.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Open Container Initiative (OCI)</a> has paved the way for alternative approaches that offer greater flexibility and simplicity.</p>\n<p>One such approach is <a href=\"https://buildpacks.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Cloud Native Buildpacks (CNB)</a>, a project that aims to unify the buildpack ecosystem and provide a platform-agnostic way to build OCI images. CNB is implemented by a number of tools, including <a href=\"https://buildpacks.io/docs/tools/pack/\" target=\"_blank\" rel=\"noopener noreferrer\">Pack</a>, a CLI that enables users to build, manage, and deploy applications using buildpacks.</p>\n<p>In this blog post, we will explore how Pack can be used to achieve Dockerfile-less deployment to Kubernetes. We will discuss the benefits of using buildpacks over Dockerfiles, and we will demonstrate how to use Pack to build and deploy a simple Node.js application to Kubernetes.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVR42q2R20rEQAyG+/5v4613guAL6KULLqK1x+lhOofM9N8kdZddFKFgIaVNMl/+P1Pgn59iT3NeV8SYYQYLM1osS8BsPRYXEULCyvVdwJQyImUcjiVe3z7R9hPKqkdnZjhHyPkbKGSJHwBOXWflQIgJxFAfiCNqhEiaz2eFnRl5UnsDE9Dj/Qum9+GS2CwTiJUOk0XVGtTtAMvWEw+7AKumx8dXo82Rkloz84KHuye0z0dk7pGaqLKL1x7ZncA6M8H7bYiYLORFlDRSzjpF7DsXUJsB/WxlJ5onrjsfGJ4YZFHWPYsxmGbPwHX/pcgOI20uRG3TjXrjutezwr8AK24vRRTIrsSJhDpL23dS4E6FG/SXQVf/JwdVEyiuqhKRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pack\" title=\"\" src=\"/static/915b0257c814fdbe81ddab643c019f45/c5bb3/pack.png\" srcset=\"/static/915b0257c814fdbe81ddab643c019f45/04472/pack.png 170w,\n/static/915b0257c814fdbe81ddab643c019f45/9f933/pack.png 340w,\n/static/915b0257c814fdbe81ddab643c019f45/c5bb3/pack.png 680w,\n/static/915b0257c814fdbe81ddab643c019f45/b12f7/pack.png 1020w,\n/static/915b0257c814fdbe81ddab643c019f45/b5a09/pack.png 1360w,\n/static/915b0257c814fdbe81ddab643c019f45/29007/pack.png 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-oci-image-standard-a-foundation-for-portable-and-interoperable-containerization\" style=\"position:relative;\"><a href=\"#-oci-image-standard-a-foundation-for-portable-and-interoperable-containerization\" aria-label=\" oci image standard a foundation for portable and interoperable containerization permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üì¶ OCI Image Standard: A Foundation for Portable and Interoperable Containerization</h2>\n<p>OCI images, or Open Container Initiative images, are a standard format for container images. They are defined by the Open Container Initiative (OCI), a non-profit organization that aims to create open standards for containerization.</p>\n<p>OCI images are composed of a manifest, a set of filesystem layers, and a configuration. The manifest lists the layers that make up the image, as well as other metadata such as the image name and the author. The filesystem layers are stored as tarballs, and they contain the files that make up the image. The configuration file contains information about the image, such as the environment variables that should be set when the image is run.</p>\n<p>OCI images are designed to be portable across different container runtimes. This means that an OCI image can be run on any runtime that supports the OCI image format. Some popular container runtimes that support OCI images include <a href=\"https://www.docker.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker</a>, <a href=\"https://cri-o.io/\" target=\"_blank\" rel=\"noopener noreferrer\">CRI-O</a>, and <a href=\"https://containerd.io/\" target=\"_blank\" rel=\"noopener noreferrer\">containerd</a>.</p>\n<p>OCI images are the de facto standard for container images. They are used by a wide variety of organizations, including Google, Amazon, and Microsoft.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 47.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIEBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAezOkSof/8QAGhAAAQUBAAAAAAAAAAAAAAAAAAECEBIhMf/aAAgBAQABBQJ+FROT/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAgIDAAAAAAAAAAAAAAAAASEAAiAyUf/aAAgBAQAGPwIMvk2tj//EABgQAQEAAwAAAAAAAAAAAAAAAAERECAx/9oACAEBAAE/IWKg4MGIC2af/9oADAMBAAIAAwAAABBDD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAESBhMXHw/9oACAEBAAE/EDJd6D5l3s3EYSFW8uH/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"oci\" title=\"\" src=\"/static/552b1728e6ea5d491d61d5166dfe8f0c/7bf67/oci.jpg\" srcset=\"/static/552b1728e6ea5d491d61d5166dfe8f0c/651be/oci.jpg 170w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/d30a3/oci.jpg 340w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/7bf67/oci.jpg 680w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/990cb/oci.jpg 1020w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/c44b8/oci.jpg 1360w,\n/static/552b1728e6ea5d491d61d5166dfe8f0c/b17f8/oci.jpg 1600w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<hr>\n<h2 id=\"-pack-a-swift-solution-for-docker-image-creation\" style=\"position:relative;\"><a href=\"#-pack-a-swift-solution-for-docker-image-creation\" aria-label=\" pack a swift solution for docker image creation permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üöÄ Pack: A Swift Solution for Docker Image Creation</h2>\n<p>Pack is a convenient tool for swiftly constructing Docker images for your projects without the need for individual Dockerfiles. This enables you to efficiently Dockerize numerous projects without having to write Dockerfiles for each one.</p>\n<p>Buildpacks automatically identify the programming language of your project as well as any required dependencies, such as <code class=\"language-text\">pom.xml</code>, <code class=\"language-text\">build.gradle</code>, or <code class=\"language-text\">requirements.txt</code> files. All you have to do for each project is run a single command, which makes it simple to incorporate into your CI/CD pipeline for automated Docker image creation.</p>\n<hr>\n<h3 id=\"-benefits-of-using-buildpacks-over-dockerfiles\" style=\"position:relative;\"><a href=\"#-benefits-of-using-buildpacks-over-dockerfiles\" aria-label=\" benefits of using buildpacks over dockerfiles permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Benefits of Using Buildpacks Over Dockerfiles</h3>\n<p>There are a number of benefits to using buildpacks over Dockerfiles. These include:</p>\n<ul>\n<li><strong>Simplicity</strong>: Buildpacks are designed to be simpler to use than Dockerfiles. They are based on the idea of detecting the programming language and project structure of an application, and then applying a series of build steps that are appropriate for that language and project. This means that users do not need to have a deep understanding of how to create Dockerfiles.</li>\n<li><strong>Flexibility</strong>: Buildpacks are more flexible than Dockerfiles. They can be used to build a wider range of images, and they can be more easily adapted to changes in the underlying application. For example, if a buildpack is updated to support a new version of a programming language, all images that are built using that buildpack will automatically benefit from the update.</li>\n<li><strong>Portability</strong>: Buildpacks are portable across different platforms. This means that an image that is built using a buildpack can be deployed to any platform that supports OCI images.</li>\n</ul>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 79.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAdtFQZSf/8QAGhAAAgIDAAAAAAAAAAAAAAAAATEAAhIyQv/aAAgBAQABBQLqyxg2Kqv/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8BZH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAEDFB/9oACAEBAAY/AtVK/wD/xAAaEAACAwEBAAAAAAAAAAAAAAABEQAhMWFB/9oACAEBAAE/IQdLEBpLklrgXLF+PJU6fJjS5P/aAAwDAQACAAMAAAAQuN//xAAYEQADAQEAAAAAAAAAAAAAAAAAAREhQf/aAAgBAwEBPxDjqLbD/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERIUH/2gAIAQIBAT8Q2iWf/8QAGhABAQADAQEAAAAAAAAAAAAAAREAITFBcf/aAAgBAQABPxDY7gc1iTDtOfcTFaunE14J5R6Ex13JYZcdbe9TY5//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Benefits\" title=\"\" src=\"/static/7ad030aa1c03089c29a3d491b47156c0/04df2/Benefits.jpg\" srcset=\"/static/7ad030aa1c03089c29a3d491b47156c0/651be/Benefits.jpg 170w,\n/static/7ad030aa1c03089c29a3d491b47156c0/d30a3/Benefits.jpg 340w,\n/static/7ad030aa1c03089c29a3d491b47156c0/04df2/Benefits.jpg 522w\" sizes=\"(max-width: 522px) 100vw, 522px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"hands-on\" style=\"position:relative;\"><a href=\"#hands-on\" aria-label=\"hands on permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-on</h2>\n<p>To illustrate the capabilities of buildpacks, let's consider a basic Node.js application as an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">myapp\n‚îú‚îÄ‚îÄ package.json\n‚îî‚îÄ‚îÄ src\n    ‚îî‚îÄ‚îÄ index.js</code></pre></div>\n<p>To containerize our application in a container, we typically create a Dockerfile. This file contains the essential instructions for constructing an environment that will be used to execute our application.</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:latest</span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /app</span>\n<span class=\"token comment\"># add our code to our future image</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> package.json /app/package.json</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> src/ /app/src</span>\n<span class=\"token comment\"># launch npm which will install the Node.js dependencies of the application</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm install</span>\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> <span class=\"token string\">'npm start'</span></span></code></pre></div>\n<p>Once built, we can inspect our image with <code class=\"language-text\">docker inspect</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">(...)\n  <span class=\"token property\">\"Config\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Hostname\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Domainname\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"User\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"AttachStdin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"AttachStdout\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"AttachStderr\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Tty\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"OpenStdin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"StdinOnce\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"NODE_VERSION=16.17.0\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"YARN_VERSION=1.22.19\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Cmd\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"-c\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"npm start\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Image\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sha256:ca5108589bcee5007319db215f0f22048fb7b75d4d6c16e6310ef044c58218c0\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Volumes\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"WorkingDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/app\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Entrypoint\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"docker-entrypoint.sh\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"OnBuild\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Labels\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  (...)\n      <span class=\"token property\">\"Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"layers\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Layers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"sha256:20833a96725ec17c9ab15711400e43781a7b7fe31d23fc6c78a7cca478935d33\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:07b905e91599cd0251bd575fb77d0918cd4f40b64fa7ea50ff82806c60e2ba61\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:5cbe2d191b8f91d974fbba38b5ddcbd5d4882e715a9e008061ab6d2ec432ef7b\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:47b6660a2b9bb2091a980c361a1c15b2a391c530877961877138fffc50d2f6f7\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:1e69483976e43c657172c073712c3d741245f9141fb560db5af7704aee95114c\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:a51886a0928017dc307b85b85c6fb3f9d727b5204ea944117ce59c4b4acc5e05\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:ba9804f7abedf8ddea3228539ae12b90966272d6eb02fd2c57446e44d32f1b70\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:c77311ff502e318598cc7b6c03a5bd25182f7f6f0352d9b68fad82ed7b4e8c26\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:93a6676fffe0813e4ca03cae4769300b539b66234e95be66d86c3ac7748c1321\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:3cf3c6f03984f8a31c0181feb75ac056fc2bd56ef8282af9a72dafd1b6bb0c41\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:02dacaf7071cc5792c28a4cf54141b7058ee492c93f04176f8f3f090c42735eb\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:85152f012a08f63dfaf306c01ac382c1962871bf1864b357549899ec2fa7385d\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"sha256:8ceb0bd5afef8a5fa451f89273974732cd0c89dac2c80ff8b7855531710fbc49\"</span>\n      <span class=\"token punctuation\">]</span>\n  (...)</code></pre></div>\n<p>We can see a configuration block with:</p>\n<ul>\n<li>The environment variables</li>\n<li>The entrypoint command, the default command</li>\n<li>The working directory</li>\n<li>The user of the image</li>\n</ul>\n<p>And a second block Layers with a list of checksums. Each checksum corresponds to a compressed archive file (.tar.gz). All these layers applied on top of each other build a complete filesystem.</p>\n<h3 id=\"Ô∏è-how-docker-builds-images\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-how-docker-builds-images\" aria-label=\"Ô∏è how docker builds images permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèóÔ∏è How Docker builds images</h3>\n<p>To comprehend how Docker constructs an image, it is essential to be familiar with the <code class=\"language-text\">docker commit</code> command. This command operates on a running container and creates an image from the state of that container.</p>\n<p>This mechanism is utilized, for instance, in the <code class=\"language-text\">RUN npm install</code> instruction:</p>\n<ol>\n<li>Docker starts an intermediate container.</li>\n<li>Within this container, the <code class=\"language-text\">npm install</code> command is executed.</li>\n<li>Once the command is complete, Docker commits the container, and the difference between the previous image allows for the creation of an additional layer, resulting in a new intermediate image.</li>\n</ol>\n<p>However, <code class=\"language-text\">docker build</code> has one significant drawback: by default, the build is not reproducible. Two consecutive <code class=\"language-text\">docker builds</code> with the same Dockerfile will not necessarily produce the same layers, and therefore the same checksums. This phenomenon is primarily caused by timestamps. Each file in a standard Linux filesystem has a creation date, a last modification date, and a last access date. Additionally, the image has a timestamp that is embedded in the image and alters the checksum. This makes it very difficult to isolate our different layers, and it is challenging to logically associate an operation in our Dockerfile with a layer in our final image.</p>\n<p>For modifications to the base image (the <code class=\"language-text\">FROM</code> instruction, for security reasons, for example), Docker must perform a complete build. Additionally, uploading this update to our registry necessitates sending all the layers. Depending on the size of our image, this can lead to a significant amount of traffic on each of our machines hosting our image and wishing to update.</p>\n<p>An image is simply a stack of layers on top of each other, along with configuration files. However, Docker (and its Dockerfile) is not the only way to build an image. Buildpacks offer a different principle for building images. Buildpacks is a project incubated at the <a href=\"https://www.cncf.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Cloud Native Computing Foundation</a>.</p>\n<h2 id=\"-how-buildpack-builds-images\" style=\"position:relative;\"><a href=\"#-how-buildpack-builds-images\" aria-label=\" how buildpack builds images permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üáµüá∏ How buildpack builds images</h2>\n<p>A buildpack is a set of executable scripts that will allow you to build and launch your application. A buildpack is made of 3 components:</p>\n<ol>\n<li><code class=\"language-text\">buildpack.toml</code>: the metadata of your buildpack.</li>\n<li><code class=\"language-text\">bin/detect</code>: script that determines if the buildpack applies to your application.</li>\n<li><code class=\"language-text\">bin/build</code>: script launching the build sequence of the application.</li>\n</ol>\n<p>Building your application means running buildpacks one after the other. To do this we use a builder. A builder is an image including a whole set of buildpacks, a lifecycle, and a reference to a very light run image in which we will integrate our application. The build image/run image couple is called a stack.</p>\n<p>Coming back to our Node.js application, Buildpack will only use the information in the <code class=\"language-text\">package.json</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"myapp\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.1\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"express\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^4.18.1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node src/index.js\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"engines\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"16\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This is all we need to build an image containing our application with buildpacks:</p>\n<ul>\n<li>The base image (the <code class=\"language-text\">FROM</code> of the Dockerfile) will be the one specified in the stack.</li>\n<li>The buildpacks lifecycle detects a <code class=\"language-text\">package.json</code> and thus starts the installation process of Node.js and the dependencies.</li>\n<li>The version of Node will be the version specified in the <code class=\"language-text\">package.json</code>.</li>\n<li>The default command will be <code class=\"language-text\">node src/index.js</code> because it is the start command of the <code class=\"language-text\">package.json</code>.</li>\n</ul>\n<p>The only command you need to know to use buildpacks is the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">pack build myapp <span class=\"token parameter variable\">--builder</span> gcr.io/buildpacks/builder:v1</code></pre></div>\n<p>Here we use the builder provided by Google <code class=\"language-text\">gcr.io/buildpacks/builder:v1</code>. Other builders are available (see <code class=\"language-text\">pack stack suggest</code>) or you can build your own! It is then directly possible to launch our application.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">docker</span> run myapp\n<span class=\"token operator\">></span> myapp@0.0.1 start\n<span class=\"token operator\">></span> <span class=\"token function\">node</span> src/index.js\nExample app listening on port <span class=\"token number\">3000</span></code></pre></div>\n<h3 id=\"-advantages-of-using-buildpacks\" style=\"position:relative;\"><a href=\"#-advantages-of-using-buildpacks\" aria-label=\" advantages of using buildpacks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üåü Advantages of using buildpacks</h3>\n<p>The advantages of using buildpacks include:</p>\n<ul>\n<li>The absence of a Dockerfile. The developer can concentrate on his code only.</li>\n<li>The respect of good image building practices, in terms of security, limitation of the number and size of layers. This is the responsibility of the buildpack designer, not the developer.</li>\n<li>Caching is native, whether it's the binaries to be installed or the software libraries.</li>\n<li>Uses your organization's best practices if you create your own buildpack (use of internal mirrors, code analysis‚Ä¶).</li>\n<li>Each layer of the final image is logically linked with the dependencies it brings.</li>\n<li>Each operation of a buildpack touches only a restricted area (a folder with the name of the buildpack in the run image).</li>\n<li>Buildpacks allow obtaining reproducible builds with less effort.</li>\n<li>The files copied into the image all have a timestamp with a value of 0.</li>\n<li>It is however necessary that the intermediate build steps (e.g. compilation of Java code) must be idempotent.</li>\n<li>This allows launching an operation that buildpacks calls 'rebase'.</li>\n</ul>\n<h3 id=\"-image-rebasing-with-buildpacks\" style=\"position:relative;\"><a href=\"#-image-rebasing-with-buildpacks\" aria-label=\" image rebasing with buildpacks permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üîÑ Image rebasing with Buildpacks</h3>\n<p>Image rebasing is the ability to swap out multiple layers of an image without having to modify the upper layers. This is particularly useful when updating the base image of our run image.</p>\n<p>As an example, let's consider a Node.js application (which I'm simplifying for the sake of brevity):</p>\n<p>At build time, Buildpacks rely on the lightest possible run image, adding layer by layer:</p>\n<ul>\n<li>A layer containing the Node binaries.</li>\n<li>A layer containing the <code class=\"language-text\">node_modules</code> (dependencies) of our application.</li>\n</ul>\n<p>Note that the <code class=\"language-text\">npm</code> binary is not needed in our run image. It will not be included, but it is used in our build image to install the <code class=\"language-text\">node_modules</code> that will be integrated into our run image.</p>\n<p>If our container is deployed in Kubernetes and a flaw is discovered in its base image, it is necessary to update the base image. With Docker, this would require rebuilding our image completely, and uploading our entire new image to our registry, and each Kubernetes worker would have to download this new image.</p>\n<p>This is not necessary with Buildpacks. Only the layers related to the base image need to be uploaded. For example, we can compare two OCI images, one with an Ubuntu 18.04 base image and the other with an Ubuntu 20.04 base image. The first 3 layers (in blue) are the Ubuntu-related layers. The next layers (in red) are the layers added by Buildpacks. These layers are identical. This behavior is possible in Docker (but complex to set up), but it is the default behavior with Buildpacks.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVR42mNQ1zbUNnRQ07JQ0bRU1UIgRTUzU0tnRxcPFW1nDV2gAgc1bQdVLXs1bQhyVFK3YDBUVI3TNE/QtgSiRB1LCAOI4tXNYs0dna1tQxUNE3WtE3Ws4ChBxypZ18ZXxZBBT142WFE6REk2TFk2REkGyICgYDmJUAM9JysrLwnhIEWZIAXpQHlpEKkgHSAvFawg7SIrBQBf2SVTwPOOcAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"change\" title=\"\" src=\"/static/e814e2c5621d360f2f8e23d40a9068bd/a6d36/change.png\" srcset=\"/static/e814e2c5621d360f2f8e23d40a9068bd/04472/change.png 170w,\n/static/e814e2c5621d360f2f8e23d40a9068bd/9f933/change.png 340w,\n/static/e814e2c5621d360f2f8e23d40a9068bd/a6d36/change.png 650w\" sizes=\"(max-width: 650px) 100vw, 650px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>If you want to easily implement good image creation practices for your containerized applications, Buildpacks is an excellent choice to consider. It easily integrates with your CI/CD via projects like <a href=\"https://github.com/pivotal/kpack\" target=\"_blank\" rel=\"noopener noreferrer\">kpack</a>. It may even already be integrated into your DevOps infrastructure as Buildpacks is the one behind <a href=\"https://docs.gitlab.com/ee/topics/autodevops/\" target=\"_blank\" rel=\"noopener noreferrer\">Gitlab's Auto DevOps feature</a>.</p>\n<h2 id=\"-closing-thoughts\" style=\"position:relative;\"><a href=\"#-closing-thoughts\" aria-label=\" closing thoughts permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìå Closing thoughts</h2>\n<p>Buildpacks offer a compelling alternative to Dockerfiles for building container images. They are simpler to use, more flexible, and more portable. Additionally, Buildpacks provide a number of advantages over Dockerfiles, such as reproducible builds and image rebasing.</p>\n<p>As the containerization landscape continues to evolve, Buildpacks are poised to play a major role in the future of container image creation. If you are looking for a way to simplify and streamline your containerization workflow, then Buildpacks are a great option to consider.</p>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"},"nextThought":{"frontmatter":{"path":"/blog/securing-monitoring-stack-dead-man-switch/","title":"Never Get Caught Blind: Securing Your Monitoring Stack with a Dead Man Switch üëÄ","date":"2024-10-27 18:06:00"},"excerpt":"Who Watches the Watchers and the Monitoring Stack? üëÆ üí¨ Introduction Nowadays, monitoring systems play an important role in ensuring the‚Ä¶","html":"<blockquote>\n<p><strong>Who Watches the Watchers and the Monitoring Stack? üëÆ</strong></p>\n</blockquote>\n<h2 id=\"-introduction\" style=\"position:relative;\"><a href=\"#-introduction\" aria-label=\" introduction permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üí¨ Introduction</h2>\n<p>Nowadays, monitoring systems play an important role in ensuring the smooth operation of critical infrastructure.</p>\n<p>However, what happens when the monitoring system itself falters? This is where the concept of a <a href=\"https://deadmanssnitch.com/\" target=\"_blank\" rel=\"noopener noreferrer\">dead man switch</a> comes into play.</p>\n<p>A dead man switch, in the context of monitoring, serves as an independent watchdog, tasked with keeping an eye on the monitoring system. If the monitoring system fails to provide <a href=\"https://en.wikipedia.org/wiki/Heartbeat_(computing)\" target=\"_blank\" rel=\"noopener noreferrer\">regular heartbeats</a> to the dead man switch, it triggers an alarm, alerting operators to a potential problem.</p>\n<h2 id=\"-objectives\" style=\"position:relative;\"><a href=\"#-objectives\" aria-label=\" objectives permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>ü•Ö Objectives</h2>\n<p>This blog post is a deep dive into the implementation of a dead man switch for <a href=\"https://prometheus.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Prometheus</a>, a widely used monitoring tool. We'll explore the tools and techniques involved in setting up this guardian of the guardians, ensuring that our monitoring system remains vigilant and reliable.</p>\n<p>By the end of this post, you'll have a clear understanding of how a dead man switch can safeguard your monitoring system and prevent blind spots in your infrastructure.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEz0lEQVR42gHEBDv7AAsTFgAAAAABAQAAAAAAAAIHCwwSFw0aHgtBSh5JUi5KUzlNU0tSU1pXU1pWUk1QTzhJTiFDSwg8Rww8RgAPXGQLDhEAAAABAgIAAAADCAwTGB0aIiYgRk82UVlIVFliXFqOdF6gfVyee1mPclhpX1VASk8hRk0gQEcABomPEF1iCgwOAAAAAQEBBAcKGB8lJysyNUtSTVpfdGVdnXBUyJlh1q1q1apnzJ9jo3dUcFpPQFheETU/AAqAhgV/ghRMUhMbHgAAAAQGCRsgJy0yO0FMUm1lY6FzWsiGT+OzaPDWiO/VhOfEc8+LSphwVDtXYQ4tNgAZmKgGfoQVYGk2UFsqMTQAAAAZHiMwNUBLTlSPb13Df0vfo1nxzn778sH79Mn235nor1mrfV06T1QRMDcAD4+cDZmnFVxmJD9IWG97PkBECgsOKzA7T05Tk29cypNr6bNh9uCZ/f73/v//+u6/78Jku4ZhSlRREC42AAt2eglschNeZxw7QkZcZY2aqWReZDc4QkZFTHJTTLF6ae2uV/Tck/7/+f7///nuv+6+YLKFY0BPVA8iKgAJfIYNYmYUWF4WOUA8TlN4qrulxtpUT1lAQE17doKtiInapHvtvmr335734qfvzX7io06GblocKzQFCw8ABoGKCIGIEkZNES0zL0pQKZu6Qb3jQUZROzdCfIyomYudrX9635RF57168Pfn4MykxHo9XEhABwoRAQQGAAp1ewZ4exBGSxAYHBtJWQGu3Aar2DFBSickKzxUaE9ohqBvWcBuM8mje97//8HIt4leRTw5OQACBgEBAgAHbHMFbnMUU1kWMTUaQk4QgaERlrgjOkIaFRcZRFshcpJsaGF9TjmajXjG9eSbu6dPUlApMzcDBwwHFhwACHB5BWhvEE1UFDI3GDU+KICZVKK5GC43Cw0QHURcL1NgNGBsU2Fobo6HsefLgbKfJ0lPHTU8CxsjCB0mAApzdwVmaQ5SVxIxNxstNRJ5nhew4QsiKhsYGUJmdkhjbkBncihjd0yGhKDcvmqmlQxATBQ1PgkaIAYbIwAIcnQEcnANVloPLzUXKC8PTWsCgrkIHCMRDAonOkAoSFI/XWQHT2QubW+LzrBYnIwAM0ISMjsKGiAFGyIABnFyA2trDExPDi8zDSIsAR0zBDJNGSwyJiovME5bQlpfQFxpFzE4cYx9h7GbO2hmETlFFjM6CRkfBRkfAAV7fgNpaw5LTQ0tLwskKwQiLhU0PSc/RzxOWDZQWz1TXH2Ri8rOpP/+yqCljx41RCtGTzI/QwoYHgQWHAANYGEKLi8ePkIbNz0PJy0TKzMdMzwhOEETKzccNT83Qj9wgHLj7rDl7q+SooQaNkQjP0gdLDEUGR0HERUAEhUbDxAUDBIVDx4jFy01GTA6Eyo2ECc0DyYvQVpMf5Zwka+Fv9mcz+elgZx6EzA+HThCFzQ+Dh0iDQ8SAAUMEAQLEQsZJhAlNRAmMxs0Oi9NRVN3XIivfq3VlbTdmrPamazRlLndm3aYdBEqNhoxORgvORcxOwkWGgAQJCcnRkE1WUxKdVZglGVzrXGIxH2SzoKQy4GKxH2IwXyJwn6Mw3+WzoZnlWoRJzIWLTUVLDMVLTUVLzdkK5VPW0cNiwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"dms\" title=\"\" src=\"/static/5ea78d6221ddecfdc2ea528584b7892e/01e7c/dms.png\" srcset=\"/static/5ea78d6221ddecfdc2ea528584b7892e/04472/dms.png 170w,\n/static/5ea78d6221ddecfdc2ea528584b7892e/9f933/dms.png 340w,\n/static/5ea78d6221ddecfdc2ea528584b7892e/01e7c/dms.png 512w\" sizes=\"(max-width: 512px) 100vw, 512px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-dead-mans-switch\" style=\"position:relative;\"><a href=\"#-dead-mans-switch\" aria-label=\" dead mans switch permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìò Dead Man's Switch</h2>\n<p>A monitoring system can be very simple, like a ping to a server IP, or it can be as complex as monitoring every component in a distributed system to ensure everything is working as expected. No matter how sophisticated the monitoring system is, we rely on them to ensure that our main system is in a healthy state. But what happens when your monitoring system fails? How do you know that your monitoring system is healthy?</p>\n<p>A frequent question I get asked when working with our DevOps teams is:</p>\n<blockquote>\n<p><strong>Who is monitoring the monitoring system to make sure it's working?</strong></p>\n</blockquote>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB30lEQVR42oWTbY/SQBSF+f+/xY9GP7jGdaOyQFgxvK4CUqBMaaFv9L2dPs7UJQiaeJOTO83tnDN37plWLSV1XZOmKVEUEcdxgyRJyPO8ga7pb13XWaMsy2bfLVrUEqhxjw7mdoMldji2zWg0otvp0H964lHl3W7HZrNBCNFAk+r4izCMJWEKcaGQg5tI0qpCKuR5QVVo5M3Pf0ZdyxfcEHZmEXc9wbuuyedJxKe9xTDYsIocNrnLOAqwconuI60kSSkpZXUh5oawv6y4/+ZyPzjSVeu2WHE36/J2+IWH7YSPfsr7tc/dQvDoVXx1F4jTmKiw8DNDdXXUrBdCxy+w/RIvkuyDgkloMQ5NRt5abTZo+xmvxwav+jMe7ISf4ZTvxgd64zds3R52PKSo0hdSSevg2EzGQ6aTEbZqN1ITtlTO1HQLNUmRVhhRrogy1kmBeXpmabX5YbZZH7u46RwpL3fZMs0tq5XBfr9vLCKExWAwUAITNXUT33WZKUFHiWiLnaKQnTCVqMA+CCpZXLesp6kVzqG9FgQBVfX74o+KcDqb4XoesbKKYzvM53MWiyWGsb46XUN4XtwWzjbJsowwDBsRLeYqAU04nU6brv5h7Gt//S/0tXjqtIfDoXktt/ELAa9G78y6ljAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/50a19ac56732f90aa55f1d0ac63b0216/c5bb3/image.png\" srcset=\"/static/50a19ac56732f90aa55f1d0ac63b0216/04472/image.png 170w,\n/static/50a19ac56732f90aa55f1d0ac63b0216/9f933/image.png 340w,\n/static/50a19ac56732f90aa55f1d0ac63b0216/c5bb3/image.png 680w,\n/static/50a19ac56732f90aa55f1d0ac63b0216/b12f7/image.png 1020w,\n/static/50a19ac56732f90aa55f1d0ac63b0216/fbf76/image.png 1252w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>We can borrow a concept from the physical engineering world: the <a href=\"https://en.wikipedia.org/wiki/Dead_man&#x27;s_switch\" target=\"_blank\" rel=\"noopener noreferrer\">dead man's switch</a>.</p>\n<p>The idea revolves around ensuring that we can receive a signal to trigger an alarm at any unpredictable moment. To achieve this, we can flip the logic: instead of relying on a signal to activate the alarm, we can set it up so that the alarm goes off when we <strong>do not</strong> receive a signal. This approach is quite straightforward! This principle, often referred to as a <a href=\"https://en.wikipedia.org/wiki/Heartbeat_(computing)\" target=\"_blank\" rel=\"noopener noreferrer\">¬´heartbeat¬ª</a>, is used in various applications, including clustering, and is also employed in military contexts.</p>\n<p>In this scenario, if the operator (like Prometheus) goes offline or malfunctions, it will stop sending its \"OK\" response, which will then trigger an alert.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.11764705882352%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACQ0lEQVR42m1U227aQBDN/39EGymoalVVykOkPhRI4pZEbapETYH0zjU4Bl+xvbbX9p7ODoYY5JEGdndmz5yzs+ujolT4FozQ8wb45PXhSwEz8XHlDXHtD/EjnCOUaTV/wFf/N/QeJ43Q8/u48ge4C/7SGtiOJI0u/Fuc2gZOHQOrLMC/yMKrxSVOphfouUN4WYw3poHXjx9xtvwCvWcee2hNDbRmBs7MW+RFBci/ChBZCS/K4cYSXpzDCiREuslSapOcyhJlyensslCQudrFnwF1MgVykpJTUkGeka+TAr7IqYCEG20K1U1L13vqtgPMSEY9FOUZHCG4QJaX7I9eSswzrMKMwU0/46KVyH1AWQGqKvR5OUF7/pMzi4r52BYMahNbLX+d5OyNDOUBQ71hFUoELPn5bOum5cZZ2QwYS8lMtgecEKBTMWEnyU8kd7neuE3Fpk7C40bJ19YYlgh3EgWBaI+p05qpBl+Q3ITXCy6gzy8QRTPDICGGtf5rORGBuXSVLGJRl7xN0+caZ42Am4DaA9QyC7p3ihmXFAvTnNmNVoK7rfcEh03ZQrghsQlKZhUlBJYo+GHJYz8uIGjurklqqjbXhpjHseL4HqCW1o9GMJw+2tZ3LEWEWeShu9TzPu69GWyR0HyADya9XfsXs3yKQ3Qtev/OA+7XY5bPgPrCvl/doGV2cLJo84fhT2SitejgeNbBpd3nD8HxtIsXo3O8fezxFZtELl5OaG18jnfzG3qCB29ZqVrv66Zq/4c5DWv/AXL4ghnCpD3zAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/32118deec60cf303716385f78ccb8b2d/c5bb3/image-1.png\" srcset=\"/static/32118deec60cf303716385f78ccb8b2d/04472/image-1.png 170w,\n/static/32118deec60cf303716385f78ccb8b2d/9f933/image-1.png 340w,\n/static/32118deec60cf303716385f78ccb8b2d/c5bb3/image-1.png 680w,\n/static/32118deec60cf303716385f78ccb8b2d/b12f7/image-1.png 1020w,\n/static/32118deec60cf303716385f78ccb8b2d/b5a09/image-1.png 1360w,\n/static/32118deec60cf303716385f78ccb8b2d/51dd6/image-1.png 1952w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h2 id=\"-why-do-we-need-it\" style=\"position:relative;\"><a href=\"#-why-do-we-need-it\" aria-label=\" why do we need it permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üèó Why Do We Need It</h2>\n<p>Your monitoring solution is your bread and butter for knowing when you have issues with your infrastructure. But what happens if it has issues? Unless you are monitoring your system health dashboards 24/7, you will want to have some notification configured to let you know if your monitoring solution itself is experiencing issues.</p>\n<p>To do this, we'll want to create a rule that always triggers in Prometheus (think if <code class=\"language-text\">False == True</code>).</p>\n<h3 id=\"integrations\" style=\"position:relative;\"><a href=\"#integrations\" aria-label=\"integrations permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Integrations</h3>\n<p>Integrations help bring alerts from Dead Man's Snitch into the systems and services your team uses.</p>\n<p>Supported Integrations:</p>\n<ul>\n<li><a href=\"https://deadmanssnitch.com/docs/integrations/teams\" target=\"_blank\" rel=\"noopener noreferrer\">Microsoft Teams</a></li>\n<li><a href=\"https://deadmanssnitch.com/docs/integrations/opsgenie\" target=\"_blank\" rel=\"noopener noreferrer\">Opsgenie</a></li>\n<li><a href=\"https://deadmanssnitch.com/docs/integrations/pagerduty\" target=\"_blank\" rel=\"noopener noreferrer\">PagerDuty</a></li>\n<li><a href=\"https://deadmanssnitch.com/docs/integrations/slack\" target=\"_blank\" rel=\"noopener noreferrer\">Slack</a></li>\n<li><a href=\"https://deadmanssnitch.com/docs/integrations/victor-ops\" target=\"_blank\" rel=\"noopener noreferrer\">VictorOps</a></li>\n<li><a href=\"https://deadmanssnitch.com/docs/integrations/webhooks\" target=\"_blank\" rel=\"noopener noreferrer\">Webhooks</a></li>\n</ul>\n<h2 id=\"hands-on\" style=\"position:relative;\"><a href=\"#hands-on\" aria-label=\"hands on permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Hands-On</h2>\n<p>To transform the concept of a dead man's switch into the Prometheus world, we need to:</p>\n<ol>\n<li><strong>Create a Prometheus alert</strong> that will fire regularly, like the train conductor pushing the button.</li>\n<li><strong>Configure the Alertmanager</strong> to send to another system outside our primary monitoring system.</li>\n<li><strong>Set up the outside system</strong> to take care of the alert and notify us if it doesn't receive the alert.</li>\n</ol>\n<p>In the following sections, we will go through each of these steps in detail.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 117.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAADfUlEQVR42q1VS4sjVRQeBEFm7ULUjS6EWbgRF/4Axb8guPKxcUDGhSAqKIPoQsGVDP4DXQiiM2Jnphv7kX4kpjGPqkrSSedRValKPW89U0lVJd/ce3vSdtOZpgUPnDp17z33u+ee75yqa7hUFo/06nKNPfI8x3g8BiEEnU4Hoiig1jhCs63iqKtRK0OQhlT7qNfrUFWV+5qmifl8fhEwTVM4jsMnPM+FOnIg7H+O0u+vorL2JvbvvoG/772G+ta76PcHCIKA+9q2zfeuBHRd99HUHBk91O58idHBS+gVX0Fz42UMizcgH76FLP83IgY4m80uArLJZYSLxYKnwPcJkokH01CgyF3EoQvingewLOvxgGxxKdPpFN1jGUPZgKIaGAx1yMqYjnWEYXzqx3J4JcDFPEfsSUj8GtxxCf32A/peRUSqND3R1SJkpy1lEtvorD+N8i9Pon7vOppr13H461PobTwBS13/71fOsyms3o8wu99Db38LRfwazuAOyPAOkmh0NVKWgCc1qUEfE6iaA8sOaBnZGOkOVUL9TGRZxn0ZkSvL5iwgY9myI9huDNsJYVoeJUhFGKV87JKEAubcl5XaJYAnOcyyFCPpNrT6e9AaN9Etv4Ne+W2MxZt0/AEM6UNaQublgGc7JUtn6O29DqnwDMTCc+huvkCL+kU07z8PYe1Z6KUb8MmA+xLyGECWE8ZyHMeIogjKUMJh+T4GxxWYmgBdFaApdUiNbXTaFd56SZLwIJb5PAfIhIH5vs+bvlSq0BQQxJMZ+gMV1ZoIQWyjcljja5IoQZIk+hERIcsyz/sFwLMShsHpycyZtyMfL+DSqFgnzWk1sHxneX4xQraBXTWZTJBSZ7EhwHNcTOgcizikNprOEFPyhFYLrh9gSoEm1JftWcmyqigY6hqEQQ+FnS38c9RCuV7DQamEg2IRhZ9/Qmt/F7t/3EWT2uNKGYYiQzeMc8ScAtpjA781q/iqWMB3uw/wzfaf+GF/A+xCdqMK4bOPUP70Flq3P0Hti49RuvU+RpvrCGcpZtNkBSBluWcZ2Bt0sNttY+e4hUrvCDlNR2Aa0Pa2aflsQt75CyP6Lm9tINRG8MMI6Zn244DsM27Rvgw8H6FLEBCP28g7Yd0LqKVVQKIYLgVwwhBORLvG8zhJK1lmk/MVevqzWix1ziLgumC66if1f8pD5GO7iblWma4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"alt text\" title=\"\" src=\"/static/5d08d7b2e5070900b428a4a74592580f/c5bb3/image-2.png\" srcset=\"/static/5d08d7b2e5070900b428a4a74592580f/04472/image-2.png 170w,\n/static/5d08d7b2e5070900b428a4a74592580f/9f933/image-2.png 340w,\n/static/5d08d7b2e5070900b428a4a74592580f/c5bb3/image-2.png 680w,\n/static/5d08d7b2e5070900b428a4a74592580f/b12f7/image-2.png 1020w,\n/static/5d08d7b2e5070900b428a4a74592580f/302a4/image-2.png 1080w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"setting-up-the-dead-mans-switch\" style=\"position:relative;\"><a href=\"#setting-up-the-dead-mans-switch\" aria-label=\"setting up the dead mans switch permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Setting Up the Dead Man's Switch</h3>\n<p>I will use the following services and tools:</p>\n<ul>\n<li><a href=\"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack\" target=\"_blank\" rel=\"noopener noreferrer\">kube-prometheus-stack Helm chart</a> to deploy Prometheus and Alertmanager.</li>\n<li><a href=\"https://deadmanssnitch.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Dead Man's Snitch</a> to send the alerts to.</li>\n<li>A Kubernetes cluster to deploy onto. I will use Docker Desktop for Mac to deploy the services, but you can use any Kubernetes cluster you want.</li>\n</ul>\n<h4 id=\"sign-up-for-dead-mans-snitch\" style=\"position:relative;\"><a href=\"#sign-up-for-dead-mans-snitch\" aria-label=\"sign up for dead mans snitch permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Sign Up for Dead Man's Snitch</h4>\n<p>Dead Man's Snitch is a monitoring tool for cron, <a href=\"https://addons.heroku.com/scheduler\" target=\"_blank\" rel=\"noopener noreferrer\">Heroku Scheduler</a>, or any periodic process. Dead Man's Snitch will notify you when your scheduled tasks don't run so you can investigate before it becomes a problem.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAt0lEQVR42qWSyw7CIBBF+/+f4o+4dd9q2ZSHBbQ82rhortNpXBYjkpxAyHAyw0wzSIkjpFK49T26rkPbthBC8F3pTZPmjBJ3O0JpDWU0n2NOxfhmCzgk7TzDxKScUYwnisJEZJKs64rPynOuF0aSbVn5ECGMRU88QqDSqoWJM7pKjdP5wgzWYV4yQq2QpSR4vRYm/VfyTqDGTCkyobYp38bpZ6H1DtY5jM7y/GljaLcw9IfO+0PhGwcN/Q9d2Le7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Sign up page\" title=\"\" src=\"/static/9f2ef18bff3f1e2addf3fbbb63364baa/c5bb3/account.png\" srcset=\"/static/9f2ef18bff3f1e2addf3fbbb63364baa/04472/account.png 170w,\n/static/9f2ef18bff3f1e2addf3fbbb63364baa/9f933/account.png 340w,\n/static/9f2ef18bff3f1e2addf3fbbb63364baa/c5bb3/account.png 680w,\n/static/9f2ef18bff3f1e2addf3fbbb63364baa/b12f7/account.png 1020w,\n/static/9f2ef18bff3f1e2addf3fbbb63364baa/c1b63/account.png 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>A Snitch looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">curl</span> https://nosnch.in/c2354d53d2</code></pre></div>\n<p>It's a unique URL we create for you to add to jobs you want to be monitored. If you want to add a Snitch to your backup cron job, it would look something like this:</p>\n<p>To create a snitch:</p>\n<ol>\n<li>Log in and click \"Create Your First Snitch\".</li>\n<li>Give your Snitch a name (Nightly Backup, Data Import, Monthly Invoice, etc.).</li>\n<li>Choose an interval. This is based on how often your task runs. If you have an hourly task, then choose hourly. If you have a task that runs every six hours, round up to Daily.</li>\n<li>Type in an email address that you would like to be alerted at should your task fail. If you leave this space blank, your Snitch alerts will be sent to the email you used to sign up with. Click \"Save\".</li>\n</ol>\n<p>The next page displays your unique Snitch URL in the blue box followed by examples of how your Snitch can be used. For each Snitch you create, a new URL will be created. Simply curl the unique Snitch URL after your task (as shown in the examples).</p>\n<p>To tell your Snitch to start checking, hit the URL. You can manually hit the URL by pasting your Snitch URL into a browser window and hitting return. Refresh the page. The box next to your Snitch should be green.</p>\n<p>That's it! If your process fails to run, Dead Man's Snitch will email you.</p>\n<p><img src=\"/abe81a46d267e9a529b9108aa856a662/snitch.gif\" alt=\"snitch\" loading=\"lazy\">\n          </p>\n<p>The next page displays your unique Snitch URL and methods for checking in your Snitch: cURL, <a href=\"https://deadmanssnitch.com/docs/field-agent\" target=\"_blank\" rel=\"noopener noreferrer\">Field Agent</a>, <a href=\"https://deadmanssnitch.com/blog/snitch-check-in-via-email\" target=\"_blank\" rel=\"noopener noreferrer\">email</a>, Ruby, and Python.</p>\n<p>To kick off the checking-in process for your Snitch, you'll send a request for the unique Snitch URL. The most common and basic method is using cURL and it would look something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">run_backups_or_something.sh <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">curl</span> https://nosnch.in/c2354d53d2</code></pre></div>\n<p>For the purpose of the test Snitch, cURL only the Snitch URL in the terminal or paste the Snitch URL in your browser.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVR42nWSyW7aUBSG71Ok21RMggA2XSAhVrwIuzTdFGyk0GYR5jxAum5eo0W46iaNAaXbRGrTQplthjCVQVXM33uvC1EaYunT+f/zn2PJ1iGhUAhujweiT4QoivAKXgiCAI/XQ/tu7Ln34Pf7EQgEuN+GIArYfb6L/Zf7ILFYDBEpClmWEaX1MH6I+Js45JiM15EIItEIJEmCJEtcb4PtHbw6wOm7U5BvN99Rb9Rx8/MHR+/p0LoaRae6yzH1vX+KttYBufx6iWKxiHK5zCmVStyrRXVTVVXFhXphevXes2w9f/7lHFfXVyDD4RCMwWCA0XBEMX2/38c6ux3cmvlotJkbj8cP5lidzWYgtVoNzWYTjUYD1WoVlUoF9Xqde6bXOcvYr6n9qvE+yzudDnq9Hn+ZpmmYTCYgHfrdLPgfXdfRbrf5IKPVaqHb7fI+82xmOp1isVhgPp9zlsslSDAYhN1uh9PphMvl4nWNy+mCw+Hg5+R74YPVaoXNZttgsVg4TD/b2UE4HAbJZNNIZzLInZxQcpxsLvtAJ1MppNJJJJIJzvE/EskkjhMJmqXw9ugI78/OQK7bn2HgDoaxwlOPYRhYrbbnd7T9h+4yftPTIfnCBxSUAkf5pDyCZwUTRVEeYe4q+JjP8xP6C0Nbmf6ReOREAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"test\" title=\"\" src=\"/static/1676add9d9cddbc23df8dbfb97b6656e/c5bb3/test.png\" srcset=\"/static/1676add9d9cddbc23df8dbfb97b6656e/04472/test.png 170w,\n/static/1676add9d9cddbc23df8dbfb97b6656e/9f933/test.png 340w,\n/static/1676add9d9cddbc23df8dbfb97b6656e/c5bb3/test.png 680w,\n/static/1676add9d9cddbc23df8dbfb97b6656e/b12f7/test.png 1020w,\n/static/1676add9d9cddbc23df8dbfb97b6656e/c1b63/test.png 1200w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<p>On the hour, every hour, Dead Man's Snitch looks to see if your Snitch checked in during the previous hour. Since you just checked in your Snitch manually, and our alert type is set to Basic, we won't check on your Snitch until the next full hour. For example, if you manually checked in your Snitch at 2:10 p.m., the next full hour it monitors doesn't start until the period of 3‚Äì4 p.m. This means we won't check for your Snitch until 4:01 p.m. Once you check-in, we will continue to monitor your Snitches on the hour, every hour.</p>\n<p>We'll keep watching your Snitch, expecting it to check in every hour. We'll alert you at the end of the expected interval if it doesn't check-in.</p>\n<h3 id=\"terraform-code\" style=\"position:relative;\"><a href=\"#terraform-code\" aria-label=\"terraform code permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Terraform Code</h3>\n<p>We can automate the creation of snitch. I have created a <a href=\"https://github.com/seifrajhi/Terraform-Dead-Mans-Snitch-module/tree/main\" target=\"_blank\" rel=\"noopener noreferrer\">Terraform module</a> to automate it.</p>\n<div class=\"gatsby-highlight\" data-language=\"hcl\"><pre class=\"language-hcl\"><code class=\"language-hcl\"><span class=\"token keyword\">terraform</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">required_providers</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">dmsnitch</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">source</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"plukevdh/dmsnitch\"</span>\n            <span class=\"token property\">version</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"0.1.5\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">provider<span class=\"token type variable\"> \"dmsnitch\" </span></span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">api_key</span> <span class=\"token punctuation\">=</span> var.dms_key\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">resource <span class=\"token type variable\">\"dmsnitch_snitch\"</span></span> <span class=\"token string\">\"dmsnitch\"</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">name</span> <span class=\"token punctuation\">=</span> var.snitch_name\n    <span class=\"token property\">notes</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"DeadMan's Switch ensures proper functioning of k8s Alertmanager alerting pipeline\"</span>\n\n    <span class=\"token property\">interval</span> <span class=\"token punctuation\">=</span> var.snitch_interval\n    <span class=\"token property\">type</span> <span class=\"token punctuation\">=</span> var.snitch_type\n    <span class=\"token property\">tags</span> <span class=\"token punctuation\">=</span> var.snitch_tags\n    <span class=\"token property\">alert_email</span> <span class=\"token punctuation\">=</span> var.snitch_emails\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To apply it, you can use your values:</p>\n<div class=\"gatsby-highlight\" data-language=\"hcl\"><pre class=\"language-hcl\"><code class=\"language-hcl\"><span class=\"token keyword\">module<span class=\"token type variable\"> \"dmsnitch\" </span></span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">source</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"git::https://github.com/seifrajhi/Terraform-Dead-Mans-Snitch-module.git?ref=v1.0.0\"</span>\n\n    <span class=\"token property\">snitch_name</span>     <span class=\"token punctuation\">=</span> <span class=\"token string\">\"dms-demo-blog\"</span>\n    <span class=\"token property\">snitch_interval</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"5_minute\"</span>\n    <span class=\"token property\">snitch_type</span>     <span class=\"token punctuation\">=</span> <span class=\"token string\">\"basic\"</span>\n    <span class=\"token property\">snitch_tags</span>     <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"DMS\"</span>, <span class=\"token string\">\"demo\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token property\">snitch_emails</span>   <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"example@example.com\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"deploying-prometheus-and-alertmanager\" style=\"position:relative;\"><a href=\"#deploying-prometheus-and-alertmanager\" aria-label=\"deploying prometheus and alertmanager permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Deploying Prometheus and Alertmanager</h3>\n<p>I use the default values to deploy the <a href=\"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack\" target=\"_blank\" rel=\"noopener noreferrer\">kube-prometheus-stack Helm chart</a>. The only thing I changed is setting the Alertmanager configuration to use the deadmanssnitch.com service when it receives it's not receiving an alert.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">alertmanager:\n    config:\n        receivers:\n            - name: <span class=\"token string\">'null'</span>\n            - name: deadman\n                webhook_configs:\n                    - url: <span class=\"token string\">\"https://nosnch.in/c2354d53d2\"</span>\n        route:\n            routes:\n                - match:\n                        alertname: Watchdog\n                    receiver: deadman\n                    group_wait: 0s\n                    group_interval: 1m\n                    repeat_interval: 50s\nprometheus-node-exporter:\n    hostRootFsMount:\n        enabled: <span class=\"token boolean\">false</span></code></pre></div>\n<p>Then run the following commands</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">helm repo <span class=\"token function\">add</span> prometheus-community https://prometheus-community.github.io/helm-charts\nhelm upgrade <span class=\"token parameter variable\">-i</span> monitoring prometheus-community/kube-prometheus-stack <span class=\"token parameter variable\">-f</span> values.yaml</code></pre></div>\n<p>The good thing about the kube-prometheus-stack Helm chart is that there is already a Prometheus alert configured that acts as a heartbeat. The alert is called Watchdog and here is the alert rule:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">alert</span><span class=\"token punctuation\">:</span> Watchdog\n                <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n                        This is an alert meant to ensure that the entire alerting pipeline is functional.\n                        This alert is always firing, therefore it should always be firing in Alertmanager\n                        and always fire against a receiver. There are integrations with various notification\n                        mechanisms that send a notification when this alert is not firing. For example the\n                        \"DeadMansSnitch\" integration in PagerDuty.</span>\n                    <span class=\"token key atrule\">runbook_url</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//runbooks.prometheus<span class=\"token punctuation\">-</span>operator.dev/runbooks/general/watchdog\n                    <span class=\"token key atrule\">summary</span><span class=\"token punctuation\">:</span> An alert that should always be firing to certify that Alertmanager\n                        is working properly.\n                <span class=\"token key atrule\">expr</span><span class=\"token punctuation\">:</span> vector(1)\n                <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">severity</span><span class=\"token punctuation\">:</span> none</code></pre></div>\n<p>If everything went well, you should see the Watchdog alert firing in the Alertmanager dashboard.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVR42nWSWQqEQAwFvf8p/RAVd3FfM1TgyeD0BKRNJ6m8RKNpmixJEqvr2u77tvM8rSgKy7LMxnE0jHsMP01Ty/Pc9n23kEXrujqEIgpI3rbNrusyYjTs+966rvOTvOM4PBYELsvyOLzP8+xAjEKUAOcELsV/FQpIEl2BCEgRvuLcc6pBEEgA6Ht0HgFk5HDPFNRp/B+FLLppmqd7WZa+y+8RMXw+lj4K9+TSWH5EByAaSXt7j0zj731XVWVxHHtcSnl8ZEYFKqAgxAQnzqhSPAyDtW3rtYqTGwHR7qQopJC4FJKv5gJyukJepETy375M/x9ggZTLPTv8AJLHENjSJLzgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"logic\" title=\"\" src=\"/static/86e9cb03a086f37228e7ae5f631acc0c/c5bb3/logic.png\" srcset=\"/static/86e9cb03a086f37228e7ae5f631acc0c/04472/logic.png 170w,\n/static/86e9cb03a086f37228e7ae5f631acc0c/9f933/logic.png 340w,\n/static/86e9cb03a086f37228e7ae5f631acc0c/c5bb3/logic.png 680w,\n/static/86e9cb03a086f37228e7ae5f631acc0c/c1c45/logic.png 824w\" sizes=\"(max-width: 680px) 100vw, 680px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n          </p>\n<h3 id=\"lets-break-it\" style=\"position:relative;\"><a href=\"#lets-break-it\" aria-label=\"lets break it permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>Let's break it</h3>\n<p>Now that we have everything set up, let's break it and see what happens. For this, I will <strong>scale down the Alertmanager and the operator to 0</strong>.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl scale statefulset alertmanager-monitoring-kube-prometheus-alertmanager <span class=\"token parameter variable\">--replicas</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\nkubectl scale deployment monitoring-kube-prometheus-operator <span class=\"token parameter variable\">--replicas</span><span class=\"token operator\">=</span><span class=\"token number\">0</span></code></pre></div>\n<p>Let's see what happens in the <strong>deadmanssnitch.com</strong> dashboard. We should see in the status column that the check is late. This means that the check didn't receive a ping in the last 2 minutes.</p>\n<p>To fix the problem, we need to scale up the Alertmanager and the operator again.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">kubectl scale statefulset alertmanager-monitoring-kube-prometheus-alertmanager <span class=\"token parameter variable\">--replicas</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nkubectl scale deployment monitoring-kube-prometheus-operator <span class=\"token parameter variable\">--replicas</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></code></pre></div>\n<h2 id=\"-conclusion\" style=\"position:relative;\"><a href=\"#-conclusion\" aria-label=\" conclusion permalink\" class=\"anchor before\"><svg class=\"anchor-icon\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a>üìë Conclusion</h2>\n<p>In this article, we learned how to create a dead man's switch implementation with Prometheus and Alertmanager. Of course, a dead man's switch is not a silver bullet, but it is an important part of a monitoring system and helps to build a more robust monitoring system.</p>\n<p>In the end, we need to make sure that our systems are up and running, and if they are not, which can happen more often than we think, we need to be notified as soon as possible. This means also when the monitoring system itself is not working.</p>\n<p><strong>References</strong></p>\n<ul>\n<li><a href=\"https://deadmanssnitch.com/docs/api/\" target=\"_blank\" rel=\"noopener noreferrer\">https://deadmanssnitch.com/docs/api/</a></li>\n</ul>\n<br>\n<p><strong><em>Until next time, „Å§„Å•„Åè üéâ</em></strong></p>\n<blockquote>\n<p>üí° Thank you for Reading !! üôåüèªüòÅüìÉ, see you in the next blog.ü§ò  <strong><em>Until next time üéâ</em></strong></p>\n</blockquote>\n<p>üöÄ Thank you for sticking up till the end. If you have any questions/feedback regarding this blog feel free to connect with me:</p>\n<p><strong>‚ôªÔ∏è LinkedIn:</strong> <a href=\"https://www.linkedin.com/in/rajhi-saif/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.linkedin.com/in/rajhi-saif/</a></p>\n<p><strong>‚ôªÔ∏è X/Twitter:</strong> <a href=\"https://x.com/rajhisaifeddine\" target=\"_blank\" rel=\"noopener noreferrer\">https://x.com/rajhisaifeddine</a></p>\n<p><strong>The end ‚úåüèª</strong></p>\n<h1 align=\"center\">üî∞ Keep Learning !! Keep Sharing !! üî∞</h1>\n<p><strong>üìÖ Stay updated</strong></p>\n<p>Subscribe to our newsletter for more insights on AWS cloud computing and containers.</p>"}}},"staticQueryHashes":["1271460761","1321585977"],"slicesMap":{}}